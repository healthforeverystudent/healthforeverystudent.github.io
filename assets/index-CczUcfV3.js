function yG(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();function SF(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function bG(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var IS={exports:{}},_p={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vA;function xG(){if(vA)return _p;vA=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,r,i){var a=null;if(i!==void 0&&(a=""+i),r.key!==void 0&&(a=""+r.key),"key"in r){i={};for(var o in r)o!=="key"&&(i[o]=r[o])}else i=r;return r=i.ref,{$$typeof:n,type:s,key:a,ref:r!==void 0?r:null,props:i}}return _p.Fragment=e,_p.jsx=t,_p.jsxs=t,_p}var wA;function vG(){return wA||(wA=1,IS.exports=xG()),IS.exports}var I=vG(),$S={exports:{}},ht={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SA;function wG(){if(SA)return ht;SA=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;function m(W){return W===null||typeof W!="object"?null:(W=f&&W[f]||W["@@iterator"],typeof W=="function"?W:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,w={};function x(W,ee,me){this.props=W,this.context=ee,this.refs=w,this.updater=me||y}x.prototype.isReactComponent={},x.prototype.setState=function(W,ee){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,ee,"setState")},x.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function T(){}T.prototype=x.prototype;function E(W,ee,me){this.props=W,this.context=ee,this.refs=w,this.updater=me||y}var $=E.prototype=new T;$.constructor=E,b($,x.prototype),$.isPureReactComponent=!0;var C=Array.isArray,O={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function F(W,ee,me,de,be,_e){return me=_e.ref,{$$typeof:n,type:W,key:ee,ref:me!==void 0?me:null,props:_e}}function R(W,ee){return F(W.type,ee,void 0,void 0,void 0,W.props)}function N(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function D(W){var ee={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(me){return ee[me]})}var k=/\/+/g;function z(W,ee){return typeof W=="object"&&W!==null&&W.key!=null?D(""+W.key):ee.toString(36)}function B(){}function ne(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(B,B):(W.status="pending",W.then(function(ee){W.status==="pending"&&(W.status="fulfilled",W.value=ee)},function(ee){W.status==="pending"&&(W.status="rejected",W.reason=ee)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function J(W,ee,me,de,be){var _e=typeof W;(_e==="undefined"||_e==="boolean")&&(W=null);var Ne=!1;if(W===null)Ne=!0;else switch(_e){case"bigint":case"string":case"number":Ne=!0;break;case"object":switch(W.$$typeof){case n:case e:Ne=!0;break;case d:return Ne=W._init,J(Ne(W._payload),ee,me,de,be)}}if(Ne)return be=be(W),Ne=de===""?"."+z(W,0):de,C(be)?(me="",Ne!=null&&(me=Ne.replace(k,"$&/")+"/"),J(be,ee,me,"",function(Be){return Be})):be!=null&&(N(be)&&(be=R(be,me+(be.key==null||W&&W.key===be.key?"":(""+be.key).replace(k,"$&/")+"/")+Ne)),ee.push(be)),1;Ne=0;var Ve=de===""?".":de+":";if(C(W))for(var Le=0;Le<W.length;Le++)de=W[Le],_e=Ve+z(de,Le),Ne+=J(de,ee,me,_e,be);else if(Le=m(W),typeof Le=="function")for(W=Le.call(W),Le=0;!(de=W.next()).done;)de=de.value,_e=Ve+z(de,Le++),Ne+=J(de,ee,me,_e,be);else if(_e==="object"){if(typeof W.then=="function")return J(ne(W),ee,me,de,be);throw ee=String(W),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return Ne}function K(W,ee,me){if(W==null)return W;var de=[],be=0;return J(W,de,"","",function(_e){return ee.call(me,_e,be++)}),de}function re(W){if(W._status===-1){var ee=W._result;ee=ee(),ee.then(function(me){(W._status===0||W._status===-1)&&(W._status=1,W._result=me)},function(me){(W._status===0||W._status===-1)&&(W._status=2,W._result=me)}),W._status===-1&&(W._status=0,W._result=ee)}if(W._status===1)return W._result.default;throw W._result}var Z=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)};function he(){}return ht.Children={map:K,forEach:function(W,ee,me){K(W,function(){ee.apply(this,arguments)},me)},count:function(W){var ee=0;return K(W,function(){ee++}),ee},toArray:function(W){return K(W,function(ee){return ee})||[]},only:function(W){if(!N(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},ht.Component=x,ht.Fragment=t,ht.Profiler=r,ht.PureComponent=E,ht.StrictMode=s,ht.Suspense=l,ht.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,ht.act=function(){throw Error("act(...) is not supported in production builds of React.")},ht.cache=function(W){return function(){return W.apply(null,arguments)}},ht.cloneElement=function(W,ee,me){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var de=b({},W.props),be=W.key,_e=void 0;if(ee!=null)for(Ne in ee.ref!==void 0&&(_e=void 0),ee.key!==void 0&&(be=""+ee.key),ee)!V.call(ee,Ne)||Ne==="key"||Ne==="__self"||Ne==="__source"||Ne==="ref"&&ee.ref===void 0||(de[Ne]=ee[Ne]);var Ne=arguments.length-2;if(Ne===1)de.children=me;else if(1<Ne){for(var Ve=Array(Ne),Le=0;Le<Ne;Le++)Ve[Le]=arguments[Le+2];de.children=Ve}return F(W.type,be,void 0,void 0,_e,de)},ht.createContext=function(W){return W={$$typeof:a,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:i,_context:W},W},ht.createElement=function(W,ee,me){var de,be={},_e=null;if(ee!=null)for(de in ee.key!==void 0&&(_e=""+ee.key),ee)V.call(ee,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(be[de]=ee[de]);var Ne=arguments.length-2;if(Ne===1)be.children=me;else if(1<Ne){for(var Ve=Array(Ne),Le=0;Le<Ne;Le++)Ve[Le]=arguments[Le+2];be.children=Ve}if(W&&W.defaultProps)for(de in Ne=W.defaultProps,Ne)be[de]===void 0&&(be[de]=Ne[de]);return F(W,_e,void 0,void 0,null,be)},ht.createRef=function(){return{current:null}},ht.forwardRef=function(W){return{$$typeof:o,render:W}},ht.isValidElement=N,ht.lazy=function(W){return{$$typeof:d,_payload:{_status:-1,_result:W},_init:re}},ht.memo=function(W,ee){return{$$typeof:u,type:W,compare:ee===void 0?null:ee}},ht.startTransition=function(W){var ee=O.T,me={};O.T=me;try{var de=W(),be=O.S;be!==null&&be(me,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(he,Z)}catch(_e){Z(_e)}finally{O.T=ee}},ht.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},ht.use=function(W){return O.H.use(W)},ht.useActionState=function(W,ee,me){return O.H.useActionState(W,ee,me)},ht.useCallback=function(W,ee){return O.H.useCallback(W,ee)},ht.useContext=function(W){return O.H.useContext(W)},ht.useDebugValue=function(){},ht.useDeferredValue=function(W,ee){return O.H.useDeferredValue(W,ee)},ht.useEffect=function(W,ee){return O.H.useEffect(W,ee)},ht.useId=function(){return O.H.useId()},ht.useImperativeHandle=function(W,ee,me){return O.H.useImperativeHandle(W,ee,me)},ht.useInsertionEffect=function(W,ee){return O.H.useInsertionEffect(W,ee)},ht.useLayoutEffect=function(W,ee){return O.H.useLayoutEffect(W,ee)},ht.useMemo=function(W,ee){return O.H.useMemo(W,ee)},ht.useOptimistic=function(W,ee){return O.H.useOptimistic(W,ee)},ht.useReducer=function(W,ee,me){return O.H.useReducer(W,ee,me)},ht.useRef=function(W){return O.H.useRef(W)},ht.useState=function(W){return O.H.useState(W)},ht.useSyncExternalStore=function(W,ee,me){return O.H.useSyncExternalStore(W,ee,me)},ht.useTransition=function(){return O.H.useTransition()},ht.version="19.0.0",ht}var TA;function a_(){return TA||(TA=1,$S.exports=wG()),$S.exports}var we=a_();const Hl=SF(we);var CS={exports:{}},Ip={},NS={exports:{}},kS={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EA;function SG(){return EA||(EA=1,function(n){function e(K,re){var Z=K.length;K.push(re);e:for(;0<Z;){var he=Z-1>>>1,W=K[he];if(0<r(W,re))K[he]=re,K[Z]=W,Z=he;else break e}}function t(K){return K.length===0?null:K[0]}function s(K){if(K.length===0)return null;var re=K[0],Z=K.pop();if(Z!==re){K[0]=Z;e:for(var he=0,W=K.length,ee=W>>>1;he<ee;){var me=2*(he+1)-1,de=K[me],be=me+1,_e=K[be];if(0>r(de,Z))be<W&&0>r(_e,de)?(K[he]=_e,K[be]=Z,he=be):(K[he]=de,K[me]=Z,he=me);else if(be<W&&0>r(_e,Z))K[he]=_e,K[be]=Z,he=be;else break e}}return re}function r(K,re){var Z=K.sortIndex-re.sortIndex;return Z!==0?Z:K.id-re.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],u=[],d=1,f=null,m=3,y=!1,b=!1,w=!1,x=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function $(K){for(var re=t(u);re!==null;){if(re.callback===null)s(u);else if(re.startTime<=K)s(u),re.sortIndex=re.expirationTime,e(l,re);else break;re=t(u)}}function C(K){if(w=!1,$(K),!b)if(t(l)!==null)b=!0,ne();else{var re=t(u);re!==null&&J(C,re.startTime-K)}}var O=!1,V=-1,F=5,R=-1;function N(){return!(n.unstable_now()-R<F)}function D(){if(O){var K=n.unstable_now();R=K;var re=!0;try{e:{b=!1,w&&(w=!1,T(V),V=-1),y=!0;var Z=m;try{t:{for($(K),f=t(l);f!==null&&!(f.expirationTime>K&&N());){var he=f.callback;if(typeof he=="function"){f.callback=null,m=f.priorityLevel;var W=he(f.expirationTime<=K);if(K=n.unstable_now(),typeof W=="function"){f.callback=W,$(K),re=!0;break t}f===t(l)&&s(l),$(K)}else s(l);f=t(l)}if(f!==null)re=!0;else{var ee=t(u);ee!==null&&J(C,ee.startTime-K),re=!1}}break e}finally{f=null,m=Z,y=!1}re=void 0}}finally{re?k():O=!1}}}var k;if(typeof E=="function")k=function(){E(D)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,B=z.port2;z.port1.onmessage=D,k=function(){B.postMessage(null)}}else k=function(){x(D,0)};function ne(){O||(O=!0,k())}function J(K,re){V=x(function(){K(n.unstable_now())},re)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(K){K.callback=null},n.unstable_continueExecution=function(){b||y||(b=!0,ne())},n.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<K?Math.floor(1e3/K):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(K){switch(m){case 1:case 2:case 3:var re=3;break;default:re=m}var Z=m;m=re;try{return K()}finally{m=Z}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(K,re){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var Z=m;m=K;try{return re()}finally{m=Z}},n.unstable_scheduleCallback=function(K,re,Z){var he=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?he+Z:he):Z=he,K){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=Z+W,K={id:d++,callback:re,priorityLevel:K,startTime:Z,expirationTime:W,sortIndex:-1},Z>he?(K.sortIndex=Z,e(u,K),t(l)===null&&K===t(u)&&(w?(T(V),V=-1):w=!0,J(C,Z-he))):(K.sortIndex=W,e(l,K),b||y||(b=!0,ne())),K},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(K){var re=m;return function(){var Z=m;m=re;try{return K.apply(this,arguments)}finally{m=Z}}}}(kS)),kS}var _A;function TG(){return _A||(_A=1,NS.exports=SG()),NS.exports}var AS={exports:{}},Xs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IA;function EG(){if(IA)return Xs;IA=1;var n=a_();function e(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)u+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function i(l,u,d){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:f==null?null:""+f,children:l,containerInfo:u,implementation:d}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,u){if(l==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Xs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Xs.createPortal=function(l,u){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return i(l,u,null,d)},Xs.flushSync=function(l){var u=a.T,d=s.p;try{if(a.T=null,s.p=2,l)return l()}finally{a.T=u,s.p=d,s.d.f()}},Xs.preconnect=function(l,u){typeof l=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,s.d.C(l,u))},Xs.prefetchDNS=function(l){typeof l=="string"&&s.d.D(l)},Xs.preinit=function(l,u){if(typeof l=="string"&&u&&typeof u.as=="string"){var d=u.as,f=o(d,u.crossOrigin),m=typeof u.integrity=="string"?u.integrity:void 0,y=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;d==="style"?s.d.S(l,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:f,integrity:m,fetchPriority:y}):d==="script"&&s.d.X(l,{crossOrigin:f,integrity:m,fetchPriority:y,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Xs.preinitModule=function(l,u){if(typeof l=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var d=o(u.as,u.crossOrigin);s.d.M(l,{crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&s.d.M(l)},Xs.preload=function(l,u){if(typeof l=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var d=u.as,f=o(d,u.crossOrigin);s.d.L(l,d,{crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Xs.preloadModule=function(l,u){if(typeof l=="string")if(u){var d=o(u.as,u.crossOrigin);s.d.m(l,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else s.d.m(l)},Xs.requestFormReset=function(l){s.d.r(l)},Xs.unstable_batchedUpdates=function(l,u){return l(u)},Xs.useFormState=function(l,u,d){return a.H.useFormState(l,u,d)},Xs.useFormStatus=function(){return a.H.useHostTransitionStatus()},Xs.version="19.0.0",Xs}var $A;function _G(){if($A)return AS.exports;$A=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),AS.exports=EG(),AS.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CA;function IG(){if(CA)return Ip;CA=1;var n=TG(),e=a_(),t=_G();function s(c){var h="https://react.dev/errors/"+c;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}var i=Symbol.for("react.element"),a=Symbol.for("react.transitional.element"),o=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),m=Symbol.for("react.consumer"),y=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),$=Symbol.for("react.offscreen"),C=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function V(c){return c===null||typeof c!="object"?null:(c=O&&c[O]||c["@@iterator"],typeof c=="function"?c:null)}var F=Symbol.for("react.client.reference");function R(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===F?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case l:return"Fragment";case o:return"Portal";case d:return"Profiler";case u:return"StrictMode";case w:return"Suspense";case x:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case y:return(c.displayName||"Context")+".Provider";case m:return(c._context.displayName||"Context")+".Consumer";case b:var h=c.render;return c=c.displayName,c||(c=h.displayName||h.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case T:return h=c.displayName||null,h!==null?h:R(c.type)||"Memo";case E:h=c._payload,c=c._init;try{return R(c(h))}catch{}}return null}var N=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=Object.assign,k,z;function B(c){if(k===void 0)try{throw Error()}catch(p){var h=p.stack.trim().match(/\n( *(at )?)/);k=h&&h[1]||"",z=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+k+c+z}var ne=!1;function J(c,h){if(!c||ne)return"";ne=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(h){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(Ie){var ve=Ie}Reflect.construct(c,[],Re)}else{try{Re.call()}catch(Ie){ve=Ie}c.call(Re.prototype)}}else{try{throw Error()}catch(Ie){ve=Ie}(Re=c())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(Ie){if(Ie&&ve&&typeof Ie.stack=="string")return[Ie.stack,ve.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=g.DetermineComponentFrameRoot(),M=_[0],U=_[1];if(M&&U){var q=M.split(`
`),oe=U.split(`
`);for(S=g=0;g<q.length&&!q[g].includes("DetermineComponentFrameRoot");)g++;for(;S<oe.length&&!oe[S].includes("DetermineComponentFrameRoot");)S++;if(g===q.length||S===oe.length)for(g=q.length-1,S=oe.length-1;1<=g&&0<=S&&q[g]!==oe[S];)S--;for(;1<=g&&0<=S;g--,S--)if(q[g]!==oe[S]){if(g!==1||S!==1)do if(g--,S--,0>S||q[g]!==oe[S]){var $e=`
`+q[g].replace(" at new "," at ");return c.displayName&&$e.includes("<anonymous>")&&($e=$e.replace("<anonymous>",c.displayName)),$e}while(1<=g&&0<=S);break}}}finally{ne=!1,Error.prepareStackTrace=p}return(p=c?c.displayName||c.name:"")?B(p):""}function K(c){switch(c.tag){case 26:case 27:case 5:return B(c.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 15:return c=J(c.type,!1),c;case 11:return c=J(c.type.render,!1),c;case 1:return c=J(c.type,!0),c;default:return""}}function re(c){try{var h="";do h+=K(c),c=c.return;while(c);return h}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function Z(c){var h=c,p=c;if(c.alternate)for(;h.return;)h=h.return;else{c=h;do h=c,(h.flags&4098)!==0&&(p=h.return),c=h.return;while(c)}return h.tag===3?p:null}function he(c){if(c.tag===13){var h=c.memoizedState;if(h===null&&(c=c.alternate,c!==null&&(h=c.memoizedState)),h!==null)return h.dehydrated}return null}function W(c){if(Z(c)!==c)throw Error(s(188))}function ee(c){var h=c.alternate;if(!h){if(h=Z(c),h===null)throw Error(s(188));return h!==c?null:c}for(var p=c,g=h;;){var S=p.return;if(S===null)break;var _=S.alternate;if(_===null){if(g=S.return,g!==null){p=g;continue}break}if(S.child===_.child){for(_=S.child;_;){if(_===p)return W(S),c;if(_===g)return W(S),h;_=_.sibling}throw Error(s(188))}if(p.return!==g.return)p=S,g=_;else{for(var M=!1,U=S.child;U;){if(U===p){M=!0,p=S,g=_;break}if(U===g){M=!0,g=S,p=_;break}U=U.sibling}if(!M){for(U=_.child;U;){if(U===p){M=!0,p=_,g=S;break}if(U===g){M=!0,g=_,p=S;break}U=U.sibling}if(!M)throw Error(s(189))}}if(p.alternate!==g)throw Error(s(190))}if(p.tag!==3)throw Error(s(188));return p.stateNode.current===p?c:h}function me(c){var h=c.tag;if(h===5||h===26||h===27||h===6)return c;for(c=c.child;c!==null;){if(h=me(c),h!==null)return h;c=c.sibling}return null}var de=Array.isArray,be=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e={pending:!1,data:null,method:null,action:null},Ne=[],Ve=-1;function Le(c){return{current:c}}function Be(c){0>Ve||(c.current=Ne[Ve],Ne[Ve]=null,Ve--)}function je(c,h){Ve++,Ne[Ve]=c.current,c.current=h}var Qe=Le(null),ft=Le(null),pt=Le(null),Mt=Le(null);function Tt(c,h){switch(je(pt,h),je(ft,c),je(Qe,null),c=h.nodeType,c){case 9:case 11:h=(h=h.documentElement)&&(h=h.namespaceURI)?X2(h):0;break;default:if(c=c===8?h.parentNode:h,h=c.tagName,c=c.namespaceURI)c=X2(c),h=Y2(c,h);else switch(h){case"svg":h=1;break;case"math":h=2;break;default:h=0}}Be(Qe),je(Qe,h)}function bt(){Be(Qe),Be(ft),Be(pt)}function qt(c){c.memoizedState!==null&&je(Mt,c);var h=Qe.current,p=Y2(h,c.type);h!==p&&(je(ft,c),je(Qe,p))}function Vt(c){ft.current===c&&(Be(Qe),Be(ft)),Mt.current===c&&(Be(Mt),vp._currentValue=_e)}var qs=Object.prototype.hasOwnProperty,hn=n.unstable_scheduleCallback,hr=n.unstable_cancelCallback,As=n.unstable_shouldYield,Lr=n.unstable_requestPaint,dn=n.unstable_now,_r=n.unstable_getCurrentPriorityLevel,en=n.unstable_ImmediatePriority,an=n.unstable_UserBlockingPriority,ms=n.unstable_NormalPriority,sa=n.unstable_LowPriority,qa=n.unstable_IdlePriority,Cc=n.log,Ka=n.unstable_setDisableYieldValue,Pr=null,gs=null;function Nc(c){if(gs&&typeof gs.onCommitFiberRoot=="function")try{gs.onCommitFiberRoot(Pr,c,void 0,(c.current.flags&128)===128)}catch{}}function ra(c){if(typeof Cc=="function"&&Ka(c),gs&&typeof gs.setStrictMode=="function")try{gs.setStrictMode(Pr,c)}catch{}}var dr=Math.clz32?Math.clz32:my,Ef=Math.log,py=Math.LN2;function my(c){return c>>>=0,c===0?32:31-(Ef(c)/py|0)|0}var ia=128,Qo=4194304;function Ai(c){var h=c&42;if(h!==0)return h;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function Jr(c,h){var p=c.pendingLanes;if(p===0)return 0;var g=0,S=c.suspendedLanes,_=c.pingedLanes,M=c.warmLanes;c=c.finishedLanes!==0;var U=p&134217727;return U!==0?(p=U&~S,p!==0?g=Ai(p):(_&=U,_!==0?g=Ai(_):c||(M=U&~M,M!==0&&(g=Ai(M))))):(U=p&~S,U!==0?g=Ai(U):_!==0?g=Ai(_):c||(M=p&~M,M!==0&&(g=Ai(M)))),g===0?0:h!==0&&h!==g&&(h&S)===0&&(S=g&-g,M=h&-h,S>=M||S===32&&(M&4194176)!==0)?h:g}function Zo(c,h){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&h)===0}function ch(c,h){switch(c){case 1:case 2:case 4:case 8:return h+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _f(){var c=ia;return ia<<=1,(ia&4194176)===0&&(ia=128),c}function Jo(){var c=Qo;return Qo<<=1,(Qo&62914560)===0&&(Qo=4194304),c}function uh(c){for(var h=[],p=0;31>p;p++)h.push(c);return h}function Vn(c,h){c.pendingLanes|=h,h!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function gy(c,h,p,g,S,_){var M=c.pendingLanes;c.pendingLanes=p,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=p,c.entangledLanes&=p,c.errorRecoveryDisabledLanes&=p,c.shellSuspendCounter=0;var U=c.entanglements,q=c.expirationTimes,oe=c.hiddenUpdates;for(p=M&~p;0<p;){var $e=31-dr(p),Re=1<<$e;U[$e]=0,q[$e]=-1;var ve=oe[$e];if(ve!==null)for(oe[$e]=null,$e=0;$e<ve.length;$e++){var Ie=ve[$e];Ie!==null&&(Ie.lane&=-536870913)}p&=~Re}g!==0&&el(c,g,0),_!==0&&S===0&&c.tag!==0&&(c.suspendedLanes|=_&~(M&~h))}function el(c,h,p){c.pendingLanes|=h,c.suspendedLanes&=~h;var g=31-dr(h);c.entangledLanes|=h,c.entanglements[g]=c.entanglements[g]|1073741824|p&4194218}function tl(c,h){var p=c.entangledLanes|=h;for(c=c.entanglements;p;){var g=31-dr(p),S=1<<g;S&h|c[g]&h&&(c[g]|=h),p&=~S}}function yy(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function by(){var c=be.p;return c!==0?c:(c=window.event,c===void 0?32:pA(c.type))}function nl(c,h){var p=be.p;try{return be.p=c,h()}finally{be.p=p}}var aa=Math.random().toString(36).slice(2),ys="__reactFiber$"+aa,ss="__reactProps$"+aa,Xa="__reactContainer$"+aa,kc="__reactEvents$"+aa,hh="__reactListeners$"+aa,oa="__reactHandles$"+aa,If="__reactResources$"+aa,sl="__reactMarker$"+aa;function Ac(c){delete c[ys],delete c[ss],delete c[kc],delete c[hh],delete c[oa]}function Ri(c){var h=c[ys];if(h)return h;for(var p=c.parentNode;p;){if(h=p[Xa]||p[ys]){if(p=h.alternate,h.child!==null||p!==null&&p.child!==null)for(c=J2(c);c!==null;){if(p=c[ys])return p;c=J2(c)}return h}c=p,p=c.parentNode}return null}function Ya(c){if(c=c[ys]||c[Xa]){var h=c.tag;if(h===5||h===6||h===13||h===26||h===27||h===3)return c}return null}function rl(c){var h=c.tag;if(h===5||h===26||h===27||h===6)return c.stateNode;throw Error(s(33))}function il(c){var h=c[If];return h||(h=c[If]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function Tn(c){c[sl]=!0}var $f=new Set,dh={};function Mr(c,h){Ir(c,h),Ir(c+"Capture",h)}function Ir(c,h){for(dh[c]=h,c=0;c<h.length;c++)$f.add(h[c])}var Vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),k1=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Cf={},Nf={};function xy(c){return qs.call(Nf,c)?!0:qs.call(Cf,c)?!1:k1.test(c)?Nf[c]=!0:(Cf[c]=!0,!1)}function al(c,h,p){if(xy(h))if(p===null)c.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":c.removeAttribute(h);return;case"boolean":var g=h.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){c.removeAttribute(h);return}}c.setAttribute(h,""+p)}}function ol(c,h,p){if(p===null)c.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(h);return}c.setAttribute(h,""+p)}}function ei(c,h,p,g){if(g===null)c.removeAttribute(p);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(p);return}c.setAttributeNS(h,p,""+g)}}function fr(c){switch(typeof c){case"bigint":case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function vy(c){var h=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function A1(c){var h=vy(c)?"checked":"value",p=Object.getOwnPropertyDescriptor(c.constructor.prototype,h),g=""+c[h];if(!c.hasOwnProperty(h)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,_=p.set;return Object.defineProperty(c,h,{configurable:!0,get:function(){return S.call(this)},set:function(M){g=""+M,_.call(this,M)}}),Object.defineProperty(c,h,{enumerable:p.enumerable}),{getValue:function(){return g},setValue:function(M){g=""+M},stopTracking:function(){c._valueTracker=null,delete c[h]}}}}function Rc(c){c._valueTracker||(c._valueTracker=A1(c))}function kf(c){if(!c)return!1;var h=c._valueTracker;if(!h)return!0;var p=h.getValue(),g="";return c&&(g=vy(c)?c.checked?"true":"false":c.value),c=g,c!==p?(h.setValue(c),!0):!1}function fh(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}var Qa=/[\n"\\]/g;function Cn(c){return c.replace(Qa,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function ll(c,h,p,g,S,_,M,U){c.name="",M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?c.type=M:c.removeAttribute("type"),h!=null?M==="number"?(h===0&&c.value===""||c.value!=h)&&(c.value=""+fr(h)):c.value!==""+fr(h)&&(c.value=""+fr(h)):M!=="submit"&&M!=="reset"||c.removeAttribute("value"),h!=null?ph(c,M,fr(h)):p!=null?ph(c,M,fr(p)):g!=null&&c.removeAttribute("value"),S==null&&_!=null&&(c.defaultChecked=!!_),S!=null&&(c.checked=S&&typeof S!="function"&&typeof S!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?c.name=""+fr(U):c.removeAttribute("name")}function Dc(c,h,p,g,S,_,M,U){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(c.type=_),h!=null||p!=null){if(!(_!=="submit"&&_!=="reset"||h!=null))return;p=p!=null?""+fr(p):"",h=h!=null?""+fr(h):p,U||h===c.value||(c.value=h),c.defaultValue=h}g=g??S,g=typeof g!="function"&&typeof g!="symbol"&&!!g,c.checked=U?c.checked:!!g,c.defaultChecked=!!g,M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(c.name=M)}function ph(c,h,p){h==="number"&&fh(c.ownerDocument)===c||c.defaultValue===""+p||(c.defaultValue=""+p)}function Bt(c,h,p,g){if(c=c.options,h){h={};for(var S=0;S<p.length;S++)h["$"+p[S]]=!0;for(p=0;p<c.length;p++)S=h.hasOwnProperty("$"+c[p].value),c[p].selected!==S&&(c[p].selected=S),S&&g&&(c[p].defaultSelected=!0)}else{for(p=""+fr(p),h=null,S=0;S<c.length;S++){if(c[S].value===p){c[S].selected=!0,g&&(c[S].defaultSelected=!0);return}h!==null||c[S].disabled||(h=c[S])}h!==null&&(h.selected=!0)}}function Oc(c,h,p){if(h!=null&&(h=""+fr(h),h!==c.value&&(c.value=h),p==null)){c.defaultValue!==h&&(c.defaultValue=h);return}c.defaultValue=p!=null?""+fr(p):""}function cl(c,h,p,g){if(h==null){if(g!=null){if(p!=null)throw Error(s(92));if(de(g)){if(1<g.length)throw Error(s(93));g=g[0]}p=g}p==null&&(p=""),h=p}p=fr(h),c.defaultValue=p,g=c.textContent,g===p&&g!==""&&g!==null&&(c.value=g)}function ti(c,h){if(h){var p=c.firstChild;if(p&&p===c.lastChild&&p.nodeType===3){p.nodeValue=h;return}}c.textContent=h}var R1=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Af(c,h,p){var g=h.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?g?c.setProperty(h,""):h==="float"?c.cssFloat="":c[h]="":g?c.setProperty(h,p):typeof p!="number"||p===0||R1.has(h)?h==="float"?c.cssFloat=p:c[h]=(""+p).trim():c[h]=p+"px"}function wy(c,h,p){if(h!=null&&typeof h!="object")throw Error(s(62));if(c=c.style,p!=null){for(var g in p)!p.hasOwnProperty(g)||h!=null&&h.hasOwnProperty(g)||(g.indexOf("--")===0?c.setProperty(g,""):g==="float"?c.cssFloat="":c[g]="");for(var S in h)g=h[S],h.hasOwnProperty(S)&&p[S]!==g&&Af(c,S,g)}else for(var _ in h)h.hasOwnProperty(_)&&Af(c,_,h[_])}function Rf(c){if(c.indexOf("-")===-1)return!1;switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var D1=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),O1=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function la(c){return O1.test(""+c)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":c}var ni=null;function mh(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Za=null,Ja=null;function eo(c){var h=Ya(c);if(h&&(c=h.stateNode)){var p=c[ss]||null;e:switch(c=h.stateNode,h.type){case"input":if(ll(c,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),h=p.name,p.type==="radio"&&h!=null){for(p=c;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Cn(""+h)+'"][type="radio"]'),h=0;h<p.length;h++){var g=p[h];if(g!==c&&g.form===c.form){var S=g[ss]||null;if(!S)throw Error(s(90));ll(g,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(h=0;h<p.length;h++)g=p[h],g.form===c.form&&kf(g)}break e;case"textarea":Oc(c,p.value,p.defaultValue);break e;case"select":h=p.value,h!=null&&Bt(c,!!p.multiple,h,!1)}}}var Df=!1;function Sy(c,h,p){if(Df)return c(h,p);Df=!0;try{var g=c(h);return g}finally{if(Df=!1,(Za!==null||Ja!==null)&&(fb(),Za&&(h=Za,c=Ja,Ja=Za=null,eo(h),c)))for(h=0;h<c.length;h++)eo(c[h])}}function Fc(c,h){var p=c.stateNode;if(p===null)return null;var g=p[ss]||null;if(g===null)return null;p=g[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(c=c.type,g=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!g;break e;default:c=!1}if(c)return null;if(p&&typeof p!="function")throw Error(s(231,h,typeof p));return p}var si=!1;if(Vr)try{var Lc={};Object.defineProperty(Lc,"passive",{get:function(){si=!0}}),window.addEventListener("test",Lc,Lc),window.removeEventListener("test",Lc,Lc)}catch{si=!1}var ca=null,ul=null,to=null;function Of(){if(to)return to;var c,h=ul,p=h.length,g,S="value"in ca?ca.value:ca.textContent,_=S.length;for(c=0;c<p&&h[c]===S[c];c++);var M=p-c;for(g=1;g<=M&&h[p-g]===S[_-g];g++);return to=S.slice(c,1<g?1-g:void 0)}function ua(c){var h=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&h===13&&(c=13)):c=h,c===10&&(c=13),32<=c||c===13?c:0}function ha(){return!0}function Ff(){return!1}function bs(c){function h(p,g,S,_,M){this._reactName=p,this._targetInst=S,this.type=g,this.nativeEvent=_,this.target=M,this.currentTarget=null;for(var U in c)c.hasOwnProperty(U)&&(p=c[U],this[U]=p?p(_):_[U]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?ha:Ff,this.isPropagationStopped=Ff,this}return D(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=ha)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=ha)},persist:function(){},isPersistent:ha}),h}var Kt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gh=bs(Kt),Pc=D({},Kt,{view:0,detail:0}),Ty=bs(Pc),yh,bh,da,Mc=D({},Pc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zc,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==da&&(da&&c.type==="mousemove"?(yh=c.screenX-da.screenX,bh=c.screenY-da.screenY):bh=yh=0,da=c),yh)},movementY:function(c){return"movementY"in c?c.movementY:bh}}),ri=bs(Mc),Ey=D({},Mc,{dataTransfer:0}),F1=bs(Ey),Vc=D({},Pc,{relatedTarget:0}),xh=bs(Vc),Lf=D({},Kt,{animationName:0,elapsedTime:0,pseudoElement:0}),vh=bs(Lf),_y=D({},Kt,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),wh=bs(_y),L1=D({},Kt,{data:0}),Pf=bs(L1),Bc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Iy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$y={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mf(c){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(c):(c=$y[c])?!!h[c]:!1}function zc(){return Mf}var Cy=D({},Pc,{key:function(c){if(c.key){var h=Bc[c.key]||c.key;if(h!=="Unidentified")return h}return c.type==="keypress"?(c=ua(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?Iy[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zc,charCode:function(c){return c.type==="keypress"?ua(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?ua(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),Sh=bs(Cy),Ny=D({},Mc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vf=bs(Ny),no=D({},Pc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zc}),ky=bs(no),Ay=D({},Kt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ry=bs(Ay),Dy=D({},Mc,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),Th=bs(Dy),pr=D({},Kt,{newState:0,oldState:0}),Oy=bs(pr),Fy=[9,13,27,32],fa=Vr&&"CompositionEvent"in window,v=null;Vr&&"documentMode"in document&&(v=document.documentMode);var A=Vr&&"TextEvent"in window&&!v,P=Vr&&(!fa||v&&8<v&&11>=v),G=" ",pe=!1;function Te(c,h){switch(c){case"keyup":return Fy.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pe(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Nt=!1;function rs(c,h){switch(c){case"compositionend":return Pe(h);case"keypress":return h.which!==32?null:(pe=!0,G);case"textInput":return c=h.data,c===G&&pe?null:c;default:return null}}function kt(c,h){if(Nt)return c==="compositionend"||!fa&&Te(c,h)?(c=Of(),to=ul=ca=null,Nt=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return P&&h.locale!=="ko"?null:h.data;default:return null}}var xs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function is(c){var h=c&&c.nodeName&&c.nodeName.toLowerCase();return h==="input"?!!xs[c.type]:h==="textarea"}function so(c,h,p,g){Za?Ja?Ja.push(g):Ja=[g]:Za=g,h=bb(h,"onChange"),0<h.length&&(p=new gh("onChange","change",null,p,g),c.push({event:p,listeners:h}))}var Rs=null,pa=null;function Bf(c){W2(c,0)}function Ly(c){var h=rl(c);if(kf(h))return c}function xN(c,h){if(c==="change")return h}var vN=!1;if(Vr){var P1;if(Vr){var M1="oninput"in document;if(!M1){var wN=document.createElement("div");wN.setAttribute("oninput","return;"),M1=typeof wN.oninput=="function"}P1=M1}else P1=!1;vN=P1&&(!document.documentMode||9<document.documentMode)}function SN(){Rs&&(Rs.detachEvent("onpropertychange",TN),pa=Rs=null)}function TN(c){if(c.propertyName==="value"&&Ly(pa)){var h=[];so(h,pa,c,mh(c)),Sy(Bf,h)}}function qj(c,h,p){c==="focusin"?(SN(),Rs=h,pa=p,Rs.attachEvent("onpropertychange",TN)):c==="focusout"&&SN()}function Kj(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Ly(pa)}function Xj(c,h){if(c==="click")return Ly(h)}function Yj(c,h){if(c==="input"||c==="change")return Ly(h)}function Qj(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var Br=typeof Object.is=="function"?Object.is:Qj;function zf(c,h){if(Br(c,h))return!0;if(typeof c!="object"||c===null||typeof h!="object"||h===null)return!1;var p=Object.keys(c),g=Object.keys(h);if(p.length!==g.length)return!1;for(g=0;g<p.length;g++){var S=p[g];if(!qs.call(h,S)||!Br(c[S],h[S]))return!1}return!0}function EN(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function _N(c,h){var p=EN(c);c=0;for(var g;p;){if(p.nodeType===3){if(g=c+p.textContent.length,c<=h&&g>=h)return{node:p,offset:h-c};c=g}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=EN(p)}}function IN(c,h){return c&&h?c===h?!0:c&&c.nodeType===3?!1:h&&h.nodeType===3?IN(c,h.parentNode):"contains"in c?c.contains(h):c.compareDocumentPosition?!!(c.compareDocumentPosition(h)&16):!1:!1}function $N(c){c=c!=null&&c.ownerDocument!=null&&c.ownerDocument.defaultView!=null?c.ownerDocument.defaultView:window;for(var h=fh(c.document);h instanceof c.HTMLIFrameElement;){try{var p=typeof h.contentWindow.location.href=="string"}catch{p=!1}if(p)c=h.contentWindow;else break;h=fh(c.document)}return h}function V1(c){var h=c&&c.nodeName&&c.nodeName.toLowerCase();return h&&(h==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||h==="textarea"||c.contentEditable==="true")}function Zj(c,h){var p=$N(h);h=c.focusedElem;var g=c.selectionRange;if(p!==h&&h&&h.ownerDocument&&IN(h.ownerDocument.documentElement,h)){if(g!==null&&V1(h)){if(c=g.start,p=g.end,p===void 0&&(p=c),"selectionStart"in h)h.selectionStart=c,h.selectionEnd=Math.min(p,h.value.length);else if(p=(c=h.ownerDocument||document)&&c.defaultView||window,p.getSelection){p=p.getSelection();var S=h.textContent.length,_=Math.min(g.start,S);g=g.end===void 0?_:Math.min(g.end,S),!p.extend&&_>g&&(S=g,g=_,_=S),S=_N(h,_);var M=_N(h,g);S&&M&&(p.rangeCount!==1||p.anchorNode!==S.node||p.anchorOffset!==S.offset||p.focusNode!==M.node||p.focusOffset!==M.offset)&&(c=c.createRange(),c.setStart(S.node,S.offset),p.removeAllRanges(),_>g?(p.addRange(c),p.extend(M.node,M.offset)):(c.setEnd(M.node,M.offset),p.addRange(c)))}}for(c=[],p=h;p=p.parentNode;)p.nodeType===1&&c.push({element:p,left:p.scrollLeft,top:p.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<c.length;h++)p=c[h],p.element.scrollLeft=p.left,p.element.scrollTop=p.top}}var Jj=Vr&&"documentMode"in document&&11>=document.documentMode,Eh=null,B1=null,Uf=null,z1=!1;function CN(c,h,p){var g=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;z1||Eh==null||Eh!==fh(g)||(g=Eh,"selectionStart"in g&&V1(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Uf&&zf(Uf,g)||(Uf=g,g=bb(B1,"onSelect"),0<g.length&&(h=new gh("onSelect","select",null,h,p),c.push({event:h,listeners:g}),h.target=Eh)))}function Uc(c,h){var p={};return p[c.toLowerCase()]=h.toLowerCase(),p["Webkit"+c]="webkit"+h,p["Moz"+c]="moz"+h,p}var _h={animationend:Uc("Animation","AnimationEnd"),animationiteration:Uc("Animation","AnimationIteration"),animationstart:Uc("Animation","AnimationStart"),transitionrun:Uc("Transition","TransitionRun"),transitionstart:Uc("Transition","TransitionStart"),transitioncancel:Uc("Transition","TransitionCancel"),transitionend:Uc("Transition","TransitionEnd")},U1={},NN={};Vr&&(NN=document.createElement("div").style,"AnimationEvent"in window||(delete _h.animationend.animation,delete _h.animationiteration.animation,delete _h.animationstart.animation),"TransitionEvent"in window||delete _h.transitionend.transition);function jc(c){if(U1[c])return U1[c];if(!_h[c])return c;var h=_h[c],p;for(p in h)if(h.hasOwnProperty(p)&&p in NN)return U1[c]=h[p];return c}var kN=jc("animationend"),AN=jc("animationiteration"),RN=jc("animationstart"),eW=jc("transitionrun"),tW=jc("transitionstart"),nW=jc("transitioncancel"),DN=jc("transitionend"),ON=new Map,FN="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Di(c,h){ON.set(c,h),Mr(h,[c])}var ii=[],Ih=0,j1=0;function Py(){for(var c=Ih,h=j1=Ih=0;h<c;){var p=ii[h];ii[h++]=null;var g=ii[h];ii[h++]=null;var S=ii[h];ii[h++]=null;var _=ii[h];if(ii[h++]=null,g!==null&&S!==null){var M=g.pending;M===null?S.next=S:(S.next=M.next,M.next=S),g.pending=S}_!==0&&LN(p,S,_)}}function My(c,h,p,g){ii[Ih++]=c,ii[Ih++]=h,ii[Ih++]=p,ii[Ih++]=g,j1|=g,c.lanes|=g,c=c.alternate,c!==null&&(c.lanes|=g)}function W1(c,h,p,g){return My(c,h,p,g),Vy(c)}function hl(c,h){return My(c,null,null,h),Vy(c)}function LN(c,h,p){c.lanes|=p;var g=c.alternate;g!==null&&(g.lanes|=p);for(var S=!1,_=c.return;_!==null;)_.childLanes|=p,g=_.alternate,g!==null&&(g.childLanes|=p),_.tag===22&&(c=_.stateNode,c===null||c._visibility&1||(S=!0)),c=_,_=_.return;S&&h!==null&&c.tag===3&&(_=c.stateNode,S=31-dr(p),_=_.hiddenUpdates,c=_[S],c===null?_[S]=[h]:c.push(h),h.lane=p|536870912)}function Vy(c){if(50<fp)throw fp=0,Yw=null,Error(s(185));for(var h=c.return;h!==null;)c=h,h=c.return;return c.tag===3?c.stateNode:null}var $h={},PN=new WeakMap;function ai(c,h){if(typeof c=="object"&&c!==null){var p=PN.get(c);return p!==void 0?p:(h={value:c,source:h,stack:re(h)},PN.set(c,h),h)}return{value:c,source:h,stack:re(h)}}var Ch=[],Nh=0,By=null,zy=0,oi=[],li=0,Wc=null,ro=1,io="";function Gc(c,h){Ch[Nh++]=zy,Ch[Nh++]=By,By=c,zy=h}function MN(c,h,p){oi[li++]=ro,oi[li++]=io,oi[li++]=Wc,Wc=c;var g=ro;c=io;var S=32-dr(g)-1;g&=~(1<<S),p+=1;var _=32-dr(h)+S;if(30<_){var M=S-S%5;_=(g&(1<<M)-1).toString(32),g>>=M,S-=M,ro=1<<32-dr(h)+S|p<<S|g,io=_+c}else ro=1<<_|p<<S|g,io=c}function G1(c){c.return!==null&&(Gc(c,1),MN(c,1,0))}function H1(c){for(;c===By;)By=Ch[--Nh],Ch[Nh]=null,zy=Ch[--Nh],Ch[Nh]=null;for(;c===Wc;)Wc=oi[--li],oi[li]=null,io=oi[--li],oi[li]=null,ro=oi[--li],oi[li]=null}var mr=null,Ds=null,zt=!1,Oi=null,ma=!1,q1=Error(s(519));function Hc(c){var h=Error(s(418,""));throw Gf(ai(h,c)),q1}function VN(c){var h=c.stateNode,p=c.type,g=c.memoizedProps;switch(h[ys]=c,h[ss]=g,p){case"dialog":Et("cancel",h),Et("close",h);break;case"iframe":case"object":case"embed":Et("load",h);break;case"video":case"audio":for(p=0;p<mp.length;p++)Et(mp[p],h);break;case"source":Et("error",h);break;case"img":case"image":case"link":Et("error",h),Et("load",h);break;case"details":Et("toggle",h);break;case"input":Et("invalid",h),Dc(h,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0),Rc(h);break;case"select":Et("invalid",h);break;case"textarea":Et("invalid",h),cl(h,g.value,g.defaultValue,g.children),Rc(h)}p=g.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||h.textContent===""+p||g.suppressHydrationWarning===!0||K2(h.textContent,p)?(g.popover!=null&&(Et("beforetoggle",h),Et("toggle",h)),g.onScroll!=null&&Et("scroll",h),g.onScrollEnd!=null&&Et("scrollend",h),g.onClick!=null&&(h.onclick=xb),h=!0):h=!1,h||Hc(c)}function BN(c){for(mr=c.return;mr;)switch(mr.tag){case 3:case 27:ma=!0;return;case 5:case 13:ma=!1;return;default:mr=mr.return}}function jf(c){if(c!==mr)return!1;if(!zt)return BN(c),zt=!0,!1;var h=!1,p;if((p=c.tag!==3&&c.tag!==27)&&((p=c.tag===5)&&(p=c.type,p=!(p!=="form"&&p!=="button")||fS(c.type,c.memoizedProps)),p=!p),p&&(h=!0),h&&Ds&&Hc(c),BN(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(s(317));e:{for(c=c.nextSibling,h=0;c;){if(c.nodeType===8)if(p=c.data,p==="/$"){if(h===0){Ds=Li(c.nextSibling);break e}h--}else p!=="$"&&p!=="$!"&&p!=="$?"||h++;c=c.nextSibling}Ds=null}}else Ds=mr?Li(c.stateNode.nextSibling):null;return!0}function Wf(){Ds=mr=null,zt=!1}function Gf(c){Oi===null?Oi=[c]:Oi.push(c)}var Hf=Error(s(460)),zN=Error(s(474)),K1={then:function(){}};function UN(c){return c=c.status,c==="fulfilled"||c==="rejected"}function Uy(){}function jN(c,h,p){switch(p=c[p],p===void 0?c.push(h):p!==h&&(h.then(Uy,Uy),h=p),h.status){case"fulfilled":return h.value;case"rejected":throw c=h.reason,c===Hf?Error(s(483)):c;default:if(typeof h.status=="string")h.then(Uy,Uy);else{if(c=fn,c!==null&&100<c.shellSuspendCounter)throw Error(s(482));c=h,c.status="pending",c.then(function(g){if(h.status==="pending"){var S=h;S.status="fulfilled",S.value=g}},function(g){if(h.status==="pending"){var S=h;S.status="rejected",S.reason=g}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw c=h.reason,c===Hf?Error(s(483)):c}throw qf=h,Hf}}var qf=null;function WN(){if(qf===null)throw Error(s(459));var c=qf;return qf=null,c}var kh=null,Kf=0;function jy(c){var h=Kf;return Kf+=1,kh===null&&(kh=[]),jN(kh,c,h)}function Xf(c,h){h=h.props.ref,c.ref=h!==void 0?h:null}function Wy(c,h){throw h.$$typeof===i?Error(s(525)):(c=Object.prototype.toString.call(h),Error(s(31,c==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":c)))}function GN(c){var h=c._init;return h(c._payload)}function HN(c){function h(fe,ae){if(c){var ye=fe.deletions;ye===null?(fe.deletions=[ae],fe.flags|=16):ye.push(ae)}}function p(fe,ae){if(!c)return null;for(;ae!==null;)h(fe,ae),ae=ae.sibling;return null}function g(fe){for(var ae=new Map;fe!==null;)fe.key!==null?ae.set(fe.key,fe):ae.set(fe.index,fe),fe=fe.sibling;return ae}function S(fe,ae){return fe=Tl(fe,ae),fe.index=0,fe.sibling=null,fe}function _(fe,ae,ye){return fe.index=ye,c?(ye=fe.alternate,ye!==null?(ye=ye.index,ye<ae?(fe.flags|=33554434,ae):ye):(fe.flags|=33554434,ae)):(fe.flags|=1048576,ae)}function M(fe){return c&&fe.alternate===null&&(fe.flags|=33554434),fe}function U(fe,ae,ye,ke){return ae===null||ae.tag!==6?(ae=Uw(ye,fe.mode,ke),ae.return=fe,ae):(ae=S(ae,ye),ae.return=fe,ae)}function q(fe,ae,ye,ke){var Ge=ye.type;return Ge===l?$e(fe,ae,ye.props.children,ke,ye.key):ae!==null&&(ae.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===E&&GN(Ge)===ae.type)?(ae=S(ae,ye.props),Xf(ae,ye),ae.return=fe,ae):(ae=lb(ye.type,ye.key,ye.props,null,fe.mode,ke),Xf(ae,ye),ae.return=fe,ae)}function oe(fe,ae,ye,ke){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==ye.containerInfo||ae.stateNode.implementation!==ye.implementation?(ae=jw(ye,fe.mode,ke),ae.return=fe,ae):(ae=S(ae,ye.children||[]),ae.return=fe,ae)}function $e(fe,ae,ye,ke,Ge){return ae===null||ae.tag!==7?(ae=nu(ye,fe.mode,ke,Ge),ae.return=fe,ae):(ae=S(ae,ye),ae.return=fe,ae)}function Re(fe,ae,ye){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=Uw(""+ae,fe.mode,ye),ae.return=fe,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case a:return ye=lb(ae.type,ae.key,ae.props,null,fe.mode,ye),Xf(ye,ae),ye.return=fe,ye;case o:return ae=jw(ae,fe.mode,ye),ae.return=fe,ae;case E:var ke=ae._init;return ae=ke(ae._payload),Re(fe,ae,ye)}if(de(ae)||V(ae))return ae=nu(ae,fe.mode,ye,null),ae.return=fe,ae;if(typeof ae.then=="function")return Re(fe,jy(ae),ye);if(ae.$$typeof===y)return Re(fe,ib(fe,ae),ye);Wy(fe,ae)}return null}function ve(fe,ae,ye,ke){var Ge=ae!==null?ae.key:null;if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return Ge!==null?null:U(fe,ae,""+ye,ke);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case a:return ye.key===Ge?q(fe,ae,ye,ke):null;case o:return ye.key===Ge?oe(fe,ae,ye,ke):null;case E:return Ge=ye._init,ye=Ge(ye._payload),ve(fe,ae,ye,ke)}if(de(ye)||V(ye))return Ge!==null?null:$e(fe,ae,ye,ke,null);if(typeof ye.then=="function")return ve(fe,ae,jy(ye),ke);if(ye.$$typeof===y)return ve(fe,ae,ib(fe,ye),ke);Wy(fe,ye)}return null}function Ie(fe,ae,ye,ke,Ge){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return fe=fe.get(ye)||null,U(ae,fe,""+ke,Ge);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case a:return fe=fe.get(ke.key===null?ye:ke.key)||null,q(ae,fe,ke,Ge);case o:return fe=fe.get(ke.key===null?ye:ke.key)||null,oe(ae,fe,ke,Ge);case E:var wt=ke._init;return ke=wt(ke._payload),Ie(fe,ae,ye,ke,Ge)}if(de(ke)||V(ke))return fe=fe.get(ye)||null,$e(ae,fe,ke,Ge,null);if(typeof ke.then=="function")return Ie(fe,ae,ye,jy(ke),Ge);if(ke.$$typeof===y)return Ie(fe,ae,ye,ib(ae,ke),Ge);Wy(ae,ke)}return null}function Xe(fe,ae,ye,ke){for(var Ge=null,wt=null,et=ae,nt=ae=0,Ss=null;et!==null&&nt<ye.length;nt++){et.index>nt?(Ss=et,et=null):Ss=et.sibling;var Ut=ve(fe,et,ye[nt],ke);if(Ut===null){et===null&&(et=Ss);break}c&&et&&Ut.alternate===null&&h(fe,et),ae=_(Ut,ae,nt),wt===null?Ge=Ut:wt.sibling=Ut,wt=Ut,et=Ss}if(nt===ye.length)return p(fe,et),zt&&Gc(fe,nt),Ge;if(et===null){for(;nt<ye.length;nt++)et=Re(fe,ye[nt],ke),et!==null&&(ae=_(et,ae,nt),wt===null?Ge=et:wt.sibling=et,wt=et);return zt&&Gc(fe,nt),Ge}for(et=g(et);nt<ye.length;nt++)Ss=Ie(et,fe,nt,ye[nt],ke),Ss!==null&&(c&&Ss.alternate!==null&&et.delete(Ss.key===null?nt:Ss.key),ae=_(Ss,ae,nt),wt===null?Ge=Ss:wt.sibling=Ss,wt=Ss);return c&&et.forEach(function(kl){return h(fe,kl)}),zt&&Gc(fe,nt),Ge}function at(fe,ae,ye,ke){if(ye==null)throw Error(s(151));for(var Ge=null,wt=null,et=ae,nt=ae=0,Ss=null,Ut=ye.next();et!==null&&!Ut.done;nt++,Ut=ye.next()){et.index>nt?(Ss=et,et=null):Ss=et.sibling;var kl=ve(fe,et,Ut.value,ke);if(kl===null){et===null&&(et=Ss);break}c&&et&&kl.alternate===null&&h(fe,et),ae=_(kl,ae,nt),wt===null?Ge=kl:wt.sibling=kl,wt=kl,et=Ss}if(Ut.done)return p(fe,et),zt&&Gc(fe,nt),Ge;if(et===null){for(;!Ut.done;nt++,Ut=ye.next())Ut=Re(fe,Ut.value,ke),Ut!==null&&(ae=_(Ut,ae,nt),wt===null?Ge=Ut:wt.sibling=Ut,wt=Ut);return zt&&Gc(fe,nt),Ge}for(et=g(et);!Ut.done;nt++,Ut=ye.next())Ut=Ie(et,fe,nt,Ut.value,ke),Ut!==null&&(c&&Ut.alternate!==null&&et.delete(Ut.key===null?nt:Ut.key),ae=_(Ut,ae,nt),wt===null?Ge=Ut:wt.sibling=Ut,wt=Ut);return c&&et.forEach(function(gG){return h(fe,gG)}),zt&&Gc(fe,nt),Ge}function An(fe,ae,ye,ke){if(typeof ye=="object"&&ye!==null&&ye.type===l&&ye.key===null&&(ye=ye.props.children),typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case a:e:{for(var Ge=ye.key;ae!==null;){if(ae.key===Ge){if(Ge=ye.type,Ge===l){if(ae.tag===7){p(fe,ae.sibling),ke=S(ae,ye.props.children),ke.return=fe,fe=ke;break e}}else if(ae.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===E&&GN(Ge)===ae.type){p(fe,ae.sibling),ke=S(ae,ye.props),Xf(ke,ye),ke.return=fe,fe=ke;break e}p(fe,ae);break}else h(fe,ae);ae=ae.sibling}ye.type===l?(ke=nu(ye.props.children,fe.mode,ke,ye.key),ke.return=fe,fe=ke):(ke=lb(ye.type,ye.key,ye.props,null,fe.mode,ke),Xf(ke,ye),ke.return=fe,fe=ke)}return M(fe);case o:e:{for(Ge=ye.key;ae!==null;){if(ae.key===Ge)if(ae.tag===4&&ae.stateNode.containerInfo===ye.containerInfo&&ae.stateNode.implementation===ye.implementation){p(fe,ae.sibling),ke=S(ae,ye.children||[]),ke.return=fe,fe=ke;break e}else{p(fe,ae);break}else h(fe,ae);ae=ae.sibling}ke=jw(ye,fe.mode,ke),ke.return=fe,fe=ke}return M(fe);case E:return Ge=ye._init,ye=Ge(ye._payload),An(fe,ae,ye,ke)}if(de(ye))return Xe(fe,ae,ye,ke);if(V(ye)){if(Ge=V(ye),typeof Ge!="function")throw Error(s(150));return ye=Ge.call(ye),at(fe,ae,ye,ke)}if(typeof ye.then=="function")return An(fe,ae,jy(ye),ke);if(ye.$$typeof===y)return An(fe,ae,ib(fe,ye),ke);Wy(fe,ye)}return typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint"?(ye=""+ye,ae!==null&&ae.tag===6?(p(fe,ae.sibling),ke=S(ae,ye),ke.return=fe,fe=ke):(p(fe,ae),ke=Uw(ye,fe.mode,ke),ke.return=fe,fe=ke),M(fe)):p(fe,ae)}return function(fe,ae,ye,ke){try{Kf=0;var Ge=An(fe,ae,ye,ke);return kh=null,Ge}catch(et){if(et===Hf)throw et;var wt=di(29,et,null,fe.mode);return wt.lanes=ke,wt.return=fe,wt}finally{}}}var qc=HN(!0),qN=HN(!1),Ah=Le(null),Gy=Le(0);function KN(c,h){c=yo,je(Gy,c),je(Ah,h),yo=c|h.baseLanes}function X1(){je(Gy,yo),je(Ah,Ah.current)}function Y1(){yo=Gy.current,Be(Ah),Be(Gy)}var ci=Le(null),ga=null;function dl(c){var h=c.alternate;je(as,as.current&1),je(ci,c),ga===null&&(h===null||Ah.current!==null||h.memoizedState!==null)&&(ga=c)}function XN(c){if(c.tag===22){if(je(as,as.current),je(ci,c),ga===null){var h=c.alternate;h!==null&&h.memoizedState!==null&&(ga=c)}}else fl()}function fl(){je(as,as.current),je(ci,ci.current)}function ao(c){Be(ci),ga===c&&(ga=null),Be(as)}var as=Le(0);function Hy(c){for(var h=c;h!==null;){if(h.tag===13){var p=h.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var sW=typeof AbortController<"u"?AbortController:function(){var c=[],h=this.signal={aborted:!1,addEventListener:function(p,g){c.push(g)}};this.abort=function(){h.aborted=!0,c.forEach(function(p){return p()})}},rW=n.unstable_scheduleCallback,iW=n.unstable_NormalPriority,os={$$typeof:y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Q1(){return{controller:new sW,data:new Map,refCount:0}}function Yf(c){c.refCount--,c.refCount===0&&rW(iW,function(){c.controller.abort()})}var Qf=null,Z1=0,Rh=0,Dh=null;function aW(c,h){if(Qf===null){var p=Qf=[];Z1=0,Rh=rS(),Dh={status:"pending",value:void 0,then:function(g){p.push(g)}}}return Z1++,h.then(YN,YN),h}function YN(){if(--Z1===0&&Qf!==null){Dh!==null&&(Dh.status="fulfilled");var c=Qf;Qf=null,Rh=0,Dh=null;for(var h=0;h<c.length;h++)(0,c[h])()}}function oW(c,h){var p=[],g={status:"pending",value:null,reason:null,then:function(S){p.push(S)}};return c.then(function(){g.status="fulfilled",g.value=h;for(var S=0;S<p.length;S++)(0,p[S])(h)},function(S){for(g.status="rejected",g.reason=S,S=0;S<p.length;S++)(0,p[S])(void 0)}),g}var QN=N.S;N.S=function(c,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&aW(c,h),QN!==null&&QN(c,h)};var Kc=Le(null);function J1(){var c=Kc.current;return c!==null?c:fn.pooledCache}function qy(c,h){h===null?je(Kc,Kc.current):je(Kc,h.pool)}function ZN(){var c=J1();return c===null?null:{parent:os._currentValue,pool:c}}var pl=0,xt=null,tn=null,Gn=null,Ky=!1,Oh=!1,Xc=!1,Xy=0,Zf=0,Fh=null,lW=0;function Bn(){throw Error(s(321))}function ew(c,h){if(h===null)return!1;for(var p=0;p<h.length&&p<c.length;p++)if(!Br(c[p],h[p]))return!1;return!0}function tw(c,h,p,g,S,_){return pl=_,xt=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,N.H=c===null||c.memoizedState===null?Yc:ml,Xc=!1,_=p(g,S),Xc=!1,Oh&&(_=ek(h,p,g,S)),JN(c),_}function JN(c){N.H=ya;var h=tn!==null&&tn.next!==null;if(pl=0,Gn=tn=xt=null,Ky=!1,Zf=0,Fh=null,h)throw Error(s(300));c===null||vs||(c=c.dependencies,c!==null&&rb(c)&&(vs=!0))}function ek(c,h,p,g){xt=c;var S=0;do{if(Oh&&(Fh=null),Zf=0,Oh=!1,25<=S)throw Error(s(301));if(S+=1,Gn=tn=null,c.updateQueue!=null){var _=c.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}N.H=Qc,_=h(p,g)}while(Oh);return _}function cW(){var c=N.H,h=c.useState()[0];return h=typeof h.then=="function"?Jf(h):h,c=c.useState()[0],(tn!==null?tn.memoizedState:null)!==c&&(xt.flags|=1024),h}function nw(){var c=Xy!==0;return Xy=0,c}function sw(c,h,p){h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~p}function rw(c){if(Ky){for(c=c.memoizedState;c!==null;){var h=c.queue;h!==null&&(h.pending=null),c=c.next}Ky=!1}pl=0,Gn=tn=xt=null,Oh=!1,Zf=Xy=0,Fh=null}function $r(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gn===null?xt.memoizedState=Gn=c:Gn=Gn.next=c,Gn}function Hn(){if(tn===null){var c=xt.alternate;c=c!==null?c.memoizedState:null}else c=tn.next;var h=Gn===null?xt.memoizedState:Gn.next;if(h!==null)Gn=h,tn=c;else{if(c===null)throw xt.alternate===null?Error(s(467)):Error(s(310));tn=c,c={memoizedState:tn.memoizedState,baseState:tn.baseState,baseQueue:tn.baseQueue,queue:tn.queue,next:null},Gn===null?xt.memoizedState=Gn=c:Gn=Gn.next=c}return Gn}var Yy;Yy=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Jf(c){var h=Zf;return Zf+=1,Fh===null&&(Fh=[]),c=jN(Fh,c,h),h=xt,(Gn===null?h.memoizedState:Gn.next)===null&&(h=h.alternate,N.H=h===null||h.memoizedState===null?Yc:ml),c}function Qy(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return Jf(c);if(c.$$typeof===y)return Ks(c)}throw Error(s(438,String(c)))}function iw(c){var h=null,p=xt.updateQueue;if(p!==null&&(h=p.memoCache),h==null){var g=xt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(h={data:g.data.map(function(S){return S.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),p===null&&(p=Yy(),xt.updateQueue=p),p.memoCache=h,p=h.data[h.index],p===void 0)for(p=h.data[h.index]=Array(c),g=0;g<c;g++)p[g]=C;return h.index++,p}function oo(c,h){return typeof h=="function"?h(c):h}function Zy(c){var h=Hn();return aw(h,tn,c)}function aw(c,h,p){var g=c.queue;if(g===null)throw Error(s(311));g.lastRenderedReducer=p;var S=c.baseQueue,_=g.pending;if(_!==null){if(S!==null){var M=S.next;S.next=_.next,_.next=M}h.baseQueue=S=_,g.pending=null}if(_=c.baseState,S===null)c.memoizedState=_;else{h=S.next;var U=M=null,q=null,oe=h,$e=!1;do{var Re=oe.lane&-536870913;if(Re!==oe.lane?(At&Re)===Re:(pl&Re)===Re){var ve=oe.revertLane;if(ve===0)q!==null&&(q=q.next={lane:0,revertLane:0,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),Re===Rh&&($e=!0);else if((pl&ve)===ve){oe=oe.next,ve===Rh&&($e=!0);continue}else Re={lane:0,revertLane:oe.revertLane,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},q===null?(U=q=Re,M=_):q=q.next=Re,xt.lanes|=ve,El|=ve;Re=oe.action,Xc&&p(_,Re),_=oe.hasEagerState?oe.eagerState:p(_,Re)}else ve={lane:Re,revertLane:oe.revertLane,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},q===null?(U=q=ve,M=_):q=q.next=ve,xt.lanes|=Re,El|=Re;oe=oe.next}while(oe!==null&&oe!==h);if(q===null?M=_:q.next=U,!Br(_,c.memoizedState)&&(vs=!0,$e&&(p=Dh,p!==null)))throw p;c.memoizedState=_,c.baseState=M,c.baseQueue=q,g.lastRenderedState=_}return S===null&&(g.lanes=0),[c.memoizedState,g.dispatch]}function ow(c){var h=Hn(),p=h.queue;if(p===null)throw Error(s(311));p.lastRenderedReducer=c;var g=p.dispatch,S=p.pending,_=h.memoizedState;if(S!==null){p.pending=null;var M=S=S.next;do _=c(_,M.action),M=M.next;while(M!==S);Br(_,h.memoizedState)||(vs=!0),h.memoizedState=_,h.baseQueue===null&&(h.baseState=_),p.lastRenderedState=_}return[_,g]}function tk(c,h,p){var g=xt,S=Hn(),_=zt;if(_){if(p===void 0)throw Error(s(407));p=p()}else p=h();var M=!Br((tn||S).memoizedState,p);if(M&&(S.memoizedState=p,vs=!0),S=S.queue,uw(rk.bind(null,g,S,c),[c]),S.getSnapshot!==h||M||Gn!==null&&Gn.memoizedState.tag&1){if(g.flags|=2048,Lh(9,sk.bind(null,g,S,p,h),{destroy:void 0},null),fn===null)throw Error(s(349));_||(pl&60)!==0||nk(g,h,p)}return p}function nk(c,h,p){c.flags|=16384,c={getSnapshot:h,value:p},h=xt.updateQueue,h===null?(h=Yy(),xt.updateQueue=h,h.stores=[c]):(p=h.stores,p===null?h.stores=[c]:p.push(c))}function sk(c,h,p,g){h.value=p,h.getSnapshot=g,ik(h)&&ak(c)}function rk(c,h,p){return p(function(){ik(h)&&ak(c)})}function ik(c){var h=c.getSnapshot;c=c.value;try{var p=h();return!Br(c,p)}catch{return!0}}function ak(c){var h=hl(c,2);h!==null&&gr(h,c,2)}function lw(c){var h=$r();if(typeof c=="function"){var p=c;if(c=p(),Xc){ra(!0);try{p()}finally{ra(!1)}}}return h.memoizedState=h.baseState=c,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oo,lastRenderedState:c},h}function ok(c,h,p,g){return c.baseState=p,aw(c,tn,typeof g=="function"?g:oo)}function uW(c,h,p,g,S){if(tb(c))throw Error(s(485));if(c=h.action,c!==null){var _={payload:S,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(M){_.listeners.push(M)}};N.T!==null?p(!0):_.isTransition=!1,g(_),p=h.pending,p===null?(_.next=h.pending=_,lk(h,_)):(_.next=p.next,h.pending=p.next=_)}}function lk(c,h){var p=h.action,g=h.payload,S=c.state;if(h.isTransition){var _=N.T,M={};N.T=M;try{var U=p(S,g),q=N.S;q!==null&&q(M,U),ck(c,h,U)}catch(oe){cw(c,h,oe)}finally{N.T=_}}else try{_=p(S,g),ck(c,h,_)}catch(oe){cw(c,h,oe)}}function ck(c,h,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(g){uk(c,h,g)},function(g){return cw(c,h,g)}):uk(c,h,p)}function uk(c,h,p){h.status="fulfilled",h.value=p,hk(h),c.state=p,h=c.pending,h!==null&&(p=h.next,p===h?c.pending=null:(p=p.next,h.next=p,lk(c,p)))}function cw(c,h,p){var g=c.pending;if(c.pending=null,g!==null){g=g.next;do h.status="rejected",h.reason=p,hk(h),h=h.next;while(h!==g)}c.action=null}function hk(c){c=c.listeners;for(var h=0;h<c.length;h++)(0,c[h])()}function dk(c,h){return h}function fk(c,h){if(zt){var p=fn.formState;if(p!==null){e:{var g=xt;if(zt){if(Ds){t:{for(var S=Ds,_=ma;S.nodeType!==8;){if(!_){S=null;break t}if(S=Li(S.nextSibling),S===null){S=null;break t}}_=S.data,S=_==="F!"||_==="F"?S:null}if(S){Ds=Li(S.nextSibling),g=S.data==="F!";break e}}Hc(g)}g=!1}g&&(h=p[0])}}return p=$r(),p.memoizedState=p.baseState=h,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dk,lastRenderedState:h},p.queue=g,p=Ak.bind(null,xt,g),g.dispatch=p,g=lw(!1),_=mw.bind(null,xt,!1,g.queue),g=$r(),S={state:h,dispatch:null,action:c,pending:null},g.queue=S,p=uW.bind(null,xt,S,_,p),S.dispatch=p,g.memoizedState=c,[h,p,!1]}function pk(c){var h=Hn();return mk(h,tn,c)}function mk(c,h,p){h=aw(c,h,dk)[0],c=Zy(oo)[0],h=typeof h=="object"&&h!==null&&typeof h.then=="function"?Jf(h):h;var g=Hn(),S=g.queue,_=S.dispatch;return p!==g.memoizedState&&(xt.flags|=2048,Lh(9,hW.bind(null,S,p),{destroy:void 0},null)),[h,_,c]}function hW(c,h){c.action=h}function gk(c){var h=Hn(),p=tn;if(p!==null)return mk(h,p,c);Hn(),h=h.memoizedState,p=Hn();var g=p.queue.dispatch;return p.memoizedState=c,[h,g,!1]}function Lh(c,h,p,g){return c={tag:c,create:h,inst:p,deps:g,next:null},h=xt.updateQueue,h===null&&(h=Yy(),xt.updateQueue=h),p=h.lastEffect,p===null?h.lastEffect=c.next=c:(g=p.next,p.next=c,c.next=g,h.lastEffect=c),c}function yk(){return Hn().memoizedState}function Jy(c,h,p,g){var S=$r();xt.flags|=c,S.memoizedState=Lh(1|h,p,{destroy:void 0},g===void 0?null:g)}function eb(c,h,p,g){var S=Hn();g=g===void 0?null:g;var _=S.memoizedState.inst;tn!==null&&g!==null&&ew(g,tn.memoizedState.deps)?S.memoizedState=Lh(h,p,_,g):(xt.flags|=c,S.memoizedState=Lh(1|h,p,_,g))}function bk(c,h){Jy(8390656,8,c,h)}function uw(c,h){eb(2048,8,c,h)}function xk(c,h){return eb(4,2,c,h)}function vk(c,h){return eb(4,4,c,h)}function wk(c,h){if(typeof h=="function"){c=c();var p=h(c);return function(){typeof p=="function"?p():h(null)}}if(h!=null)return c=c(),h.current=c,function(){h.current=null}}function Sk(c,h,p){p=p!=null?p.concat([c]):null,eb(4,4,wk.bind(null,h,c),p)}function hw(){}function Tk(c,h){var p=Hn();h=h===void 0?null:h;var g=p.memoizedState;return h!==null&&ew(h,g[1])?g[0]:(p.memoizedState=[c,h],c)}function Ek(c,h){var p=Hn();h=h===void 0?null:h;var g=p.memoizedState;if(h!==null&&ew(h,g[1]))return g[0];if(g=c(),Xc){ra(!0);try{c()}finally{ra(!1)}}return p.memoizedState=[g,h],g}function dw(c,h,p){return p===void 0||(pl&1073741824)!==0?c.memoizedState=h:(c.memoizedState=p,c=I2(),xt.lanes|=c,El|=c,p)}function _k(c,h,p,g){return Br(p,h)?p:Ah.current!==null?(c=dw(c,p,g),Br(c,h)||(vs=!0),c):(pl&42)===0?(vs=!0,c.memoizedState=p):(c=I2(),xt.lanes|=c,El|=c,h)}function Ik(c,h,p,g,S){var _=be.p;be.p=_!==0&&8>_?_:8;var M=N.T,U={};N.T=U,mw(c,!1,h,p);try{var q=S(),oe=N.S;if(oe!==null&&oe(U,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var $e=oW(q,g);ep(c,h,$e,Wr(c))}else ep(c,h,g,Wr(c))}catch(Re){ep(c,h,{then:function(){},status:"rejected",reason:Re},Wr())}finally{be.p=_,N.T=M}}function dW(){}function fw(c,h,p,g){if(c.tag!==5)throw Error(s(476));var S=$k(c).queue;Ik(c,S,h,_e,p===null?dW:function(){return Ck(c),p(g)})}function $k(c){var h=c.memoizedState;if(h!==null)return h;h={memoizedState:_e,baseState:_e,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oo,lastRenderedState:_e},next:null};var p={};return h.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oo,lastRenderedState:p},next:null},c.memoizedState=h,c=c.alternate,c!==null&&(c.memoizedState=h),h}function Ck(c){var h=$k(c).next.queue;ep(c,h,{},Wr())}function pw(){return Ks(vp)}function Nk(){return Hn().memoizedState}function kk(){return Hn().memoizedState}function fW(c){for(var h=c.return;h!==null;){switch(h.tag){case 24:case 3:var p=Wr();c=bl(p);var g=xl(h,c,p);g!==null&&(gr(g,h,p),sp(g,h,p)),h={cache:Q1()},c.payload=h;return}h=h.return}}function pW(c,h,p){var g=Wr();p={lane:g,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},tb(c)?Rk(h,p):(p=W1(c,h,p,g),p!==null&&(gr(p,c,g),Dk(p,h,g)))}function Ak(c,h,p){var g=Wr();ep(c,h,p,g)}function ep(c,h,p,g){var S={lane:g,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(tb(c))Rk(h,S);else{var _=c.alternate;if(c.lanes===0&&(_===null||_.lanes===0)&&(_=h.lastRenderedReducer,_!==null))try{var M=h.lastRenderedState,U=_(M,p);if(S.hasEagerState=!0,S.eagerState=U,Br(U,M))return My(c,h,S,0),fn===null&&Py(),!1}catch{}finally{}if(p=W1(c,h,S,g),p!==null)return gr(p,c,g),Dk(p,h,g),!0}return!1}function mw(c,h,p,g){if(g={lane:2,revertLane:rS(),action:g,hasEagerState:!1,eagerState:null,next:null},tb(c)){if(h)throw Error(s(479))}else h=W1(c,p,g,2),h!==null&&gr(h,c,2)}function tb(c){var h=c.alternate;return c===xt||h!==null&&h===xt}function Rk(c,h){Oh=Ky=!0;var p=c.pending;p===null?h.next=h:(h.next=p.next,p.next=h),c.pending=h}function Dk(c,h,p){if((p&4194176)!==0){var g=h.lanes;g&=c.pendingLanes,p|=g,h.lanes=p,tl(c,p)}}var ya={readContext:Ks,use:Qy,useCallback:Bn,useContext:Bn,useEffect:Bn,useImperativeHandle:Bn,useLayoutEffect:Bn,useInsertionEffect:Bn,useMemo:Bn,useReducer:Bn,useRef:Bn,useState:Bn,useDebugValue:Bn,useDeferredValue:Bn,useTransition:Bn,useSyncExternalStore:Bn,useId:Bn};ya.useCacheRefresh=Bn,ya.useMemoCache=Bn,ya.useHostTransitionStatus=Bn,ya.useFormState=Bn,ya.useActionState=Bn,ya.useOptimistic=Bn;var Yc={readContext:Ks,use:Qy,useCallback:function(c,h){return $r().memoizedState=[c,h===void 0?null:h],c},useContext:Ks,useEffect:bk,useImperativeHandle:function(c,h,p){p=p!=null?p.concat([c]):null,Jy(4194308,4,wk.bind(null,h,c),p)},useLayoutEffect:function(c,h){return Jy(4194308,4,c,h)},useInsertionEffect:function(c,h){Jy(4,2,c,h)},useMemo:function(c,h){var p=$r();h=h===void 0?null:h;var g=c();if(Xc){ra(!0);try{c()}finally{ra(!1)}}return p.memoizedState=[g,h],g},useReducer:function(c,h,p){var g=$r();if(p!==void 0){var S=p(h);if(Xc){ra(!0);try{p(h)}finally{ra(!1)}}}else S=h;return g.memoizedState=g.baseState=S,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:S},g.queue=c,c=c.dispatch=pW.bind(null,xt,c),[g.memoizedState,c]},useRef:function(c){var h=$r();return c={current:c},h.memoizedState=c},useState:function(c){c=lw(c);var h=c.queue,p=Ak.bind(null,xt,h);return h.dispatch=p,[c.memoizedState,p]},useDebugValue:hw,useDeferredValue:function(c,h){var p=$r();return dw(p,c,h)},useTransition:function(){var c=lw(!1);return c=Ik.bind(null,xt,c.queue,!0,!1),$r().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,h,p){var g=xt,S=$r();if(zt){if(p===void 0)throw Error(s(407));p=p()}else{if(p=h(),fn===null)throw Error(s(349));(At&60)!==0||nk(g,h,p)}S.memoizedState=p;var _={value:p,getSnapshot:h};return S.queue=_,bk(rk.bind(null,g,_,c),[c]),g.flags|=2048,Lh(9,sk.bind(null,g,_,p,h),{destroy:void 0},null),p},useId:function(){var c=$r(),h=fn.identifierPrefix;if(zt){var p=io,g=ro;p=(g&~(1<<32-dr(g)-1)).toString(32)+p,h=":"+h+"R"+p,p=Xy++,0<p&&(h+="H"+p.toString(32)),h+=":"}else p=lW++,h=":"+h+"r"+p.toString(32)+":";return c.memoizedState=h},useCacheRefresh:function(){return $r().memoizedState=fW.bind(null,xt)}};Yc.useMemoCache=iw,Yc.useHostTransitionStatus=pw,Yc.useFormState=fk,Yc.useActionState=fk,Yc.useOptimistic=function(c){var h=$r();h.memoizedState=h.baseState=c;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=p,h=mw.bind(null,xt,!0,p),p.dispatch=h,[c,h]};var ml={readContext:Ks,use:Qy,useCallback:Tk,useContext:Ks,useEffect:uw,useImperativeHandle:Sk,useInsertionEffect:xk,useLayoutEffect:vk,useMemo:Ek,useReducer:Zy,useRef:yk,useState:function(){return Zy(oo)},useDebugValue:hw,useDeferredValue:function(c,h){var p=Hn();return _k(p,tn.memoizedState,c,h)},useTransition:function(){var c=Zy(oo)[0],h=Hn().memoizedState;return[typeof c=="boolean"?c:Jf(c),h]},useSyncExternalStore:tk,useId:Nk};ml.useCacheRefresh=kk,ml.useMemoCache=iw,ml.useHostTransitionStatus=pw,ml.useFormState=pk,ml.useActionState=pk,ml.useOptimistic=function(c,h){var p=Hn();return ok(p,tn,c,h)};var Qc={readContext:Ks,use:Qy,useCallback:Tk,useContext:Ks,useEffect:uw,useImperativeHandle:Sk,useInsertionEffect:xk,useLayoutEffect:vk,useMemo:Ek,useReducer:ow,useRef:yk,useState:function(){return ow(oo)},useDebugValue:hw,useDeferredValue:function(c,h){var p=Hn();return tn===null?dw(p,c,h):_k(p,tn.memoizedState,c,h)},useTransition:function(){var c=ow(oo)[0],h=Hn().memoizedState;return[typeof c=="boolean"?c:Jf(c),h]},useSyncExternalStore:tk,useId:Nk};Qc.useCacheRefresh=kk,Qc.useMemoCache=iw,Qc.useHostTransitionStatus=pw,Qc.useFormState=gk,Qc.useActionState=gk,Qc.useOptimistic=function(c,h){var p=Hn();return tn!==null?ok(p,tn,c,h):(p.baseState=c,[c,p.queue.dispatch])};function gw(c,h,p,g){h=c.memoizedState,p=p(g,h),p=p==null?h:D({},h,p),c.memoizedState=p,c.lanes===0&&(c.updateQueue.baseState=p)}var yw={isMounted:function(c){return(c=c._reactInternals)?Z(c)===c:!1},enqueueSetState:function(c,h,p){c=c._reactInternals;var g=Wr(),S=bl(g);S.payload=h,p!=null&&(S.callback=p),h=xl(c,S,g),h!==null&&(gr(h,c,g),sp(h,c,g))},enqueueReplaceState:function(c,h,p){c=c._reactInternals;var g=Wr(),S=bl(g);S.tag=1,S.payload=h,p!=null&&(S.callback=p),h=xl(c,S,g),h!==null&&(gr(h,c,g),sp(h,c,g))},enqueueForceUpdate:function(c,h){c=c._reactInternals;var p=Wr(),g=bl(p);g.tag=2,h!=null&&(g.callback=h),h=xl(c,g,p),h!==null&&(gr(h,c,p),sp(h,c,p))}};function Ok(c,h,p,g,S,_,M){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(g,_,M):h.prototype&&h.prototype.isPureReactComponent?!zf(p,g)||!zf(S,_):!0}function Fk(c,h,p,g){c=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(p,g),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(p,g),h.state!==c&&yw.enqueueReplaceState(h,h.state,null)}function Zc(c,h){var p=h;if("ref"in h){p={};for(var g in h)g!=="ref"&&(p[g]=h[g])}if(c=c.defaultProps){p===h&&(p=D({},p));for(var S in c)p[S]===void 0&&(p[S]=c[S])}return p}var nb=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",c);return}console.error(c)};function Lk(c){nb(c)}function Pk(c){console.error(c)}function Mk(c){nb(c)}function sb(c,h){try{var p=c.onUncaughtError;p(h.value,{componentStack:h.stack})}catch(g){setTimeout(function(){throw g})}}function Vk(c,h,p){try{var g=c.onCaughtError;g(p.value,{componentStack:p.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function bw(c,h,p){return p=bl(p),p.tag=3,p.payload={element:null},p.callback=function(){sb(c,h)},p}function Bk(c){return c=bl(c),c.tag=3,c}function zk(c,h,p,g){var S=p.type.getDerivedStateFromError;if(typeof S=="function"){var _=g.value;c.payload=function(){return S(_)},c.callback=function(){Vk(h,p,g)}}var M=p.stateNode;M!==null&&typeof M.componentDidCatch=="function"&&(c.callback=function(){Vk(h,p,g),typeof S!="function"&&(_l===null?_l=new Set([this]):_l.add(this));var U=g.stack;this.componentDidCatch(g.value,{componentStack:U!==null?U:""})})}function mW(c,h,p,g,S){if(p.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(h=p.alternate,h!==null&&np(h,p,S,!0),p=ci.current,p!==null){switch(p.tag){case 13:return ga===null?Jw():p.alternate===null&&kn===0&&(kn=3),p.flags&=-257,p.flags|=65536,p.lanes=S,g===K1?p.flags|=16384:(h=p.updateQueue,h===null?p.updateQueue=new Set([g]):h.add(g),tS(c,g,S)),!1;case 22:return p.flags|=65536,g===K1?p.flags|=16384:(h=p.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([g])},p.updateQueue=h):(p=h.retryQueue,p===null?h.retryQueue=new Set([g]):p.add(g)),tS(c,g,S)),!1}throw Error(s(435,p.tag))}return tS(c,g,S),Jw(),!1}if(zt)return h=ci.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=S,g!==q1&&(c=Error(s(422),{cause:g}),Gf(ai(c,p)))):(g!==q1&&(h=Error(s(423),{cause:g}),Gf(ai(h,p))),c=c.current.alternate,c.flags|=65536,S&=-S,c.lanes|=S,g=ai(g,p),S=bw(c.stateNode,g,S),Dw(c,S),kn!==4&&(kn=2)),!1;var _=Error(s(520),{cause:g});if(_=ai(_,p),hp===null?hp=[_]:hp.push(_),kn!==4&&(kn=2),h===null)return!0;g=ai(g,p),p=h;do{switch(p.tag){case 3:return p.flags|=65536,c=S&-S,p.lanes|=c,c=bw(p.stateNode,g,c),Dw(p,c),!1;case 1:if(h=p.type,_=p.stateNode,(p.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(_l===null||!_l.has(_))))return p.flags|=65536,S&=-S,p.lanes|=S,S=Bk(S),zk(S,c,p,g),Dw(p,S),!1}p=p.return}while(p!==null);return!1}var Uk=Error(s(461)),vs=!1;function Os(c,h,p,g){h.child=c===null?qN(h,null,p,g):qc(h,c.child,p,g)}function jk(c,h,p,g,S){p=p.render;var _=h.ref;if("ref"in g){var M={};for(var U in g)U!=="ref"&&(M[U]=g[U])}else M=g;return eu(h),g=tw(c,h,p,M,_,S),U=nw(),c!==null&&!vs?(sw(c,h,S),lo(c,h,S)):(zt&&U&&G1(h),h.flags|=1,Os(c,h,g,S),h.child)}function Wk(c,h,p,g,S){if(c===null){var _=p.type;return typeof _=="function"&&!zw(_)&&_.defaultProps===void 0&&p.compare===null?(h.tag=15,h.type=_,Gk(c,h,_,g,S)):(c=lb(p.type,null,g,h,h.mode,S),c.ref=h.ref,c.return=h,h.child=c)}if(_=c.child,!$w(c,S)){var M=_.memoizedProps;if(p=p.compare,p=p!==null?p:zf,p(M,g)&&c.ref===h.ref)return lo(c,h,S)}return h.flags|=1,c=Tl(_,g),c.ref=h.ref,c.return=h,h.child=c}function Gk(c,h,p,g,S){if(c!==null){var _=c.memoizedProps;if(zf(_,g)&&c.ref===h.ref)if(vs=!1,h.pendingProps=g=_,$w(c,S))(c.flags&131072)!==0&&(vs=!0);else return h.lanes=c.lanes,lo(c,h,S)}return xw(c,h,p,g,S)}function Hk(c,h,p){var g=h.pendingProps,S=g.children,_=(h.stateNode._pendingVisibility&2)!==0,M=c!==null?c.memoizedState:null;if(tp(c,h),g.mode==="hidden"||_){if((h.flags&128)!==0){if(g=M!==null?M.baseLanes|p:p,c!==null){for(S=h.child=c.child,_=0;S!==null;)_=_|S.lanes|S.childLanes,S=S.sibling;h.childLanes=_&~g}else h.childLanes=0,h.child=null;return qk(c,h,g,p)}if((p&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},c!==null&&qy(h,M!==null?M.cachePool:null),M!==null?KN(h,M):X1(),XN(h);else return h.lanes=h.childLanes=536870912,qk(c,h,M!==null?M.baseLanes|p:p,p)}else M!==null?(qy(h,M.cachePool),KN(h,M),fl(),h.memoizedState=null):(c!==null&&qy(h,null),X1(),fl());return Os(c,h,S,p),h.child}function qk(c,h,p,g){var S=J1();return S=S===null?null:{parent:os._currentValue,pool:S},h.memoizedState={baseLanes:p,cachePool:S},c!==null&&qy(h,null),X1(),XN(h),c!==null&&np(c,h,g,!0),null}function tp(c,h){var p=h.ref;if(p===null)c!==null&&c.ref!==null&&(h.flags|=2097664);else{if(typeof p!="function"&&typeof p!="object")throw Error(s(284));(c===null||c.ref!==p)&&(h.flags|=2097664)}}function xw(c,h,p,g,S){return eu(h),p=tw(c,h,p,g,void 0,S),g=nw(),c!==null&&!vs?(sw(c,h,S),lo(c,h,S)):(zt&&g&&G1(h),h.flags|=1,Os(c,h,p,S),h.child)}function Kk(c,h,p,g,S,_){return eu(h),h.updateQueue=null,p=ek(h,g,p,S),JN(c),g=nw(),c!==null&&!vs?(sw(c,h,_),lo(c,h,_)):(zt&&g&&G1(h),h.flags|=1,Os(c,h,p,_),h.child)}function Xk(c,h,p,g,S){if(eu(h),h.stateNode===null){var _=$h,M=p.contextType;typeof M=="object"&&M!==null&&(_=Ks(M)),_=new p(g,_),h.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=yw,h.stateNode=_,_._reactInternals=h,_=h.stateNode,_.props=g,_.state=h.memoizedState,_.refs={},Aw(h),M=p.contextType,_.context=typeof M=="object"&&M!==null?Ks(M):$h,_.state=h.memoizedState,M=p.getDerivedStateFromProps,typeof M=="function"&&(gw(h,p,M,g),_.state=h.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(M=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),M!==_.state&&yw.enqueueReplaceState(_,_.state,null),ip(h,g,_,S),rp(),_.state=h.memoizedState),typeof _.componentDidMount=="function"&&(h.flags|=4194308),g=!0}else if(c===null){_=h.stateNode;var U=h.memoizedProps,q=Zc(p,U);_.props=q;var oe=_.context,$e=p.contextType;M=$h,typeof $e=="object"&&$e!==null&&(M=Ks($e));var Re=p.getDerivedStateFromProps;$e=typeof Re=="function"||typeof _.getSnapshotBeforeUpdate=="function",U=h.pendingProps!==U,$e||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(U||oe!==M)&&Fk(h,_,g,M),yl=!1;var ve=h.memoizedState;_.state=ve,ip(h,g,_,S),rp(),oe=h.memoizedState,U||ve!==oe||yl?(typeof Re=="function"&&(gw(h,p,Re,g),oe=h.memoizedState),(q=yl||Ok(h,p,q,g,ve,oe,M))?($e||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(h.flags|=4194308)):(typeof _.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=g,h.memoizedState=oe),_.props=g,_.state=oe,_.context=M,g=q):(typeof _.componentDidMount=="function"&&(h.flags|=4194308),g=!1)}else{_=h.stateNode,Rw(c,h),M=h.memoizedProps,$e=Zc(p,M),_.props=$e,Re=h.pendingProps,ve=_.context,oe=p.contextType,q=$h,typeof oe=="object"&&oe!==null&&(q=Ks(oe)),U=p.getDerivedStateFromProps,(oe=typeof U=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(M!==Re||ve!==q)&&Fk(h,_,g,q),yl=!1,ve=h.memoizedState,_.state=ve,ip(h,g,_,S),rp();var Ie=h.memoizedState;M!==Re||ve!==Ie||yl||c!==null&&c.dependencies!==null&&rb(c.dependencies)?(typeof U=="function"&&(gw(h,p,U,g),Ie=h.memoizedState),($e=yl||Ok(h,p,$e,g,ve,Ie,q)||c!==null&&c.dependencies!==null&&rb(c.dependencies))?(oe||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(g,Ie,q),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(g,Ie,q)),typeof _.componentDidUpdate=="function"&&(h.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof _.componentDidUpdate!="function"||M===c.memoizedProps&&ve===c.memoizedState||(h.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||M===c.memoizedProps&&ve===c.memoizedState||(h.flags|=1024),h.memoizedProps=g,h.memoizedState=Ie),_.props=g,_.state=Ie,_.context=q,g=$e):(typeof _.componentDidUpdate!="function"||M===c.memoizedProps&&ve===c.memoizedState||(h.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||M===c.memoizedProps&&ve===c.memoizedState||(h.flags|=1024),g=!1)}return _=g,tp(c,h),g=(h.flags&128)!==0,_||g?(_=h.stateNode,p=g&&typeof p.getDerivedStateFromError!="function"?null:_.render(),h.flags|=1,c!==null&&g?(h.child=qc(h,c.child,null,S),h.child=qc(h,null,p,S)):Os(c,h,p,S),h.memoizedState=_.state,c=h.child):c=lo(c,h,S),c}function Yk(c,h,p,g){return Wf(),h.flags|=256,Os(c,h,p,g),h.child}var vw={dehydrated:null,treeContext:null,retryLane:0};function ww(c){return{baseLanes:c,cachePool:ZN()}}function Sw(c,h,p){return c=c!==null?c.childLanes&~p:0,h&&(c|=fi),c}function Qk(c,h,p){var g=h.pendingProps,S=!1,_=(h.flags&128)!==0,M;if((M=_)||(M=c!==null&&c.memoizedState===null?!1:(as.current&2)!==0),M&&(S=!0,h.flags&=-129),M=(h.flags&32)!==0,h.flags&=-33,c===null){if(zt){if(S?dl(h):fl(),zt){var U=Ds,q;if(q=U){e:{for(q=U,U=ma;q.nodeType!==8;){if(!U){U=null;break e}if(q=Li(q.nextSibling),q===null){U=null;break e}}U=q}U!==null?(h.memoizedState={dehydrated:U,treeContext:Wc!==null?{id:ro,overflow:io}:null,retryLane:536870912},q=di(18,null,null,0),q.stateNode=U,q.return=h,h.child=q,mr=h,Ds=null,q=!0):q=!1}q||Hc(h)}if(U=h.memoizedState,U!==null&&(U=U.dehydrated,U!==null))return U.data==="$!"?h.lanes=16:h.lanes=536870912,null;ao(h)}return U=g.children,g=g.fallback,S?(fl(),S=h.mode,U=Ew({mode:"hidden",children:U},S),g=nu(g,S,p,null),U.return=h,g.return=h,U.sibling=g,h.child=U,S=h.child,S.memoizedState=ww(p),S.childLanes=Sw(c,M,p),h.memoizedState=vw,g):(dl(h),Tw(h,U))}if(q=c.memoizedState,q!==null&&(U=q.dehydrated,U!==null)){if(_)h.flags&256?(dl(h),h.flags&=-257,h=_w(c,h,p)):h.memoizedState!==null?(fl(),h.child=c.child,h.flags|=128,h=null):(fl(),S=g.fallback,U=h.mode,g=Ew({mode:"visible",children:g.children},U),S=nu(S,U,p,null),S.flags|=2,g.return=h,S.return=h,g.sibling=S,h.child=g,qc(h,c.child,null,p),g=h.child,g.memoizedState=ww(p),g.childLanes=Sw(c,M,p),h.memoizedState=vw,h=S);else if(dl(h),U.data==="$!"){if(M=U.nextSibling&&U.nextSibling.dataset,M)var oe=M.dgst;M=oe,g=Error(s(419)),g.stack="",g.digest=M,Gf({value:g,source:null,stack:null}),h=_w(c,h,p)}else if(vs||np(c,h,p,!1),M=(p&c.childLanes)!==0,vs||M){if(M=fn,M!==null){if(g=p&-p,(g&42)!==0)g=1;else switch(g){case 2:g=1;break;case 8:g=4;break;case 32:g=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:g=64;break;case 268435456:g=134217728;break;default:g=0}if(g=(g&(M.suspendedLanes|p))!==0?0:g,g!==0&&g!==q.retryLane)throw q.retryLane=g,hl(c,g),gr(M,c,g),Uk}U.data==="$?"||Jw(),h=_w(c,h,p)}else U.data==="$?"?(h.flags|=128,h.child=c.child,h=kW.bind(null,c),U._reactRetry=h,h=null):(c=q.treeContext,Ds=Li(U.nextSibling),mr=h,zt=!0,Oi=null,ma=!1,c!==null&&(oi[li++]=ro,oi[li++]=io,oi[li++]=Wc,ro=c.id,io=c.overflow,Wc=h),h=Tw(h,g.children),h.flags|=4096);return h}return S?(fl(),S=g.fallback,U=h.mode,q=c.child,oe=q.sibling,g=Tl(q,{mode:"hidden",children:g.children}),g.subtreeFlags=q.subtreeFlags&31457280,oe!==null?S=Tl(oe,S):(S=nu(S,U,p,null),S.flags|=2),S.return=h,g.return=h,g.sibling=S,h.child=g,g=S,S=h.child,U=c.child.memoizedState,U===null?U=ww(p):(q=U.cachePool,q!==null?(oe=os._currentValue,q=q.parent!==oe?{parent:oe,pool:oe}:q):q=ZN(),U={baseLanes:U.baseLanes|p,cachePool:q}),S.memoizedState=U,S.childLanes=Sw(c,M,p),h.memoizedState=vw,g):(dl(h),p=c.child,c=p.sibling,p=Tl(p,{mode:"visible",children:g.children}),p.return=h,p.sibling=null,c!==null&&(M=h.deletions,M===null?(h.deletions=[c],h.flags|=16):M.push(c)),h.child=p,h.memoizedState=null,p)}function Tw(c,h){return h=Ew({mode:"visible",children:h},c.mode),h.return=c,c.child=h}function Ew(c,h){return T2(c,h,0,null)}function _w(c,h,p){return qc(h,c.child,null,p),c=Tw(h,h.pendingProps.children),c.flags|=2,h.memoizedState=null,c}function Zk(c,h,p){c.lanes|=h;var g=c.alternate;g!==null&&(g.lanes|=h),Nw(c.return,h,p)}function Iw(c,h,p,g,S){var _=c.memoizedState;_===null?c.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:g,tail:p,tailMode:S}:(_.isBackwards=h,_.rendering=null,_.renderingStartTime=0,_.last=g,_.tail=p,_.tailMode=S)}function Jk(c,h,p){var g=h.pendingProps,S=g.revealOrder,_=g.tail;if(Os(c,h,g.children,p),g=as.current,(g&2)!==0)g=g&1|2,h.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=h.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&Zk(c,p,h);else if(c.tag===19)Zk(c,p,h);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===h)break e;for(;c.sibling===null;){if(c.return===null||c.return===h)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}g&=1}switch(je(as,g),S){case"forwards":for(p=h.child,S=null;p!==null;)c=p.alternate,c!==null&&Hy(c)===null&&(S=p),p=p.sibling;p=S,p===null?(S=h.child,h.child=null):(S=p.sibling,p.sibling=null),Iw(h,!1,S,p,_);break;case"backwards":for(p=null,S=h.child,h.child=null;S!==null;){if(c=S.alternate,c!==null&&Hy(c)===null){h.child=S;break}c=S.sibling,S.sibling=p,p=S,S=c}Iw(h,!0,p,null,_);break;case"together":Iw(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function lo(c,h,p){if(c!==null&&(h.dependencies=c.dependencies),El|=h.lanes,(p&h.childLanes)===0)if(c!==null){if(np(c,h,p,!1),(p&h.childLanes)===0)return null}else return null;if(c!==null&&h.child!==c.child)throw Error(s(153));if(h.child!==null){for(c=h.child,p=Tl(c,c.pendingProps),h.child=p,p.return=h;c.sibling!==null;)c=c.sibling,p=p.sibling=Tl(c,c.pendingProps),p.return=h;p.sibling=null}return h.child}function $w(c,h){return(c.lanes&h)!==0?!0:(c=c.dependencies,!!(c!==null&&rb(c)))}function gW(c,h,p){switch(h.tag){case 3:Tt(h,h.stateNode.containerInfo),gl(h,os,c.memoizedState.cache),Wf();break;case 27:case 5:qt(h);break;case 4:Tt(h,h.stateNode.containerInfo);break;case 10:gl(h,h.type,h.memoizedProps.value);break;case 13:var g=h.memoizedState;if(g!==null)return g.dehydrated!==null?(dl(h),h.flags|=128,null):(p&h.child.childLanes)!==0?Qk(c,h,p):(dl(h),c=lo(c,h,p),c!==null?c.sibling:null);dl(h);break;case 19:var S=(c.flags&128)!==0;if(g=(p&h.childLanes)!==0,g||(np(c,h,p,!1),g=(p&h.childLanes)!==0),S){if(g)return Jk(c,h,p);h.flags|=128}if(S=h.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),je(as,as.current),g)break;return null;case 22:case 23:return h.lanes=0,Hk(c,h,p);case 24:gl(h,os,c.memoizedState.cache)}return lo(c,h,p)}function e2(c,h,p){if(c!==null)if(c.memoizedProps!==h.pendingProps)vs=!0;else{if(!$w(c,p)&&(h.flags&128)===0)return vs=!1,gW(c,h,p);vs=(c.flags&131072)!==0}else vs=!1,zt&&(h.flags&1048576)!==0&&MN(h,zy,h.index);switch(h.lanes=0,h.tag){case 16:e:{c=h.pendingProps;var g=h.elementType,S=g._init;if(g=S(g._payload),h.type=g,typeof g=="function")zw(g)?(c=Zc(g,c),h.tag=1,h=Xk(null,h,g,c,p)):(h.tag=0,h=xw(null,h,g,c,p));else{if(g!=null){if(S=g.$$typeof,S===b){h.tag=11,h=jk(null,h,g,c,p);break e}else if(S===T){h.tag=14,h=Wk(null,h,g,c,p);break e}}throw h=R(g)||g,Error(s(306,h,""))}}return h;case 0:return xw(c,h,h.type,h.pendingProps,p);case 1:return g=h.type,S=Zc(g,h.pendingProps),Xk(c,h,g,S,p);case 3:e:{if(Tt(h,h.stateNode.containerInfo),c===null)throw Error(s(387));var _=h.pendingProps;S=h.memoizedState,g=S.element,Rw(c,h),ip(h,_,null,p);var M=h.memoizedState;if(_=M.cache,gl(h,os,_),_!==S.cache&&kw(h,[os],p,!0),rp(),_=M.element,S.isDehydrated)if(S={element:_,isDehydrated:!1,cache:M.cache},h.updateQueue.baseState=S,h.memoizedState=S,h.flags&256){h=Yk(c,h,_,p);break e}else if(_!==g){g=ai(Error(s(424)),h),Gf(g),h=Yk(c,h,_,p);break e}else for(Ds=Li(h.stateNode.containerInfo.firstChild),mr=h,zt=!0,Oi=null,ma=!0,p=qN(h,null,_,p),h.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Wf(),_===g){h=lo(c,h,p);break e}Os(c,h,_,p)}h=h.child}return h;case 26:return tp(c,h),c===null?(p=sA(h.type,null,h.pendingProps,null))?h.memoizedState=p:zt||(p=h.type,c=h.pendingProps,g=vb(pt.current).createElement(p),g[ys]=h,g[ss]=c,Fs(g,p,c),Tn(g),h.stateNode=g):h.memoizedState=sA(h.type,c.memoizedProps,h.pendingProps,c.memoizedState),null;case 27:return qt(h),c===null&&zt&&(g=h.stateNode=eA(h.type,h.pendingProps,pt.current),mr=h,ma=!0,Ds=Li(g.firstChild)),g=h.pendingProps.children,c!==null||zt?Os(c,h,g,p):h.child=qc(h,null,g,p),tp(c,h),h.child;case 5:return c===null&&zt&&((S=g=Ds)&&(g=HW(g,h.type,h.pendingProps,ma),g!==null?(h.stateNode=g,mr=h,Ds=Li(g.firstChild),ma=!1,S=!0):S=!1),S||Hc(h)),qt(h),S=h.type,_=h.pendingProps,M=c!==null?c.memoizedProps:null,g=_.children,fS(S,_)?g=null:M!==null&&fS(S,M)&&(h.flags|=32),h.memoizedState!==null&&(S=tw(c,h,cW,null,null,p),vp._currentValue=S),tp(c,h),Os(c,h,g,p),h.child;case 6:return c===null&&zt&&((c=p=Ds)&&(p=qW(p,h.pendingProps,ma),p!==null?(h.stateNode=p,mr=h,Ds=null,c=!0):c=!1),c||Hc(h)),null;case 13:return Qk(c,h,p);case 4:return Tt(h,h.stateNode.containerInfo),g=h.pendingProps,c===null?h.child=qc(h,null,g,p):Os(c,h,g,p),h.child;case 11:return jk(c,h,h.type,h.pendingProps,p);case 7:return Os(c,h,h.pendingProps,p),h.child;case 8:return Os(c,h,h.pendingProps.children,p),h.child;case 12:return Os(c,h,h.pendingProps.children,p),h.child;case 10:return g=h.pendingProps,gl(h,h.type,g.value),Os(c,h,g.children,p),h.child;case 9:return S=h.type._context,g=h.pendingProps.children,eu(h),S=Ks(S),g=g(S),h.flags|=1,Os(c,h,g,p),h.child;case 14:return Wk(c,h,h.type,h.pendingProps,p);case 15:return Gk(c,h,h.type,h.pendingProps,p);case 19:return Jk(c,h,p);case 22:return Hk(c,h,p);case 24:return eu(h),g=Ks(os),c===null?(S=J1(),S===null&&(S=fn,_=Q1(),S.pooledCache=_,_.refCount++,_!==null&&(S.pooledCacheLanes|=p),S=_),h.memoizedState={parent:g,cache:S},Aw(h),gl(h,os,S)):((c.lanes&p)!==0&&(Rw(c,h),ip(h,null,null,p),rp()),S=c.memoizedState,_=h.memoizedState,S.parent!==g?(S={parent:g,cache:g},h.memoizedState=S,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=S),gl(h,os,g)):(g=_.cache,gl(h,os,g),g!==S.cache&&kw(h,[os],p,!0))),Os(c,h,h.pendingProps.children,p),h.child;case 29:throw h.pendingProps}throw Error(s(156,h.tag))}var Cw=Le(null),Jc=null,co=null;function gl(c,h,p){je(Cw,h._currentValue),h._currentValue=p}function uo(c){c._currentValue=Cw.current,Be(Cw)}function Nw(c,h,p){for(;c!==null;){var g=c.alternate;if((c.childLanes&h)!==h?(c.childLanes|=h,g!==null&&(g.childLanes|=h)):g!==null&&(g.childLanes&h)!==h&&(g.childLanes|=h),c===p)break;c=c.return}}function kw(c,h,p,g){var S=c.child;for(S!==null&&(S.return=c);S!==null;){var _=S.dependencies;if(_!==null){var M=S.child;_=_.firstContext;e:for(;_!==null;){var U=_;_=S;for(var q=0;q<h.length;q++)if(U.context===h[q]){_.lanes|=p,U=_.alternate,U!==null&&(U.lanes|=p),Nw(_.return,p,c),g||(M=null);break e}_=U.next}}else if(S.tag===18){if(M=S.return,M===null)throw Error(s(341));M.lanes|=p,_=M.alternate,_!==null&&(_.lanes|=p),Nw(M,p,c),M=null}else M=S.child;if(M!==null)M.return=S;else for(M=S;M!==null;){if(M===c){M=null;break}if(S=M.sibling,S!==null){S.return=M.return,M=S;break}M=M.return}S=M}}function np(c,h,p,g){c=null;for(var S=h,_=!1;S!==null;){if(!_){if((S.flags&524288)!==0)_=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var M=S.alternate;if(M===null)throw Error(s(387));if(M=M.memoizedProps,M!==null){var U=S.type;Br(S.pendingProps.value,M.value)||(c!==null?c.push(U):c=[U])}}else if(S===Mt.current){if(M=S.alternate,M===null)throw Error(s(387));M.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(c!==null?c.push(vp):c=[vp])}S=S.return}c!==null&&kw(h,c,p,g),h.flags|=262144}function rb(c){for(c=c.firstContext;c!==null;){if(!Br(c.context._currentValue,c.memoizedValue))return!0;c=c.next}return!1}function eu(c){Jc=c,co=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function Ks(c){return t2(Jc,c)}function ib(c,h){return Jc===null&&eu(c),t2(c,h)}function t2(c,h){var p=h._currentValue;if(h={context:h,memoizedValue:p,next:null},co===null){if(c===null)throw Error(s(308));co=h,c.dependencies={lanes:0,firstContext:h},c.flags|=524288}else co=co.next=h;return p}var yl=!1;function Aw(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Rw(c,h){c=c.updateQueue,h.updateQueue===c&&(h.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function bl(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function xl(c,h,p){var g=c.updateQueue;if(g===null)return null;if(g=g.shared,(_n&2)!==0){var S=g.pending;return S===null?h.next=h:(h.next=S.next,S.next=h),g.pending=h,h=Vy(c),LN(c,null,p),h}return My(c,g,h,p),Vy(c)}function sp(c,h,p){if(h=h.updateQueue,h!==null&&(h=h.shared,(p&4194176)!==0)){var g=h.lanes;g&=c.pendingLanes,p|=g,h.lanes=p,tl(c,p)}}function Dw(c,h){var p=c.updateQueue,g=c.alternate;if(g!==null&&(g=g.updateQueue,p===g)){var S=null,_=null;if(p=p.firstBaseUpdate,p!==null){do{var M={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};_===null?S=_=M:_=_.next=M,p=p.next}while(p!==null);_===null?S=_=h:_=_.next=h}else S=_=h;p={baseState:g.baseState,firstBaseUpdate:S,lastBaseUpdate:_,shared:g.shared,callbacks:g.callbacks},c.updateQueue=p;return}c=p.lastBaseUpdate,c===null?p.firstBaseUpdate=h:c.next=h,p.lastBaseUpdate=h}var Ow=!1;function rp(){if(Ow){var c=Dh;if(c!==null)throw c}}function ip(c,h,p,g){Ow=!1;var S=c.updateQueue;yl=!1;var _=S.firstBaseUpdate,M=S.lastBaseUpdate,U=S.shared.pending;if(U!==null){S.shared.pending=null;var q=U,oe=q.next;q.next=null,M===null?_=oe:M.next=oe,M=q;var $e=c.alternate;$e!==null&&($e=$e.updateQueue,U=$e.lastBaseUpdate,U!==M&&(U===null?$e.firstBaseUpdate=oe:U.next=oe,$e.lastBaseUpdate=q))}if(_!==null){var Re=S.baseState;M=0,$e=oe=q=null,U=_;do{var ve=U.lane&-536870913,Ie=ve!==U.lane;if(Ie?(At&ve)===ve:(g&ve)===ve){ve!==0&&ve===Rh&&(Ow=!0),$e!==null&&($e=$e.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var Xe=c,at=U;ve=h;var An=p;switch(at.tag){case 1:if(Xe=at.payload,typeof Xe=="function"){Re=Xe.call(An,Re,ve);break e}Re=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=at.payload,ve=typeof Xe=="function"?Xe.call(An,Re,ve):Xe,ve==null)break e;Re=D({},Re,ve);break e;case 2:yl=!0}}ve=U.callback,ve!==null&&(c.flags|=64,Ie&&(c.flags|=8192),Ie=S.callbacks,Ie===null?S.callbacks=[ve]:Ie.push(ve))}else Ie={lane:ve,tag:U.tag,payload:U.payload,callback:U.callback,next:null},$e===null?(oe=$e=Ie,q=Re):$e=$e.next=Ie,M|=ve;if(U=U.next,U===null){if(U=S.shared.pending,U===null)break;Ie=U,U=Ie.next,Ie.next=null,S.lastBaseUpdate=Ie,S.shared.pending=null}}while(!0);$e===null&&(q=Re),S.baseState=q,S.firstBaseUpdate=oe,S.lastBaseUpdate=$e,_===null&&(S.shared.lanes=0),El|=M,c.lanes=M,c.memoizedState=Re}}function n2(c,h){if(typeof c!="function")throw Error(s(191,c));c.call(h)}function s2(c,h){var p=c.callbacks;if(p!==null)for(c.callbacks=null,c=0;c<p.length;c++)n2(p[c],h)}function ap(c,h){try{var p=h.updateQueue,g=p!==null?p.lastEffect:null;if(g!==null){var S=g.next;p=S;do{if((p.tag&c)===c){g=void 0;var _=p.create,M=p.inst;g=_(),M.destroy=g}p=p.next}while(p!==S)}}catch(U){on(h,h.return,U)}}function vl(c,h,p){try{var g=h.updateQueue,S=g!==null?g.lastEffect:null;if(S!==null){var _=S.next;g=_;do{if((g.tag&c)===c){var M=g.inst,U=M.destroy;if(U!==void 0){M.destroy=void 0,S=h;var q=p;try{U()}catch(oe){on(S,q,oe)}}}g=g.next}while(g!==_)}}catch(oe){on(h,h.return,oe)}}function r2(c){var h=c.updateQueue;if(h!==null){var p=c.stateNode;try{s2(h,p)}catch(g){on(c,c.return,g)}}}function i2(c,h,p){p.props=Zc(c.type,c.memoizedProps),p.state=c.memoizedState;try{p.componentWillUnmount()}catch(g){on(c,h,g)}}function tu(c,h){try{var p=c.ref;if(p!==null){var g=c.stateNode;switch(c.tag){case 26:case 27:case 5:var S=g;break;default:S=g}typeof p=="function"?c.refCleanup=p(S):p.current=S}}catch(_){on(c,h,_)}}function zr(c,h){var p=c.ref,g=c.refCleanup;if(p!==null)if(typeof g=="function")try{g()}catch(S){on(c,h,S)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(S){on(c,h,S)}else p.current=null}function a2(c){var h=c.type,p=c.memoizedProps,g=c.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":p.autoFocus&&g.focus();break e;case"img":p.src?g.src=p.src:p.srcSet&&(g.srcset=p.srcSet)}}catch(S){on(c,c.return,S)}}function o2(c,h,p){try{var g=c.stateNode;zW(g,c.type,p,h),g[ss]=h}catch(S){on(c,c.return,S)}}function l2(c){return c.tag===5||c.tag===3||c.tag===26||c.tag===27||c.tag===4}function Fw(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||l2(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==27&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function Lw(c,h,p){var g=c.tag;if(g===5||g===6)c=c.stateNode,h?p.nodeType===8?p.parentNode.insertBefore(c,h):p.insertBefore(c,h):(p.nodeType===8?(h=p.parentNode,h.insertBefore(c,p)):(h=p,h.appendChild(c)),p=p._reactRootContainer,p!=null||h.onclick!==null||(h.onclick=xb));else if(g!==4&&g!==27&&(c=c.child,c!==null))for(Lw(c,h,p),c=c.sibling;c!==null;)Lw(c,h,p),c=c.sibling}function ab(c,h,p){var g=c.tag;if(g===5||g===6)c=c.stateNode,h?p.insertBefore(c,h):p.appendChild(c);else if(g!==4&&g!==27&&(c=c.child,c!==null))for(ab(c,h,p),c=c.sibling;c!==null;)ab(c,h,p),c=c.sibling}var ho=!1,Nn=!1,Pw=!1,c2=typeof WeakSet=="function"?WeakSet:Set,ws=null,u2=!1;function yW(c,h){if(c=c.containerInfo,hS=Ib,c=$N(c),V1(c)){if("selectionStart"in c)var p={start:c.selectionStart,end:c.selectionEnd};else e:{p=(p=c.ownerDocument)&&p.defaultView||window;var g=p.getSelection&&p.getSelection();if(g&&g.rangeCount!==0){p=g.anchorNode;var S=g.anchorOffset,_=g.focusNode;g=g.focusOffset;try{p.nodeType,_.nodeType}catch{p=null;break e}var M=0,U=-1,q=-1,oe=0,$e=0,Re=c,ve=null;t:for(;;){for(var Ie;Re!==p||S!==0&&Re.nodeType!==3||(U=M+S),Re!==_||g!==0&&Re.nodeType!==3||(q=M+g),Re.nodeType===3&&(M+=Re.nodeValue.length),(Ie=Re.firstChild)!==null;)ve=Re,Re=Ie;for(;;){if(Re===c)break t;if(ve===p&&++oe===S&&(U=M),ve===_&&++$e===g&&(q=M),(Ie=Re.nextSibling)!==null)break;Re=ve,ve=Re.parentNode}Re=Ie}p=U===-1||q===-1?null:{start:U,end:q}}else p=null}p=p||{start:0,end:0}}else p=null;for(dS={focusedElem:c,selectionRange:p},Ib=!1,ws=h;ws!==null;)if(h=ws,c=h.child,(h.subtreeFlags&1028)!==0&&c!==null)c.return=h,ws=c;else for(;ws!==null;){switch(h=ws,_=h.alternate,c=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((c&1024)!==0&&_!==null){c=void 0,p=h,S=_.memoizedProps,_=_.memoizedState,g=p.stateNode;try{var Xe=Zc(p.type,S,p.elementType===p.type);c=g.getSnapshotBeforeUpdate(Xe,_),g.__reactInternalSnapshotBeforeUpdate=c}catch(at){on(p,p.return,at)}}break;case 3:if((c&1024)!==0){if(c=h.stateNode.containerInfo,p=c.nodeType,p===9)gS(c);else if(p===1)switch(c.nodeName){case"HEAD":case"HTML":case"BODY":gS(c);break;default:c.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((c&1024)!==0)throw Error(s(163))}if(c=h.sibling,c!==null){c.return=h.return,ws=c;break}ws=h.return}return Xe=u2,u2=!1,Xe}function h2(c,h,p){var g=p.flags;switch(p.tag){case 0:case 11:case 15:po(c,p),g&4&&ap(5,p);break;case 1:if(po(c,p),g&4)if(c=p.stateNode,h===null)try{c.componentDidMount()}catch(U){on(p,p.return,U)}else{var S=Zc(p.type,h.memoizedProps);h=h.memoizedState;try{c.componentDidUpdate(S,h,c.__reactInternalSnapshotBeforeUpdate)}catch(U){on(p,p.return,U)}}g&64&&r2(p),g&512&&tu(p,p.return);break;case 3:if(po(c,p),g&64&&(g=p.updateQueue,g!==null)){if(c=null,p.child!==null)switch(p.child.tag){case 27:case 5:c=p.child.stateNode;break;case 1:c=p.child.stateNode}try{s2(g,c)}catch(U){on(p,p.return,U)}}break;case 26:po(c,p),g&512&&tu(p,p.return);break;case 27:case 5:po(c,p),h===null&&g&4&&a2(p),g&512&&tu(p,p.return);break;case 12:po(c,p);break;case 13:po(c,p),g&4&&p2(c,p);break;case 22:if(S=p.memoizedState!==null||ho,!S){h=h!==null&&h.memoizedState!==null||Nn;var _=ho,M=Nn;ho=S,(Nn=h)&&!M?wl(c,p,(p.subtreeFlags&8772)!==0):po(c,p),ho=_,Nn=M}g&512&&(p.memoizedProps.mode==="manual"?tu(p,p.return):zr(p,p.return));break;default:po(c,p)}}function d2(c){var h=c.alternate;h!==null&&(c.alternate=null,d2(h)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(h=c.stateNode,h!==null&&Ac(h)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}var qn=null,Ur=!1;function fo(c,h,p){for(p=p.child;p!==null;)f2(c,h,p),p=p.sibling}function f2(c,h,p){if(gs&&typeof gs.onCommitFiberUnmount=="function")try{gs.onCommitFiberUnmount(Pr,p)}catch{}switch(p.tag){case 26:Nn||zr(p,h),fo(c,h,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Nn||zr(p,h);var g=qn,S=Ur;for(qn=p.stateNode,fo(c,h,p),p=p.stateNode,h=p.attributes;h.length;)p.removeAttributeNode(h[0]);Ac(p),qn=g,Ur=S;break;case 5:Nn||zr(p,h);case 6:S=qn;var _=Ur;if(qn=null,fo(c,h,p),qn=S,Ur=_,qn!==null)if(Ur)try{c=qn,g=p.stateNode,c.nodeType===8?c.parentNode.removeChild(g):c.removeChild(g)}catch(M){on(p,h,M)}else try{qn.removeChild(p.stateNode)}catch(M){on(p,h,M)}break;case 18:qn!==null&&(Ur?(h=qn,p=p.stateNode,h.nodeType===8?mS(h.parentNode,p):h.nodeType===1&&mS(h,p),Ep(h)):mS(qn,p.stateNode));break;case 4:g=qn,S=Ur,qn=p.stateNode.containerInfo,Ur=!0,fo(c,h,p),qn=g,Ur=S;break;case 0:case 11:case 14:case 15:Nn||vl(2,p,h),Nn||vl(4,p,h),fo(c,h,p);break;case 1:Nn||(zr(p,h),g=p.stateNode,typeof g.componentWillUnmount=="function"&&i2(p,h,g)),fo(c,h,p);break;case 21:fo(c,h,p);break;case 22:Nn||zr(p,h),Nn=(g=Nn)||p.memoizedState!==null,fo(c,h,p),Nn=g;break;default:fo(c,h,p)}}function p2(c,h){if(h.memoizedState===null&&(c=h.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{Ep(c)}catch(p){on(h,h.return,p)}}function bW(c){switch(c.tag){case 13:case 19:var h=c.stateNode;return h===null&&(h=c.stateNode=new c2),h;case 22:return c=c.stateNode,h=c._retryCache,h===null&&(h=c._retryCache=new c2),h;default:throw Error(s(435,c.tag))}}function Mw(c,h){var p=bW(c);h.forEach(function(g){var S=AW.bind(null,c,g);p.has(g)||(p.add(g),g.then(S,S))})}function ui(c,h){var p=h.deletions;if(p!==null)for(var g=0;g<p.length;g++){var S=p[g],_=c,M=h,U=M;e:for(;U!==null;){switch(U.tag){case 27:case 5:qn=U.stateNode,Ur=!1;break e;case 3:qn=U.stateNode.containerInfo,Ur=!0;break e;case 4:qn=U.stateNode.containerInfo,Ur=!0;break e}U=U.return}if(qn===null)throw Error(s(160));f2(_,M,S),qn=null,Ur=!1,_=S.alternate,_!==null&&(_.return=null),S.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)m2(h,c),h=h.sibling}var Fi=null;function m2(c,h){var p=c.alternate,g=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:ui(h,c),hi(c),g&4&&(vl(3,c,c.return),ap(3,c),vl(5,c,c.return));break;case 1:ui(h,c),hi(c),g&512&&(Nn||p===null||zr(p,p.return)),g&64&&ho&&(c=c.updateQueue,c!==null&&(g=c.callbacks,g!==null&&(p=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=p===null?g:p.concat(g))));break;case 26:var S=Fi;if(ui(h,c),hi(c),g&512&&(Nn||p===null||zr(p,p.return)),g&4){var _=p!==null?p.memoizedState:null;if(g=c.memoizedState,p===null)if(g===null)if(c.stateNode===null){e:{g=c.type,p=c.memoizedProps,S=S.ownerDocument||S;t:switch(g){case"title":_=S.getElementsByTagName("title")[0],(!_||_[sl]||_[ys]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=S.createElement(g),S.head.insertBefore(_,S.querySelector("head > title"))),Fs(_,g,p),_[ys]=c,Tn(_),g=_;break e;case"link":var M=aA("link","href",S).get(g+(p.href||""));if(M){for(var U=0;U<M.length;U++)if(_=M[U],_.getAttribute("href")===(p.href==null?null:p.href)&&_.getAttribute("rel")===(p.rel==null?null:p.rel)&&_.getAttribute("title")===(p.title==null?null:p.title)&&_.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){M.splice(U,1);break t}}_=S.createElement(g),Fs(_,g,p),S.head.appendChild(_);break;case"meta":if(M=aA("meta","content",S).get(g+(p.content||""))){for(U=0;U<M.length;U++)if(_=M[U],_.getAttribute("content")===(p.content==null?null:""+p.content)&&_.getAttribute("name")===(p.name==null?null:p.name)&&_.getAttribute("property")===(p.property==null?null:p.property)&&_.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&_.getAttribute("charset")===(p.charSet==null?null:p.charSet)){M.splice(U,1);break t}}_=S.createElement(g),Fs(_,g,p),S.head.appendChild(_);break;default:throw Error(s(468,g))}_[ys]=c,Tn(_),g=_}c.stateNode=g}else oA(S,c.type,c.stateNode);else c.stateNode=iA(S,g,c.memoizedProps);else _!==g?(_===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):_.count--,g===null?oA(S,c.type,c.stateNode):iA(S,g,c.memoizedProps)):g===null&&c.stateNode!==null&&o2(c,c.memoizedProps,p.memoizedProps)}break;case 27:if(g&4&&c.alternate===null){S=c.stateNode,_=c.memoizedProps;try{for(var q=S.firstChild;q;){var oe=q.nextSibling,$e=q.nodeName;q[sl]||$e==="HEAD"||$e==="BODY"||$e==="SCRIPT"||$e==="STYLE"||$e==="LINK"&&q.rel.toLowerCase()==="stylesheet"||S.removeChild(q),q=oe}for(var Re=c.type,ve=S.attributes;ve.length;)S.removeAttributeNode(ve[0]);Fs(S,Re,_),S[ys]=c,S[ss]=_}catch(Xe){on(c,c.return,Xe)}}case 5:if(ui(h,c),hi(c),g&512&&(Nn||p===null||zr(p,p.return)),c.flags&32){S=c.stateNode;try{ti(S,"")}catch(Xe){on(c,c.return,Xe)}}g&4&&c.stateNode!=null&&(S=c.memoizedProps,o2(c,S,p!==null?p.memoizedProps:S)),g&1024&&(Pw=!0);break;case 6:if(ui(h,c),hi(c),g&4){if(c.stateNode===null)throw Error(s(162));g=c.memoizedProps,p=c.stateNode;try{p.nodeValue=g}catch(Xe){on(c,c.return,Xe)}}break;case 3:if(Tb=null,S=Fi,Fi=wb(h.containerInfo),ui(h,c),Fi=S,hi(c),g&4&&p!==null&&p.memoizedState.isDehydrated)try{Ep(h.containerInfo)}catch(Xe){on(c,c.return,Xe)}Pw&&(Pw=!1,g2(c));break;case 4:g=Fi,Fi=wb(c.stateNode.containerInfo),ui(h,c),hi(c),Fi=g;break;case 12:ui(h,c),hi(c);break;case 13:ui(h,c),hi(c),c.child.flags&8192&&c.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(qw=dn()),g&4&&(g=c.updateQueue,g!==null&&(c.updateQueue=null,Mw(c,g)));break;case 22:if(g&512&&(Nn||p===null||zr(p,p.return)),q=c.memoizedState!==null,oe=p!==null&&p.memoizedState!==null,$e=ho,Re=Nn,ho=$e||q,Nn=Re||oe,ui(h,c),Nn=Re,ho=$e,hi(c),h=c.stateNode,h._current=c,h._visibility&=-3,h._visibility|=h._pendingVisibility&2,g&8192&&(h._visibility=q?h._visibility&-2:h._visibility|1,q&&(h=ho||Nn,p===null||oe||h||Ph(c)),c.memoizedProps===null||c.memoizedProps.mode!=="manual"))e:for(p=null,h=c;;){if(h.tag===5||h.tag===26||h.tag===27){if(p===null){oe=p=h;try{if(S=oe.stateNode,q)_=S.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{M=oe.stateNode,U=oe.memoizedProps.style;var Ie=U!=null&&U.hasOwnProperty("display")?U.display:null;M.style.display=Ie==null||typeof Ie=="boolean"?"":(""+Ie).trim()}}catch(Xe){on(oe,oe.return,Xe)}}}else if(h.tag===6){if(p===null){oe=h;try{oe.stateNode.nodeValue=q?"":oe.memoizedProps}catch(Xe){on(oe,oe.return,Xe)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===c)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break e;for(;h.sibling===null;){if(h.return===null||h.return===c)break e;p===h&&(p=null),h=h.return}p===h&&(p=null),h.sibling.return=h.return,h=h.sibling}g&4&&(g=c.updateQueue,g!==null&&(p=g.retryQueue,p!==null&&(g.retryQueue=null,Mw(c,p))));break;case 19:ui(h,c),hi(c),g&4&&(g=c.updateQueue,g!==null&&(c.updateQueue=null,Mw(c,g)));break;case 21:break;default:ui(h,c),hi(c)}}function hi(c){var h=c.flags;if(h&2){try{if(c.tag!==27){e:{for(var p=c.return;p!==null;){if(l2(p)){var g=p;break e}p=p.return}throw Error(s(160))}switch(g.tag){case 27:var S=g.stateNode,_=Fw(c);ab(c,_,S);break;case 5:var M=g.stateNode;g.flags&32&&(ti(M,""),g.flags&=-33);var U=Fw(c);ab(c,U,M);break;case 3:case 4:var q=g.stateNode.containerInfo,oe=Fw(c);Lw(c,oe,q);break;default:throw Error(s(161))}}}catch($e){on(c,c.return,$e)}c.flags&=-3}h&4096&&(c.flags&=-4097)}function g2(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var h=c;g2(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),c=c.sibling}}function po(c,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)h2(c,h.alternate,h),h=h.sibling}function Ph(c){for(c=c.child;c!==null;){var h=c;switch(h.tag){case 0:case 11:case 14:case 15:vl(4,h,h.return),Ph(h);break;case 1:zr(h,h.return);var p=h.stateNode;typeof p.componentWillUnmount=="function"&&i2(h,h.return,p),Ph(h);break;case 26:case 27:case 5:zr(h,h.return),Ph(h);break;case 22:zr(h,h.return),h.memoizedState===null&&Ph(h);break;default:Ph(h)}c=c.sibling}}function wl(c,h,p){for(p=p&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var g=h.alternate,S=c,_=h,M=_.flags;switch(_.tag){case 0:case 11:case 15:wl(S,_,p),ap(4,_);break;case 1:if(wl(S,_,p),g=_,S=g.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(oe){on(g,g.return,oe)}if(g=_,S=g.updateQueue,S!==null){var U=g.stateNode;try{var q=S.shared.hiddenCallbacks;if(q!==null)for(S.shared.hiddenCallbacks=null,S=0;S<q.length;S++)n2(q[S],U)}catch(oe){on(g,g.return,oe)}}p&&M&64&&r2(_),tu(_,_.return);break;case 26:case 27:case 5:wl(S,_,p),p&&g===null&&M&4&&a2(_),tu(_,_.return);break;case 12:wl(S,_,p);break;case 13:wl(S,_,p),p&&M&4&&p2(S,_);break;case 22:_.memoizedState===null&&wl(S,_,p),tu(_,_.return);break;default:wl(S,_,p)}h=h.sibling}}function Vw(c,h){var p=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),c=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(c=h.memoizedState.cachePool.pool),c!==p&&(c!=null&&c.refCount++,p!=null&&Yf(p))}function Bw(c,h){c=null,h.alternate!==null&&(c=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==c&&(h.refCount++,c!=null&&Yf(c))}function Sl(c,h,p,g){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)y2(c,h,p,g),h=h.sibling}function y2(c,h,p,g){var S=h.flags;switch(h.tag){case 0:case 11:case 15:Sl(c,h,p,g),S&2048&&ap(9,h);break;case 3:Sl(c,h,p,g),S&2048&&(c=null,h.alternate!==null&&(c=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==c&&(h.refCount++,c!=null&&Yf(c)));break;case 12:if(S&2048){Sl(c,h,p,g),c=h.stateNode;try{var _=h.memoizedProps,M=_.id,U=_.onPostCommit;typeof U=="function"&&U(M,h.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(q){on(h,h.return,q)}}else Sl(c,h,p,g);break;case 23:break;case 22:_=h.stateNode,h.memoizedState!==null?_._visibility&4?Sl(c,h,p,g):op(c,h):_._visibility&4?Sl(c,h,p,g):(_._visibility|=4,Mh(c,h,p,g,(h.subtreeFlags&10256)!==0)),S&2048&&Vw(h.alternate,h);break;case 24:Sl(c,h,p,g),S&2048&&Bw(h.alternate,h);break;default:Sl(c,h,p,g)}}function Mh(c,h,p,g,S){for(S=S&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var _=c,M=h,U=p,q=g,oe=M.flags;switch(M.tag){case 0:case 11:case 15:Mh(_,M,U,q,S),ap(8,M);break;case 23:break;case 22:var $e=M.stateNode;M.memoizedState!==null?$e._visibility&4?Mh(_,M,U,q,S):op(_,M):($e._visibility|=4,Mh(_,M,U,q,S)),S&&oe&2048&&Vw(M.alternate,M);break;case 24:Mh(_,M,U,q,S),S&&oe&2048&&Bw(M.alternate,M);break;default:Mh(_,M,U,q,S)}h=h.sibling}}function op(c,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var p=c,g=h,S=g.flags;switch(g.tag){case 22:op(p,g),S&2048&&Vw(g.alternate,g);break;case 24:op(p,g),S&2048&&Bw(g.alternate,g);break;default:op(p,g)}h=h.sibling}}var lp=8192;function Vh(c){if(c.subtreeFlags&lp)for(c=c.child;c!==null;)b2(c),c=c.sibling}function b2(c){switch(c.tag){case 26:Vh(c),c.flags&lp&&c.memoizedState!==null&&aG(Fi,c.memoizedState,c.memoizedProps);break;case 5:Vh(c);break;case 3:case 4:var h=Fi;Fi=wb(c.stateNode.containerInfo),Vh(c),Fi=h;break;case 22:c.memoizedState===null&&(h=c.alternate,h!==null&&h.memoizedState!==null?(h=lp,lp=16777216,Vh(c),lp=h):Vh(c));break;default:Vh(c)}}function x2(c){var h=c.alternate;if(h!==null&&(c=h.child,c!==null)){h.child=null;do h=c.sibling,c.sibling=null,c=h;while(c!==null)}}function cp(c){var h=c.deletions;if((c.flags&16)!==0){if(h!==null)for(var p=0;p<h.length;p++){var g=h[p];ws=g,w2(g,c)}x2(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)v2(c),c=c.sibling}function v2(c){switch(c.tag){case 0:case 11:case 15:cp(c),c.flags&2048&&vl(9,c,c.return);break;case 3:cp(c);break;case 12:cp(c);break;case 22:var h=c.stateNode;c.memoizedState!==null&&h._visibility&4&&(c.return===null||c.return.tag!==13)?(h._visibility&=-5,ob(c)):cp(c);break;default:cp(c)}}function ob(c){var h=c.deletions;if((c.flags&16)!==0){if(h!==null)for(var p=0;p<h.length;p++){var g=h[p];ws=g,w2(g,c)}x2(c)}for(c=c.child;c!==null;){switch(h=c,h.tag){case 0:case 11:case 15:vl(8,h,h.return),ob(h);break;case 22:p=h.stateNode,p._visibility&4&&(p._visibility&=-5,ob(h));break;default:ob(h)}c=c.sibling}}function w2(c,h){for(;ws!==null;){var p=ws;switch(p.tag){case 0:case 11:case 15:vl(8,p,h);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var g=p.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Yf(p.memoizedState.cache)}if(g=p.child,g!==null)g.return=p,ws=g;else e:for(p=c;ws!==null;){g=ws;var S=g.sibling,_=g.return;if(d2(g),g===p){ws=null;break e}if(S!==null){S.return=_,ws=S;break e}ws=_}}}function xW(c,h,p,g){this.tag=c,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(c,h,p,g){return new xW(c,h,p,g)}function zw(c){return c=c.prototype,!(!c||!c.isReactComponent)}function Tl(c,h){var p=c.alternate;return p===null?(p=di(c.tag,h,c.key,c.mode),p.elementType=c.elementType,p.type=c.type,p.stateNode=c.stateNode,p.alternate=c,c.alternate=p):(p.pendingProps=h,p.type=c.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=c.flags&31457280,p.childLanes=c.childLanes,p.lanes=c.lanes,p.child=c.child,p.memoizedProps=c.memoizedProps,p.memoizedState=c.memoizedState,p.updateQueue=c.updateQueue,h=c.dependencies,p.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},p.sibling=c.sibling,p.index=c.index,p.ref=c.ref,p.refCleanup=c.refCleanup,p}function S2(c,h){c.flags&=31457282;var p=c.alternate;return p===null?(c.childLanes=0,c.lanes=h,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=p.childLanes,c.lanes=p.lanes,c.child=p.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=p.memoizedProps,c.memoizedState=p.memoizedState,c.updateQueue=p.updateQueue,c.type=p.type,h=p.dependencies,c.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),c}function lb(c,h,p,g,S,_){var M=0;if(g=c,typeof c=="function")zw(c)&&(M=1);else if(typeof c=="string")M=rG(c,p,Qe.current)?26:c==="html"||c==="head"||c==="body"?27:5;else e:switch(c){case l:return nu(p.children,S,_,h);case u:M=8,S|=24;break;case d:return c=di(12,p,h,S|2),c.elementType=d,c.lanes=_,c;case w:return c=di(13,p,h,S),c.elementType=w,c.lanes=_,c;case x:return c=di(19,p,h,S),c.elementType=x,c.lanes=_,c;case $:return T2(p,S,_,h);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case f:case y:M=10;break e;case m:M=9;break e;case b:M=11;break e;case T:M=14;break e;case E:M=16,g=null;break e}M=29,p=Error(s(130,c===null?"null":typeof c,"")),g=null}return h=di(M,p,h,S),h.elementType=c,h.type=g,h.lanes=_,h}function nu(c,h,p,g){return c=di(7,c,g,h),c.lanes=p,c}function T2(c,h,p,g){c=di(22,c,g,h),c.elementType=$,c.lanes=p;var S={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var _=S._current;if(_===null)throw Error(s(456));if((S._pendingVisibility&2)===0){var M=hl(_,2);M!==null&&(S._pendingVisibility|=2,gr(M,_,2))}},attach:function(){var _=S._current;if(_===null)throw Error(s(456));if((S._pendingVisibility&2)!==0){var M=hl(_,2);M!==null&&(S._pendingVisibility&=-3,gr(M,_,2))}}};return c.stateNode=S,c}function Uw(c,h,p){return c=di(6,c,null,h),c.lanes=p,c}function jw(c,h,p){return h=di(4,c.children!==null?c.children:[],c.key,h),h.lanes=p,h.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},h}function mo(c){c.flags|=4}function E2(c,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)c.flags&=-16777217;else if(c.flags|=16777216,!lA(h)){if(h=ci.current,h!==null&&((At&4194176)===At?ga!==null:(At&62914560)!==At&&(At&536870912)===0||h!==ga))throw qf=K1,zN;c.flags|=8192}}function cb(c,h){h!==null&&(c.flags|=4),c.flags&16384&&(h=c.tag!==22?Jo():536870912,c.lanes|=h,zh|=h)}function up(c,h){if(!zt)switch(c.tailMode){case"hidden":h=c.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?c.tail=null:p.sibling=null;break;case"collapsed":p=c.tail;for(var g=null;p!==null;)p.alternate!==null&&(g=p),p=p.sibling;g===null?h||c.tail===null?c.tail=null:c.tail.sibling=null:g.sibling=null}}function En(c){var h=c.alternate!==null&&c.alternate.child===c.child,p=0,g=0;if(h)for(var S=c.child;S!==null;)p|=S.lanes|S.childLanes,g|=S.subtreeFlags&31457280,g|=S.flags&31457280,S.return=c,S=S.sibling;else for(S=c.child;S!==null;)p|=S.lanes|S.childLanes,g|=S.subtreeFlags,g|=S.flags,S.return=c,S=S.sibling;return c.subtreeFlags|=g,c.childLanes=p,h}function vW(c,h,p){var g=h.pendingProps;switch(H1(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return En(h),null;case 1:return En(h),null;case 3:return p=h.stateNode,g=null,c!==null&&(g=c.memoizedState.cache),h.memoizedState.cache!==g&&(h.flags|=2048),uo(os),bt(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(c===null||c.child===null)&&(jf(h)?mo(h):c===null||c.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Oi!==null&&(Qw(Oi),Oi=null))),En(h),null;case 26:return p=h.memoizedState,c===null?(mo(h),p!==null?(En(h),E2(h,p)):(En(h),h.flags&=-16777217)):p?p!==c.memoizedState?(mo(h),En(h),E2(h,p)):(En(h),h.flags&=-16777217):(c.memoizedProps!==g&&mo(h),En(h),h.flags&=-16777217),null;case 27:Vt(h),p=pt.current;var S=h.type;if(c!==null&&h.stateNode!=null)c.memoizedProps!==g&&mo(h);else{if(!g){if(h.stateNode===null)throw Error(s(166));return En(h),null}c=Qe.current,jf(h)?VN(h):(c=eA(S,g,p),h.stateNode=c,mo(h))}return En(h),null;case 5:if(Vt(h),p=h.type,c!==null&&h.stateNode!=null)c.memoizedProps!==g&&mo(h);else{if(!g){if(h.stateNode===null)throw Error(s(166));return En(h),null}if(c=Qe.current,jf(h))VN(h);else{switch(S=vb(pt.current),c){case 1:c=S.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:c=S.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":c=S.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":c=S.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":c=S.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild);break;case"select":c=typeof g.is=="string"?S.createElement("select",{is:g.is}):S.createElement("select"),g.multiple?c.multiple=!0:g.size&&(c.size=g.size);break;default:c=typeof g.is=="string"?S.createElement(p,{is:g.is}):S.createElement(p)}}c[ys]=h,c[ss]=g;e:for(S=h.child;S!==null;){if(S.tag===5||S.tag===6)c.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===h)break e;for(;S.sibling===null;){if(S.return===null||S.return===h)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}h.stateNode=c;e:switch(Fs(c,p,g),p){case"button":case"input":case"select":case"textarea":c=!!g.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&mo(h)}}return En(h),h.flags&=-16777217,null;case 6:if(c&&h.stateNode!=null)c.memoizedProps!==g&&mo(h);else{if(typeof g!="string"&&h.stateNode===null)throw Error(s(166));if(c=pt.current,jf(h)){if(c=h.stateNode,p=h.memoizedProps,g=null,S=mr,S!==null)switch(S.tag){case 27:case 5:g=S.memoizedProps}c[ys]=h,c=!!(c.nodeValue===p||g!==null&&g.suppressHydrationWarning===!0||K2(c.nodeValue,p)),c||Hc(h)}else c=vb(c).createTextNode(g),c[ys]=h,h.stateNode=c}return En(h),null;case 13:if(g=h.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(S=jf(h),g!==null&&g.dehydrated!==null){if(c===null){if(!S)throw Error(s(318));if(S=h.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(s(317));S[ys]=h}else Wf(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;En(h),S=!1}else Oi!==null&&(Qw(Oi),Oi=null),S=!0;if(!S)return h.flags&256?(ao(h),h):(ao(h),null)}if(ao(h),(h.flags&128)!==0)return h.lanes=p,h;if(p=g!==null,c=c!==null&&c.memoizedState!==null,p){g=h.child,S=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(S=g.alternate.memoizedState.cachePool.pool);var _=null;g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(_=g.memoizedState.cachePool.pool),_!==S&&(g.flags|=2048)}return p!==c&&p&&(h.child.flags|=8192),cb(h,h.updateQueue),En(h),null;case 4:return bt(),c===null&&lS(h.stateNode.containerInfo),En(h),null;case 10:return uo(h.type),En(h),null;case 19:if(Be(as),S=h.memoizedState,S===null)return En(h),null;if(g=(h.flags&128)!==0,_=S.rendering,_===null)if(g)up(S,!1);else{if(kn!==0||c!==null&&(c.flags&128)!==0)for(c=h.child;c!==null;){if(_=Hy(c),_!==null){for(h.flags|=128,up(S,!1),c=_.updateQueue,h.updateQueue=c,cb(h,c),h.subtreeFlags=0,c=p,p=h.child;p!==null;)S2(p,c),p=p.sibling;return je(as,as.current&1|2),h.child}c=c.sibling}S.tail!==null&&dn()>ub&&(h.flags|=128,g=!0,up(S,!1),h.lanes=4194304)}else{if(!g)if(c=Hy(_),c!==null){if(h.flags|=128,g=!0,c=c.updateQueue,h.updateQueue=c,cb(h,c),up(S,!0),S.tail===null&&S.tailMode==="hidden"&&!_.alternate&&!zt)return En(h),null}else 2*dn()-S.renderingStartTime>ub&&p!==536870912&&(h.flags|=128,g=!0,up(S,!1),h.lanes=4194304);S.isBackwards?(_.sibling=h.child,h.child=_):(c=S.last,c!==null?c.sibling=_:h.child=_,S.last=_)}return S.tail!==null?(h=S.tail,S.rendering=h,S.tail=h.sibling,S.renderingStartTime=dn(),h.sibling=null,c=as.current,je(as,g?c&1|2:c&1),h):(En(h),null);case 22:case 23:return ao(h),Y1(),g=h.memoizedState!==null,c!==null?c.memoizedState!==null!==g&&(h.flags|=8192):g&&(h.flags|=8192),g?(p&536870912)!==0&&(h.flags&128)===0&&(En(h),h.subtreeFlags&6&&(h.flags|=8192)):En(h),p=h.updateQueue,p!==null&&cb(h,p.retryQueue),p=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),g=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(g=h.memoizedState.cachePool.pool),g!==p&&(h.flags|=2048),c!==null&&Be(Kc),null;case 24:return p=null,c!==null&&(p=c.memoizedState.cache),h.memoizedState.cache!==p&&(h.flags|=2048),uo(os),En(h),null;case 25:return null}throw Error(s(156,h.tag))}function wW(c,h){switch(H1(h),h.tag){case 1:return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 3:return uo(os),bt(),c=h.flags,(c&65536)!==0&&(c&128)===0?(h.flags=c&-65537|128,h):null;case 26:case 27:case 5:return Vt(h),null;case 13:if(ao(h),c=h.memoizedState,c!==null&&c.dehydrated!==null){if(h.alternate===null)throw Error(s(340));Wf()}return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 19:return Be(as),null;case 4:return bt(),null;case 10:return uo(h.type),null;case 22:case 23:return ao(h),Y1(),c!==null&&Be(Kc),c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 24:return uo(os),null;case 25:return null;default:return null}}function _2(c,h){switch(H1(h),h.tag){case 3:uo(os),bt();break;case 26:case 27:case 5:Vt(h);break;case 4:bt();break;case 13:ao(h);break;case 19:Be(as);break;case 10:uo(h.type);break;case 22:case 23:ao(h),Y1(),c!==null&&Be(Kc);break;case 24:uo(os)}}var SW={getCacheForType:function(c){var h=Ks(os),p=h.data.get(c);return p===void 0&&(p=c(),h.data.set(c,p)),p}},TW=typeof WeakMap=="function"?WeakMap:Map,_n=0,fn=null,St=null,At=0,pn=0,jr=null,go=!1,Bh=!1,Ww=!1,yo=0,kn=0,El=0,su=0,Gw=0,fi=0,zh=0,hp=null,ba=null,Hw=!1,qw=0,ub=1/0,hb=null,_l=null,db=!1,ru=null,dp=0,Kw=0,Xw=null,fp=0,Yw=null;function Wr(){if((_n&2)!==0&&At!==0)return At&-At;if(N.T!==null){var c=Rh;return c!==0?c:rS()}return by()}function I2(){fi===0&&(fi=(At&536870912)===0||zt?_f():536870912);var c=ci.current;return c!==null&&(c.flags|=32),fi}function gr(c,h,p){(c===fn&&pn===2||c.cancelPendingCommit!==null)&&(Uh(c,0),bo(c,At,fi,!1)),Vn(c,p),((_n&2)===0||c!==fn)&&(c===fn&&((_n&2)===0&&(su|=p),kn===4&&bo(c,At,fi,!1)),xa(c))}function $2(c,h,p){if((_n&6)!==0)throw Error(s(327));var g=!p&&(h&60)===0&&(h&c.expiredLanes)===0||Zo(c,h),S=g?IW(c,h):eS(c,h,!0),_=g;do{if(S===0){Bh&&!g&&bo(c,h,0,!1);break}else if(S===6)bo(c,h,0,!go);else{if(p=c.current.alternate,_&&!EW(p)){S=eS(c,h,!1),_=!1;continue}if(S===2){if(_=h,c.errorRecoveryDisabledLanes&_)var M=0;else M=c.pendingLanes&-536870913,M=M!==0?M:M&536870912?536870912:0;if(M!==0){h=M;e:{var U=c;S=hp;var q=U.current.memoizedState.isDehydrated;if(q&&(Uh(U,M).flags|=256),M=eS(U,M,!1),M!==2){if(Ww&&!q){U.errorRecoveryDisabledLanes|=_,su|=_,S=4;break e}_=ba,ba=S,_!==null&&Qw(_)}S=M}if(_=!1,S!==2)continue}}if(S===1){Uh(c,0),bo(c,h,0,!0);break}e:{switch(g=c,S){case 0:case 1:throw Error(s(345));case 4:if((h&4194176)===h){bo(g,h,fi,!go);break e}break;case 2:ba=null;break;case 3:case 5:break;default:throw Error(s(329))}if(g.finishedWork=p,g.finishedLanes=h,(h&62914560)===h&&(_=qw+300-dn(),10<_)){if(bo(g,h,fi,!go),Jr(g,0)!==0)break e;g.timeoutHandle=Q2(C2.bind(null,g,p,ba,hb,Hw,h,fi,su,zh,go,2,-0,0),_);break e}C2(g,p,ba,hb,Hw,h,fi,su,zh,go,0,-0,0)}}break}while(!0);xa(c)}function Qw(c){ba===null?ba=c:ba.push.apply(ba,c)}function C2(c,h,p,g,S,_,M,U,q,oe,$e,Re,ve){var Ie=h.subtreeFlags;if((Ie&8192||(Ie&16785408)===16785408)&&(xp={stylesheets:null,count:0,unsuspend:iG},b2(h),h=oG(),h!==null)){c.cancelPendingCommit=h(F2.bind(null,c,p,g,S,M,U,q,1,Re,ve)),bo(c,_,M,!oe);return}F2(c,p,g,S,M,U,q,$e,Re,ve)}function EW(c){for(var h=c;;){var p=h.tag;if((p===0||p===11||p===15)&&h.flags&16384&&(p=h.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var g=0;g<p.length;g++){var S=p[g],_=S.getSnapshot;S=S.value;try{if(!Br(_(),S))return!1}catch{return!1}}if(p=h.child,h.subtreeFlags&16384&&p!==null)p.return=h,h=p;else{if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function bo(c,h,p,g){h&=~Gw,h&=~su,c.suspendedLanes|=h,c.pingedLanes&=~h,g&&(c.warmLanes|=h),g=c.expirationTimes;for(var S=h;0<S;){var _=31-dr(S),M=1<<_;g[_]=-1,S&=~M}p!==0&&el(c,p,h)}function fb(){return(_n&6)===0?(pp(0),!1):!0}function Zw(){if(St!==null){if(pn===0)var c=St.return;else c=St,co=Jc=null,rw(c),kh=null,Kf=0,c=St;for(;c!==null;)_2(c.alternate,c),c=c.return;St=null}}function Uh(c,h){c.finishedWork=null,c.finishedLanes=0;var p=c.timeoutHandle;p!==-1&&(c.timeoutHandle=-1,jW(p)),p=c.cancelPendingCommit,p!==null&&(c.cancelPendingCommit=null,p()),Zw(),fn=c,St=p=Tl(c.current,null),At=h,pn=0,jr=null,go=!1,Bh=Zo(c,h),Ww=!1,zh=fi=Gw=su=El=kn=0,ba=hp=null,Hw=!1,(h&8)!==0&&(h|=h&32);var g=c.entangledLanes;if(g!==0)for(c=c.entanglements,g&=h;0<g;){var S=31-dr(g),_=1<<S;h|=c[S],g&=~_}return yo=h,Py(),p}function N2(c,h){xt=null,N.H=ya,h===Hf?(h=WN(),pn=3):h===zN?(h=WN(),pn=4):pn=h===Uk?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,jr=h,St===null&&(kn=1,sb(c,ai(h,c.current)))}function k2(){var c=N.H;return N.H=ya,c===null?ya:c}function A2(){var c=N.A;return N.A=SW,c}function Jw(){kn=4,go||(At&4194176)!==At&&ci.current!==null||(Bh=!0),(El&134217727)===0&&(su&134217727)===0||fn===null||bo(fn,At,fi,!1)}function eS(c,h,p){var g=_n;_n|=2;var S=k2(),_=A2();(fn!==c||At!==h)&&(hb=null,Uh(c,h)),h=!1;var M=kn;e:do try{if(pn!==0&&St!==null){var U=St,q=jr;switch(pn){case 8:Zw(),M=6;break e;case 3:case 2:case 6:ci.current===null&&(h=!0);var oe=pn;if(pn=0,jr=null,jh(c,U,q,oe),p&&Bh){M=0;break e}break;default:oe=pn,pn=0,jr=null,jh(c,U,q,oe)}}_W(),M=kn;break}catch($e){N2(c,$e)}while(!0);return h&&c.shellSuspendCounter++,co=Jc=null,_n=g,N.H=S,N.A=_,St===null&&(fn=null,At=0,Py()),M}function _W(){for(;St!==null;)R2(St)}function IW(c,h){var p=_n;_n|=2;var g=k2(),S=A2();fn!==c||At!==h?(hb=null,ub=dn()+500,Uh(c,h)):Bh=Zo(c,h);e:do try{if(pn!==0&&St!==null){h=St;var _=jr;t:switch(pn){case 1:pn=0,jr=null,jh(c,h,_,1);break;case 2:if(UN(_)){pn=0,jr=null,D2(h);break}h=function(){pn===2&&fn===c&&(pn=7),xa(c)},_.then(h,h);break e;case 3:pn=7;break e;case 4:pn=5;break e;case 7:UN(_)?(pn=0,jr=null,D2(h)):(pn=0,jr=null,jh(c,h,_,7));break;case 5:var M=null;switch(St.tag){case 26:M=St.memoizedState;case 5:case 27:var U=St;if(!M||lA(M)){pn=0,jr=null;var q=U.sibling;if(q!==null)St=q;else{var oe=U.return;oe!==null?(St=oe,pb(oe)):St=null}break t}}pn=0,jr=null,jh(c,h,_,5);break;case 6:pn=0,jr=null,jh(c,h,_,6);break;case 8:Zw(),kn=6;break e;default:throw Error(s(462))}}$W();break}catch($e){N2(c,$e)}while(!0);return co=Jc=null,N.H=g,N.A=S,_n=p,St!==null?0:(fn=null,At=0,Py(),kn)}function $W(){for(;St!==null&&!As();)R2(St)}function R2(c){var h=e2(c.alternate,c,yo);c.memoizedProps=c.pendingProps,h===null?pb(c):St=h}function D2(c){var h=c,p=h.alternate;switch(h.tag){case 15:case 0:h=Kk(p,h,h.pendingProps,h.type,void 0,At);break;case 11:h=Kk(p,h,h.pendingProps,h.type.render,h.ref,At);break;case 5:rw(h);default:_2(p,h),h=St=S2(h,yo),h=e2(p,h,yo)}c.memoizedProps=c.pendingProps,h===null?pb(c):St=h}function jh(c,h,p,g){co=Jc=null,rw(h),kh=null,Kf=0;var S=h.return;try{if(mW(c,S,h,p,At)){kn=1,sb(c,ai(p,c.current)),St=null;return}}catch(_){if(S!==null)throw St=S,_;kn=1,sb(c,ai(p,c.current)),St=null;return}h.flags&32768?(zt||g===1?c=!0:Bh||(At&536870912)!==0?c=!1:(go=c=!0,(g===2||g===3||g===6)&&(g=ci.current,g!==null&&g.tag===13&&(g.flags|=16384))),O2(h,c)):pb(h)}function pb(c){var h=c;do{if((h.flags&32768)!==0){O2(h,go);return}c=h.return;var p=vW(h.alternate,h,yo);if(p!==null){St=p;return}if(h=h.sibling,h!==null){St=h;return}St=h=c}while(h!==null);kn===0&&(kn=5)}function O2(c,h){do{var p=wW(c.alternate,c);if(p!==null){p.flags&=32767,St=p;return}if(p=c.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!h&&(c=c.sibling,c!==null)){St=c;return}St=c=p}while(c!==null);kn=6,St=null}function F2(c,h,p,g,S,_,M,U,q,oe){var $e=N.T,Re=be.p;try{be.p=2,N.T=null,CW(c,h,p,g,Re,S,_,M,U,q,oe)}finally{N.T=$e,be.p=Re}}function CW(c,h,p,g,S,_,M,U){do Wh();while(ru!==null);if((_n&6)!==0)throw Error(s(327));var q=c.finishedWork;if(g=c.finishedLanes,q===null)return null;if(c.finishedWork=null,c.finishedLanes=0,q===c.current)throw Error(s(177));c.callbackNode=null,c.callbackPriority=0,c.cancelPendingCommit=null;var oe=q.lanes|q.childLanes;if(oe|=j1,gy(c,g,oe,_,M,U),c===fn&&(St=fn=null,At=0),(q.subtreeFlags&10256)===0&&(q.flags&10256)===0||db||(db=!0,Kw=oe,Xw=p,RW(ms,function(){return Wh(),null})),p=(q.flags&15990)!==0,(q.subtreeFlags&15990)!==0||p?(p=N.T,N.T=null,_=be.p,be.p=2,M=_n,_n|=4,yW(c,q),m2(q,c),Zj(dS,c.containerInfo),Ib=!!hS,dS=hS=null,c.current=q,h2(c,q.alternate,q),Lr(),_n=M,be.p=_,N.T=p):c.current=q,db?(db=!1,ru=c,dp=g):L2(c,oe),oe=c.pendingLanes,oe===0&&(_l=null),Nc(q.stateNode),xa(c),h!==null)for(S=c.onRecoverableError,q=0;q<h.length;q++)oe=h[q],S(oe.value,{componentStack:oe.stack});return(dp&3)!==0&&Wh(),oe=c.pendingLanes,(g&4194218)!==0&&(oe&42)!==0?c===Yw?fp++:(fp=0,Yw=c):fp=0,pp(0),null}function L2(c,h){(c.pooledCacheLanes&=h)===0&&(h=c.pooledCache,h!=null&&(c.pooledCache=null,Yf(h)))}function Wh(){if(ru!==null){var c=ru,h=Kw;Kw=0;var p=yy(dp),g=N.T,S=be.p;try{if(be.p=32>p?32:p,N.T=null,ru===null)var _=!1;else{p=Xw,Xw=null;var M=ru,U=dp;if(ru=null,dp=0,(_n&6)!==0)throw Error(s(331));var q=_n;if(_n|=4,v2(M.current),y2(M,M.current,U,p),_n=q,pp(0,!1),gs&&typeof gs.onPostCommitFiberRoot=="function")try{gs.onPostCommitFiberRoot(Pr,M)}catch{}_=!0}return _}finally{be.p=S,N.T=g,L2(c,h)}}return!1}function P2(c,h,p){h=ai(p,h),h=bw(c.stateNode,h,2),c=xl(c,h,2),c!==null&&(Vn(c,2),xa(c))}function on(c,h,p){if(c.tag===3)P2(c,c,p);else for(;h!==null;){if(h.tag===3){P2(h,c,p);break}else if(h.tag===1){var g=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(_l===null||!_l.has(g))){c=ai(p,c),p=Bk(2),g=xl(h,p,2),g!==null&&(zk(p,g,h,c),Vn(g,2),xa(g));break}}h=h.return}}function tS(c,h,p){var g=c.pingCache;if(g===null){g=c.pingCache=new TW;var S=new Set;g.set(h,S)}else S=g.get(h),S===void 0&&(S=new Set,g.set(h,S));S.has(p)||(Ww=!0,S.add(p),c=NW.bind(null,c,h,p),h.then(c,c))}function NW(c,h,p){var g=c.pingCache;g!==null&&g.delete(h),c.pingedLanes|=c.suspendedLanes&p,c.warmLanes&=~p,fn===c&&(At&p)===p&&(kn===4||kn===3&&(At&62914560)===At&&300>dn()-qw?(_n&2)===0&&Uh(c,0):Gw|=p,zh===At&&(zh=0)),xa(c)}function M2(c,h){h===0&&(h=Jo()),c=hl(c,h),c!==null&&(Vn(c,h),xa(c))}function kW(c){var h=c.memoizedState,p=0;h!==null&&(p=h.retryLane),M2(c,p)}function AW(c,h){var p=0;switch(c.tag){case 13:var g=c.stateNode,S=c.memoizedState;S!==null&&(p=S.retryLane);break;case 19:g=c.stateNode;break;case 22:g=c.stateNode._retryCache;break;default:throw Error(s(314))}g!==null&&g.delete(h),M2(c,p)}function RW(c,h){return hn(c,h)}var mb=null,Gh=null,nS=!1,gb=!1,sS=!1,iu=0;function xa(c){c!==Gh&&c.next===null&&(Gh===null?mb=Gh=c:Gh=Gh.next=c),gb=!0,nS||(nS=!0,OW(DW))}function pp(c,h){if(!sS&&gb){sS=!0;do for(var p=!1,g=mb;g!==null;){if(c!==0){var S=g.pendingLanes;if(S===0)var _=0;else{var M=g.suspendedLanes,U=g.pingedLanes;_=(1<<31-dr(42|c)+1)-1,_&=S&~(M&~U),_=_&201326677?_&201326677|1:_?_|2:0}_!==0&&(p=!0,z2(g,_))}else _=At,_=Jr(g,g===fn?_:0),(_&3)===0||Zo(g,_)||(p=!0,z2(g,_));g=g.next}while(p);sS=!1}}function DW(){gb=nS=!1;var c=0;iu!==0&&(UW()&&(c=iu),iu=0);for(var h=dn(),p=null,g=mb;g!==null;){var S=g.next,_=V2(g,h);_===0?(g.next=null,p===null?mb=S:p.next=S,S===null&&(Gh=p)):(p=g,(c!==0||(_&3)!==0)&&(gb=!0)),g=S}pp(c)}function V2(c,h){for(var p=c.suspendedLanes,g=c.pingedLanes,S=c.expirationTimes,_=c.pendingLanes&-62914561;0<_;){var M=31-dr(_),U=1<<M,q=S[M];q===-1?((U&p)===0||(U&g)!==0)&&(S[M]=ch(U,h)):q<=h&&(c.expiredLanes|=U),_&=~U}if(h=fn,p=At,p=Jr(c,c===h?p:0),g=c.callbackNode,p===0||c===h&&pn===2||c.cancelPendingCommit!==null)return g!==null&&g!==null&&hr(g),c.callbackNode=null,c.callbackPriority=0;if((p&3)===0||Zo(c,p)){if(h=p&-p,h===c.callbackPriority)return h;switch(g!==null&&hr(g),yy(p)){case 2:case 8:p=an;break;case 32:p=ms;break;case 268435456:p=qa;break;default:p=ms}return g=B2.bind(null,c),p=hn(p,g),c.callbackPriority=h,c.callbackNode=p,h}return g!==null&&g!==null&&hr(g),c.callbackPriority=2,c.callbackNode=null,2}function B2(c,h){var p=c.callbackNode;if(Wh()&&c.callbackNode!==p)return null;var g=At;return g=Jr(c,c===fn?g:0),g===0?null:($2(c,g,h),V2(c,dn()),c.callbackNode!=null&&c.callbackNode===p?B2.bind(null,c):null)}function z2(c,h){if(Wh())return null;$2(c,h,!0)}function OW(c){WW(function(){(_n&6)!==0?hn(en,c):c()})}function rS(){return iu===0&&(iu=_f()),iu}function U2(c){return c==null||typeof c=="symbol"||typeof c=="boolean"?null:typeof c=="function"?c:la(""+c)}function j2(c,h){var p=h.ownerDocument.createElement("input");return p.name=h.name,p.value=h.value,c.id&&p.setAttribute("form",c.id),h.parentNode.insertBefore(p,h),c=new FormData(c),p.parentNode.removeChild(p),c}function FW(c,h,p,g,S){if(h==="submit"&&p&&p.stateNode===S){var _=U2((S[ss]||null).action),M=g.submitter;M&&(h=(h=M[ss]||null)?U2(h.formAction):M.getAttribute("formAction"),h!==null&&(_=h,M=null));var U=new gh("action","action",null,g,S);c.push({event:U,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(iu!==0){var q=M?j2(S,M):new FormData(S);fw(p,{pending:!0,data:q,method:S.method,action:_},null,q)}}else typeof _=="function"&&(U.preventDefault(),q=M?j2(S,M):new FormData(S),fw(p,{pending:!0,data:q,method:S.method,action:_},_,q))},currentTarget:S}]})}}for(var iS=0;iS<FN.length;iS++){var aS=FN[iS],LW=aS.toLowerCase(),PW=aS[0].toUpperCase()+aS.slice(1);Di(LW,"on"+PW)}Di(kN,"onAnimationEnd"),Di(AN,"onAnimationIteration"),Di(RN,"onAnimationStart"),Di("dblclick","onDoubleClick"),Di("focusin","onFocus"),Di("focusout","onBlur"),Di(eW,"onTransitionRun"),Di(tW,"onTransitionStart"),Di(nW,"onTransitionCancel"),Di(DN,"onTransitionEnd"),Ir("onMouseEnter",["mouseout","mouseover"]),Ir("onMouseLeave",["mouseout","mouseover"]),Ir("onPointerEnter",["pointerout","pointerover"]),Ir("onPointerLeave",["pointerout","pointerover"]),Mr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Mr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Mr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Mr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Mr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Mr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MW=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(mp));function W2(c,h){h=(h&4)!==0;for(var p=0;p<c.length;p++){var g=c[p],S=g.event;g=g.listeners;e:{var _=void 0;if(h)for(var M=g.length-1;0<=M;M--){var U=g[M],q=U.instance,oe=U.currentTarget;if(U=U.listener,q!==_&&S.isPropagationStopped())break e;_=U,S.currentTarget=oe;try{_(S)}catch($e){nb($e)}S.currentTarget=null,_=q}else for(M=0;M<g.length;M++){if(U=g[M],q=U.instance,oe=U.currentTarget,U=U.listener,q!==_&&S.isPropagationStopped())break e;_=U,S.currentTarget=oe;try{_(S)}catch($e){nb($e)}S.currentTarget=null,_=q}}}}function Et(c,h){var p=h[kc];p===void 0&&(p=h[kc]=new Set);var g=c+"__bubble";p.has(g)||(G2(h,c,2,!1),p.add(g))}function oS(c,h,p){var g=0;h&&(g|=4),G2(p,c,g,h)}var yb="_reactListening"+Math.random().toString(36).slice(2);function lS(c){if(!c[yb]){c[yb]=!0,$f.forEach(function(p){p!=="selectionchange"&&(MW.has(p)||oS(p,!1,c),oS(p,!0,c))});var h=c.nodeType===9?c:c.ownerDocument;h===null||h[yb]||(h[yb]=!0,oS("selectionchange",!1,h))}}function G2(c,h,p,g){switch(pA(h)){case 2:var S=uG;break;case 8:S=hG;break;default:S=wS}p=S.bind(null,h,p,c),S=void 0,!si||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(S=!0),g?S!==void 0?c.addEventListener(h,p,{capture:!0,passive:S}):c.addEventListener(h,p,!0):S!==void 0?c.addEventListener(h,p,{passive:S}):c.addEventListener(h,p,!1)}function cS(c,h,p,g,S){var _=g;if((h&1)===0&&(h&2)===0&&g!==null)e:for(;;){if(g===null)return;var M=g.tag;if(M===3||M===4){var U=g.stateNode.containerInfo;if(U===S||U.nodeType===8&&U.parentNode===S)break;if(M===4)for(M=g.return;M!==null;){var q=M.tag;if((q===3||q===4)&&(q=M.stateNode.containerInfo,q===S||q.nodeType===8&&q.parentNode===S))return;M=M.return}for(;U!==null;){if(M=Ri(U),M===null)return;if(q=M.tag,q===5||q===6||q===26||q===27){g=_=M;continue e}U=U.parentNode}}g=g.return}Sy(function(){var oe=_,$e=mh(p),Re=[];e:{var ve=ON.get(c);if(ve!==void 0){var Ie=gh,Xe=c;switch(c){case"keypress":if(ua(p)===0)break e;case"keydown":case"keyup":Ie=Sh;break;case"focusin":Xe="focus",Ie=xh;break;case"focusout":Xe="blur",Ie=xh;break;case"beforeblur":case"afterblur":Ie=xh;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ie=ri;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ie=F1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ie=ky;break;case kN:case AN:case RN:Ie=vh;break;case DN:Ie=Ry;break;case"scroll":case"scrollend":Ie=Ty;break;case"wheel":Ie=Th;break;case"copy":case"cut":case"paste":Ie=wh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ie=Vf;break;case"toggle":case"beforetoggle":Ie=Oy}var at=(h&4)!==0,An=!at&&(c==="scroll"||c==="scrollend"),fe=at?ve!==null?ve+"Capture":null:ve;at=[];for(var ae=oe,ye;ae!==null;){var ke=ae;if(ye=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||ye===null||fe===null||(ke=Fc(ae,fe),ke!=null&&at.push(gp(ae,ke,ye))),An)break;ae=ae.return}0<at.length&&(ve=new Ie(ve,Xe,null,p,$e),Re.push({event:ve,listeners:at}))}}if((h&7)===0){e:{if(ve=c==="mouseover"||c==="pointerover",Ie=c==="mouseout"||c==="pointerout",ve&&p!==ni&&(Xe=p.relatedTarget||p.fromElement)&&(Ri(Xe)||Xe[Xa]))break e;if((Ie||ve)&&(ve=$e.window===$e?$e:(ve=$e.ownerDocument)?ve.defaultView||ve.parentWindow:window,Ie?(Xe=p.relatedTarget||p.toElement,Ie=oe,Xe=Xe?Ri(Xe):null,Xe!==null&&(An=Z(Xe),at=Xe.tag,Xe!==An||at!==5&&at!==27&&at!==6)&&(Xe=null)):(Ie=null,Xe=oe),Ie!==Xe)){if(at=ri,ke="onMouseLeave",fe="onMouseEnter",ae="mouse",(c==="pointerout"||c==="pointerover")&&(at=Vf,ke="onPointerLeave",fe="onPointerEnter",ae="pointer"),An=Ie==null?ve:rl(Ie),ye=Xe==null?ve:rl(Xe),ve=new at(ke,ae+"leave",Ie,p,$e),ve.target=An,ve.relatedTarget=ye,ke=null,Ri($e)===oe&&(at=new at(fe,ae+"enter",Xe,p,$e),at.target=ye,at.relatedTarget=An,ke=at),An=ke,Ie&&Xe)t:{for(at=Ie,fe=Xe,ae=0,ye=at;ye;ye=Hh(ye))ae++;for(ye=0,ke=fe;ke;ke=Hh(ke))ye++;for(;0<ae-ye;)at=Hh(at),ae--;for(;0<ye-ae;)fe=Hh(fe),ye--;for(;ae--;){if(at===fe||fe!==null&&at===fe.alternate)break t;at=Hh(at),fe=Hh(fe)}at=null}else at=null;Ie!==null&&H2(Re,ve,Ie,at,!1),Xe!==null&&An!==null&&H2(Re,An,Xe,at,!0)}}e:{if(ve=oe?rl(oe):window,Ie=ve.nodeName&&ve.nodeName.toLowerCase(),Ie==="select"||Ie==="input"&&ve.type==="file")var Ge=xN;else if(is(ve))if(vN)Ge=Yj;else{Ge=Kj;var wt=qj}else Ie=ve.nodeName,!Ie||Ie.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?oe&&Rf(oe.elementType)&&(Ge=xN):Ge=Xj;if(Ge&&(Ge=Ge(c,oe))){so(Re,Ge,p,$e);break e}wt&&wt(c,ve,oe),c==="focusout"&&oe&&ve.type==="number"&&oe.memoizedProps.value!=null&&ph(ve,"number",ve.value)}switch(wt=oe?rl(oe):window,c){case"focusin":(is(wt)||wt.contentEditable==="true")&&(Eh=wt,B1=oe,Uf=null);break;case"focusout":Uf=B1=Eh=null;break;case"mousedown":z1=!0;break;case"contextmenu":case"mouseup":case"dragend":z1=!1,CN(Re,p,$e);break;case"selectionchange":if(Jj)break;case"keydown":case"keyup":CN(Re,p,$e)}var et;if(fa)e:{switch(c){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else Nt?Te(c,p)&&(nt="onCompositionEnd"):c==="keydown"&&p.keyCode===229&&(nt="onCompositionStart");nt&&(P&&p.locale!=="ko"&&(Nt||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&Nt&&(et=Of()):(ca=$e,ul="value"in ca?ca.value:ca.textContent,Nt=!0)),wt=bb(oe,nt),0<wt.length&&(nt=new Pf(nt,c,null,p,$e),Re.push({event:nt,listeners:wt}),et?nt.data=et:(et=Pe(p),et!==null&&(nt.data=et)))),(et=A?rs(c,p):kt(c,p))&&(nt=bb(oe,"onBeforeInput"),0<nt.length&&(wt=new Pf("onBeforeInput","beforeinput",null,p,$e),Re.push({event:wt,listeners:nt}),wt.data=et)),FW(Re,c,oe,p,$e)}W2(Re,h)})}function gp(c,h,p){return{instance:c,listener:h,currentTarget:p}}function bb(c,h){for(var p=h+"Capture",g=[];c!==null;){var S=c,_=S.stateNode;S=S.tag,S!==5&&S!==26&&S!==27||_===null||(S=Fc(c,p),S!=null&&g.unshift(gp(c,S,_)),S=Fc(c,h),S!=null&&g.push(gp(c,S,_))),c=c.return}return g}function Hh(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5&&c.tag!==27);return c||null}function H2(c,h,p,g,S){for(var _=h._reactName,M=[];p!==null&&p!==g;){var U=p,q=U.alternate,oe=U.stateNode;if(U=U.tag,q!==null&&q===g)break;U!==5&&U!==26&&U!==27||oe===null||(q=oe,S?(oe=Fc(p,_),oe!=null&&M.unshift(gp(p,oe,q))):S||(oe=Fc(p,_),oe!=null&&M.push(gp(p,oe,q)))),p=p.return}M.length!==0&&c.push({event:h,listeners:M})}var VW=/\r\n?/g,BW=/\u0000|\uFFFD/g;function q2(c){return(typeof c=="string"?c:""+c).replace(VW,`
`).replace(BW,"")}function K2(c,h){return h=q2(h),q2(c)===h}function xb(){}function nn(c,h,p,g,S,_){switch(p){case"children":typeof g=="string"?h==="body"||h==="textarea"&&g===""||ti(c,g):(typeof g=="number"||typeof g=="bigint")&&h!=="body"&&ti(c,""+g);break;case"className":ol(c,"class",g);break;case"tabIndex":ol(c,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":ol(c,p,g);break;case"style":wy(c,g,_);break;case"data":if(h!=="object"){ol(c,"data",g);break}case"src":case"href":if(g===""&&(h!=="a"||p!=="href")){c.removeAttribute(p);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){c.removeAttribute(p);break}g=la(""+g),c.setAttribute(p,g);break;case"action":case"formAction":if(typeof g=="function"){c.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(p==="formAction"?(h!=="input"&&nn(c,h,"name",S.name,S,null),nn(c,h,"formEncType",S.formEncType,S,null),nn(c,h,"formMethod",S.formMethod,S,null),nn(c,h,"formTarget",S.formTarget,S,null)):(nn(c,h,"encType",S.encType,S,null),nn(c,h,"method",S.method,S,null),nn(c,h,"target",S.target,S,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){c.removeAttribute(p);break}g=la(""+g),c.setAttribute(p,g);break;case"onClick":g!=null&&(c.onclick=xb);break;case"onScroll":g!=null&&Et("scroll",c);break;case"onScrollEnd":g!=null&&Et("scrollend",c);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(s(61));if(p=g.__html,p!=null){if(S.children!=null)throw Error(s(60));c.innerHTML=p}}break;case"multiple":c.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":c.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){c.removeAttribute("xlink:href");break}p=la(""+g),c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?c.setAttribute(p,""+g):c.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?c.setAttribute(p,""):c.removeAttribute(p);break;case"capture":case"download":g===!0?c.setAttribute(p,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?c.setAttribute(p,g):c.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?c.setAttribute(p,g):c.removeAttribute(p);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?c.removeAttribute(p):c.setAttribute(p,g);break;case"popover":Et("beforetoggle",c),Et("toggle",c),al(c,"popover",g);break;case"xlinkActuate":ei(c,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":ei(c,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":ei(c,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":ei(c,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":ei(c,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":ei(c,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":ei(c,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":ei(c,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":ei(c,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":al(c,"is",g);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=D1.get(p)||p,al(c,p,g))}}function uS(c,h,p,g,S,_){switch(p){case"style":wy(c,g,_);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(s(61));if(p=g.__html,p!=null){if(S.children!=null)throw Error(s(60));c.innerHTML=p}}break;case"children":typeof g=="string"?ti(c,g):(typeof g=="number"||typeof g=="bigint")&&ti(c,""+g);break;case"onScroll":g!=null&&Et("scroll",c);break;case"onScrollEnd":g!=null&&Et("scrollend",c);break;case"onClick":g!=null&&(c.onclick=xb);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!dh.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(S=p.endsWith("Capture"),h=p.slice(2,S?p.length-7:void 0),_=c[ss]||null,_=_!=null?_[p]:null,typeof _=="function"&&c.removeEventListener(h,_,S),typeof g=="function")){typeof _!="function"&&_!==null&&(p in c?c[p]=null:c.hasAttribute(p)&&c.removeAttribute(p)),c.addEventListener(h,g,S);break e}p in c?c[p]=g:g===!0?c.setAttribute(p,""):al(c,p,g)}}}function Fs(c,h,p){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Et("error",c),Et("load",c);var g=!1,S=!1,_;for(_ in p)if(p.hasOwnProperty(_)){var M=p[_];if(M!=null)switch(_){case"src":g=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,h));default:nn(c,h,_,M,p,null)}}S&&nn(c,h,"srcSet",p.srcSet,p,null),g&&nn(c,h,"src",p.src,p,null);return;case"input":Et("invalid",c);var U=_=M=S=null,q=null,oe=null;for(g in p)if(p.hasOwnProperty(g)){var $e=p[g];if($e!=null)switch(g){case"name":S=$e;break;case"type":M=$e;break;case"checked":q=$e;break;case"defaultChecked":oe=$e;break;case"value":_=$e;break;case"defaultValue":U=$e;break;case"children":case"dangerouslySetInnerHTML":if($e!=null)throw Error(s(137,h));break;default:nn(c,h,g,$e,p,null)}}Dc(c,_,U,q,oe,M,S,!1),Rc(c);return;case"select":Et("invalid",c),g=M=_=null;for(S in p)if(p.hasOwnProperty(S)&&(U=p[S],U!=null))switch(S){case"value":_=U;break;case"defaultValue":M=U;break;case"multiple":g=U;default:nn(c,h,S,U,p,null)}h=_,p=M,c.multiple=!!g,h!=null?Bt(c,!!g,h,!1):p!=null&&Bt(c,!!g,p,!0);return;case"textarea":Et("invalid",c),_=S=g=null;for(M in p)if(p.hasOwnProperty(M)&&(U=p[M],U!=null))switch(M){case"value":g=U;break;case"defaultValue":S=U;break;case"children":_=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(s(91));break;default:nn(c,h,M,U,p,null)}cl(c,g,S,_),Rc(c);return;case"option":for(q in p)if(p.hasOwnProperty(q)&&(g=p[q],g!=null))switch(q){case"selected":c.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:nn(c,h,q,g,p,null)}return;case"dialog":Et("cancel",c),Et("close",c);break;case"iframe":case"object":Et("load",c);break;case"video":case"audio":for(g=0;g<mp.length;g++)Et(mp[g],c);break;case"image":Et("error",c),Et("load",c);break;case"details":Et("toggle",c);break;case"embed":case"source":case"link":Et("error",c),Et("load",c);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in p)if(p.hasOwnProperty(oe)&&(g=p[oe],g!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,h));default:nn(c,h,oe,g,p,null)}return;default:if(Rf(h)){for($e in p)p.hasOwnProperty($e)&&(g=p[$e],g!==void 0&&uS(c,h,$e,g,p,void 0));return}}for(U in p)p.hasOwnProperty(U)&&(g=p[U],g!=null&&nn(c,h,U,g,p,null))}function zW(c,h,p,g){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,_=null,M=null,U=null,q=null,oe=null,$e=null;for(Ie in p){var Re=p[Ie];if(p.hasOwnProperty(Ie)&&Re!=null)switch(Ie){case"checked":break;case"value":break;case"defaultValue":q=Re;default:g.hasOwnProperty(Ie)||nn(c,h,Ie,null,g,Re)}}for(var ve in g){var Ie=g[ve];if(Re=p[ve],g.hasOwnProperty(ve)&&(Ie!=null||Re!=null))switch(ve){case"type":_=Ie;break;case"name":S=Ie;break;case"checked":oe=Ie;break;case"defaultChecked":$e=Ie;break;case"value":M=Ie;break;case"defaultValue":U=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(s(137,h));break;default:Ie!==Re&&nn(c,h,ve,Ie,g,Re)}}ll(c,M,U,q,oe,$e,_,S);return;case"select":Ie=M=U=ve=null;for(_ in p)if(q=p[_],p.hasOwnProperty(_)&&q!=null)switch(_){case"value":break;case"multiple":Ie=q;default:g.hasOwnProperty(_)||nn(c,h,_,null,g,q)}for(S in g)if(_=g[S],q=p[S],g.hasOwnProperty(S)&&(_!=null||q!=null))switch(S){case"value":ve=_;break;case"defaultValue":U=_;break;case"multiple":M=_;default:_!==q&&nn(c,h,S,_,g,q)}h=U,p=M,g=Ie,ve!=null?Bt(c,!!p,ve,!1):!!g!=!!p&&(h!=null?Bt(c,!!p,h,!0):Bt(c,!!p,p?[]:"",!1));return;case"textarea":Ie=ve=null;for(U in p)if(S=p[U],p.hasOwnProperty(U)&&S!=null&&!g.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:nn(c,h,U,null,g,S)}for(M in g)if(S=g[M],_=p[M],g.hasOwnProperty(M)&&(S!=null||_!=null))switch(M){case"value":ve=S;break;case"defaultValue":Ie=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(s(91));break;default:S!==_&&nn(c,h,M,S,g,_)}Oc(c,ve,Ie);return;case"option":for(var Xe in p)if(ve=p[Xe],p.hasOwnProperty(Xe)&&ve!=null&&!g.hasOwnProperty(Xe))switch(Xe){case"selected":c.selected=!1;break;default:nn(c,h,Xe,null,g,ve)}for(q in g)if(ve=g[q],Ie=p[q],g.hasOwnProperty(q)&&ve!==Ie&&(ve!=null||Ie!=null))switch(q){case"selected":c.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:nn(c,h,q,ve,g,Ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var at in p)ve=p[at],p.hasOwnProperty(at)&&ve!=null&&!g.hasOwnProperty(at)&&nn(c,h,at,null,g,ve);for(oe in g)if(ve=g[oe],Ie=p[oe],g.hasOwnProperty(oe)&&ve!==Ie&&(ve!=null||Ie!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(s(137,h));break;default:nn(c,h,oe,ve,g,Ie)}return;default:if(Rf(h)){for(var An in p)ve=p[An],p.hasOwnProperty(An)&&ve!==void 0&&!g.hasOwnProperty(An)&&uS(c,h,An,void 0,g,ve);for($e in g)ve=g[$e],Ie=p[$e],!g.hasOwnProperty($e)||ve===Ie||ve===void 0&&Ie===void 0||uS(c,h,$e,ve,g,Ie);return}}for(var fe in p)ve=p[fe],p.hasOwnProperty(fe)&&ve!=null&&!g.hasOwnProperty(fe)&&nn(c,h,fe,null,g,ve);for(Re in g)ve=g[Re],Ie=p[Re],!g.hasOwnProperty(Re)||ve===Ie||ve==null&&Ie==null||nn(c,h,Re,ve,g,Ie)}var hS=null,dS=null;function vb(c){return c.nodeType===9?c:c.ownerDocument}function X2(c){switch(c){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Y2(c,h){if(c===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return c===1&&h==="foreignObject"?0:c}function fS(c,h){return c==="textarea"||c==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var pS=null;function UW(){var c=window.event;return c&&c.type==="popstate"?c===pS?!1:(pS=c,!0):(pS=null,!1)}var Q2=typeof setTimeout=="function"?setTimeout:void 0,jW=typeof clearTimeout=="function"?clearTimeout:void 0,Z2=typeof Promise=="function"?Promise:void 0,WW=typeof queueMicrotask=="function"?queueMicrotask:typeof Z2<"u"?function(c){return Z2.resolve(null).then(c).catch(GW)}:Q2;function GW(c){setTimeout(function(){throw c})}function mS(c,h){var p=h,g=0;do{var S=p.nextSibling;if(c.removeChild(p),S&&S.nodeType===8)if(p=S.data,p==="/$"){if(g===0){c.removeChild(S),Ep(h);return}g--}else p!=="$"&&p!=="$?"&&p!=="$!"||g++;p=S}while(p);Ep(h)}function gS(c){var h=c.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var p=h;switch(h=h.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":gS(p),Ac(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}c.removeChild(p)}}function HW(c,h,p,g){for(;c.nodeType===1;){var S=p;if(c.nodeName.toLowerCase()!==h.toLowerCase()){if(!g&&(c.nodeName!=="INPUT"||c.type!=="hidden"))break}else if(g){if(!c[sl])switch(h){case"meta":if(!c.hasAttribute("itemprop"))break;return c;case"link":if(_=c.getAttribute("rel"),_==="stylesheet"&&c.hasAttribute("data-precedence"))break;if(_!==S.rel||c.getAttribute("href")!==(S.href==null?null:S.href)||c.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||c.getAttribute("title")!==(S.title==null?null:S.title))break;return c;case"style":if(c.hasAttribute("data-precedence"))break;return c;case"script":if(_=c.getAttribute("src"),(_!==(S.src==null?null:S.src)||c.getAttribute("type")!==(S.type==null?null:S.type)||c.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&_&&c.hasAttribute("async")&&!c.hasAttribute("itemprop"))break;return c;default:return c}}else if(h==="input"&&c.type==="hidden"){var _=S.name==null?null:""+S.name;if(S.type==="hidden"&&c.getAttribute("name")===_)return c}else return c;if(c=Li(c.nextSibling),c===null)break}return null}function qW(c,h,p){if(h==="")return null;for(;c.nodeType!==3;)if((c.nodeType!==1||c.nodeName!=="INPUT"||c.type!=="hidden")&&!p||(c=Li(c.nextSibling),c===null))return null;return c}function Li(c){for(;c!=null;c=c.nextSibling){var h=c.nodeType;if(h===1||h===3)break;if(h===8){if(h=c.data,h==="$"||h==="$!"||h==="$?"||h==="F!"||h==="F")break;if(h==="/$")return null}}return c}function J2(c){c=c.previousSibling;for(var h=0;c;){if(c.nodeType===8){var p=c.data;if(p==="$"||p==="$!"||p==="$?"){if(h===0)return c;h--}else p==="/$"&&h++}c=c.previousSibling}return null}function eA(c,h,p){switch(h=vb(p),c){case"html":if(c=h.documentElement,!c)throw Error(s(452));return c;case"head":if(c=h.head,!c)throw Error(s(453));return c;case"body":if(c=h.body,!c)throw Error(s(454));return c;default:throw Error(s(451))}}var pi=new Map,tA=new Set;function wb(c){return typeof c.getRootNode=="function"?c.getRootNode():c.ownerDocument}var xo=be.d;be.d={f:KW,r:XW,D:YW,C:QW,L:ZW,m:JW,X:tG,S:eG,M:nG};function KW(){var c=xo.f(),h=fb();return c||h}function XW(c){var h=Ya(c);h!==null&&h.tag===5&&h.type==="form"?Ck(h):xo.r(c)}var qh=typeof document>"u"?null:document;function nA(c,h,p){var g=qh;if(g&&typeof h=="string"&&h){var S=Cn(h);S='link[rel="'+c+'"][href="'+S+'"]',typeof p=="string"&&(S+='[crossorigin="'+p+'"]'),tA.has(S)||(tA.add(S),c={rel:c,crossOrigin:p,href:h},g.querySelector(S)===null&&(h=g.createElement("link"),Fs(h,"link",c),Tn(h),g.head.appendChild(h)))}}function YW(c){xo.D(c),nA("dns-prefetch",c,null)}function QW(c,h){xo.C(c,h),nA("preconnect",c,h)}function ZW(c,h,p){xo.L(c,h,p);var g=qh;if(g&&c&&h){var S='link[rel="preload"][as="'+Cn(h)+'"]';h==="image"&&p&&p.imageSrcSet?(S+='[imagesrcset="'+Cn(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(S+='[imagesizes="'+Cn(p.imageSizes)+'"]')):S+='[href="'+Cn(c)+'"]';var _=S;switch(h){case"style":_=Kh(c);break;case"script":_=Xh(c)}pi.has(_)||(c=D({rel:"preload",href:h==="image"&&p&&p.imageSrcSet?void 0:c,as:h},p),pi.set(_,c),g.querySelector(S)!==null||h==="style"&&g.querySelector(yp(_))||h==="script"&&g.querySelector(bp(_))||(h=g.createElement("link"),Fs(h,"link",c),Tn(h),g.head.appendChild(h)))}}function JW(c,h){xo.m(c,h);var p=qh;if(p&&c){var g=h&&typeof h.as=="string"?h.as:"script",S='link[rel="modulepreload"][as="'+Cn(g)+'"][href="'+Cn(c)+'"]',_=S;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Xh(c)}if(!pi.has(_)&&(c=D({rel:"modulepreload",href:c},h),pi.set(_,c),p.querySelector(S)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(bp(_)))return}g=p.createElement("link"),Fs(g,"link",c),Tn(g),p.head.appendChild(g)}}}function eG(c,h,p){xo.S(c,h,p);var g=qh;if(g&&c){var S=il(g).hoistableStyles,_=Kh(c);h=h||"default";var M=S.get(_);if(!M){var U={loading:0,preload:null};if(M=g.querySelector(yp(_)))U.loading=5;else{c=D({rel:"stylesheet",href:c,"data-precedence":h},p),(p=pi.get(_))&&yS(c,p);var q=M=g.createElement("link");Tn(q),Fs(q,"link",c),q._p=new Promise(function(oe,$e){q.onload=oe,q.onerror=$e}),q.addEventListener("load",function(){U.loading|=1}),q.addEventListener("error",function(){U.loading|=2}),U.loading|=4,Sb(M,h,g)}M={type:"stylesheet",instance:M,count:1,state:U},S.set(_,M)}}}function tG(c,h){xo.X(c,h);var p=qh;if(p&&c){var g=il(p).hoistableScripts,S=Xh(c),_=g.get(S);_||(_=p.querySelector(bp(S)),_||(c=D({src:c,async:!0},h),(h=pi.get(S))&&bS(c,h),_=p.createElement("script"),Tn(_),Fs(_,"link",c),p.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},g.set(S,_))}}function nG(c,h){xo.M(c,h);var p=qh;if(p&&c){var g=il(p).hoistableScripts,S=Xh(c),_=g.get(S);_||(_=p.querySelector(bp(S)),_||(c=D({src:c,async:!0,type:"module"},h),(h=pi.get(S))&&bS(c,h),_=p.createElement("script"),Tn(_),Fs(_,"link",c),p.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},g.set(S,_))}}function sA(c,h,p,g){var S=(S=pt.current)?wb(S):null;if(!S)throw Error(s(446));switch(c){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(h=Kh(p.href),p=il(S).hoistableStyles,g=p.get(h),g||(g={type:"style",instance:null,count:0,state:null},p.set(h,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){c=Kh(p.href);var _=il(S).hoistableStyles,M=_.get(c);if(M||(S=S.ownerDocument||S,M={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(c,M),(_=S.querySelector(yp(c)))&&!_._p&&(M.instance=_,M.state.loading=5),pi.has(c)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},pi.set(c,p),_||sG(S,c,p,M.state))),h&&g===null)throw Error(s(528,""));return M}if(h&&g!==null)throw Error(s(529,""));return null;case"script":return h=p.async,p=p.src,typeof p=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=Xh(p),p=il(S).hoistableScripts,g=p.get(h),g||(g={type:"script",instance:null,count:0,state:null},p.set(h,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,c))}}function Kh(c){return'href="'+Cn(c)+'"'}function yp(c){return'link[rel="stylesheet"]['+c+"]"}function rA(c){return D({},c,{"data-precedence":c.precedence,precedence:null})}function sG(c,h,p,g){c.querySelector('link[rel="preload"][as="style"]['+h+"]")?g.loading=1:(h=c.createElement("link"),g.preload=h,h.addEventListener("load",function(){return g.loading|=1}),h.addEventListener("error",function(){return g.loading|=2}),Fs(h,"link",p),Tn(h),c.head.appendChild(h))}function Xh(c){return'[src="'+Cn(c)+'"]'}function bp(c){return"script[async]"+c}function iA(c,h,p){if(h.count++,h.instance===null)switch(h.type){case"style":var g=c.querySelector('style[data-href~="'+Cn(p.href)+'"]');if(g)return h.instance=g,Tn(g),g;var S=D({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return g=(c.ownerDocument||c).createElement("style"),Tn(g),Fs(g,"style",S),Sb(g,p.precedence,c),h.instance=g;case"stylesheet":S=Kh(p.href);var _=c.querySelector(yp(S));if(_)return h.state.loading|=4,h.instance=_,Tn(_),_;g=rA(p),(S=pi.get(S))&&yS(g,S),_=(c.ownerDocument||c).createElement("link"),Tn(_);var M=_;return M._p=new Promise(function(U,q){M.onload=U,M.onerror=q}),Fs(_,"link",g),h.state.loading|=4,Sb(_,p.precedence,c),h.instance=_;case"script":return _=Xh(p.src),(S=c.querySelector(bp(_)))?(h.instance=S,Tn(S),S):(g=p,(S=pi.get(_))&&(g=D({},p),bS(g,S)),c=c.ownerDocument||c,S=c.createElement("script"),Tn(S),Fs(S,"link",g),c.head.appendChild(S),h.instance=S);case"void":return null;default:throw Error(s(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(g=h.instance,h.state.loading|=4,Sb(g,p.precedence,c));return h.instance}function Sb(c,h,p){for(var g=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=g.length?g[g.length-1]:null,_=S,M=0;M<g.length;M++){var U=g[M];if(U.dataset.precedence===h)_=U;else if(_!==S)break}_?_.parentNode.insertBefore(c,_.nextSibling):(h=p.nodeType===9?p.head:p,h.insertBefore(c,h.firstChild))}function yS(c,h){c.crossOrigin==null&&(c.crossOrigin=h.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=h.referrerPolicy),c.title==null&&(c.title=h.title)}function bS(c,h){c.crossOrigin==null&&(c.crossOrigin=h.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=h.referrerPolicy),c.integrity==null&&(c.integrity=h.integrity)}var Tb=null;function aA(c,h,p){if(Tb===null){var g=new Map,S=Tb=new Map;S.set(p,g)}else S=Tb,g=S.get(p),g||(g=new Map,S.set(p,g));if(g.has(c))return g;for(g.set(c,null),p=p.getElementsByTagName(c),S=0;S<p.length;S++){var _=p[S];if(!(_[sl]||_[ys]||c==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var M=_.getAttribute(h)||"";M=c+M;var U=g.get(M);U?U.push(_):g.set(M,[_])}}return g}function oA(c,h,p){c=c.ownerDocument||c,c.head.insertBefore(p,h==="title"?c.querySelector("head > title"):null)}function rG(c,h,p){if(p===1||h.itemProp!=null)return!1;switch(c){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return c=h.disabled,typeof h.precedence=="string"&&c==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function lA(c){return!(c.type==="stylesheet"&&(c.state.loading&3)===0)}var xp=null;function iG(){}function aG(c,h,p){if(xp===null)throw Error(s(475));var g=xp;if(h.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var S=Kh(p.href),_=c.querySelector(yp(S));if(_){c=_._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(g.count++,g=Eb.bind(g),c.then(g,g)),h.state.loading|=4,h.instance=_,Tn(_);return}_=c.ownerDocument||c,p=rA(p),(S=pi.get(S))&&yS(p,S),_=_.createElement("link"),Tn(_);var M=_;M._p=new Promise(function(U,q){M.onload=U,M.onerror=q}),Fs(_,"link",p),h.instance=_}g.stylesheets===null&&(g.stylesheets=new Map),g.stylesheets.set(h,c),(c=h.state.preload)&&(h.state.loading&3)===0&&(g.count++,h=Eb.bind(g),c.addEventListener("load",h),c.addEventListener("error",h))}}function oG(){if(xp===null)throw Error(s(475));var c=xp;return c.stylesheets&&c.count===0&&xS(c,c.stylesheets),0<c.count?function(h){var p=setTimeout(function(){if(c.stylesheets&&xS(c,c.stylesheets),c.unsuspend){var g=c.unsuspend;c.unsuspend=null,g()}},6e4);return c.unsuspend=h,function(){c.unsuspend=null,clearTimeout(p)}}:null}function Eb(){if(this.count--,this.count===0){if(this.stylesheets)xS(this,this.stylesheets);else if(this.unsuspend){var c=this.unsuspend;this.unsuspend=null,c()}}}var _b=null;function xS(c,h){c.stylesheets=null,c.unsuspend!==null&&(c.count++,_b=new Map,h.forEach(lG,c),_b=null,Eb.call(c))}function lG(c,h){if(!(h.state.loading&4)){var p=_b.get(c);if(p)var g=p.get(null);else{p=new Map,_b.set(c,p);for(var S=c.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<S.length;_++){var M=S[_];(M.nodeName==="LINK"||M.getAttribute("media")!=="not all")&&(p.set(M.dataset.precedence,M),g=M)}g&&p.set(null,g)}S=h.instance,M=S.getAttribute("data-precedence"),_=p.get(M)||g,_===g&&p.set(null,S),p.set(M,S),this.count++,g=Eb.bind(this),S.addEventListener("load",g),S.addEventListener("error",g),_?_.parentNode.insertBefore(S,_.nextSibling):(c=c.nodeType===9?c.head:c,c.insertBefore(S,c.firstChild)),h.state.loading|=4}}var vp={$$typeof:y,Provider:null,Consumer:null,_currentValue:_e,_currentValue2:_e,_threadCount:0};function cG(c,h,p,g,S,_,M,U){this.tag=1,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=uh(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uh(0),this.hiddenUpdates=uh(null),this.identifierPrefix=g,this.onUncaughtError=S,this.onCaughtError=_,this.onRecoverableError=M,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function cA(c,h,p,g,S,_,M,U,q,oe,$e,Re){return c=new cG(c,h,p,M,U,q,oe,Re),h=1,_===!0&&(h|=24),_=di(3,null,null,h),c.current=_,_.stateNode=c,h=Q1(),h.refCount++,c.pooledCache=h,h.refCount++,_.memoizedState={element:g,isDehydrated:p,cache:h},Aw(_),c}function uA(c){return c?(c=$h,c):$h}function hA(c,h,p,g,S,_){S=uA(S),g.context===null?g.context=S:g.pendingContext=S,g=bl(h),g.payload={element:p},_=_===void 0?null:_,_!==null&&(g.callback=_),p=xl(c,g,h),p!==null&&(gr(p,c,h),sp(p,c,h))}function dA(c,h){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var p=c.retryLane;c.retryLane=p!==0&&p<h?p:h}}function vS(c,h){dA(c,h),(c=c.alternate)&&dA(c,h)}function fA(c){if(c.tag===13){var h=hl(c,67108864);h!==null&&gr(h,c,67108864),vS(c,67108864)}}var Ib=!0;function uG(c,h,p,g){var S=N.T;N.T=null;var _=be.p;try{be.p=2,wS(c,h,p,g)}finally{be.p=_,N.T=S}}function hG(c,h,p,g){var S=N.T;N.T=null;var _=be.p;try{be.p=8,wS(c,h,p,g)}finally{be.p=_,N.T=S}}function wS(c,h,p,g){if(Ib){var S=SS(g);if(S===null)cS(c,h,g,$b,p),mA(c,g);else if(fG(S,c,h,p,g))g.stopPropagation();else if(mA(c,g),h&4&&-1<dG.indexOf(c)){for(;S!==null;){var _=Ya(S);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var M=Ai(_.pendingLanes);if(M!==0){var U=_;for(U.pendingLanes|=2,U.entangledLanes|=2;M;){var q=1<<31-dr(M);U.entanglements[1]|=q,M&=~q}xa(_),(_n&6)===0&&(ub=dn()+500,pp(0))}}break;case 13:U=hl(_,2),U!==null&&gr(U,_,2),fb(),vS(_,2)}if(_=SS(g),_===null&&cS(c,h,g,$b,p),_===S)break;S=_}S!==null&&g.stopPropagation()}else cS(c,h,g,null,p)}}function SS(c){return c=mh(c),TS(c)}var $b=null;function TS(c){if($b=null,c=Ri(c),c!==null){var h=Z(c);if(h===null)c=null;else{var p=h.tag;if(p===13){if(c=he(h),c!==null)return c;c=null}else if(p===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;c=null}else h!==c&&(c=null)}}return $b=c,null}function pA(c){switch(c){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(_r()){case en:return 2;case an:return 8;case ms:case sa:return 32;case qa:return 268435456;default:return 32}default:return 32}}var ES=!1,Il=null,$l=null,Cl=null,wp=new Map,Sp=new Map,Nl=[],dG="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mA(c,h){switch(c){case"focusin":case"focusout":Il=null;break;case"dragenter":case"dragleave":$l=null;break;case"mouseover":case"mouseout":Cl=null;break;case"pointerover":case"pointerout":wp.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sp.delete(h.pointerId)}}function Tp(c,h,p,g,S,_){return c===null||c.nativeEvent!==_?(c={blockedOn:h,domEventName:p,eventSystemFlags:g,nativeEvent:_,targetContainers:[S]},h!==null&&(h=Ya(h),h!==null&&fA(h)),c):(c.eventSystemFlags|=g,h=c.targetContainers,S!==null&&h.indexOf(S)===-1&&h.push(S),c)}function fG(c,h,p,g,S){switch(h){case"focusin":return Il=Tp(Il,c,h,p,g,S),!0;case"dragenter":return $l=Tp($l,c,h,p,g,S),!0;case"mouseover":return Cl=Tp(Cl,c,h,p,g,S),!0;case"pointerover":var _=S.pointerId;return wp.set(_,Tp(wp.get(_)||null,c,h,p,g,S)),!0;case"gotpointercapture":return _=S.pointerId,Sp.set(_,Tp(Sp.get(_)||null,c,h,p,g,S)),!0}return!1}function gA(c){var h=Ri(c.target);if(h!==null){var p=Z(h);if(p!==null){if(h=p.tag,h===13){if(h=he(p),h!==null){c.blockedOn=h,nl(c.priority,function(){if(p.tag===13){var g=Wr(),S=hl(p,g);S!==null&&gr(S,p,g),vS(p,g)}});return}}else if(h===3&&p.stateNode.current.memoizedState.isDehydrated){c.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Cb(c){if(c.blockedOn!==null)return!1;for(var h=c.targetContainers;0<h.length;){var p=SS(c.nativeEvent);if(p===null){p=c.nativeEvent;var g=new p.constructor(p.type,p);ni=g,p.target.dispatchEvent(g),ni=null}else return h=Ya(p),h!==null&&fA(h),c.blockedOn=p,!1;h.shift()}return!0}function yA(c,h,p){Cb(c)&&p.delete(h)}function pG(){ES=!1,Il!==null&&Cb(Il)&&(Il=null),$l!==null&&Cb($l)&&($l=null),Cl!==null&&Cb(Cl)&&(Cl=null),wp.forEach(yA),Sp.forEach(yA)}function Nb(c,h){c.blockedOn===h&&(c.blockedOn=null,ES||(ES=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,pG)))}var kb=null;function bA(c){kb!==c&&(kb=c,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){kb===c&&(kb=null);for(var h=0;h<c.length;h+=3){var p=c[h],g=c[h+1],S=c[h+2];if(typeof g!="function"){if(TS(g||p)===null)continue;break}var _=Ya(p);_!==null&&(c.splice(h,3),h-=3,fw(_,{pending:!0,data:S,method:p.method,action:g},g,S))}}))}function Ep(c){function h(q){return Nb(q,c)}Il!==null&&Nb(Il,c),$l!==null&&Nb($l,c),Cl!==null&&Nb(Cl,c),wp.forEach(h),Sp.forEach(h);for(var p=0;p<Nl.length;p++){var g=Nl[p];g.blockedOn===c&&(g.blockedOn=null)}for(;0<Nl.length&&(p=Nl[0],p.blockedOn===null);)gA(p),p.blockedOn===null&&Nl.shift();if(p=(c.ownerDocument||c).$$reactFormReplay,p!=null)for(g=0;g<p.length;g+=3){var S=p[g],_=p[g+1],M=S[ss]||null;if(typeof _=="function")M||bA(p);else if(M){var U=null;if(_&&_.hasAttribute("formAction")){if(S=_,M=_[ss]||null)U=M.formAction;else if(TS(S)!==null)continue}else U=M.action;typeof U=="function"?p[g+1]=U:(p.splice(g,3),g-=3),bA(p)}}}function _S(c){this._internalRoot=c}Ab.prototype.render=_S.prototype.render=function(c){var h=this._internalRoot;if(h===null)throw Error(s(409));var p=h.current,g=Wr();hA(p,g,c,h,null,null)},Ab.prototype.unmount=_S.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var h=c.containerInfo;c.tag===0&&Wh(),hA(c.current,2,null,c,null,null),fb(),h[Xa]=null}};function Ab(c){this._internalRoot=c}Ab.prototype.unstable_scheduleHydration=function(c){if(c){var h=by();c={blockedOn:null,target:c,priority:h};for(var p=0;p<Nl.length&&h!==0&&h<Nl[p].priority;p++);Nl.splice(p,0,c),p===0&&gA(c)}};var xA=e.version;if(xA!=="19.0.0")throw Error(s(527,xA,"19.0.0"));be.findDOMNode=function(c){var h=c._reactInternals;if(h===void 0)throw typeof c.render=="function"?Error(s(188)):(c=Object.keys(c).join(","),Error(s(268,c)));return c=ee(h),c=c!==null?me(c):null,c=c===null?null:c.stateNode,c};var mG={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:N,findFiberByHostInstance:Ri,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rb.isDisabled&&Rb.supportsFiber)try{Pr=Rb.inject(mG),gs=Rb}catch{}}return Ip.createRoot=function(c,h){if(!r(c))throw Error(s(299));var p=!1,g="",S=Lk,_=Pk,M=Mk,U=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(g=h.identifierPrefix),h.onUncaughtError!==void 0&&(S=h.onUncaughtError),h.onCaughtError!==void 0&&(_=h.onCaughtError),h.onRecoverableError!==void 0&&(M=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(U=h.unstable_transitionCallbacks)),h=cA(c,1,!1,null,null,p,g,S,_,M,U,null),c[Xa]=h.current,lS(c.nodeType===8?c.parentNode:c),new _S(h)},Ip.hydrateRoot=function(c,h,p){if(!r(c))throw Error(s(299));var g=!1,S="",_=Lk,M=Pk,U=Mk,q=null,oe=null;return p!=null&&(p.unstable_strictMode===!0&&(g=!0),p.identifierPrefix!==void 0&&(S=p.identifierPrefix),p.onUncaughtError!==void 0&&(_=p.onUncaughtError),p.onCaughtError!==void 0&&(M=p.onCaughtError),p.onRecoverableError!==void 0&&(U=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(q=p.unstable_transitionCallbacks),p.formState!==void 0&&(oe=p.formState)),h=cA(c,1,!0,h,p??null,g,S,_,M,U,q,oe),h.context=uA(null),p=h.current,g=Wr(),S=bl(g),S.callback=null,xl(p,S,g),h.current.lanes=g,Vn(h,g),xa(h),c[Xa]=h.current,lS(c),new Ab(h)},Ip.version="19.0.0",Ip}var NA;function $G(){if(NA)return CS.exports;NA=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),CS.exports=IG(),CS.exports}var CG=$G(),$p={},kA;function NG(){if(kA)return $p;kA=1,Object.defineProperty($p,"__esModule",{value:!0}),$p.parse=a,$p.serialize=u;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,r=Object.prototype.toString,i=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function a(m,y){const b=new i,w=m.length;if(w<2)return b;const x=(y==null?void 0:y.decode)||d;let T=0;do{const E=m.indexOf("=",T);if(E===-1)break;const $=m.indexOf(";",T),C=$===-1?w:$;if(E>C){T=m.lastIndexOf(";",E-1)+1;continue}const O=o(m,T,E),V=l(m,E,O),F=m.slice(O,V);if(b[F]===void 0){let R=o(m,E+1,C),N=l(m,C,R);const D=x(m.slice(R,N));b[F]=D}T=C+1}while(T<w);return b}function o(m,y,b){do{const w=m.charCodeAt(y);if(w!==32&&w!==9)return y}while(++y<b);return b}function l(m,y,b){for(;y>b;){const w=m.charCodeAt(--y);if(w!==32&&w!==9)return y+1}return b}function u(m,y,b){const w=(b==null?void 0:b.encode)||encodeURIComponent;if(!n.test(m))throw new TypeError(`argument name is invalid: ${m}`);const x=w(y);if(!e.test(x))throw new TypeError(`argument val is invalid: ${y}`);let T=m+"="+x;if(!b)return T;if(b.maxAge!==void 0){if(!Number.isInteger(b.maxAge))throw new TypeError(`option maxAge is invalid: ${b.maxAge}`);T+="; Max-Age="+b.maxAge}if(b.domain){if(!t.test(b.domain))throw new TypeError(`option domain is invalid: ${b.domain}`);T+="; Domain="+b.domain}if(b.path){if(!s.test(b.path))throw new TypeError(`option path is invalid: ${b.path}`);T+="; Path="+b.path}if(b.expires){if(!f(b.expires)||!Number.isFinite(b.expires.valueOf()))throw new TypeError(`option expires is invalid: ${b.expires}`);T+="; Expires="+b.expires.toUTCString()}if(b.httpOnly&&(T+="; HttpOnly"),b.secure&&(T+="; Secure"),b.partitioned&&(T+="; Partitioned"),b.priority)switch(typeof b.priority=="string"?b.priority.toLowerCase():void 0){case"low":T+="; Priority=Low";break;case"medium":T+="; Priority=Medium";break;case"high":T+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${b.priority}`)}if(b.sameSite)switch(typeof b.sameSite=="string"?b.sameSite.toLowerCase():b.sameSite){case!0:case"strict":T+="; SameSite=Strict";break;case"lax":T+="; SameSite=Lax";break;case"none":T+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${b.sameSite}`)}return T}function d(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch{return m}}function f(m){return r.call(m)==="[object Date]"}return $p}NG();/**
 * react-router v7.4.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var AA="popstate";function kG(n={}){function e(s,r){let{pathname:i,search:a,hash:o}=s.location;return xT("",{pathname:i,search:a,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(s,r){return typeof r=="string"?r:lm(r)}return RG(e,t,null,n)}function wn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Ki(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function AG(){return Math.random().toString(36).substring(2,10)}function RA(n,e){return{usr:n.state,key:n.key,idx:e}}function xT(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?qd(e):e,state:t,key:e&&e.key||s||AG()}}function lm({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function qd(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function RG(n,e,t,s={}){let{window:r=document.defaultView,v5Compat:i=!1}=s,a=r.history,o="POP",l=null,u=d();u==null&&(u=0,a.replaceState({...a.state,idx:u},""));function d(){return(a.state||{idx:null}).idx}function f(){o="POP";let x=d(),T=x==null?null:x-u;u=x,l&&l({action:o,location:w.location,delta:T})}function m(x,T){o="PUSH";let E=xT(w.location,x,T);u=d()+1;let $=RA(E,u),C=w.createHref(E);try{a.pushState($,"",C)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;r.location.assign(C)}i&&l&&l({action:o,location:w.location,delta:1})}function y(x,T){o="REPLACE";let E=xT(w.location,x,T);u=d();let $=RA(E,u),C=w.createHref(E);a.replaceState($,"",C),i&&l&&l({action:o,location:w.location,delta:0})}function b(x){let T=r.location.origin!=="null"?r.location.origin:r.location.href,E=typeof x=="string"?x:lm(x);return E=E.replace(/ $/,"%20"),wn(T,`No window.location.(origin|href) available to create URL for href: ${E}`),new URL(E,T)}let w={get action(){return o},get location(){return n(r,a)},listen(x){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(AA,f),l=x,()=>{r.removeEventListener(AA,f),l=null}},createHref(x){return e(r,x)},createURL:b,encodeLocation(x){let T=b(x);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:y,go(x){return a.go(x)}};return w}function TF(n,e,t="/"){return DG(n,e,t,!1)}function DG(n,e,t,s){let r=typeof e=="string"?qd(e):e,i=Do(r.pathname||"/",t);if(i==null)return null;let a=EF(n);OG(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=GG(i);o=jG(a[l],u,s)}return o}function EF(n,e=[],t=[],s=""){let r=(i,a,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};l.relativePath.startsWith("/")&&(wn(l.relativePath.startsWith(s),`Absolute route path "${l.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(s.length));let u=No([s,l.relativePath]),d=t.concat(l);i.children&&i.children.length>0&&(wn(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),EF(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:zG(u,i.index),routesMeta:d})};return n.forEach((i,a)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))r(i,a);else for(let l of _F(i.path))r(i,a,l)}),e}function _F(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,r=t.endsWith("?"),i=t.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let a=_F(s.join("/")),o=[];return o.push(...a.map(l=>l===""?i:[i,l].join("/"))),r&&o.push(...a),o.map(l=>n.startsWith("/")&&l===""?"/":l)}function OG(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:UG(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var FG=/^:[\w-]+$/,LG=3,PG=2,MG=1,VG=10,BG=-2,DA=n=>n==="*";function zG(n,e){let t=n.split("/"),s=t.length;return t.some(DA)&&(s+=BG),e&&(s+=PG),t.filter(r=>!DA(r)).reduce((r,i)=>r+(FG.test(i)?LG:i===""?MG:VG),s)}function UG(n,e){return n.length===e.length&&n.slice(0,-1).every((s,r)=>s===e[r])?n[n.length-1]-e[e.length-1]:0}function jG(n,e,t=!1){let{routesMeta:s}=n,r={},i="/",a=[];for(let o=0;o<s.length;++o){let l=s[o],u=o===s.length-1,d=i==="/"?e:e.slice(i.length)||"/",f=_0({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),m=l.route;if(!f&&u&&t&&!s[s.length-1].route.index&&(f=_0({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},d)),!f)return null;Object.assign(r,f.params),a.push({params:r,pathname:No([i,f.pathname]),pathnameBase:XG(No([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=No([i,f.pathnameBase]))}return a}function _0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=WG(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let i=r[0],a=i.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:s.reduce((u,{paramName:d,isOptional:f},m)=>{if(d==="*"){let b=o[m]||"";a=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const y=o[m];return f&&!y?u[d]=void 0:u[d]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:a,pattern:n}}function WG(n,e=!1,t=!0){Ki(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function GG(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ki(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Do(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}function HG(n,e="/"){let{pathname:t,search:s="",hash:r=""}=typeof n=="string"?qd(n):n;return{pathname:t?t.startsWith("/")?t:qG(t,e):e,search:YG(s),hash:QG(r)}}function qG(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function RS(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function KG(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function o_(n){let e=KG(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function l_(n,e,t,s=!1){let r;typeof n=="string"?r=qd(n):(r={...n},wn(!r.pathname||!r.pathname.includes("?"),RS("?","pathname","search",r)),wn(!r.pathname||!r.pathname.includes("#"),RS("#","pathname","hash",r)),wn(!r.search||!r.search.includes("#"),RS("#","search","hash",r)));let i=n===""||r.pathname==="",a=i?"/":r.pathname,o;if(a==null)o=t;else{let f=e.length-1;if(!s&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),f-=1;r.pathname=m.join("/")}o=f>=0?e[f]:"/"}let l=HG(r,o),u=a&&a!=="/"&&a.endsWith("/"),d=(i||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}var No=n=>n.join("/").replace(/\/\/+/g,"/"),XG=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),YG=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,QG=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function ZG(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var IF=["POST","PUT","PATCH","DELETE"];new Set(IF);var JG=["GET",...IF];new Set(JG);var Kd=we.createContext(null);Kd.displayName="DataRouter";var $x=we.createContext(null);$x.displayName="DataRouterState";var $F=we.createContext({isTransitioning:!1});$F.displayName="ViewTransition";var eH=we.createContext(new Map);eH.displayName="Fetchers";var tH=we.createContext(null);tH.displayName="Await";var ea=we.createContext(null);ea.displayName="Navigation";var Fm=we.createContext(null);Fm.displayName="Location";var Wa=we.createContext({outlet:null,matches:[],isDataRoute:!1});Wa.displayName="Route";var c_=we.createContext(null);c_.displayName="RouteError";function nH(n,{relative:e}={}){wn(Xd(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=we.useContext(ea),{hash:r,pathname:i,search:a}=Lm(n,{relative:e}),o=i;return t!=="/"&&(o=i==="/"?t:No([t,i])),s.createHref({pathname:o,search:a,hash:r})}function Xd(){return we.useContext(Fm)!=null}function Ga(){return wn(Xd(),"useLocation() may be used only in the context of a <Router> component."),we.useContext(Fm).location}var CF="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function NF(n){we.useContext(ea).static||we.useLayoutEffect(n)}function Yd(){let{isDataRoute:n}=we.useContext(Wa);return n?mH():sH()}function sH(){wn(Xd(),"useNavigate() may be used only in the context of a <Router> component.");let n=we.useContext(Kd),{basename:e,navigator:t}=we.useContext(ea),{matches:s}=we.useContext(Wa),{pathname:r}=Ga(),i=JSON.stringify(o_(s)),a=we.useRef(!1);return NF(()=>{a.current=!0}),we.useCallback((l,u={})=>{if(Ki(a.current,CF),!a.current)return;if(typeof l=="number"){t.go(l);return}let d=l_(l,JSON.parse(i),r,u.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:No([e,d.pathname])),(u.replace?t.replace:t.push)(d,u.state,u)},[e,t,i,r,n])}we.createContext(null);function Lm(n,{relative:e}={}){let{matches:t}=we.useContext(Wa),{pathname:s}=Ga(),r=JSON.stringify(o_(t));return we.useMemo(()=>l_(n,JSON.parse(r),s,e==="path"),[n,r,s,e])}function rH(n,e){return kF(n,e)}function kF(n,e,t,s){var E;wn(Xd(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r,static:i}=we.useContext(ea),{matches:a}=we.useContext(Wa),o=a[a.length-1],l=o?o.params:{},u=o?o.pathname:"/",d=o?o.pathnameBase:"/",f=o&&o.route;{let $=f&&f.path||"";AF(u,!f||$.endsWith("*")||$.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${$}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${$}"> to <Route path="${$==="/"?"*":`${$}/*`}">.`)}let m=Ga(),y;if(e){let $=typeof e=="string"?qd(e):e;wn(d==="/"||((E=$.pathname)==null?void 0:E.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${$.pathname}" was given in the \`location\` prop.`),y=$}else y=m;let b=y.pathname||"/",w=b;if(d!=="/"){let $=d.replace(/^\//,"").split("/");w="/"+b.replace(/^\//,"").split("/").slice($.length).join("/")}let x=!i&&t&&t.matches&&t.matches.length>0?t.matches:TF(n,{pathname:w});Ki(f||x!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),Ki(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=cH(x&&x.map($=>Object.assign({},$,{params:Object.assign({},l,$.params),pathname:No([d,r.encodeLocation?r.encodeLocation($.pathname).pathname:$.pathname]),pathnameBase:$.pathnameBase==="/"?d:No([d,r.encodeLocation?r.encodeLocation($.pathnameBase).pathname:$.pathnameBase])})),a,t,s);return e&&T?we.createElement(Fm.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},T):T}function iH(){let n=pH(),e=ZG(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},i={padding:"2px 4px",backgroundColor:s},a=null;return console.error("Error handled by React Router default ErrorBoundary:",n),a=we.createElement(we.Fragment,null,we.createElement("p",null,"💿 Hey developer 👋"),we.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",we.createElement("code",{style:i},"ErrorBoundary")," or"," ",we.createElement("code",{style:i},"errorElement")," prop on your route.")),we.createElement(we.Fragment,null,we.createElement("h2",null,"Unexpected Application Error!"),we.createElement("h3",{style:{fontStyle:"italic"}},e),t?we.createElement("pre",{style:r},t):null,a)}var aH=we.createElement(iH,null),oH=class extends we.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?we.createElement(Wa.Provider,{value:this.props.routeContext},we.createElement(c_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function lH({routeContext:n,match:e,children:t}){let s=we.useContext(Kd);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),we.createElement(Wa.Provider,{value:n},t)}function cH(n,e=[],t=null,s=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let r=n,i=t==null?void 0:t.errors;if(i!=null){let l=r.findIndex(u=>u.route.id&&(i==null?void 0:i[u.route.id])!==void 0);wn(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),r=r.slice(0,Math.min(r.length,l+1))}let a=!1,o=-1;if(t)for(let l=0;l<r.length;l++){let u=r[l];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(o=l),u.route.id){let{loaderData:d,errors:f}=t,m=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!f||f[u.route.id]===void 0);if(u.route.lazy||m){a=!0,o>=0?r=r.slice(0,o+1):r=[r[0]];break}}}return r.reduceRight((l,u,d)=>{let f,m=!1,y=null,b=null;t&&(f=i&&u.route.id?i[u.route.id]:void 0,y=u.route.errorElement||aH,a&&(o<0&&d===0?(AF("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,b=null):o===d&&(m=!0,b=u.route.hydrateFallbackElement||null)));let w=e.concat(r.slice(0,d+1)),x=()=>{let T;return f?T=y:m?T=b:u.route.Component?T=we.createElement(u.route.Component,null):u.route.element?T=u.route.element:T=l,we.createElement(lH,{match:u,routeContext:{outlet:l,matches:w,isDataRoute:t!=null},children:T})};return t&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?we.createElement(oH,{location:t.location,revalidation:t.revalidation,component:y,error:f,children:x(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):x()},null)}function u_(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function uH(n){let e=we.useContext(Kd);return wn(e,u_(n)),e}function hH(n){let e=we.useContext($x);return wn(e,u_(n)),e}function dH(n){let e=we.useContext(Wa);return wn(e,u_(n)),e}function h_(n){let e=dH(n),t=e.matches[e.matches.length-1];return wn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function fH(){return h_("useRouteId")}function pH(){var s;let n=we.useContext(c_),e=hH("useRouteError"),t=h_("useRouteError");return n!==void 0?n:(s=e.errors)==null?void 0:s[t]}function mH(){let{router:n}=uH("useNavigate"),e=h_("useNavigate"),t=we.useRef(!1);return NF(()=>{t.current=!0}),we.useCallback(async(r,i={})=>{Ki(t.current,CF),t.current&&(typeof r=="number"?n.navigate(r):await n.navigate(r,{fromRouteId:e,...i}))},[n,e])}var OA={};function AF(n,e,t){!e&&!OA[n]&&(OA[n]=!0,Ki(!1,t))}we.memo(gH);function gH({routes:n,future:e,state:t}){return kF(n,void 0,t,e)}function yH({to:n,replace:e,state:t,relative:s}){wn(Xd(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=we.useContext(ea);Ki(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=we.useContext(Wa),{pathname:a}=Ga(),o=Yd(),l=l_(n,o_(i),a,s==="path"),u=JSON.stringify(l);return we.useEffect(()=>{o(JSON.parse(u),{replace:e,state:t,relative:s})},[o,u,s,e,t]),null}function vo(n){wn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function bH({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:r,static:i=!1}){wn(!Xd(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=n.replace(/^\/*/,"/"),o=we.useMemo(()=>({basename:a,navigator:r,static:i,future:{}}),[a,r,i]);typeof t=="string"&&(t=qd(t));let{pathname:l="/",search:u="",hash:d="",state:f=null,key:m="default"}=t,y=we.useMemo(()=>{let b=Do(l,a);return b==null?null:{location:{pathname:b,search:u,hash:d,state:f,key:m},navigationType:s}},[a,l,u,d,f,m,s]);return Ki(y!=null,`<Router basename="${a}"> is not able to match the URL "${l}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:we.createElement(ea.Provider,{value:o},we.createElement(Fm.Provider,{children:e,value:y}))}function xH({children:n,location:e}){return rH(vT(n),e)}function vT(n,e=[]){let t=[];return we.Children.forEach(n,(s,r)=>{if(!we.isValidElement(s))return;let i=[...e,r];if(s.type===we.Fragment){t.push.apply(t,vT(s.props.children,i));return}wn(s.type===vo,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),wn(!s.props.index||!s.props.children,"An index route cannot have child routes.");let a={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=vT(s.props.children,i)),t.push(a)}),t}var t0="get",n0="application/x-www-form-urlencoded";function Cx(n){return n!=null&&typeof n.tagName=="string"}function vH(n){return Cx(n)&&n.tagName.toLowerCase()==="button"}function wH(n){return Cx(n)&&n.tagName.toLowerCase()==="form"}function SH(n){return Cx(n)&&n.tagName.toLowerCase()==="input"}function TH(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function EH(n,e){return n.button===0&&(!e||e==="_self")&&!TH(n)}var Db=null;function _H(){if(Db===null)try{new FormData(document.createElement("form"),0),Db=!1}catch{Db=!0}return Db}var IH=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function DS(n){return n!=null&&!IH.has(n)?(Ki(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${n0}"`),null):n}function $H(n,e){let t,s,r,i,a;if(wH(n)){let o=n.getAttribute("action");s=o?Do(o,e):null,t=n.getAttribute("method")||t0,r=DS(n.getAttribute("enctype"))||n0,i=new FormData(n)}else if(vH(n)||SH(n)&&(n.type==="submit"||n.type==="image")){let o=n.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||o.getAttribute("action");if(s=l?Do(l,e):null,t=n.getAttribute("formmethod")||o.getAttribute("method")||t0,r=DS(n.getAttribute("formenctype"))||DS(o.getAttribute("enctype"))||n0,i=new FormData(o,n),!_H()){let{name:u,type:d,value:f}=n;if(d==="image"){let m=u?`${u}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else u&&i.append(u,f)}}else{if(Cx(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=t0,s=null,r=n0,a=n}return i&&r==="text/plain"&&(a=i,i=void 0),{action:s,method:t.toLowerCase(),encType:r,formData:i,body:a}}function d_(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function CH(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function NH(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function kH(n,e,t){let s=await Promise.all(n.map(async r=>{let i=e.routes[r.route.id];if(i){let a=await CH(i,t);return a.links?a.links():[]}return[]}));return OH(s.flat(1).filter(NH).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function FA(n,e,t,s,r,i){let a=(l,u)=>t[u]?l.route.id!==t[u].route.id:!0,o=(l,u)=>{var d;return t[u].pathname!==l.pathname||((d=t[u].route.path)==null?void 0:d.endsWith("*"))&&t[u].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,u)=>a(l,u)||o(l,u)):i==="data"?e.filter((l,u)=>{var f;let d=s.routes[l.route.id];if(!d||!d.hasLoader)return!1;if(a(l,u)||o(l,u))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((f=t[0])==null?void 0:f.params)||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function AH(n,e,{includeHydrateFallback:t}={}){return RH(n.map(s=>{let r=e.routes[s.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function RH(n){return[...new Set(n)]}function DH(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function OH(n,e){let t=new Set;return new Set(e),n.reduce((s,r)=>{let i=JSON.stringify(DH(r));return t.has(i)||(t.add(i),s.push({key:i,link:r})),s},[])}function FH(n,e){let t=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t.pathname==="/"?t.pathname="_root.data":e&&Do(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function RF(){let n=we.useContext(Kd);return d_(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function LH(){let n=we.useContext($x);return d_(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var f_=we.createContext(void 0);f_.displayName="FrameworkContext";function DF(){let n=we.useContext(f_);return d_(n,"You must render this element inside a <HydratedRouter> element"),n}function PH(n,e){let t=we.useContext(f_),[s,r]=we.useState(!1),[i,a]=we.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=e,m=we.useRef(null);we.useEffect(()=>{if(n==="render"&&a(!0),n==="viewport"){let w=T=>{T.forEach(E=>{a(E.isIntersecting)})},x=new IntersectionObserver(w,{threshold:.5});return m.current&&x.observe(m.current),()=>{x.disconnect()}}},[n]),we.useEffect(()=>{if(s){let w=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(w)}}},[s]);let y=()=>{r(!0)},b=()=>{r(!1),a(!1)};return t?n!=="intent"?[i,m,{}]:[i,m,{onFocus:Cp(o,y),onBlur:Cp(l,b),onMouseEnter:Cp(u,y),onMouseLeave:Cp(d,b),onTouchStart:Cp(f,y)}]:[!1,m,{}]}function Cp(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function MH({page:n,...e}){let{router:t}=RF(),s=we.useMemo(()=>TF(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?we.createElement(BH,{page:n,matches:s,...e}):null}function VH(n){let{manifest:e,routeModules:t}=DF(),[s,r]=we.useState([]);return we.useEffect(()=>{let i=!1;return kH(n,e,t).then(a=>{i||r(a)}),()=>{i=!0}},[n,e,t]),s}function BH({page:n,matches:e,...t}){let s=Ga(),{manifest:r,routeModules:i}=DF(),{basename:a}=RF(),{loaderData:o,matches:l}=LH(),u=we.useMemo(()=>FA(n,e,l,r,s,"data"),[n,e,l,r,s]),d=we.useMemo(()=>FA(n,e,l,r,s,"assets"),[n,e,l,r,s]),f=we.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let b=new Set,w=!1;if(e.forEach(T=>{var $;let E=r.routes[T.route.id];!E||!E.hasLoader||(!u.some(C=>C.route.id===T.route.id)&&T.route.id in o&&(($=i[T.route.id])!=null&&$.shouldRevalidate)||E.hasClientLoader?w=!0:b.add(T.route.id))}),b.size===0)return[];let x=FH(n,a);return w&&b.size>0&&x.searchParams.set("_routes",e.filter(T=>b.has(T.route.id)).map(T=>T.route.id).join(",")),[x.pathname+x.search]},[a,o,s,r,u,e,n,i]),m=we.useMemo(()=>AH(d,r),[d,r]),y=VH(d);return we.createElement(we.Fragment,null,f.map(b=>we.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...t})),m.map(b=>we.createElement("link",{key:b,rel:"modulepreload",href:b,...t})),y.map(({key:b,link:w})=>we.createElement("link",{key:b,...w})))}function zH(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var OF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{OF&&(window.__reactRouterVersion="7.4.0")}catch{}function UH({basename:n,children:e,window:t}){let s=we.useRef();s.current==null&&(s.current=kG({window:t,v5Compat:!0}));let r=s.current,[i,a]=we.useState({action:r.action,location:r.location}),o=we.useCallback(l=>{we.startTransition(()=>a(l))},[a]);return we.useLayoutEffect(()=>r.listen(o),[r,o]),we.createElement(bH,{basename:n,children:e,location:i.location,navigationType:i.action,navigator:r})}var FF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,p_=we.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:r,reloadDocument:i,replace:a,state:o,target:l,to:u,preventScrollReset:d,viewTransition:f,...m},y){let{basename:b}=we.useContext(ea),w=typeof u=="string"&&FF.test(u),x,T=!1;if(typeof u=="string"&&w&&(x=u,OF))try{let N=new URL(window.location.href),D=u.startsWith("//")?new URL(N.protocol+u):new URL(u),k=Do(D.pathname,b);D.origin===N.origin&&k!=null?u=k+D.search+D.hash:T=!0}catch{Ki(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=nH(u,{relative:r}),[$,C,O]=PH(s,m),V=HH(u,{replace:a,state:o,target:l,preventScrollReset:d,relative:r,viewTransition:f});function F(N){e&&e(N),N.defaultPrevented||V(N)}let R=we.createElement("a",{...m,...O,href:x||E,onClick:T||i?e:F,ref:zH(y,C),target:l,"data-discover":!w&&t==="render"?"true":void 0});return $&&!w?we.createElement(we.Fragment,null,R,we.createElement(MH,{page:E})):R});p_.displayName="Link";var jH=we.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:r=!1,style:i,to:a,viewTransition:o,children:l,...u},d){let f=Lm(a,{relative:u.relative}),m=Ga(),y=we.useContext($x),{navigator:b,basename:w}=we.useContext(ea),x=y!=null&&QH(f)&&o===!0,T=b.encodeLocation?b.encodeLocation(f).pathname:f.pathname,E=m.pathname,$=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;t||(E=E.toLowerCase(),$=$?$.toLowerCase():null,T=T.toLowerCase()),$&&w&&($=Do($,w)||$);const C=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let O=E===T||!r&&E.startsWith(T)&&E.charAt(C)==="/",V=$!=null&&($===T||!r&&$.startsWith(T)&&$.charAt(T.length)==="/"),F={isActive:O,isPending:V,isTransitioning:x},R=O?e:void 0,N;typeof s=="function"?N=s(F):N=[s,O?"active":null,V?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let D=typeof i=="function"?i(F):i;return we.createElement(p_,{...u,"aria-current":R,className:N,ref:d,style:D,to:a,viewTransition:o},typeof l=="function"?l(F):l)});jH.displayName="NavLink";var WH=we.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:r,state:i,method:a=t0,action:o,onSubmit:l,relative:u,preventScrollReset:d,viewTransition:f,...m},y)=>{let b=XH(),w=YH(o,{relative:u}),x=a.toLowerCase()==="get"?"get":"post",T=typeof o=="string"&&FF.test(o),E=$=>{if(l&&l($),$.defaultPrevented)return;$.preventDefault();let C=$.nativeEvent.submitter,O=(C==null?void 0:C.getAttribute("formmethod"))||a;b(C||$.currentTarget,{fetcherKey:e,method:O,navigate:t,replace:r,state:i,relative:u,preventScrollReset:d,viewTransition:f})};return we.createElement("form",{ref:y,method:x,action:w,onSubmit:s?l:E,...m,"data-discover":!T&&n==="render"?"true":void 0})});WH.displayName="Form";function GH(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function LF(n){let e=we.useContext(Kd);return wn(e,GH(n)),e}function HH(n,{target:e,replace:t,state:s,preventScrollReset:r,relative:i,viewTransition:a}={}){let o=Yd(),l=Ga(),u=Lm(n,{relative:i});return we.useCallback(d=>{if(EH(d,e)){d.preventDefault();let f=t!==void 0?t:lm(l)===lm(u);o(n,{replace:f,state:s,preventScrollReset:r,relative:i,viewTransition:a})}},[l,o,u,t,s,e,n,r,i,a])}var qH=0,KH=()=>`__${String(++qH)}__`;function XH(){let{router:n}=LF("useSubmit"),{basename:e}=we.useContext(ea),t=fH();return we.useCallback(async(s,r={})=>{let{action:i,method:a,encType:o,formData:l,body:u}=$H(s,e);if(r.navigate===!1){let d=r.fetcherKey||KH();await n.fetch(d,t,r.action||i,{preventScrollReset:r.preventScrollReset,formData:l,body:u,formMethod:r.method||a,formEncType:r.encType||o,flushSync:r.flushSync})}else await n.navigate(r.action||i,{preventScrollReset:r.preventScrollReset,formData:l,body:u,formMethod:r.method||a,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[n,e,t])}function YH(n,{relative:e}={}){let{basename:t}=we.useContext(ea),s=we.useContext(Wa);wn(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),i={...Lm(n||".",{relative:e})},a=Ga();if(n==null){i.search=a.search;let o=new URLSearchParams(i.search),l=o.getAll("index");if(l.some(d=>d==="")){o.delete("index"),l.filter(f=>f).forEach(f=>o.append("index",f));let d=o.toString();i.search=d?`?${d}`:""}}return(!n||n===".")&&r.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:No([t,i.pathname])),lm(i)}function QH(n,e={}){let t=we.useContext($F);wn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=LF("useViewTransitionState"),r=Lm(n,{relative:e.relative});if(!t.isTransitioning)return!1;let i=Do(t.currentLocation.pathname,s)||t.currentLocation.pathname,a=Do(t.nextLocation.pathname,s)||t.nextLocation.pathname;return _0(r.pathname,a)!=null||_0(r.pathname,i)!=null}new TextEncoder;var LA={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PF=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},ZH=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=n[t++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=n[t++],a=n[t++],o=n[t++],l=((r&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|a&63)}}return e.join("")},MF={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const i=n[r],a=r+1<n.length,o=a?n[r+1]:0,l=r+2<n.length,u=l?n[r+2]:0,d=i>>2,f=(i&3)<<4|o>>4;let m=(o&15)<<2|u>>6,y=u&63;l||(y=64,a||(m=64)),s.push(t[d],t[f],t[m],t[y])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(PF(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ZH(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const i=t[n.charAt(r++)],o=r<n.length?t[n.charAt(r)]:0;++r;const u=r<n.length?t[n.charAt(r)]:64;++r;const f=r<n.length?t[n.charAt(r)]:64;if(++r,i==null||o==null||u==null||f==null)throw new JH;const m=i<<2|o>>4;if(s.push(m),u!==64){const y=o<<4&240|u>>2;if(s.push(y),f!==64){const b=u<<6&192|f;s.push(b)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class JH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const e6=function(n){const e=PF(n);return MF.encodeByteArray(e,!0)},I0=function(n){return e6(n).replace(/\./g,"")},VF=function(n){try{return MF.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t6(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n6=()=>t6().__FIREBASE_DEFAULTS__,s6=()=>{if(typeof process>"u"||typeof LA>"u")return;const n=LA.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},r6=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&VF(n[1]);return e&&JSON.parse(e)},Nx=()=>{try{return n6()||s6()||r6()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},BF=n=>{var e,t;return(t=(e=Nx())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},i6=n=>{const e=BF(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},zF=()=>{var n;return(n=Nx())===null||n===void 0?void 0:n.config},UF=n=>{var e;return(e=Nx())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o6(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[I0(JSON.stringify(t)),I0(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function l6(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(lr())}function c6(){var n;const e=(n=Nx())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function u6(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function h6(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function d6(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function f6(){const n=lr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function p6(){return!c6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function m6(){try{return typeof indexedDB=="object"}catch{return!1}}function g6(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y6="FirebaseError";class Wo extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=y6,Object.setPrototypeOf(this,Wo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pm.prototype.create)}}class Pm{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],a=i?b6(i,s):"Error",o=`${this.serviceName}: ${a} (${r}).`;return new Wo(r,o,s)}}function b6(n,e){return n.replace(x6,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const x6=/\{\$([^}]+)}/g;function v6(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function $0(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const i=n[r],a=e[r];if(PA(i)&&PA(a)){if(!$0(i,a))return!1}else if(i!==a)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function PA(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mm(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Mp(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function Vp(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function w6(n,e){const t=new S6(n,e);return t.subscribe.bind(t)}class S6{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let r;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");T6(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:s},r.next===void 0&&(r.next=OS),r.error===void 0&&(r.error=OS),r.complete===void 0&&(r.complete=OS);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function T6(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function OS(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(n){return n&&n._delegate?n._delegate:n}class _u{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lu="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new a6;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(I6(e))try{this.getOrInitializeService({instanceIdentifier:lu})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=lu){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=lu){return this.instances.has(e)}getOptions(e=lu){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);s===o&&a.resolve(r)}return r}onInit(e,t){var s;const r=this.normalizeInstanceIdentifier(t),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:_6(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=lu){return this.component?this.component.multipleInstances?e:lu:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _6(n){return n===lu?void 0:n}function I6(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new E6(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _t;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(_t||(_t={}));const C6={debug:_t.DEBUG,verbose:_t.VERBOSE,info:_t.INFO,warn:_t.WARN,error:_t.ERROR,silent:_t.SILENT},N6=_t.INFO,k6={[_t.DEBUG]:"log",[_t.VERBOSE]:"log",[_t.INFO]:"info",[_t.WARN]:"warn",[_t.ERROR]:"error"},A6=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=k6[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let m_=class{constructor(e){this.name=e,this._logLevel=N6,this._logHandler=A6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?C6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,_t.DEBUG,...e),this._logHandler(this,_t.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,_t.VERBOSE,...e),this._logHandler(this,_t.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,_t.INFO,...e),this._logHandler(this,_t.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,_t.WARN,...e),this._logHandler(this,_t.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,_t.ERROR,...e),this._logHandler(this,_t.ERROR,...e)}};const R6=(n,e)=>e.some(t=>n instanceof t);let MA,VA;function D6(){return MA||(MA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function O6(){return VA||(VA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jF=new WeakMap,wT=new WeakMap,WF=new WeakMap,FS=new WeakMap,g_=new WeakMap;function F6(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(ql(n.result)),r()},a=()=>{s(n.error),r()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&jF.set(t,n)}).catch(()=>{}),g_.set(e,n),e}function L6(n){if(wT.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),r()},a=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});wT.set(n,e)}let ST={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return wT.get(n);if(e==="objectStoreNames")return n.objectStoreNames||WF.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ql(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function P6(n){ST=n(ST)}function M6(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(LS(this),e,...t);return WF.set(s,e.sort?e.sort():[e]),ql(s)}:O6().includes(n)?function(...e){return n.apply(LS(this),e),ql(jF.get(this))}:function(...e){return ql(n.apply(LS(this),e))}}function V6(n){return typeof n=="function"?M6(n):(n instanceof IDBTransaction&&L6(n),R6(n,D6())?new Proxy(n,ST):n)}function ql(n){if(n instanceof IDBRequest)return F6(n);if(FS.has(n))return FS.get(n);const e=V6(n);return e!==n&&(FS.set(n,e),g_.set(e,n)),e}const LS=n=>g_.get(n);function B6(n,e,{blocked:t,upgrade:s,blocking:r,terminated:i}={}){const a=indexedDB.open(n,e),o=ql(a);return s&&a.addEventListener("upgradeneeded",l=>{s(ql(a.result),l.oldVersion,l.newVersion,ql(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),r&&l.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const z6=["get","getKey","getAll","getAllKeys","count"],U6=["put","add","delete","clear"],PS=new Map;function BA(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(PS.get(e))return PS.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=U6.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||z6.includes(t)))return;const i=async function(a,...o){const l=this.transaction(a,r?"readwrite":"readonly");let u=l.store;return s&&(u=u.index(o.shift())),(await Promise.all([u[t](...o),r&&l.done]))[0]};return PS.set(e,i),i}P6(n=>({...n,get:(e,t,s)=>BA(e,t)||n.get(e,t,s),has:(e,t)=>!!BA(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(W6(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function W6(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const TT="@firebase/app",zA="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo=new m_("@firebase/app"),G6="@firebase/app-compat",H6="@firebase/analytics-compat",q6="@firebase/analytics",K6="@firebase/app-check-compat",X6="@firebase/app-check",Y6="@firebase/auth",Q6="@firebase/auth-compat",Z6="@firebase/database",J6="@firebase/data-connect",eq="@firebase/database-compat",tq="@firebase/functions",nq="@firebase/functions-compat",sq="@firebase/installations",rq="@firebase/installations-compat",iq="@firebase/messaging",aq="@firebase/messaging-compat",oq="@firebase/performance",lq="@firebase/performance-compat",cq="@firebase/remote-config",uq="@firebase/remote-config-compat",hq="@firebase/storage",dq="@firebase/storage-compat",fq="@firebase/firestore",pq="@firebase/vertexai-preview",mq="@firebase/firestore-compat",gq="firebase",yq="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="[DEFAULT]",bq={[TT]:"fire-core",[G6]:"fire-core-compat",[q6]:"fire-analytics",[H6]:"fire-analytics-compat",[X6]:"fire-app-check",[K6]:"fire-app-check-compat",[Y6]:"fire-auth",[Q6]:"fire-auth-compat",[Z6]:"fire-rtdb",[J6]:"fire-data-connect",[eq]:"fire-rtdb-compat",[tq]:"fire-fn",[nq]:"fire-fn-compat",[sq]:"fire-iid",[rq]:"fire-iid-compat",[iq]:"fire-fcm",[aq]:"fire-fcm-compat",[oq]:"fire-perf",[lq]:"fire-perf-compat",[cq]:"fire-rc",[uq]:"fire-rc-compat",[hq]:"fire-gcs",[dq]:"fire-gcs-compat",[fq]:"fire-fst",[mq]:"fire-fst-compat",[pq]:"fire-vertex","fire-js":"fire-js",[gq]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0=new Map,xq=new Map,_T=new Map;function UA(n,e){try{n.container.addComponent(e)}catch(t){Oo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ed(n){const e=n.name;if(_T.has(e))return Oo.debug(`There were multiple attempts to register component ${e}.`),!1;_T.set(e,n);for(const t of C0.values())UA(t,n);for(const t of xq.values())UA(t,n);return!0}function y_(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ia(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vq={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Kl=new Pm("app","Firebase",vq);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wq{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new _u("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Kl.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd=yq;function b_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:ET,automaticDataCollectionEnabled:!1},e),r=s.name;if(typeof r!="string"||!r)throw Kl.create("bad-app-name",{appName:String(r)});if(t||(t=zF()),!t)throw Kl.create("no-options");const i=C0.get(r);if(i){if($0(t,i.options)&&$0(s,i.config))return i;throw Kl.create("duplicate-app",{appName:r})}const a=new $6(r);for(const l of _T.values())a.addComponent(l);const o=new wq(t,s,a);return C0.set(r,o),o}function GF(n=ET){const e=C0.get(n);if(!e&&n===ET&&zF())return b_();if(!e)throw Kl.create("no-app",{appName:n});return e}function Xl(n,e,t){var s;let r=(s=bq[n])!==null&&s!==void 0?s:n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Oo.warn(o.join(" "));return}Ed(new _u(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sq="firebase-heartbeat-database",Tq=1,cm="firebase-heartbeat-store";let MS=null;function HF(){return MS||(MS=B6(Sq,Tq,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(cm)}catch(t){console.warn(t)}}}}).catch(n=>{throw Kl.create("idb-open",{originalErrorMessage:n.message})})),MS}async function Eq(n){try{const t=(await HF()).transaction(cm),s=await t.objectStore(cm).get(qF(n));return await t.done,s}catch(e){if(e instanceof Wo)Oo.warn(e.message);else{const t=Kl.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Oo.warn(t.message)}}}async function jA(n,e){try{const s=(await HF()).transaction(cm,"readwrite");await s.objectStore(cm).put(e,qF(n)),await s.done}catch(t){if(t instanceof Wo)Oo.warn(t.message);else{const s=Kl.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Oo.warn(s.message)}}}function qF(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _q=1024,Iq=30*24*60*60*1e3;class $q{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Nq(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=WA();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=Iq}),this._storage.overwrite(this._heartbeatsCache))}catch(s){Oo.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=WA(),{heartbeatsToSend:s,unsentEntries:r}=Cq(this._heartbeatsCache.heartbeats),i=I0(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Oo.warn(t),""}}}function WA(){return new Date().toISOString().substring(0,10)}function Cq(n,e=_q){const t=[];let s=n.slice();for(const r of n){const i=t.find(a=>a.agent===r.agent);if(i){if(i.dates.push(r.date),GA(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),GA(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class Nq{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return m6()?g6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Eq(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return jA(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return jA(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function GA(n){return I0(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kq(n){Ed(new _u("platform-logger",e=>new j6(e),"PRIVATE")),Ed(new _u("heartbeat",e=>new $q(e),"PRIVATE")),Xl(TT,zA,n),Xl(TT,zA,"esm2017"),Xl("fire-js","")}kq("");function x_(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t}function KF(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Aq=KF,XF=new Pm("auth","Firebase",KF());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0=new m_("@firebase/auth");function Rq(n,...e){N0.logLevel<=_t.WARN&&N0.warn(`Auth (${Qd}): ${n}`,...e)}function s0(n,...e){N0.logLevel<=_t.ERROR&&N0.error(`Auth (${Qd}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(n,...e){throw v_(n,...e)}function Ca(n,...e){return v_(n,...e)}function YF(n,e,t){const s=Object.assign(Object.assign({},Aq()),{[e]:t});return new Pm("auth","Firebase",s).create(e,{appName:n.name})}function ko(n){return YF(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function v_(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return XF.create(n,...e)}function it(n,e,...t){if(!n)throw v_(e,...t)}function _o(n){const e="INTERNAL ASSERTION FAILED: "+n;throw s0(e),new Error(e)}function Fo(n,e){n||_o(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IT(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Dq(){return HA()==="http:"||HA()==="https:"}function HA(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oq(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Dq()||h6()||"connection"in navigator)?navigator.onLine:!0}function Fq(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(e,t){this.shortDelay=e,this.longDelay=t,Fo(t>e,"Short delay should be less than long delay!"),this.isMobile=l6()||d6()}get(){return Oq()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w_(n,e){Fo(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;_o("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;_o("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;_o("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pq=new Vm(3e4,6e4);function dc(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function fc(n,e,t,s,r={}){return ZF(n,r,async()=>{let i={},a={};s&&(e==="GET"?a=s:i={body:JSON.stringify(s)});const o=Mm(Object.assign({key:n.config.apiKey},a)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u=Object.assign({method:e,headers:l},i);return u6()||(u.referrerPolicy="no-referrer"),QF.fetch()(JF(n,n.config.apiHost,t,o),u)})}async function ZF(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},Lq),e);try{const r=new Vq(n),i=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Ob(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ob(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Ob(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw Ob(n,"user-disabled",a);const d=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw YF(n,d,u);Xi(n,d)}}catch(r){if(r instanceof Wo)throw r;Xi(n,"network-request-failed",{message:String(r)})}}async function Bm(n,e,t,s,r={}){const i=await fc(n,e,t,s,r);return"mfaPendingCredential"in i&&Xi(n,"multi-factor-auth-required",{_serverResponse:i}),i}function JF(n,e,t,s){const r=`${e}${t}?${s}`;return n.config.emulator?w_(n.config,r):`${n.config.apiScheme}://${r}`}function Mq(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Vq{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(Ca(this.auth,"network-request-failed")),Pq.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ob(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const r=Ca(n,e,s);return r.customData._tokenResponse=t,r}function qA(n){return n!==void 0&&n.enterprise!==void 0}class Bq{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Mq(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function zq(n,e){return fc(n,"GET","/v2/recaptchaConfig",dc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uq(n,e){return fc(n,"POST","/v1/accounts:delete",e)}async function eL(n,e){return fc(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zp(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function jq(n,e=!1){const t=Xr(n),s=await t.getIdToken(e),r=S_(s);it(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:Zp(VS(r.auth_time)),issuedAtTime:Zp(VS(r.iat)),expirationTime:Zp(VS(r.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function VS(n){return Number(n)*1e3}function S_(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return s0("JWT malformed, contained fewer than 3 sections"),null;try{const r=VF(t);return r?JSON.parse(r):(s0("Failed to decode base64 JWT payload"),null)}catch(r){return s0("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function KA(n){const e=S_(n);return it(e,"internal-error"),it(typeof e.exp<"u","internal-error"),it(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function um(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof Wo&&Wq(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function Wq({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gq{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zp(this.lastLoginAt),this.creationTime=Zp(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k0(n){var e;const t=n.auth,s=await n.getIdToken(),r=await um(n,eL(t,{idToken:s}));it(r==null?void 0:r.users.length,t,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?tL(i.providerUserInfo):[],o=qq(n.providerData,a),l=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!(o!=null&&o.length),d=l?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new $T(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function Hq(n){const e=Xr(n);await k0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qq(n,e){return[...n.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function tL(n){return n.map(e=>{var{providerId:t}=e,s=x_(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kq(n,e){const t=await ZF(n,{},async()=>{const s=Mm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=n.config,a=JF(n,r,"/v1/token",`key=${i}`),o=await n._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",QF.fetch()(a,{method:"POST",headers:o,body:s})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Xq(n,e){return fc(n,"POST","/v2/accounts:revokeToken",dc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){it(e.idToken,"internal-error"),it(typeof e.idToken<"u","internal-error"),it(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):KA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){it(e.length!==0,"internal-error");const t=KA(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(it(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:r,expiresIn:i}=await Kq(e,t);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:r,expirationTime:i}=t,a=new ld;return s&&(it(typeof s=="string","internal-error",{appName:e}),a.refreshToken=s),r&&(it(typeof r=="string","internal-error",{appName:e}),a.accessToken=r),i&&(it(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ld,this.toJSON())}_performRefresh(){return _o("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Al(n,e){it(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Io{constructor(e){var{uid:t,auth:s,stsTokenManager:r}=e,i=x_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Gq(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new $T(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await um(this,this.stsTokenManager.getToken(this.auth,e));return it(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return jq(this,e)}reload(){return Hq(this)}_assign(e){this!==e&&(it(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Io(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){it(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await k0(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ia(this.auth.app))return Promise.reject(ko(this.auth));const e=await this.getIdToken();return await um(this,Uq(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,r,i,a,o,l,u,d;const f=(s=t.displayName)!==null&&s!==void 0?s:void 0,m=(r=t.email)!==null&&r!==void 0?r:void 0,y=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,b=(a=t.photoURL)!==null&&a!==void 0?a:void 0,w=(o=t.tenantId)!==null&&o!==void 0?o:void 0,x=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,T=(u=t.createdAt)!==null&&u!==void 0?u:void 0,E=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:$,emailVerified:C,isAnonymous:O,providerData:V,stsTokenManager:F}=t;it($&&F,e,"internal-error");const R=ld.fromJSON(this.name,F);it(typeof $=="string",e,"internal-error"),Al(f,e.name),Al(m,e.name),it(typeof C=="boolean",e,"internal-error"),it(typeof O=="boolean",e,"internal-error"),Al(y,e.name),Al(b,e.name),Al(w,e.name),Al(x,e.name),Al(T,e.name),Al(E,e.name);const N=new Io({uid:$,auth:e,email:m,emailVerified:C,displayName:f,isAnonymous:O,photoURL:b,phoneNumber:y,tenantId:w,stsTokenManager:R,createdAt:T,lastLoginAt:E});return V&&Array.isArray(V)&&(N.providerData=V.map(D=>Object.assign({},D))),x&&(N._redirectEventId=x),N}static async _fromIdTokenResponse(e,t,s=!1){const r=new ld;r.updateFromServerResponse(t);const i=new Io({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await k0(i),i}static async _fromGetAccountInfoResponse(e,t,s){const r=t.users[0];it(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?tL(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!(i!=null&&i.length),o=new ld;o.updateFromIdToken(s);const l=new Io({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new $T(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XA=new Map;function $o(n){Fo(n instanceof Function,"Expected a class definition");let e=XA.get(n);return e?(Fo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,XA.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}nL.type="NONE";const YA=nL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0(n,e,t){return`firebase:${n}:${e}:${t}`}class cd{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=r0(this.userKey,r.apiKey,i),this.fullPersistenceKey=r0("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Io._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new cd($o(YA),e,s);const r=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=r[0]||$o(YA);const a=r0(s,e.config.apiKey,e.name);let o=null;for(const u of t)try{const d=await u._get(a);if(d){const f=Io._fromJSON(e,d);u!==i&&(o=f),i=u;break}}catch{}const l=r.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new cd(i,e,s):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(t.map(async u=>{if(u!==i)try{await u._remove(a)}catch{}})),new cd(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(aL(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(sL(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(lL(e))return"Blackberry";if(cL(e))return"Webos";if(rL(e))return"Safari";if((e.includes("chrome/")||iL(e))&&!e.includes("edge/"))return"Chrome";if(oL(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function sL(n=lr()){return/firefox\//i.test(n)}function rL(n=lr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function iL(n=lr()){return/crios\//i.test(n)}function aL(n=lr()){return/iemobile/i.test(n)}function oL(n=lr()){return/android/i.test(n)}function lL(n=lr()){return/blackberry/i.test(n)}function cL(n=lr()){return/webos/i.test(n)}function T_(n=lr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Yq(n=lr()){var e;return T_(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Qq(){return f6()&&document.documentMode===10}function uL(n=lr()){return T_(n)||oL(n)||cL(n)||lL(n)||/windows phone/i.test(n)||aL(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hL(n,e=[]){let t;switch(n){case"Browser":t=QA(lr());break;case"Worker":t=`${QA(lr())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Qd}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zq{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});s.onAbort=t,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jq(n,e={}){return fc(n,"GET","/v2/passwordPolicy",dc(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e5=6;class t5{constructor(e){var t,s,r,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:e5,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,r,i,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(s=l.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n5{constructor(e,t,s,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ZA(this),this.idTokenSubscription=new ZA(this),this.beforeStateQueue=new Zq(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=XF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=$o(t)),this._initializationPromise=this.queue(async()=>{var s,r;if(!this._deleted&&(this.persistenceManager=await cd.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await eL(this,{idToken:e}),s=await Io._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ia(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let r=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,o=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return it(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await k0(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Fq()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ia(this.app))return Promise.reject(ko(this));const t=e?Xr(e):null;return t&&it(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&it(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ia(this.app)?Promise.reject(ko(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ia(this.app)?Promise.reject(ko(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($o(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Jq(this),t=new t5(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Pm("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await Xq(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&$o(e)||this._popupRedirectResolver;it(t,this,"argument-error"),this.redirectPersistenceManager=await cd.create(this,[$o(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,r){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(it(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,s,r);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return it(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hL(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&Rq(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Qu(n){return Xr(n)}class ZA{constructor(e){this.auth=e,this.observer=null,this.addObserver=w6(t=>this.observer=t)}get next(){return it(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function s5(n){kx=n}function dL(n){return kx.loadJS(n)}function r5(){return kx.recaptchaEnterpriseScript}function i5(){return kx.gapiScript}function a5(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const o5="recaptcha-enterprise",l5="NO_RECAPTCHA";class c5{constructor(e){this.type=o5,this.auth=Qu(e)}async verify(e="verify",t=!1){async function s(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,o)=>{zq(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new Bq(l);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,a(u.siteKey)}}).catch(l=>{o(l)})})}function r(i,a,o){const l=window.grecaptcha;qA(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(u=>{a(u)}).catch(()=>{a(l5)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,a)=>{s(this.auth).then(o=>{if(!t&&qA(window.grecaptcha))r(o,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=r5();l.length!==0&&(l+=o),dL(l).then(()=>{r(o,i,a)}).catch(u=>{a(u)})}}).catch(o=>{a(o)})})}}async function JA(n,e,t,s=!1){const r=new c5(n);let i;try{i=await r.verify(t)}catch{i=await r.verify(t,!0)}const a=Object.assign({},e);return s?Object.assign(a,{captchaResp:i}):Object.assign(a,{captchaResponse:i}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function CT(n,e,t,s){var r;if(!((r=n._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await JA(n,e,t,t==="getOobCode");return s(n,i)}else return s(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await JA(n,e,t,t==="getOobCode");return s(n,a)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u5(n,e){const t=y_(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),i=t.getOptions();if($0(i,e??{}))return r;Xi(r,"already-initialized")}return t.initialize({options:e})}function h5(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map($o);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function d5(n,e,t){const s=Qu(n);it(s._canInitEmulator,s,"emulator-config-failed"),it(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=fL(e),{host:a,port:o}=f5(e),l=o===null?"":`:${o}`;s.config.emulator={url:`${i}//${a}${l}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})}),p5()}function fL(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function f5(n){const e=fL(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:eR(s.substr(i.length+1))}}else{const[i,a]=s.split(":");return{host:i,port:eR(a)}}}function eR(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function p5(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return _o("not implemented")}_getIdTokenResponse(e){return _o("not implemented")}_linkToIdToken(e,t){return _o("not implemented")}_getReauthenticationResolver(e){return _o("not implemented")}}async function m5(n,e){return fc(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g5(n,e){return Bm(n,"POST","/v1/accounts:signInWithPassword",dc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y5(n,e){return Bm(n,"POST","/v1/accounts:signInWithEmailLink",dc(n,e))}async function b5(n,e){return Bm(n,"POST","/v1/accounts:signInWithEmailLink",dc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm extends E_{constructor(e,t,s,r=null){super("password",s),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new hm(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new hm(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return CT(e,t,"signInWithPassword",g5);case"emailLink":return y5(e,{email:this._email,oobCode:this._password});default:Xi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return CT(e,s,"signUpPassword",m5);case"emailLink":return b5(e,{idToken:t,email:this._email,oobCode:this._password});default:Xi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ud(n,e){return Bm(n,"POST","/v1/accounts:signInWithIdp",dc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x5="http://localhost";class Iu extends E_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Iu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Xi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r}=t,i=x_(t,["providerId","signInMethod"]);if(!s||!r)return null;const a=new Iu(s,r);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return ud(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,ud(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ud(e,t)}buildRequest(){const e={requestUri:x5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Mm(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v5(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function w5(n){const e=Mp(Vp(n)).link,t=e?Mp(Vp(e)).deep_link_id:null,s=Mp(Vp(n)).deep_link_id;return(s?Mp(Vp(s)).link:null)||s||t||e||n}class __{constructor(e){var t,s,r,i,a,o;const l=Mp(Vp(e)),u=(t=l.apiKey)!==null&&t!==void 0?t:null,d=(s=l.oobCode)!==null&&s!==void 0?s:null,f=v5((r=l.mode)!==null&&r!==void 0?r:null);it(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const t=w5(e);try{return new __(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(){this.providerId=Zd.PROVIDER_ID}static credential(e,t){return hm._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=__.parseLink(t);return it(s,"argument-error"),hm._fromEmailAndCode(e,s.code,s.tenantId)}}Zd.PROVIDER_ID="password";Zd.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Zd.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm extends pL{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol extends zm{constructor(){super("facebook.com")}static credential(e){return Iu._fromParams({providerId:Ol.PROVIDER_ID,signInMethod:Ol.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ol.credentialFromTaggedObject(e)}static credentialFromError(e){return Ol.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ol.credential(e.oauthAccessToken)}catch{return null}}}Ol.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ol.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl extends zm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Iu._fromParams({providerId:Fl.PROVIDER_ID,signInMethod:Fl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fl.credentialFromTaggedObject(e)}static credentialFromError(e){return Fl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Fl.credential(t,s)}catch{return null}}}Fl.GOOGLE_SIGN_IN_METHOD="google.com";Fl.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll extends zm{constructor(){super("github.com")}static credential(e){return Iu._fromParams({providerId:Ll.PROVIDER_ID,signInMethod:Ll.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ll.credentialFromTaggedObject(e)}static credentialFromError(e){return Ll.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ll.credential(e.oauthAccessToken)}catch{return null}}}Ll.GITHUB_SIGN_IN_METHOD="github.com";Ll.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl extends zm{constructor(){super("twitter.com")}static credential(e,t){return Iu._fromParams({providerId:Pl.PROVIDER_ID,signInMethod:Pl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Pl.credentialFromTaggedObject(e)}static credentialFromError(e){return Pl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Pl.credential(t,s)}catch{return null}}}Pl.TWITTER_SIGN_IN_METHOD="twitter.com";Pl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S5(n,e){return Bm(n,"POST","/v1/accounts:signUp",dc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,r=!1){const i=await Io._fromIdTokenResponse(e,s,r),a=tR(s);return new $u({user:i,providerId:a,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const r=tR(s);return new $u({user:e,providerId:r,_tokenResponse:s,operationType:t})}}function tR(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0 extends Wo{constructor(e,t,s,r){var i;super(t.code,t.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,A0.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,r){return new A0(e,t,s,r)}}function mL(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?A0._fromErrorAndOperation(n,i,e,s):i})}async function T5(n,e,t=!1){const s=await um(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return $u._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E5(n,e,t=!1){const{auth:s}=n;if(Ia(s.app))return Promise.reject(ko(s));const r="reauthenticate";try{const i=await um(n,mL(s,r,e,n),t);it(i.idToken,s,"internal-error");const a=S_(i.idToken);it(a,s,"internal-error");const{sub:o}=a;return it(n.uid===o,s,"user-mismatch"),$u._forOperation(n,r,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Xi(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gL(n,e,t=!1){if(Ia(n.app))return Promise.reject(ko(n));const s="signIn",r=await mL(n,s,e),i=await $u._fromIdTokenResponse(n,s,r);return t||await n._updateCurrentUser(i.user),i}async function _5(n,e){return gL(Qu(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yL(n){const e=Qu(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function I5(n,e,t){if(Ia(n.app))return Promise.reject(ko(n));const s=Qu(n),a=await CT(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",S5).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&yL(n),l}),o=await $u._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(o.user),o}function $5(n,e,t){return Ia(n.app)?Promise.reject(ko(n)):_5(Xr(n),Zd.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&yL(n),s})}function C5(n,e,t,s){return Xr(n).onIdTokenChanged(e,t,s)}function N5(n,e,t){return Xr(n).beforeAuthStateChanged(e,t)}function k5(n,e,t,s){return Xr(n).onAuthStateChanged(e,t,s)}function A5(n){return Xr(n).signOut()}const R0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(R0,"1"),this.storage.removeItem(R0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R5=1e3,D5=10;class xL extends bL{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=uL(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),r=this.localCache[t];s!==r&&e(t,r,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const s=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const a=this.storage.getItem(s);!t&&this.localCache[s]===a||this.notifyListeners(s,a)},i=this.storage.getItem(s);Qq()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,D5):r()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},R5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xL.type="LOCAL";const O5=xL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL extends bL{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}vL.type="SESSION";const wL=vL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F5(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const s=new Ax(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:r,data:i}=t.data,a=this.handlersMap[r];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const o=Array.from(a).map(async u=>u(t.origin,i)),l=await F5(o);t.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ax.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I_(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const u=I_("",20);r.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},s);a={messageChannel:r,onMessage(f){const m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(m.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Na(){return window}function P5(n){Na().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(){return typeof Na().WorkerGlobalScope<"u"&&typeof Na().importScripts=="function"}async function M5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function V5(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function B5(){return SL()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TL="firebaseLocalStorageDb",z5=1,D0="firebaseLocalStorage",EL="fbase_key";class Um{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Rx(n,e){return n.transaction([D0],e?"readwrite":"readonly").objectStore(D0)}function U5(){const n=indexedDB.deleteDatabase(TL);return new Um(n).toPromise()}function NT(){const n=indexedDB.open(TL,z5);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(D0,{keyPath:EL})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(D0)?e(s):(s.close(),await U5(),e(await NT()))})})}async function nR(n,e,t){const s=Rx(n,!0).put({[EL]:e,value:t});return new Um(s).toPromise()}async function j5(n,e){const t=Rx(n,!1).get(e),s=await new Um(t).toPromise();return s===void 0?null:s.value}function sR(n,e){const t=Rx(n,!0).delete(e);return new Um(t).toPromise()}const W5=800,G5=3;class _L{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await NT(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>G5)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return SL()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ax._getInstance(B5()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await M5(),!this.activeServiceWorker)return;this.sender=new L5(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||V5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await NT();return await nR(e,R0,"1"),await sR(e,R0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>nR(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>j5(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>sR(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=Rx(r,!1).getAll();return new Um(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),W5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}_L.type="LOCAL";const H5=_L;new Vm(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q5(n,e){return e?$o(e):(it(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_ extends E_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ud(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ud(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ud(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function K5(n){return gL(n.auth,new $_(n),n.bypassAuthState)}function X5(n){const{auth:e,user:t}=n;return it(t,e,"internal-error"),E5(t,new $_(n),n.bypassAuthState)}async function Y5(n){const{auth:e,user:t}=n;return it(t,e,"internal-error"),T5(t,new $_(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{constructor(e,t,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:r,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return K5;case"linkViaPopup":case"linkViaRedirect":return Y5;case"reauthViaPopup":case"reauthViaRedirect":return X5;default:Xi(this.auth,"internal-error")}}resolve(e){Fo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5=new Vm(2e3,1e4);class od extends IL{constructor(e,t,s,r,i){super(e,t,r,i),this.provider=s,this.authWindow=null,this.pollId=null,od.currentPopupAction&&od.currentPopupAction.cancel(),od.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return it(e,this.auth,"internal-error"),e}async onExecution(){Fo(this.filter.length===1,"Popup operations only handle one event");const e=I_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ca(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ca(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,od.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ca(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Q5.get())};e()}}od.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z5="pendingRedirect",i0=new Map;class J5 extends IL{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=i0.get(this.auth._key());if(!e){try{const s=await eK(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}i0.set(this.auth._key(),e)}return this.bypassAuthState||i0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function eK(n,e){const t=sK(e),s=nK(n);if(!await s._isAvailable())return!1;const r=await s._get(t)==="true";return await s._remove(t),r}function tK(n,e){i0.set(n._key(),e)}function nK(n){return $o(n._redirectPersistence)}function sK(n){return r0(Z5,n.config.apiKey,n.name)}async function rK(n,e,t=!1){if(Ia(n.app))return Promise.reject(ko(n));const s=Qu(n),r=q5(s,e),a=await new J5(s,r,t).execute();return a&&!t&&(delete a.user._redirectEventId,await s._persistUserIfCurrent(a.user),await s._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iK=10*60*1e3;class aK{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!oK(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!$L(e)){const r=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(Ca(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=iK&&this.cachedEventUids.clear(),this.cachedEventUids.has(rR(e))}saveEventToCache(e){this.cachedEventUids.add(rR(e)),this.lastProcessedEventTime=Date.now()}}function rR(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function $L({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function oK(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $L(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lK(n,e={}){return fc(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cK=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uK=/^https?/;async function hK(n){if(n.config.emulator)return;const{authorizedDomains:e}=await lK(n);for(const t of e)try{if(dK(t))return}catch{}Xi(n,"unauthorized-domain")}function dK(n){const e=IT(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===s}if(!uK.test(t))return!1;if(cK.test(n))return s===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fK=new Vm(3e4,6e4);function iR(){const n=Na().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function pK(n){return new Promise((e,t)=>{var s,r,i;function a(){iR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iR(),t(Ca(n,"network-request-failed"))},timeout:fK.get()})}if(!((r=(s=Na().gapi)===null||s===void 0?void 0:s.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((i=Na().gapi)===null||i===void 0)&&i.load)a();else{const o=a5("iframefcb");return Na()[o]=()=>{gapi.load?a():t(Ca(n,"network-request-failed"))},dL(`${i5()}?onload=${o}`).catch(l=>t(l))}}).catch(e=>{throw a0=null,e})}let a0=null;function mK(n){return a0=a0||pK(n),a0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gK=new Vm(5e3,15e3),yK="__/auth/iframe",bK="emulator/auth/iframe",xK={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vK=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wK(n){const e=n.config;it(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?w_(e,bK):`https://${n.config.authDomain}/${yK}`,s={apiKey:e.apiKey,appName:n.name,v:Qd},r=vK.get(n.config.apiHost);r&&(s.eid=r);const i=n._getFrameworks();return i.length&&(s.fw=i.join(",")),`${t}?${Mm(s).slice(1)}`}async function SK(n){const e=await mK(n),t=Na().gapi;return it(t,n,"internal-error"),e.open({where:document.body,url:wK(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xK,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const a=Ca(n,"network-request-failed"),o=Na().setTimeout(()=>{i(a)},gK.get());function l(){Na().clearTimeout(o),r(s)}s.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TK={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},EK=500,_K=600,IK="_blank",$K="http://localhost";class aR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function CK(n,e,t,s=EK,r=_K){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let o="";const l=Object.assign(Object.assign({},TK),{width:s.toString(),height:r.toString(),top:i,left:a}),u=lr().toLowerCase();t&&(o=iL(u)?IK:t),sL(u)&&(e=e||$K,l.scrollbars="yes");const d=Object.entries(l).reduce((m,[y,b])=>`${m}${y}=${b},`,"");if(Yq(u)&&o!=="_self")return NK(e||"",o),new aR(null);const f=window.open(e||"",o,d);it(f,n,"popup-blocked");try{f.focus()}catch{}return new aR(f)}function NK(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kK="__/auth/handler",AK="emulator/auth/handler",RK=encodeURIComponent("fac");async function oR(n,e,t,s,r,i){it(n.config.authDomain,n,"auth-domain-config-required"),it(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Qd,eventId:r};if(e instanceof pL){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",v6(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))a[d]=f}if(e instanceof zm){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(a.scopes=d.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const l=await n._getAppCheckToken(),u=l?`#${RK}=${encodeURIComponent(l)}`:"";return`${DK(n)}?${Mm(o).slice(1)}${u}`}function DK({config:n}){return n.emulator?w_(n,AK):`https://${n.authDomain}/${kK}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS="webStorageSupport";class OK{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wL,this._completeRedirectFn=rK,this._overrideRedirectResult=tK}async _openPopup(e,t,s,r){var i;Fo((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await oR(e,t,s,IT(),r);return CK(e,a,I_())}async _openRedirect(e,t,s,r){await this._originValidation(e);const i=await oR(e,t,s,IT(),r);return P5(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:i}=this.eventManagers[t];return r?Promise.resolve(r):(Fo(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await SK(e),s=new aK(e);return t.register("authEvent",r=>(it(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(BS,{type:BS},r=>{var i;const a=(i=r==null?void 0:r[0])===null||i===void 0?void 0:i[BS];a!==void 0&&t(!!a),Xi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=hK(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return uL()||rL()||T_()}}const FK=OK;var lR="@firebase/auth",cR="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LK{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){it(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PK(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function MK(n){Ed(new _u("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=s.options;it(a&&!a.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hL(n)},u=new n5(s,r,i,l);return h5(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Ed(new _u("auth-internal",e=>{const t=Qu(e.getProvider("auth").getImmediate());return(s=>new LK(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xl(lR,cR,PK(n)),Xl(lR,cR,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VK=5*60,BK=UF("authIdTokenMaxAge")||VK;let uR=null;const zK=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>BK)return;const r=t==null?void 0:t.token;uR!==r&&(uR=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function CL(n=GF()){const e=y_(n,"auth");if(e.isInitialized())return e.getImmediate();const t=u5(n,{popupRedirectResolver:FK,persistence:[H5,O5,wL]}),s=UF("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const a=zK(i.toString());N5(t,a,()=>a(t.currentUser)),C5(t,o=>a(o))}}const r=BF("auth");return r&&d5(t,`http://${r}`),t}function UK(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}s5({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=r=>{const i=Ca("internal-error");i.customData=r,t(i)},s.type="text/javascript",s.charset="UTF-8",UK().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});MK("Browser");var jK="firebase",WK="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xl(jK,WK,"app");const GK={apiKey:"AIzaSyB3WIJyjFv_KmAEzB0pK0AfEIsuK3ArKlM",authDomain:"searchengine-8ec0f.firebaseapp.com",projectId:"searchengine-8ec0f",storageBucket:"searchengine-8ec0f.firebasestorage.app",messagingSenderId:"747507579916",appId:"G-6ED7QYYJ7H"},HK=b_(GK,"auth"),Dx=CL(HK),qK=async(n,e)=>{try{return{success:!0,user:(await $5(Dx,n,e)).user}}catch(t){return console.error("Login error:",t.message),{success:!1,error:t.message}}},KK=async(n,e)=>{try{return{success:!0,user:(await I5(Dx,n,e)).user}}catch(t){return console.error("Registration error:",t.message),{success:!1,error:t.message}}},XK=async()=>{try{return await A5(Dx),{success:!0}}catch(n){return console.error("Logout error:",n.message),{success:!1,error:n.message}}},NL=we.createContext();function C_(){return we.useContext(NL)}function YK({children:n}){const[e,t]=we.useState(null),[s,r]=we.useState(!0);we.useEffect(()=>k5(Dx,o=>{t(o),r(!1)}),[]);const i={currentUser:e,isAuthenticated:!!e};return I.jsx(NL.Provider,{value:i,children:!s&&n})}const QK="/assets/logo-BxsR5wRg.png",kL=()=>{const[n,e]=we.useState(!1),[t,s]=we.useState(!1),r=Yd(),{isAuthenticated:i}=C_();we.useEffect(()=>{const u=()=>{s(window.scrollY>50)};return window.addEventListener("scroll",u),()=>window.removeEventListener("scroll",u)},[]);const a=()=>{e(!n),document.body.style.overflow=n?"auto":"hidden"},o=()=>{e(!1),document.body.style.overflow="auto"},l=async()=>{try{await XK(),r("/"),localStorage.removeItem("authToken"),console.log("Logged out successfully")}catch(u){console.error("Error during logout:",u)}};return I.jsx("header",{className:`navbar ${t?"scrolled":""}`,children:I.jsxs("div",{className:"navbar-container",children:[I.jsx(p_,{to:"/",className:"navbar-logo",onClick:o,children:I.jsx("img",{src:QK,alt:"HES Logo",className:"logo-img"})}),I.jsxs("button",{className:`menu-toggle ${n?"active":""}`,onClick:a,"aria-label":"Toggle menu","aria-expanded":n,children:[I.jsx("span",{className:"bar"}),I.jsx("span",{className:"bar"}),I.jsx("span",{className:"bar"})]}),I.jsx("nav",{className:`nav-menu ${n?"active":""}`,children:I.jsxs("ul",{className:"nav-list",children:[I.jsx("li",{className:"nav-item",children:I.jsx("a",{href:"/#services",onClick:o,children:"Services"})}),I.jsx("li",{className:"nav-item",children:I.jsx("a",{href:"/#mission",onClick:o,children:"Mission"})}),I.jsx("li",{className:"nav-item",children:I.jsx("a",{href:"/#team",onClick:o,children:"Team"})}),I.jsx("li",{className:"nav-item",children:I.jsx("a",{href:"/#faq",onClick:o,children:"FAQ"})}),I.jsx("li",{className:"nav-item sign-in",children:i?I.jsx("button",{className:"login-button",onClick:l,children:"Logout"}):I.jsx("button",{className:"login-button",onClick:()=>r("/login"),children:"Login / Sign Up"})})]})})]})})},ZK="/assets/background-image-DwkjHpWk.jpg",hR=["Info 1","Info 2","Info 3","Info 4"],JK=()=>{const n=[...hR,...hR];return I.jsx("div",{className:"vertical-carousel",children:I.jsx("div",{className:"carousel-track",children:n.map((e,t)=>I.jsx("div",{className:"carousel-slide",children:e},t))})})},e9=()=>I.jsxs("section",{id:"main",className:"main-section",children:[I.jsx("div",{className:"background",children:I.jsx("img",{src:ZK,alt:"Background"})}),I.jsx("div",{className:"overlay",children:I.jsxs("div",{className:"text-block",children:[I.jsx("h1",{children:"Health for Every Student"}),I.jsx("h2",{children:"Healthcare at our fingertips"})]})}),I.jsx("div",{className:"carousel-container",children:I.jsx(JK,{})})]}),AL="/assets/healthcare-search-DYGLdypk.png",RL="/assets/insurance-tracking-msVeLBpp.png",t9="/assets/educational-services-D21OqvF7.png",n9="/assets/coming-soon-CaoR_91n.png",s9=()=>{const{isAuthenticated:n}=C_(),e=Yd(),t=(s,r)=>{s.preventDefault(),n?e(r):e("/login",{state:{from:r}})};return I.jsxs("section",{id:"services",className:"services-section",children:[I.jsx("h2",{children:"Our Services"}),I.jsxs("div",{className:"services-container",children:[I.jsxs("div",{className:"service-card",children:[I.jsx("img",{src:AL,alt:"Healthcare Search Engine"}),I.jsx("h3",{children:"Search Local Care Providers"}),I.jsx("p",{children:"Find and connect with healthcare providers near you."}),I.jsx("button",{className:`btn ${n?"":"btn-locked"}`,onClick:s=>t(s,"/healthcare-search"),children:n?"Explore Now":"Login to Explore"})]}),I.jsxs("div",{className:"service-card",children:[I.jsx("img",{src:RL,alt:"Insurance Tracking"}),I.jsx("h3",{children:"Track and Estimate Your Insurance and Health Bills"}),I.jsx("p",{children:"Manage your insurance and health expenses effectively."}),I.jsx("button",{className:`btn ${n?"":"btn-locked"}`,onClick:s=>t(s,"/coming-soon"),children:n?"Explore Now":"Login to Explore"})]}),I.jsxs("div",{className:"service-card",children:[I.jsx("img",{src:t9,alt:"Educational Services"}),I.jsx("h3",{children:"Learn About How All Works"}),I.jsx("p",{children:"Understand the processes and services we offer."}),I.jsx("button",{className:`btn ${n?"":"btn-locked"}`,onClick:s=>t(s,"/how-it-works"),children:n?"Explore Now":"Login to Explore"})]}),I.jsxs("div",{className:"service-card",children:[I.jsx("img",{src:n9,alt:"Coming Soon"}),I.jsx("h3",{children:"See What's Coming Soon"}),I.jsx("p",{children:"Discover upcoming features and services."}),I.jsx("button",{className:`btn ${n?"":"btn-locked"}`,onClick:s=>t(s,"/coming-soon"),children:n?"Explore Now":"Login to Explore"})]})]})]})},r9="/assets/mission-image-C1V60kBm.jpg",i9=()=>I.jsxs("section",{id:"mission",className:"mission-section",children:[I.jsx("h2",{children:"Our Mission"}),I.jsxs("div",{className:"mission-container",children:[I.jsx("div",{className:"mission-text",children:I.jsx("p",{children:"Health for Every Student (HES) is dedicated to empowering college students in the U.S. with the tools and knowledge to navigate the complexities of the American healthcare system. Our platform provides personalized resources, including an insurance tracker and simulator, a community-based healthcare provider search engine, and interactive educational content. By focusing on transparency, accessibility, and tailored support, HES aims to simplify healthcare management and promote well-informed, proactive healthcare decisions among students."})}),I.jsx("div",{className:"mission-image",children:I.jsx("img",{src:r9,alt:"Our Mission"})})]})]}),a9="/assets/noah-BCHLE5pB.jpg",o9="/assets/arata-CYZnO0qA.jpg",l9="/assets/shubhagini-DjA_nGWj.jpg",c9="/assets/sora-Dlo7Ge-9.jpg",u9="/assets/bach-BnLgV3GX.png",h9="/assets/saki-BZuSM8CT.jpg",d9=()=>I.jsxs("section",{id:"team",className:"team-section",children:[I.jsx("h2",{children:"Meet the Team"}),I.jsxs("div",{className:"team-container",children:[I.jsxs("div",{className:"team-member",children:[I.jsx("img",{src:a9,alt:"Team Member 1"}),I.jsx("h3",{children:"Noah Radtke"}),I.jsx("p",{className:"title",children:"Cofounder and Project Lead"}),I.jsx("p",{className:"bio",children:"Majoring in Biochemistry and minoring in Medical Humanities"})]}),I.jsxs("div",{className:"team-member",children:[I.jsx("img",{src:o9,alt:"Team Member 2"}),I.jsx("h3",{children:"Arata Katayama"}),I.jsx("p",{className:"title",children:"Cofounder and Project Lead"}),I.jsx("p",{className:"bio",children:"Majoring in Software Engineering at Columbia University"})]}),I.jsxs("div",{className:"team-member",children:[I.jsx("img",{src:l9,alt:"Team Member 3"}),I.jsx("h3",{children:"Shubhagini Shah"}),I.jsx("p",{className:"title",children:"Health Data Analyst"}),I.jsx("p",{className:"bio",children:"Majoring in Neuroscience"})]}),I.jsxs("div",{className:"team-member",children:[I.jsx("img",{src:c9,alt:"Team Member 4"}),I.jsx("h3",{children:"Sora Owada"}),I.jsx("p",{className:"title",children:"Backend Coding"}),I.jsx("p",{className:"bio",children:"Majoring in Computer Science"})]}),I.jsxs("div",{className:"team-member",children:[I.jsx("img",{src:u9,alt:"Team Member 5"}),I.jsx("h3",{children:"Bach"}),I.jsx("p",{className:"title",children:"Backend Coding"}),I.jsx("p",{className:"bio",children:"Lead backend developer"})]}),I.jsxs("div",{className:"team-member",children:[I.jsx("img",{src:h9,alt:"Team Member 6"}),I.jsx("h3",{children:"Saki Takizawa"}),I.jsx("p",{className:"title",children:"UI/UX Specialist"}),I.jsx("p",{className:"bio",children:"Majoring in Computer Science and minoring in Music"})]})]})]}),f9=({question:n,answer:e})=>{const[t,s]=we.useState(!1);return I.jsxs("div",{className:"faq-item",children:[I.jsx("button",{className:`faq-question ${t?"open":""}`,onClick:()=>s(!t),children:n}),t&&I.jsx("div",{className:"faq-answer",children:I.jsx("p",{children:e})})]})},p9=()=>{const n=[{question:"What is HES?",answer:"HES stands for Health for Every Student – a platform to help students navigate healthcare."},{question:"How can I use the healthcare search engine?",answer:"You can search by entering your symptoms or selecting a disease category. Results include hospital details, reviews, and insurance information."},{question:"Question Three?",answer:"Answer three."},{question:"Question Four?",answer:"Answer four."},{question:"Question Five?",answer:"Answer five."},{question:"Question Six?",answer:"Answer six."}];return I.jsxs("section",{id:"faq",className:"faq-section",children:[I.jsx("h2",{children:"Frequently Asked Questions"}),I.jsx("div",{className:"faq-container",children:n.map((e,t)=>I.jsx(f9,{question:e.question,answer:e.answer},t))}),I.jsx("div",{className:"faq-link",children:I.jsx("a",{href:"https://forms.gle/YOUR_GOOGLE_FORM_LINK",target:"_blank",rel:"noopener noreferrer",children:"Have more questions? Fill out our form."})})]})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m9=1e-7,g9=1e-4;class DL{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}let N_=class{refCount(e){return Cr("refCount")}incRef(e){return Cr("incRef")}timerAvailable(){return!0}time(e){return Cr("time")}read(e){return Cr("read")}readSync(e){return Cr("readSync")}readToGPU(e,t){return Cr("readToGPU")}numDataIds(){return Cr("numDataIds")}disposeData(e,t){return Cr("disposeData")}write(e,t,s){return Cr("write")}move(e,t,s,r,i){return Cr("move")}createTensorFromGPUData(e,t,s){return Cr("createTensorFromGPUData")}memory(){return Cr("memory")}floatPrecision(){return Cr("floatPrecision")}epsilon(){return this.floatPrecision()===32?m9:g9}dispose(){return Cr("dispose")}};function Cr(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y9(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,Jh(n,e,t)}function Cu(n,e,t){return Math.max(n,Math.min(e,t))}function k_(n){return n%2===0?n:n+1}function Jh(n,e,t){const s=n[e];n[e]=n[t],n[t]=s}function b9(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function H(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function A_(n,e,t=""){H(Gt(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function OL(n){H(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Ee(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function Gt(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function _d(n){return n%1===0}function kT(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function hd(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function dR(n,e=r=>0,t,s){return new Promise((r,i)=>{let a=0;const o=()=>{if(n()){r();return}a++;const l=e(a);if(t!=null&&a>=t){i();return}s!=null?s(o,l):setTimeout(o,l)};o()})}function FL(n,e){let t=1,s=-1;for(let i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(n[i]<0)throw Error(`Shapes can not be < 0. Found ${n[i]} at dim ${i}`);if(s===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const r=n.slice();return r[s]=e/t,r}function gt(n,e){const t=e.length;return n=n==null?e.map((s,r)=>r):[].concat(n),H(n.every(s=>s>=-t&&s<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),H(n.every(s=>_d(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?t+s:s)}function pc(n,e){const t=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:gt(e,n).sort();let a=0;for(let o=0;o<n.length;++o){if(i!=null){if(i[a]===o&&n[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${n[o]}' is not 1`);(i[a]==null||i[a]>o)&&n[o]===1&&(t.push(n[o]),s.push(o)),i[a]<=o&&a++}n[o]!==1&&(t.push(n[o]),s.push(o))}return{newShape:t,keptDims:s}}function Vs(n,e){return Rn(n,e)}function Rn(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function x9(n,e){for(let t=0;t<n.length;t++){const s=n[t];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function v9(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function LL(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function O0(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function w9(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function jm(n){return typeof n=="string"||n instanceof String}function S9(n){return typeof n=="boolean"}function AT(n){return typeof n=="number"}function Jd(n){return Array.isArray(n)?Jd(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":AT(n)?"float32":jm(n)?"string":S9(n)?"bool":"float32"}function RT(n){return!!(n&&n.constructor&&n.call&&n.apply)}function DT(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function Ye(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let s=e-3;s>=0;--s)t[s]=t[s+1]*n[s+1];return t}function PL(n,e,t,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let a=0;a<i;a++)r[a]=t[n+a]}else{const i=e[0],a=e.slice(1),o=a.reduce((l,u)=>l*u)*(s?2:1);for(let l=0;l<i;l++)r[l]=PL(n+l*o,a,t,s)}return r}function Wi(n,e,t=!1){if(n.length===0)return e[0];const s=n.reduce((r,i)=>r*i)*(t?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return PL(0,n,e,t)}function T9(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function R_(n,e){const t=Bs(n,e);for(let s=0;s<t.length;s++)t[s]=1;return t}function Bs(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function ML(n,e){const t=n.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return Wi(n,new Float32Array(t));if(e==="int32")return Wi(n,new Int32Array(t));if(e==="bool")return Wi(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function Go(n){n.forEach(e=>{H(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function ka(n,e,t){if(e===0)return 0;if(e===1)return n[0];let s=n[n.length-1];for(let r=0;r<n.length-1;++r)s+=t[r]*n[r];return s}function ef(n,e,t){if(e===0)return[];if(e===1)return[n];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(n/t[r]),n-=s[r]*t[r];return s[s.length-1]=n,s}function D_(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fR="tfjsflags";let E9=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=_9,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(xe().getBool("IS_TEST")||xe().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,s){if(this.flagRegistry[e]={evaluationFn:t,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];xe().getBool("IS_TEST")||xe().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(D_(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);fR in e&&e[fR].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=$9(r,i)})}};function _9(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...s)=>(I9(e,s[0],s[1]),s.join("="))),e}function I9(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function $9(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function xe(){return VL}let VL=null;function C9(n){VL=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let zS;function BL(){if(zS==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");zS=n}return zS}function N9(){const n=BL();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function O_(n,e){const t=N9();if(t.has(n))return t.get(n);{const s=e();return t.set(n,s),t.get(n)}}const Ox="Abs",Wm="Acos",Gm="Acosh",tf="Add",F_="AddN",L_="All",P_="Any",Fx="ArgMax",Lx="ArgMin",Hm="Asin",qm="Asinh",Km="Atan",Xm="Atanh",Ym="Atan2",Px="AvgPool",M_="AvgPoolGrad",Mx="AvgPool3D",V_="AvgPool3DGrad",Vx="BatchMatMul",Bx="BatchToSpaceND",B_="Bincount",z_="BitwiseAnd",k9="BroadcastTo",zL="BroadcastArgs",Qm="Cast",Zm="Ceil",Jm="ClipByValue",U_="Complex",zx="ComplexAbs",Ux="Concat",jx="Conv2D",j_="Conv2DBackpropFilter",Wx="Conv2DBackpropInput",Gx="Conv3D",W_="Conv3DBackpropFilterV2",G_="Conv3DBackpropInputV2",eg="Cos",tg="Cosh",H_="Cumprod",Hx="Cumsum",q_="CropAndResize",K_="DenseBincount",X_="DepthToSpace",qx="DepthwiseConv2dNative",Y_="DepthwiseConv2dNativeBackpropFilter",Q_="DepthwiseConv2dNativeBackpropInput",UL="Diag",Kx="Dilation2D",OT="Dilation2DBackpropInput",FT="Dilation2DBackpropFilter",A9="Draw",ng="RealDiv",Z_="Einsum",sg="Elu",J_="EluGrad",rg="Erf",Xx="Equal",ig="Exp",Yx="ExpandDims",ag="Expm1",eI="FFT",tI="Fill",nI="FlipLeftRight",og="Floor",lg="FloorDiv",Qx="FusedBatchNorm",Zx="GatherV2",jL="GatherNd",Jx="Greater",cg="GreaterEqual",ug="Identity",sI="IFFT",rI="Imag",hg="IsFinite",dg="IsInf",fg="IsNan",ev="LeakyRelu",tv="Less",nv="LessEqual",WL="LinSpace",pg="Log",mg="Log1p",sv="LogicalAnd",rv="LogicalNot",iv="LogicalOr",R9="LogSoftmax",av="LRN",iI="LRNGrad",ov="Max",gg="Maximum",lv="MaxPool",aI="MaxPoolGrad",cv="MaxPool3D",oI="MaxPool3DGrad",GL="MaxPoolWithArgmax",uv="Mean",hv="Min",yg="Minimum",dv="MirrorPad",bg="Mod",HL="Multinomial",xg="Multiply",fv="Neg",pv="NotEqual",lI="NonMaxSuppressionV3",cI="NonMaxSuppressionV4",uI="NonMaxSuppressionV5",mv="OnesLike",gv="OneHot",yv="Pack",bv="PadV2",vg="Pow",xv="Prelu",vv="Prod",qL="RaggedGather",KL="RaggedRange",XL="RaggedTensorToTensor",hI="Range",dI="Real",wg="Reciprocal",Sg="Relu",wv="Reshape",Sv="ResizeNearestNeighbor",fI="ResizeNearestNeighborGrad",Tv="ResizeBilinear",pI="ResizeBilinearGrad",Tg="Relu6",Ev="Reverse",Eg="Round",_g="Rsqrt",YL="ScatterNd",QL="TensorScatterUpdate",ZL="SearchSorted",_v="Select",Ig="Selu",Iv="Slice",$g="Sin",Cg="Sinh",Ng="Sign",kg="Sigmoid",Ag="Softplus",Rg="Sqrt",$v="Sum",Cv="SpaceToBatchND",Nv="SplitV",kv="Softmax",JL="SparseFillEmptyRows",eP="SparseReshape",tP="SparseSegmentMean",nP="SparseSegmentSum",sP="SparseToDense",Dg="SquaredDifference",mI="Square",gI="StaticRegexReplace",yI="StridedSlice",rP="StringNGrams",iP="StringSplit",aP="StringToHashBucketFast",Og="Sub",Fg="Tan",Lg="Tanh",Pg="Tile",bI="TopK",xI="Transform",dd="Transpose",vI="Unique",Av="Unpack",Rv="UnsortedSegmentSum",Dv="ZerosLike",Mg="Step",D9="FromPixels",wI="RotateWithOffset",F0="_FusedMatMul",L0="FusedConv2D",oP="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hr(...n){xe().getBool("IS_TEST")||xe().getBool("PROD")||console.warn(...n)}function O9(...n){xe().getBool("IS_TEST")||xe().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P0=O_("kernelRegistry",()=>new Map),LT=O_("gradRegistry",()=>new Map);function pR(n,e){const t=cP(n,e);return P0.get(t)}function mR(n){return LT.get(n)}function gR(n){const e=P0.entries(),t=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,a]=r,[o]=i.split("_");o===n&&t.push(a)}return t}function lP(n){const{kernelName:e,backendName:t}=n,s=cP(e,t);P0.has(s)&&Hr(`The kernel '${e}' for backend '${t}' is already registered`),P0.set(s,n)}function F9(n){const{kernelName:e}=n;LT.has(e)&&xe().getBool("DEBUG")&&Hr(`Overriding the gradient for '${e}'`),LT.set(e,n)}function cP(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uP(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var US,yR;function L9(){if(yR)return US;yR=1,US=e;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(D,k,z){this.low=D|0,this.high=k|0,this.unsigned=!!z}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(D){return(D&&D.__isLong__)===!0}e.isLong=t;var s={},r={};function i(D,k){var z,B,ne;return k?(D>>>=0,(ne=0<=D&&D<256)&&(B=r[D],B)?B:(z=o(D,(D|0)<0?-1:0,!0),ne&&(r[D]=z),z)):(D|=0,(ne=-128<=D&&D<128)&&(B=s[D],B)?B:(z=o(D,D<0?-1:0,!1),ne&&(s[D]=z),z))}e.fromInt=i;function a(D,k){if(isNaN(D))return k?E:T;if(k){if(D<0)return E;if(D>=b)return F}else{if(D<=-9223372036854776e3)return R;if(D+1>=w)return V}return D<0?a(-D,k).neg():o(D%y|0,D/y|0,k)}e.fromNumber=a;function o(D,k,z){return new e(D,k,z)}e.fromBits=o;var l=Math.pow;function u(D,k,z){if(D.length===0)throw Error("empty string");if(D==="NaN"||D==="Infinity"||D==="+Infinity"||D==="-Infinity")return T;if(typeof k=="number"?(z=k,k=!1):k=!!k,z=z||10,z<2||36<z)throw RangeError("radix");var B;if((B=D.indexOf("-"))>0)throw Error("interior hyphen");if(B===0)return u(D.substring(1),k,z).neg();for(var ne=a(l(z,8)),J=T,K=0;K<D.length;K+=8){var re=Math.min(8,D.length-K),Z=parseInt(D.substring(K,K+re),z);if(re<8){var he=a(l(z,re));J=J.mul(he).add(a(Z))}else J=J.mul(ne),J=J.add(a(Z))}return J.unsigned=k,J}e.fromString=u;function d(D,k){return typeof D=="number"?a(D,k):typeof D=="string"?u(D,k):o(D.low,D.high,typeof k=="boolean"?k:D.unsigned)}e.fromValue=d;var f=65536,m=1<<24,y=f*f,b=y*y,w=b/2,x=i(m),T=i(0);e.ZERO=T;var E=i(0,!0);e.UZERO=E;var $=i(1);e.ONE=$;var C=i(1,!0);e.UONE=C;var O=i(-1);e.NEG_ONE=O;var V=o(-1,2147483647,!1);e.MAX_VALUE=V;var F=o(-1,-1,!0);e.MAX_UNSIGNED_VALUE=F;var R=o(0,-2147483648,!1);e.MIN_VALUE=R;var N=e.prototype;return N.toInt=function(){return this.unsigned?this.low>>>0:this.low},N.toNumber=function(){return this.unsigned?(this.high>>>0)*y+(this.low>>>0):this.high*y+(this.low>>>0)},N.toString=function(k){if(k=k||10,k<2||36<k)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(R)){var z=a(k),B=this.div(z),ne=B.mul(z).sub(this);return B.toString(k)+ne.toInt().toString(k)}else return"-"+this.neg().toString(k);for(var J=a(l(k,6),this.unsigned),K=this,re="";;){var Z=K.div(J),he=K.sub(Z.mul(J)).toInt()>>>0,W=he.toString(k);if(K=Z,K.isZero())return W+re;for(;W.length<6;)W="0"+W;re=""+W+re}},N.getHighBits=function(){return this.high},N.getHighBitsUnsigned=function(){return this.high>>>0},N.getLowBits=function(){return this.low},N.getLowBitsUnsigned=function(){return this.low>>>0},N.getNumBitsAbs=function(){if(this.isNegative())return this.eq(R)?64:this.neg().getNumBitsAbs();for(var k=this.high!=0?this.high:this.low,z=31;z>0&&(k&1<<z)==0;z--);return this.high!=0?z+33:z+1},N.isZero=function(){return this.high===0&&this.low===0},N.eqz=N.isZero,N.isNegative=function(){return!this.unsigned&&this.high<0},N.isPositive=function(){return this.unsigned||this.high>=0},N.isOdd=function(){return(this.low&1)===1},N.isEven=function(){return(this.low&1)===0},N.equals=function(k){return t(k)||(k=d(k)),this.unsigned!==k.unsigned&&this.high>>>31===1&&k.high>>>31===1?!1:this.high===k.high&&this.low===k.low},N.eq=N.equals,N.notEquals=function(k){return!this.eq(k)},N.neq=N.notEquals,N.ne=N.notEquals,N.lessThan=function(k){return this.comp(k)<0},N.lt=N.lessThan,N.lessThanOrEqual=function(k){return this.comp(k)<=0},N.lte=N.lessThanOrEqual,N.le=N.lessThanOrEqual,N.greaterThan=function(k){return this.comp(k)>0},N.gt=N.greaterThan,N.greaterThanOrEqual=function(k){return this.comp(k)>=0},N.gte=N.greaterThanOrEqual,N.ge=N.greaterThanOrEqual,N.compare=function(k){if(t(k)||(k=d(k)),this.eq(k))return 0;var z=this.isNegative(),B=k.isNegative();return z&&!B?-1:!z&&B?1:this.unsigned?k.high>>>0>this.high>>>0||k.high===this.high&&k.low>>>0>this.low>>>0?-1:1:this.sub(k).isNegative()?-1:1},N.comp=N.compare,N.negate=function(){return!this.unsigned&&this.eq(R)?R:this.not().add($)},N.neg=N.negate,N.add=function(k){t(k)||(k=d(k));var z=this.high>>>16,B=this.high&65535,ne=this.low>>>16,J=this.low&65535,K=k.high>>>16,re=k.high&65535,Z=k.low>>>16,he=k.low&65535,W=0,ee=0,me=0,de=0;return de+=J+he,me+=de>>>16,de&=65535,me+=ne+Z,ee+=me>>>16,me&=65535,ee+=B+re,W+=ee>>>16,ee&=65535,W+=z+K,W&=65535,o(me<<16|de,W<<16|ee,this.unsigned)},N.subtract=function(k){return t(k)||(k=d(k)),this.add(k.neg())},N.sub=N.subtract,N.multiply=function(k){if(this.isZero())return T;if(t(k)||(k=d(k)),n){var z=n.mul(this.low,this.high,k.low,k.high);return o(z,n.get_high(),this.unsigned)}if(k.isZero())return T;if(this.eq(R))return k.isOdd()?R:T;if(k.eq(R))return this.isOdd()?R:T;if(this.isNegative())return k.isNegative()?this.neg().mul(k.neg()):this.neg().mul(k).neg();if(k.isNegative())return this.mul(k.neg()).neg();if(this.lt(x)&&k.lt(x))return a(this.toNumber()*k.toNumber(),this.unsigned);var B=this.high>>>16,ne=this.high&65535,J=this.low>>>16,K=this.low&65535,re=k.high>>>16,Z=k.high&65535,he=k.low>>>16,W=k.low&65535,ee=0,me=0,de=0,be=0;return be+=K*W,de+=be>>>16,be&=65535,de+=J*W,me+=de>>>16,de&=65535,de+=K*he,me+=de>>>16,de&=65535,me+=ne*W,ee+=me>>>16,me&=65535,me+=J*he,ee+=me>>>16,me&=65535,me+=K*Z,ee+=me>>>16,me&=65535,ee+=B*W+ne*he+J*Z+K*re,ee&=65535,o(de<<16|be,ee<<16|me,this.unsigned)},N.mul=N.multiply,N.divide=function(k){if(t(k)||(k=d(k)),k.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&k.low===-1&&k.high===-1)return this;var z=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,k.low,k.high);return o(z,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?E:T;var B,ne,J;if(this.unsigned){if(k.unsigned||(k=k.toUnsigned()),k.gt(this))return E;if(k.gt(this.shru(1)))return C;J=E}else{if(this.eq(R)){if(k.eq($)||k.eq(O))return R;if(k.eq(R))return $;var K=this.shr(1);return B=K.div(k).shl(1),B.eq(T)?k.isNegative()?$:O:(ne=this.sub(k.mul(B)),J=B.add(ne.div(k)),J)}else if(k.eq(R))return this.unsigned?E:T;if(this.isNegative())return k.isNegative()?this.neg().div(k.neg()):this.neg().div(k).neg();if(k.isNegative())return this.div(k.neg()).neg();J=T}for(ne=this;ne.gte(k);){B=Math.max(1,Math.floor(ne.toNumber()/k.toNumber()));for(var re=Math.ceil(Math.log(B)/Math.LN2),Z=re<=48?1:l(2,re-48),he=a(B),W=he.mul(k);W.isNegative()||W.gt(ne);)B-=Z,he=a(B,this.unsigned),W=he.mul(k);he.isZero()&&(he=$),J=J.add(he),ne=ne.sub(W)}return J},N.div=N.divide,N.modulo=function(k){if(t(k)||(k=d(k)),n){var z=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,k.low,k.high);return o(z,n.get_high(),this.unsigned)}return this.sub(this.div(k).mul(k))},N.mod=N.modulo,N.rem=N.modulo,N.not=function(){return o(~this.low,~this.high,this.unsigned)},N.and=function(k){return t(k)||(k=d(k)),o(this.low&k.low,this.high&k.high,this.unsigned)},N.or=function(k){return t(k)||(k=d(k)),o(this.low|k.low,this.high|k.high,this.unsigned)},N.xor=function(k){return t(k)||(k=d(k)),o(this.low^k.low,this.high^k.high,this.unsigned)},N.shiftLeft=function(k){return t(k)&&(k=k.toInt()),(k&=63)===0?this:k<32?o(this.low<<k,this.high<<k|this.low>>>32-k,this.unsigned):o(0,this.low<<k-32,this.unsigned)},N.shl=N.shiftLeft,N.shiftRight=function(k){return t(k)&&(k=k.toInt()),(k&=63)===0?this:k<32?o(this.low>>>k|this.high<<32-k,this.high>>k,this.unsigned):o(this.high>>k-32,this.high>=0?0:-1,this.unsigned)},N.shr=N.shiftRight,N.shiftRightUnsigned=function(k){if(t(k)&&(k=k.toInt()),k&=63,k===0)return this;var z=this.high;if(k<32){var B=this.low;return o(B>>>k|z<<32-k,z>>>k,this.unsigned)}else return k===32?o(z,0,this.unsigned):o(z>>>k-32,0,this.unsigned)},N.shru=N.shiftRightUnsigned,N.shr_u=N.shiftRightUnsigned,N.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},N.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},N.toBytes=function(k){return k?this.toBytesLE():this.toBytesBE()},N.toBytesLE=function(){var k=this.high,z=this.low;return[z&255,z>>>8&255,z>>>16&255,z>>>24,k&255,k>>>8&255,k>>>16&255,k>>>24]},N.toBytesBE=function(){var k=this.high,z=this.low;return[k>>>24,k>>>16&255,k>>>8&255,k&255,z>>>24,z>>>16&255,z>>>8&255,z&255]},e.fromBytes=function(k,z,B){return B?e.fromBytesLE(k,z):e.fromBytesBE(k,z)},e.fromBytesLE=function(k,z){return new e(k[0]|k[1]<<8|k[2]<<16|k[3]<<24,k[4]|k[5]<<8|k[6]<<16|k[7]<<24,z)},e.fromBytesBE=function(k,z){return new e(k[4]<<24|k[5]<<16|k[6]<<8|k[7],k[0]<<24|k[1]<<16|k[2]<<8|k[3],z)},US}var hP=L9();const dP=SF(hP),P9=yG({__proto__:null,default:dP},[hP]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hu=dP||P9;function Ov(n){return hu.fromString(n,!0,16)}const fP=Ov("c3a5c85c97cb3127"),cu=Ov("b492b66fbe98f273"),er=Ov("9ae16a3b2f90404f");function PT(n){return n.xor(n.shru(47))}function pP(n,e,t){const s=n.slice(e,e+t);return hu.fromBytes(Array.from(s),!0,!0)}function ln(n,e){return pP(n,e,8)}function bR(n,e){return pP(n,e,4)}function ls(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function Yl(n,e,t=Ov("9ddfea08eb382d69")){let s=n.xor(e).mul(t);s=s.xor(s.shru(47));let r=e.xor(s).mul(t);return r=r.xor(r.shru(47)),r=r.mul(t),r}function M9(n,e,t,s,r,i){r=r.add(n),i=ls(i.add(r).add(s),21);const a=r;return r=r.add(e),r=r.add(t),i=i.add(ls(r,44)),[r.add(s),i.add(a)]}function Fb(n,e,t,s){return M9(ln(n,e),ln(n,e+8),ln(n,e+16),ln(n,e+24),t,s)}function V9(n,e=n.length){if(e>=8){const t=er.add(e*2),s=ln(n,0).add(er),r=ln(n,e-8),i=ls(r,37).mul(t).add(s),a=ls(s,25).add(r).mul(t);return Yl(i,a,t)}if(e>=4){const t=er.add(e*2),s=bR(n,0);return Yl(s.shl(3).add(e),bR(n,e-4),t)}if(e>0){const t=n[0],s=n[e>>1],r=n[e-1],i=t+(s<<8),a=e+(r<<2);return PT(er.mul(i).xor(fP.mul(a))).mul(er)}return er}function B9(n,e=n.length){const t=er.add(e*2),s=ln(n,0).mul(cu),r=ln(n,8),i=ln(n,e-8).mul(t),a=ln(n,e-16).mul(er);return Yl(ls(s.add(r),43).add(ls(i,30)).add(a),s.add(ls(r.add(er),18)).add(i),t)}function z9(n,e=n.length){const t=er.add(e*2),s=ln(n,0).mul(er),r=ln(n,8),i=ln(n,e-8).mul(t),a=ln(n,e-16).mul(er),o=ls(s.add(r),43).add(ls(i,30)).add(a),l=Yl(o,s.add(ls(r.add(er),18)).add(i),t),u=ln(n,16).mul(t),d=ln(n,24),f=o.add(ln(n,e-32)).mul(t),m=l.add(ln(n,e-24)).mul(t);return Yl(ls(u.add(d),43).add(ls(f,30)).add(m),u.add(ls(d.add(s),18)).add(f),t)}function U9(n,e=n.length){const t=hu.fromNumber(81,!0);if(e<=32)return e<=16?V9(n,e):B9(n,e);if(e<=64)return z9(n,e);let s=t,r=t.mul(cu).add(113),i=PT(r.mul(er).add(113)).mul(er),a=[hu.UZERO,hu.UZERO],o=[hu.UZERO,hu.UZERO];s=s.mul(er).add(ln(n,0));let l=0;const u=(e-1>>6)*64,d=u+(e-1&63)-63;do s=ls(s.add(r).add(a[0]).add(ln(n,l+8)),37).mul(cu),r=ls(r.add(a[1]).add(ln(n,l+48)),42).mul(cu),s=s.xor(o[1]),r=r.add(a[0]).add(ln(n,l+40)),i=ls(i.add(o[0]),33).mul(cu),a=Fb(n,l,a[1].mul(cu),s.add(o[0])),o=Fb(n,l+32,i.add(o[1]),r.add(ln(n,l+16))),[i,s]=[s,i],l+=64;while(l!==u);const f=cu.add(i.and(255).shl(1));return l=d,o[0]=o[0].add(e-1&63),a[0]=a[0].add(o[0]),o[0]=o[0].add(a[0]),s=ls(s.add(r).add(a[0]).add(ln(n,l+8)),37).mul(f),r=ls(r.add(a[1]).add(ln(n,l+48)),42).mul(f),s=s.xor(o[1].mul(9)),r=r.add(a[0].mul(9).add(ln(n,l+40))),i=ls(i.add(o[0]),33).mul(f),a=Fb(n,l,a[1].mul(f),s.add(o[0])),o=Fb(n,l+32,i.add(o[1]),r.add(ln(n,l+16))),[i,s]=[s,i],Yl(Yl(a[0],o[0],f).add(PT(r).mul(fP)).add(i),Yl(a[1],o[1],f).add(s),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mc(n,e){return e==="string"?Ql(n):Zu([n],e)}function j9(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function Zu(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Nu(n)),xe().getBool("DEBUG")&&x9(n,e),j9(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let s=0;s<t.length;++s)Math.round(n[s])!==0&&(t[s]=1);return t}else throw new Error(`Unknown data type ${e}`)}function yr(){return xe().platform.now()}function Ql(n,e="utf-8"){return e=e||"utf-8",xe().platform.encode(n,e)}function tc(n,e="utf-8"){return e=e||"utf-8",xe().platform.decode(n,e)}function _i(n){return xe().platform.isTypedArray!=null?xe().platform.isTypedArray(n):uP(n)}function Nu(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||D_(n)||n==null||_i(n)&&t)e.push(n);else if(Array.isArray(n)||_i(n))for(let s=0;s<n.length;++s)Nu(n[s],e,t);else{let s=-1;for(const r of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Nu(n[r],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let W9=class{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new H9)}profileKernel(e,t,s){let r;const i=()=>{r=s()};let a;const o=yr();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();for(const u of r)u.dataSync();a=Promise.resolve({kernelMs:yr()-o})}if(xe().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<r.length;u++){const d=r[u];d.data().then(f=>{G9(f,d.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:a.then(u=>u.kernelMs),extraInfo:a.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:s,timeMs:r,inputs:i,extraInfo:a}=e;s.forEach(o=>{Promise.all([o.data(),r,a]).then(l=>{this.logger.logKernelProfile(t,o,l[0],l[1],i,l[2])})})}};function G9(n,e,t){if(e!=="float32")return!1;for(let s=0;s<n.length;s++){const r=n[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${t}'`),!0}return!1}let H9=class{logKernelProfile(e,t,s,r,i,a){const o=typeof r=="number"?hd(`${r}ms`,9):r.error,l=hd(e,25),u=t.rank,d=t.size,f=hd(t.shape.toString(),14);let m="";for(const y in i){const b=i[y];if(b!=null){const w=b.shape||t.shape,x=w.length;m+=`${y}: ${x}D ${x>0?w:""} `}}console.log(`%c${l}	%c${o}	%c${u}D ${f}	%c${d}	%c${m}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q9(n,e,t){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<n.length;l++){const u=n[l],d=u.inputs;for(const f in d){const m=d[f];let y=!1;for(let b=0;b<e.length;b++)if(s[m.id]){u.outputs.forEach(w=>s[w.id]=!0),y=!0,r[u.id]=!0;break}if(y)break}}const i={};i[t.id]=!0;const a={};for(let l=n.length-1;l>=0;l--){const u=n[l],d=u.inputs;for(let f=0;f<u.outputs.length;f++)if(i[u.outputs[f].id]){for(const m in d)i[d[m].id]=!0,a[u.id]=!0;break}}const o=[];for(let l=0;l<n.length;l++){const u=n[l];if(r[u.id]&&a[u.id]){const d={};for(const m in u.inputs){const y=u.inputs[m];s[y.id]&&(d[m]=y)}const f=Object.assign({},u);f.inputs=d,f.outputs=u.outputs,o.push(f)}}return o}function K9(n,e,t,s){for(let r=e.length-1;r>=0;r--){const i=e[r],a=[];if(i.outputs.forEach(l=>{const u=n[l.id];u!=null?a.push(u):a.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const o=i.gradient(a);for(const l in i.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const u=t(()=>o[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const d=i.inputs[l];if(!Gt(u.shape,d.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${d.shape}'`);if(n[d.id]==null)n[d.id]=u;else{const f=n[d.id];n[d.id]=s(f,u),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xR=20,Np=3,jS=7;function X9(n,e,t,s){const r=Ye(e),i=Y9(n,e,t,r),a=e.length,o=o0(n,e,t,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${a}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(u=>"    "+u).join(`
`)),l.join(`
`)}function Y9(n,e,t,s){const r=Ee(e),i=s[s.length-1],a=new Array(i).fill(0),o=e.length,l=t==="complex64"?zp(n):n;if(o>1)for(let u=0;u<r/i;u++){const d=u*i;for(let f=0;f<i;f++)a[f]=Math.max(a[f],Bp(l[d+f],0,t).length)}return a}function Bp(n,e,t){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(jS))} + ${parseFloat(n[1].toFixed(jS))}j`:jm(n)?s=`'${n}'`:t==="bool"?s=mP(n):s=parseFloat(n.toFixed(jS)).toString(),hd(s,e)}function mP(n){return n===0?"false":"true"}function o0(n,e,t,s,r,i=!0){const a=t==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(t==="complex64"){const w=zp(n);return[Bp(w[0],0,t)]}return t==="bool"?[mP(n[0])]:[n[0].toString()]}if(l===1){if(o>xR){const x=Np*a;let T=Array.from(n.slice(0,x)),E=Array.from(n.slice((o-Np)*a,o*a));return t==="complex64"&&(T=zp(T),E=zp(E)),["["+T.map(($,C)=>Bp($,r[C],t)).join(", ")+", ..., "+E.map(($,C)=>Bp($,r[o-Np+C],t)).join(", ")+"]"]}return["["+(t==="complex64"?zp(n):Array.from(n)).map((x,T)=>Bp(x,r[T],t)).join(", ")+"]"]}const u=e.slice(1),d=s.slice(1),f=s[0]*a,m=[];if(o>xR){for(let w=0;w<Np;w++){const x=w*f,T=x+f;m.push(...o0(n.slice(x,T),u,t,d,r,!1))}m.push("...");for(let w=o-Np;w<o;w++){const x=w*f,T=x+f;m.push(...o0(n.slice(x,T),u,t,d,r,w===o-1))}}else for(let w=0;w<o;w++){const x=w*f,T=x+f;m.push(...o0(n.slice(x,T),u,t,d,r,w===o-1))}const y=l===2?",":"";m[0]="["+(o>0?m[0]+y:"");for(let w=1;w<m.length-1;w++)m[w]=" "+m[w]+y;let b=`,
`;for(let w=2;w<l;w++)b+=`
`;return m[m.length-1]=" "+m[m.length-1]+"]"+(i?"":b),m}function zp(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _s=class{constructor(e,t,s){if(this.dtype=t,this.shape=e.slice(),this.size=Ee(e),s!=null){const r=s.length;H(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Rn(t,this.size),this.strides=Ye(e)}set(e,...t){t.length===0&&(t=[0]),H(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const s=this.locToIndex(t);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const r of e){if(r<0||r>=this.shape[t]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}t++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let s=0;s<e.length-1;++s)t+=this.strides[s]*e[s];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let s=0;s<t.length-1;++s)t[s]=Math.floor(e/this.strides[s]),e-=t[s]*this.strides[s];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Bi().makeTensor(this.values,this.shape,this.dtype)}},Bi=null,ed=null;function Q9(n){Bi=n}function Z9(n){ed=n}let Xn=class{constructor(e,t,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Ee(e),this.strides=Ye(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return ed.buffer(this.shape,this.dtype,e)}bufferSync(){return ed.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Wi(this.shape,e,this.dtype==="complex64")}arraySync(){return Wi(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Bi().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(s=>tc(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Bi().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Bi().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>tc(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Bi().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Bi().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return ed.print(this,e)}clone(){return this.throwIfDisposed(),ed.clone(this)}toString(e=!1){const t=this.dataSync();return X9(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),ed.cast(this,e)}variable(e=!0,t,s){return this.throwIfDisposed(),Bi().makeVariable(this,e,t,s)}};Object.defineProperty(Xn,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function Se(){return O_("Tensor",()=>Xn)}Se();let M0=class extends Xn{constructor(e,t,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Gt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Bi().disposeTensor(this),this.dataId=e.dataId,Bi().incRef(this,null)}dispose(){Bi().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(M0,Symbol.hasInstance,{value:n=>n instanceof Xn&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var vR;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(vR||(vR={}));var MT;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(MT||(MT={}));var VT;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(VT||(VT={}));var BT;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(BT||(BT={}));var zT;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(zT||(zT={}));const J9={float32:BT,int32:MT,bool:VT,complex64:zT};function Rr(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return J9[n][e]}function SI(n){return Rr(n,"int32")}function gP(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function yP(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fn(n,e){if(n.dtype===e.dtype)return[n,e];const t=Rr(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function bP(n){const e=[];return xP(n,e,new Set),e}function xP(n,e,t){if(n==null)return;if(n instanceof Xn){e.push(n);return}if(!e8(n))return;const s=n;for(const r in s){const i=s[r];t.has(i)||(t.add(i),xP(i,e,t))}}function e8(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WS(n){return n.kernelName!=null}let wR=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}},TI=class UT{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new wR}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,s=1){return e in this.registryFactory?(Hr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:s}=this.initializeBackend(e);if(!(s?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new W9(this.backendInstance),!0}setupRegisteredKernels(){gR(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){gR(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=t.factory();if(s&&!(s instanceof N_)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(a=>r<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Hr(`Initialization of backend ${e} failed`),Hr(a.stack||a.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Hr(`Initialization of backend ${e} failed`),Hr(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const s=this.state.tensorInfo.get(t),r=s.backend,i=this.readSync(t),a=r.refCount(t);r.disposeData(t,!0),s.backend=e,e.move(t,i,s.shape,s.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let s=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=t(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,t,s){e();try{const r=s();return t(),r}catch(r){throw t(),r}}nextTensorId(){return UT.nextTensorId++}nextVariableId(){return UT.nextVariableId++}clone(e){const t=ie.runKernel(ug,{x:e}),s={x:e},r=a=>({x:()=>{const o="float32",l={x:a},u={dtype:o};return ie.runKernel(Qm,l,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[t],r,i,{}),t}runKernel(e,t,s){if(this.backendName==null&&this.backend,!(pR(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-i-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,s=[];const r=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const u=WS(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(WS(e)){const{kernelName:b,inputs:w,attrs:x}=e;this.backendName==null&&this.backend;const T=pR(b,this.backendName);H(T!=null,()=>`Cannot find registered kernel '${b}' for backend '${this.backendName}'`),o=()=>{const E=this.backend.numDataIds();l=T.kernelFunc({inputs:w,attrs:x,backend:this.backend});const $=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(b,E,$);const C=$.map(O=>O.rank!=null?O:this.makeTensorFromTensorInfo(O));if(r){const O=this.getTensorsForGradient(b,w,C);s=this.saveTensorsForBackwardMode(O)}return C}}else{const{forwardFunc:b}=e,w=x=>{r&&(s=x.map(T=>this.keep(this.clone(T))))};o=()=>{const x=this.backend.numDataIds();l=this.tidy(()=>b(this.backend,w));const T=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,x,T),T}}const{inputs:d,attrs:f}=e,m=WS(e)?null:e.backwardsFunc;let y;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=o():(y=this.profiler.profileKernel(u,d,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(y),t=y.outputs)}),r&&this.addTapeNode(u,d,t,m,s,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(d).map(b=>d[b]!=null?d[b].shape:null),outputShapes:t.map(b=>b.shape),kernelTimeMs:y.timeMs,extraInfo:y.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,t,s){const r=mR(e);if(r!=null){const i=r.inputsToSave||[],a=r.outputsToSave||[];let o;r.saveAllInputs?(H(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(t).map(u=>t[u])):o=i.map(u=>t[u]);const l=s.filter((u,d)=>a[d]);return o.concat(l)}return[]}makeTensor(e,t,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&jm(e[0])&&(i=e.map(l=>Ql(l)));const a=r.write(i,t,s),o=new Xn(t,s,a,this.nextTensorId());if(this.trackTensor(o,r),s==="string"){const l=this.state.tensorInfo.get(a),u=w9(i);this.state.numBytes+=u-l.bytes,l.bytes=u}return o}makeTensorFromDataId(e,t,s,r){s=s||"float32";const i={dataId:e,shape:t,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,t){const{dataId:s,shape:r,dtype:i}=e,a=new Xn(r,i,s,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e,t=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new M0(e,t,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*O0(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof M0||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*O0(e.dtype);this.state.numBytes-=s}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,s,r,i,a){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:s,saved:i},l=mR(e);l!=null&&(r=l.gradFunc),r!=null&&(o.gradient=u=>(u=u.map((d,f)=>{if(d==null){const m=s[f],y=Bs(m.size,m.dtype);return this.makeTensor(y,m.shape,m.dtype)}return d}),r(u.length>1?u:u[0],i,a))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=bP(e),s=new Set(t.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const a=this.state.activeScope.track[i];!a.kept&&!s.has(a.id)&&a.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,t,s,r=!1){if(H(t.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));H(i instanceof Xn,()=>"The result y returned by f() must be a tensor.");const a=q9(this.state.activeTape,t,i);if(!r&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[i.id]=s??t8(i.shape),K9(o,a,u=>this.tidy(u),n8);const l=t.map(u=>o[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const d of u.saved)d.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return H(RT(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{H(t.every(o=>o instanceof Xn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};t.forEach((o,l)=>{r[l]=o});const i=(o,l)=>(s=e(...t,l),H(s.value instanceof Xn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),H(RT(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),a=(o,l)=>{const u=s.gradFunc(o,l),d=Array.isArray(u)?u:[u];H(d.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),H(d.every(m=>m instanceof Xn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return d.forEach((m,y)=>{f[y]=()=>m}),f};return this.runKernelFunc({forwardFunc:i,backwardsFunc:a,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=yr(),s=await this.backend.time(e);return s.wallMs=yr()-t,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new wR;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};TI.nextTensorId=0;TI.nextVariableId=0;function t8(n){const e=R_(Ee(n),"float32");return ie.makeTensor(e,n,"float32")}function vP(){const n=BL();if(n._tfengine==null){const e=new E9(n);n._tfengine=new TI(e)}return C9(n._tfengine.ENV),Q9(()=>n._tfengine),n._tfengine}const ie=vP();function n8(n,e){const t={a:n,b:e};return ie.runKernel(tf,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s8(){return typeof navigator<"u"&&navigator!=null}function wP(n){if(n||s8()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function SP(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sr=xe();Sr.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Sr.registerFlag("IS_BROWSER",()=>SP());Sr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Sr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Sr.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Sr.registerFlag("PROD",()=>!1);Sr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Sr.getBool("DEBUG"));Sr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Sr.registerFlag("IS_TEST",()=>!1);Sr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Sr.getBool("DEBUG"));Sr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Sr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Sr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fv(n,e){let t=n;if(_i(n))return e==="string"?[]:[n.length];if(gP(n)){const r=n.channels||"RGBA";return[n.height,n.width*r.length]}else if(yP(n))return[n.buffer.size/(e==null?4:O0(e))];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(t)||_i(t)&&e!=="string";)s.push(t.length),t=t[0];return Array.isArray(n)&&xe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&TP(n,s,[]),s}function TP(n,e,t){if(t=t||[],!Array.isArray(n)&&!_i(n)){H(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}H(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),H(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const s=e.slice(1);for(let r=0;r<n.length;++r)TP(n[r],s,t.concat(r))}function SR(n,e,t,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${s}' must be ${n} tensor, but got ${e} tensor`)}}function Y(n,e,t,s="numeric"){if(n instanceof Se())return SR(s,n.dtype,e,t),n;let r=Jd(n);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),SR(s,r,e,t),n==null||!_i(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const i=Fv(n,r);!_i(n)&&!Array.isArray(n)&&(n=[n]);const o=r!=="string"?Zu(n,r):Nu(n,[],!0);return ie.makeTensor(o,i,r)}function EP(n,e,t,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((i,a)=>Y(i,`${e}[${a}]`,t,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r8="__op";function ue(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const s=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+r8;const r=(...i)=>{ie.startScope(t);try{const a=s(...i);return D_(a)&&console.error("Cannot return a Promise inside of tidy."),ie.endScope(a),a}catch(a){throw ie.endScope(null),a}};return Object.defineProperty(r,"name",{value:t,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i8(n,e){const t=Y(n,"real","complex"),s=Y(e,"imag","complex");A_(t.shape,s.shape,`real and imag shapes, ${t.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:t,imag:s};return ie.runKernel(U_,r)}const Id=ue({complex_:i8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lv(n,e,t,s){if(s==null)s=Jd(n);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(yP(n)||gP(n)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return ie.backend.createTensorFromGPUData(n,e||t,s)}if(!_i(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Go(e);const r=Ee(e),i=Ee(t);H(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let a=0;a<t.length;++a){const o=t[a],l=a===t.length-1?o!==Ee(e.slice(a)):!0;H(t[a]===e[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!_i(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=s!=="string"?Zu(n,s):Nu(n,[],!0),ie.makeTensor(n,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _P(n,e,t){const s=Fv(n,t);return Lv(n,e,s,t)}class nf{static join(e){return new nf(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>_i(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=t+r.byteLength;this.shards.push({buffer:r,start:t,end:i}),t=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=t-e,i=new ArrayBuffer(r),a=new Uint8Array(i);let o=0;for(let l=s;l<this.shards.length;l++){const u=this.shards[l],f=e+o-u.start,m=o,b=Math.min(t,u.end)-u.start,w=new Uint8Array(u.buffer,f,b-f);if(a.set(w,m),o+=w.length,t<u.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(r){return e<r.start?-1:e>=r.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=a8(this.shards,t);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function a8(n,e){let t=0,s=n.length;for(;t<=s;){const r=Math.floor((s-t)/2)+t,i=e(n[r]);if(i===0)return r;i<0?s=r:t=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function va(){return ie}function TR(){return ie.memory()}function ge(n,e){return ie.tidy(n,e)}function vt(n){bP(n).forEach(t=>t.dispose())}function Aa(n){return ie.keep(n)}function o8(){return ie.ready()}function IP(n,e,t=1){return ie.registerBackend(n,e,t)}function l8(){return ie.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ER=4;async function _R(n,e){const t=[],s=[],r=Array.isArray(n)?n.map(a=>a.name):Object.keys(n);for(let a=0;a<r.length;++a){const o=r[a],l=Array.isArray(n)?n[a].tensor:n[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const u={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const d=new Promise(async f=>{const m=await l.bytes(),y=m.reduce((x,T)=>x+T.length,0)+ER*m.length,b=new Uint8Array(y);let w=0;for(let x=0;x<m.length;x++){const T=m[x],E=new Uint8Array(new Uint32Array([T.length]).buffer);b.set(E,w),w+=ER,b.set(T,w),w+=T.length}f(b)});s.push(d)}else s.push(l.data());e!=null&&(u.group=e),t.push(u)}const i=await Promise.all(s);return{data:c8(i),specs:t}}function c8(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(i=>{if(e+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return t.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const EI=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function IR(n){return EI?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function u8(n){if(EI)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let s=0,r=e.length;s<r;s++)t+=String.fromCharCode(e[s]);return btoa(t)}function h8(n){if(EI){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t.set([e.charCodeAt(s)],s);return t.buffer}function d8(n){return nf.join(n)}function $P(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:IR(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:IR(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new nf(n.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Vg=class Mi{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Mi.instance==null&&(Mi.instance=new Mi),Mi.instance}static registerSaveRouter(e){Mi.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Mi.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Mi.getHandlers(e,"save")}static getLoadHandlers(e,t){return Mi.getHandlers(e,"load",t)}static getHandlers(e,t,s){const r=[];return(t==="load"?Mi.getInstance().loadRouters:Mi.getInstance().saveRouters).forEach(a=>{const o=a(e,s);o!==null&&r.push(o)}),r}};const f8=n=>Vg.getSaveHandlers(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jT="tensorflowjs",WT=1,pu="models_store",Ml="model_info_store";function CP(){if(!xe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function GT(n){const e=n.result;e.createObjectStore(pu,{keyPath:"modelPath"}),e.createObjectStore(Ml,{keyPath:"modelPath"})}let ku=class{constructor(e){if(this.indexedDB=CP(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((s,r)=>{const i=this.indexedDB.open(jT,WT);i.onupgradeneeded=()=>GT(i),i.onsuccess=()=>{const a=i.result;if(t==null){const o=a.transaction(pu,"readonly"),u=o.objectStore(pu).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return a.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=d=>(a.close(),r(u.error)),o.oncomplete=()=>a.close()}else{t.weightData=nf.join(t.weightData);const o=$P(t),l=a.transaction(Ml,"readwrite");let u=l.objectStore(Ml),d;try{d=u.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(m){return r(m)}let f;d.onsuccess=()=>{f=a.transaction(pu,"readwrite");const m=f.objectStore(pu);let y;try{y=m.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o})}catch(b){return r(b)}y.onsuccess=()=>s({modelArtifactsInfo:o}),y.onerror=b=>{u=l.objectStore(Ml);const w=u.delete(this.modelPath);w.onsuccess=()=>(a.close(),r(y.error)),w.onerror=x=>(a.close(),r(y.error))}},d.onerror=m=>(a.close(),r(d.error)),l.oncomplete=()=>{f==null?a.close():f.oncomplete=()=>a.close()}}},i.onerror=a=>r(i.error)})}};ku.URL_SCHEME="indexeddb://";const NP=n=>xe().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(ku.URL_SCHEME)?p8(n.slice(ku.URL_SCHEME.length)):null;Vg.registerSaveRouter(NP);Vg.registerLoadRouter(NP);function p8(n){return new ku(n)}function m8(n){return n.startsWith(ku.URL_SCHEME)?n.slice(ku.URL_SCHEME.length):n}let g8=class{constructor(){this.indexedDB=CP()}async listModels(){return new Promise((e,t)=>{const s=this.indexedDB.open(jT,WT);s.onupgradeneeded=()=>GT(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(Ml,"readonly"),o=i.objectStore(Ml).getAll();o.onsuccess=()=>{const l={};for(const u of o.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},o.onerror=l=>(r.close(),t(o.error)),i.oncomplete=()=>r.close()},s.onerror=r=>t(s.error)})}async removeModel(e){return e=m8(e),new Promise((t,s)=>{const r=this.indexedDB.open(jT,WT);r.onupgradeneeded=()=>GT(r),r.onsuccess=()=>{const i=r.result,a=i.transaction(Ml,"readwrite"),o=a.objectStore(Ml),l=o.get(e);let u;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const d=o.delete(e),f=()=>{u=i.transaction(pu,"readwrite");const y=u.objectStore(pu).delete(e);y.onsuccess=()=>t(l.result.modelArtifactsInfo),y.onerror=b=>s(l.error)};d.onsuccess=f,d.onerror=m=>(f(),i.close(),s(l.error))}},l.onerror=d=>(i.close(),s(l.error)),a.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const To="/",td="tensorflowjs_models",kP="info",y8="model_topology",b8="weight_specs",x8="weight_data",v8="model_metadata";function AP(n){return{info:[td,n,kP].join(To),topology:[td,n,y8].join(To),weightSpecs:[td,n,b8].join(To),weightData:[td,n,x8].join(To),modelMetadata:[td,n,v8].join(To)}}function RP(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function w8(n){const e=n.split(To);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(To)}function S8(n){return n.startsWith(Au.URL_SCHEME)?n.slice(Au.URL_SCHEME.length):n}let Au=class{constructor(e){if(!xe().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=AP(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=$P(e),i=nf.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,u8(i));const a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:r}}catch{throw RP(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const o=JSON.parse(i);t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy,o.signature!=null&&(t.signature=o.signature),o.userDefinedMetadata!=null&&(t.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(t.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(t.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(t.trainingConfig=o.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=h8(a),t}};Au.URL_SCHEME="localstorage://";const DP=n=>xe().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Au.URL_SCHEME)?T8(n.slice(Au.URL_SCHEME.length)):null;Vg.registerSaveRouter(DP);Vg.registerLoadRouter(DP);function T8(n){return new Au(n)}let E8=class{constructor(){H(xe().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),H(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=td+To,s=To+kP;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(t)&&i.endsWith(s)){const a=w8(i);e[a]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=S8(e);const t=AP(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(t.info));return RP(t),s}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $R="://";let CR=class Rl{constructor(){this.managers={}}static getInstance(){return Rl.instance==null&&(Rl.instance=new Rl),Rl.instance}static registerManager(e,t){H(e!=null,()=>"scheme must not be undefined or null."),e.endsWith($R)&&(e=e.slice(0,e.indexOf($R))),H(e.length>0,()=>"scheme must not be an empty string.");const s=Rl.getInstance();H(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=t}static getManager(e){const t=Rl.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(Rl.getInstance().managers)}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _8=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!xe().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return uP(e)}};if(xe().get("IS_BROWSER")){xe().setPlatform("browser",new _8);try{CR.registerManager(Au.URL_SCHEME,new E8)}catch{}try{CR.registerManager(ku.URL_SCHEME,new g8)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I8={importFetch:()=>require("node-fetch")};let GS,$8=class{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return xe().global.fetch!=null?xe().global.fetch(e,t):(GS==null&&(GS=I8.importFetch()),GS(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}};xe().get("IS_NODE")&&!xe().get("IS_BROWSER")&&xe().setPlatform("node",new $8);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mt(n,e="float32",t){return e=e||"float32",Go(n),new _s(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C8(n,e){const t=Y(n,"x","cast");if(!v9(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:t},r={dtype:e};return ie.runKernel(Qm,s,r)}const Ue=ue({cast_:C8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N8(n){const t={x:Y(n,"x","clone","string_or_numeric")};return ie.runKernel(ug,t)}const xu=ue({clone_:N8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k8(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */vP();const A8={buffer:mt,cast:Ue,clone:xu,print:k8};Z9(A8);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R8(n,e){let t=Y(n,"a","add"),s=Y(e,"b","add");[t,s]=Fn(t,s);const r={a:t,b:s};return ie.runKernel(tf,r)}const Oe=ue({add_:R8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D8(n,e){let t=Y(n,"a","floorDiv"),s=Y(e,"b","floorDiv");[t,s]=Fn(t,s);const r={a:t,b:s};return ie.runKernel(lg,r)}const OP=ue({floorDiv_:D8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O8(n,e){let t=Y(n,"a","div"),s=Y(e,"b","div");if([t,s]=Fn(t,s),t.dtype==="int32"&&s.dtype==="int32")return OP(t,s);const r={a:t,b:s},i={};return ie.runKernel(ng,r,i)}const Je=ue({div_:O8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F8(n,e){let t=Y(n,"a","mul"),s=Y(e,"b","mul");[t,s]=Fn(t,s);const r={a:t,b:s};return ie.runKernel(xg,r)}const se=ue({mul_:F8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L8(n){const e=Y(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return ie.runKernel(zx,t)}else{const t={x:e};return ie.runKernel(Ox,t)}}const Qs=ue({abs_:L8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P8(n){const t={x:Y(n,"x","acos")};return ie.runKernel(Wm,t)}const M8=ue({acos_:P8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8(n){const t={x:Y(n,"x","acosh")};return ie.runKernel(Gm,t)}const B8=ue({acosh_:V8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z8(n,e=null,t=!1){const r={x:Y(n,"x","all","bool")},i={axis:e,keepDims:t};return ie.runKernel(L_,r,i)}const FP=ue({all_:z8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U8(n,e=null,t=!1){const r={x:Y(n,"x","any","bool")},i={axis:e,keepDims:t};return ie.runKernel(P_,r,i)}const HT=ue({any_:U8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j8(n,e=0){const s={x:Y(n,"x","argMax")},r={axis:e};return ie.runKernel(Fx,s,r)}const dm=ue({argMax_:j8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8(n,e=0){const s={x:Y(n,"x","argMin")},r={axis:e};return ie.runKernel(Lx,s,r)}const G8=ue({argMin_:W8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H8(n){const t={x:Y(n,"x","asin")};return ie.runKernel(Hm,t)}const q8=ue({asin_:H8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8(n){const t={x:Y(n,"x","asinh")};return ie.runKernel(qm,t)}const X8=ue({asinh_:K8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y8(n){const t={x:Y(n,"x","atan")};return ie.runKernel(Km,t)}const Q8=ue({atan_:Y8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8(n,e){let t=Y(n,"a","atan2"),s=Y(e,"b","atan2");[t,s]=Fn(t,s);const r={a:t,b:s};return ie.runKernel(Ym,r)}const J8=ue({atan2_:Z8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e7(n){const t={x:Y(n,"x","atanh")};return ie.runKernel(Xm,t)}const t7=ue({atanh_:e7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bg(n,e,t,s,r="NHWC",i){const a=n[3],o=[...e,a],l=qo(r);return Cs(n,o,t,i,s,null,null,l)}function $i(n,e,t,s,r,i,a="channelsLast"){const[o,l]=fm(e);let u;if(a==="channelsLast")u=[o,l,n[3],n[3]];else if(a==="channelsFirst")u=[o,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return Cs(n,u,t,s,r,i,!1,a)}function Ho(n,e,t,s,r,i,a="NDHWC"){const[o,l,u]=qT(e);let d,f;if(a==="NDHWC")f="channelsLast",d=[o,l,u,n[4],n[4]];else if(a==="NCDHW")f="channelsFirst",d=[o,l,u,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return gc(n,d,t,s,r,!1,f,i)}function Cs(n,e,t,s,r,i,a=!1,o="channelsLast"){let[l,u,d,f]=[-1,-1,-1,-1];if(o==="channelsLast")[l,u,d,f]=n;else if(o==="channelsFirst")[l,f,u,d]=n;else throw new Error(`Unknown dataFormat ${o}`);const[m,y,,b]=e,[w,x]=fm(t),[T,E]=fm(s),$=fd(m,T),C=fd(y,E),{padInfo:O,outHeight:V,outWidth:F}=r7(r,u,d,w,x,$,C,i,o),R=a?b*f:b;let N;return o==="channelsFirst"?N=[l,R,V,F]:o==="channelsLast"&&(N=[l,V,F,R]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:d,inChannels:f,outHeight:V,outWidth:F,outChannels:R,padInfo:O,strideHeight:w,strideWidth:x,filterHeight:m,filterWidth:y,effectiveFilterHeight:$,effectiveFilterWidth:C,dilationHeight:T,dilationWidth:E,inShape:n,outShape:N,filterShape:e}}function gc(n,e,t,s,r,i=!1,a="channelsLast",o){let[l,u,d,f,m]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[l,u,d,f,m]=n;else if(a==="channelsFirst")[l,m,u,d,f]=n;else throw new Error(`Unknown dataFormat ${a}`);const[y,b,w,,x]=e,[T,E,$]=qT(t),[C,O,V]=qT(s),F=fd(y,C),R=fd(b,O),N=fd(w,V),{padInfo:D,outDepth:k,outHeight:z,outWidth:B}=i7(r,u,d,f,T,E,$,F,R,N,o),ne=i?x*m:x;let J;return a==="channelsFirst"?J=[l,ne,k,z,B]:a==="channelsLast"&&(J=[l,k,z,B,ne]),{batchSize:l,dataFormat:a,inDepth:u,inHeight:d,inWidth:f,inChannels:m,outDepth:k,outHeight:z,outWidth:B,outChannels:ne,padInfo:D,strideDepth:T,strideHeight:E,strideWidth:$,filterDepth:y,filterHeight:b,filterWidth:w,effectiveFilterDepth:F,effectiveFilterHeight:R,effectiveFilterWidth:N,dilationDepth:C,dilationHeight:O,dilationWidth:V,inShape:n,outShape:J,filterShape:e}}function n7(n,e,t,s,r){s==null&&(s=_I(n,e,t));const i=n[0],a=n[1],o=pm((i-e+2*s)/t+1,r),l=pm((a-e+2*s)/t+1,r);return[o,l]}function s7(n,e,t,s,r,i){r==null&&(r=_I(n,e[0],s[0]));const a=[0,0,0,t];for(let o=0;o<3;o++)n[o]+2*r>=e[o]&&(a[o]=pm((n[o]-e[o]+2*r)/s[o]+1,i));return a}function _I(n,e,t,s=1){const r=fd(e,s);return Math.floor((n[0]*(t-1)-t+r)/2)}function fm(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function qT(n){return typeof n=="number"?[n,n,n]:n}function fd(n,e){return e<=1?n:n+(n-1)*(e-1)}function r7(n,e,t,s,r,i,a,o,l){let u,d,f;if(typeof n=="number"){u={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const y=n7([e,t],i,s,n,o);d=y[0],f=y[1]}else if(n==="same"){d=Math.ceil(e/s),f=Math.ceil(t/r);const m=Math.max(0,(d-1)*s+i-e),y=Math.max(0,(f-1)*r+a-t),b=Math.floor(m/2),w=m-b,x=Math.floor(y/2),T=y-x;u={top:b,bottom:w,left:x,right:T,type:"SAME"}}else if(n==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((e-i+1)/s),f=Math.ceil((t-a+1)/r);else if(typeof n=="object"){const m=l==="channelsLast"?n[1][0]:n[2][0],y=l==="channelsLast"?n[1][1]:n[2][1],b=l==="channelsLast"?n[2][0]:n[3][0],w=l==="channelsLast"?n[2][1]:n[3][1];u={top:m,bottom:y,left:b,right:w,type:m===0&&y===0&&b===0&&w===0?"VALID":"EXPLICIT"},d=pm((e-i+m+y)/s+1,o),f=pm((t-a+b+w)/r+1,o)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:u,outHeight:d,outWidth:f}}function i7(n,e,t,s,r,i,a,o,l,u,d){let f,m,y,b;if(n==="valid"&&(n=0),typeof n=="number"){f={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const x=s7([e,t,s,1],[o,l,u],1,[r,i,a],n,d);m=x[0],y=x[1],b=x[2]}else if(n==="same"){m=Math.ceil(e/r),y=Math.ceil(t/i),b=Math.ceil(s/a);const w=(m-1)*r+o-e,x=(y-1)*i+l-t,T=(b-1)*a+u-s,E=Math.floor(w/2),$=w-E,C=Math.floor(x/2),O=x-C,V=Math.floor(T/2),F=T-V;f={top:C,bottom:O,left:V,right:F,front:E,back:$,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:f,outDepth:m,outHeight:y,outWidth:b}}function pm(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function Ru(n){const[e,t,s]=fm(n);return e===1&&t===1&&s===1}function js(n,e){return Ru(n)||Ru(e)}function Du(n){return fm(n).every(e=>e>0)}function qo(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function Er(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")H(_d(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{H(_d(r),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${r}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a7(n,e){const s={x:Y(n,"x","reshape","string_or_numeric")},r={shape:e};return ie.runKernel(wv,s,r)}const ce=ue({reshape_:a7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o7(n,e,t,s,r){const i=Y(n,"x","avgPool","float32"),a=1;H(js(t,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);let o=i,l=!1;i.rank===3&&(l=!0,o=ce(i,[1,i.shape[0],i.shape[1],i.shape[2]])),H(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),Er("avgPool",s,r);const u={x:o},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r};let f=ie.runKernel(Px,u,d);return f=Ue(f,i.dtype),l?ce(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const II=ue({avgPool_:o7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l7(n,e,t,s,r,i="NDHWC"){const a=Y(n,"x","avgPool3d","float32");let o=a,l=!1;a.rank===4&&(l=!0,o=ce(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),H(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),H(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),H(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),Er("avgPool3d",s,r);const u={x:o},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:i};let f=ie.runKernel(Mx,u,d);return f=Ue(f,o.dtype),l?ce(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const c7=ue({avgPool3d_:l7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7(n,e=0){H(n.length>=1,()=>"Pass at least one tensor to concat");const t=EP(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),t.length===1)return xu(t[0]);const s=t,r={axis:e};return ie.runKernel(Ux,s,r)}const wr=ue({concat_:u7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h7(n,e,t=!1,s=!1){let r=Y(n,"a","matMul"),i=Y(e,"b","matMul");[r,i]=Fn(r,i);const a={a:r,b:i},o={transposeA:t,transposeB:s};return ie.runKernel(Vx,a,o)}const jt=ue({matMul_:h7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d7(n){const t={x:Y(n,"x","sigmoid","float32")};return ie.runKernel(kg,t)}const sf=ue({sigmoid_:d7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f7(n,e,t){const s=Y(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:t};return ie.runKernel(Iv,r,i)}const sn=ue({slice_:f7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p7(n){const t={x:Y(n,"x","tanh","float32")};return ie.runKernel(Lg,t)}const Pv=ue({tanh_:p7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7(n,e,t){const s=Y(n,"x","batchToSpaceND"),r=e.reduce((o,l)=>o*l);H(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),H(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),H(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},a={blockShape:e,crops:t};return ie.runKernel(Bx,i,a)}const $I=ue({batchToSpaceND_:m7});function g7(n){let e;return n.rank===0||n.rank===1?e=ce(n,[1,1,1,n.size]):n.rank===2?e=ce(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=ce(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y7(n,e,t,s,r,i){i==null&&(i=.001);const a=Y(n,"x","batchNorm"),o=Y(e,"mean","batchNorm"),l=Y(t,"variance","batchNorm");let u;r!=null&&(u=Y(r,"scale","batchNorm"));let d;s!=null&&(d=Y(s,"offset","batchNorm")),H(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),H(d==null||o.rank===d.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),H(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const m={x:g7(a),scale:u,offset:d,mean:o,variance:l},y={varianceEpsilon:i},b=ie.runKernel(Qx,m,y);return ce(b,a.shape)}const Mv=ue({batchNorm_:y7});function b7(n,e,t,s,r,i){const a=Y(n,"x","batchNorm"),o=Y(e,"mean","batchNorm"),l=Y(t,"variance","batchNorm");let u;r!=null&&(u=Y(r,"scale","batchNorm"));let d;return s!=null&&(d=Y(s,"offset","batchNorm")),H(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),H(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),H(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&H(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),d!=null&&H(d.rank===2||d.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${d.rank}.`),Mv(a,o,l,d,u,i)}const x7=ue({batchNorm2d_:b7});function v7(n,e,t,s,r,i){const a=Y(n,"x","batchNorm"),o=Y(e,"mean","batchNorm"),l=Y(t,"variance","batchNorm");let u;r!=null&&(u=Y(r,"scale","batchNorm"));let d;return s!=null&&(d=Y(s,"offset","batchNorm")),H(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),H(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),H(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&H(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),d!=null&&H(d.rank===3||d.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${d.rank}.`),Mv(a,o,l,d,u,i)}const w7=ue({batchNorm3d_:v7});function S7(n,e,t,s,r,i){const a=Y(n,"x","batchNorm"),o=Y(e,"mean","batchNorm"),l=Y(t,"variance","batchNorm");let u;r!=null&&(u=Y(r,"scale","batchNorm"));let d;return s!=null&&(d=Y(s,"offset","batchNorm")),H(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),H(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),H(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&H(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),d!=null&&H(d.rank===4||d.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${d.rank}.`),Mv(a,o,l,d,u,i)}const T7=ue({batchNorm4d_:S7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E7(n,e,t){const s=Y(n,"x","bincount"),r=Y(e,"weights","bincount");H(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),H(t>=0,()=>`size must be non-negative, but got ${t}.`),H(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},a={size:t};return ie.runKernel(B_,i,a)}const _7=ue({bincount_:E7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I7(n,e){let t=Y(n,"broadcastTo","x");const s=t.shape;if(Go(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const u=t.shape.slice();for(;u.length<e.length;)u.unshift(1);t=ce(t,u)}const r=t.shape,i=Array.from(e);for(let u=e.length-1;u>=0;u--)if(r[u]===e[u])i[u]=1;else if(t.shape[u]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((u,d)=>u>1?d:-1).filter(u=>u>=0).length===0)return xu(t);const o={x:t},l={reps:i};return ie.runKernel(Pg,o,l)}const Jp=ue({broadcastTo_:I7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $7(n){const t={x:Y(n,"x","ceil","float32")};return ie.runKernel(Zm,t)}const C7=ue({ceil_:$7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vv(n,e,t){Go(n),t=t||Jd(e);const s={shape:n,value:e,dtype:t};return ie.runKernel(tI,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N7(n,e,t){const s=Y(n,"x","clipByValue");if(H(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return Vv(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:t};return ie.runKernel(Jm,r,i)}const Yr=ue({clipByValue_:N7});function k7(n){return wr(n,0)}const A7=ue({concat1d_:k7});function R7(n,e){return wr(n,e)}const D7=ue({concat2d_:R7});function O7(n,e){return wr(n,e)}const F7=ue({concat3d_:O7});function L7(n,e){return wr(n,e)}const P7=ue({concat4d_:L7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M7(n,e,t,s,r="NHWC",i=[1,1],a){const o=Y(n,"x","conv2d","float32"),l=Y(e,"filter","conv2d","float32");let u=o,d=!1;o.rank===3&&(d=!0,u=ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),H(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),H(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Er("conv2d",s,a);const f=r==="NHWC"?u.shape[3]:u.shape[1];H(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),H(js(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),H(Du(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),H(Du(t),()=>"Error in conv2D: Strides should be larger than 0.");const m={x:u,filter:l},y={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a},b=ie.runKernel(jx,m,y);return d?ce(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const Ou=ue({conv2d_:M7});function V7(n,e,t,s,r="NWC",i=1,a){const o=Y(n,"x","conv1d"),l=Y(e,"filter","conv1d");let u=o,d=!1;o.rank===2&&(d=!0,u=ce(o,[1,o.shape[0],o.shape[1]])),H(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),H(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Er("conv1d",s,a),H(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),H(js(t,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${i}'`),H(Du(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),H(Du(t),()=>"Error in conv1D: Stride should be larger than 0."),H(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const f=ce(l,[1,l.shape[0],l.shape[1],l.shape[2]]),m=ce(u,[u.shape[0],1,u.shape[1],u.shape[2]]),x=Ou(m,f,[1,t],s,"NHWC",[1,i],a);return d?ce(x,[x.shape[2],x.shape[3]]):ce(x,[x.shape[0],x.shape[2],x.shape[3]])}const LP=ue({conv1d_:V7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B7(n,e,t,s,r,i="NHWC",a){H(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,l=e,u=!1;e.rank===3&&(u=!0,l=ce(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,n[0],n[1],n[2]]),H(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),H(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),H(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const d=i==="NHWC"?o[3]:o[1],f=i==="NHWC"?l.shape[3]:l.shape[1];H(d===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${d}) must match input depth for filter ${t.shape[2]}.`),H(f===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${t.shape[3]}.`),Er("conv2dDerInput",r,a);const m={dy:l,filter:t},y={strides:s,pad:r,dataFormat:i,dimRoundingMode:a,inputShape:o},b=ie.runKernel(Wx,m,y);return u?ce(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const CI=ue({conv2DBackpropInput_:B7});function z7(n,e,t,s,r,i){const a=Y(n,"x","conv2dTranspose"),o=Y(e,"filter","conv2dTranspose");return CI(t,a,o,s,r,"NHWC",i)}const PP=ue({conv2dTranspose_:z7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U7(n,e,t,s,r="NDHWC",i=[1,1,1]){const a=Y(n,"x","conv3d"),o=Y(e,"filter","conv3d");let l=a,u=!1;a.rank===4&&(u=!0,l=ce(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),H(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),H(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),H(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),H(js(t,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),H(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),H(Du(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),H(Du(t),()=>"Error in conv3D: Strides should be larger than 0.");const d={x:l,filter:o},f={strides:t,pad:s,dataFormat:r,dilations:i},m=ie.runKernel(Gx,d,f);return u?ce(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const j7=ue({conv3d_:U7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W7(n,e,t,s,r){H(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let i=n,a=e,o=!1;e.rank===4&&(o=!0,a=ce(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,n[0],n[1],n[2],n[3]]);const l=i[4],u=a.shape[4];H(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),H(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),H(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),H(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),H(u===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${t.shape[4]}.`);const d={dy:a,filter:t},f={pad:r,strides:s,inputShape:i},m=ie.runKernel(G_,d,f);return o?ce(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const MP=ue({conv3DBackpropInput_:W7});function G7(n,e,t,s,r){const i=Y(n,"x","conv3dTranspose"),a=Y(e,"filter","conv3dTranspose");return MP(t,i,a,s,r)}const H7=ue({conv3dTranspose_:G7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7(n){const t={x:Y(n,"x","cos","float32")};return ie.runKernel(eg,t)}const NI=ue({cos_:q7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K7(n){const t={x:Y(n,"x","cosh","float32")};return ie.runKernel(tg,t)}const VP=ue({cosh_:K7});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7(n,e=0,t=!1,s=!1){const i={x:Y(n,"x","cumprod")},a={axis:e,exclusive:t,reverse:s};return ie.runKernel(H_,i,a)}const KT=ue({cumprod_:X7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(n,e=0,t=!1,s=!1){const i={x:Y(n,"x","cumsum")},a={axis:e,exclusive:t,reverse:s};return ie.runKernel(Hx,i,a)}const BP=ue({cumsum_:Y7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q7(n,e,t,s=!1){const r=Y(n,"x","denseBincount"),i=Y(e,"weights","denseBincount");H(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),H(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),H(t>=0,()=>`size must be non-negative, but got ${t}.`),H(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const a={x:r,weights:i},o={size:t,binaryOutput:s};return ie.runKernel(K_,a,o)}const NR=ue({denseBincount_:Q7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z7(n,e,t="NHWC"){const s=Y(n,"x","depthToSpace","float32"),r=t==="NHWC"?s.shape[1]:s.shape[2],i=t==="NHWC"?s.shape[2]:s.shape[3],a=t==="NHWC"?s.shape[3]:s.shape[1];H(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),H(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),H(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),H(a%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${s.shape}`);const o={x:s},l={blockSize:e,dataFormat:t};return ie.runKernel(X_,o,l)}const J7=ue({depthToSpace_:Z7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eX(n,e,t,s,r="NHWC",i=[1,1],a){const o=Y(n,"x","depthwiseConv2d","float32"),l=Y(e,"filter","depthwiseConv2d","float32");let u=o,d=!1;o.rank===3&&(d=!0,u=ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),H(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),H(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const f=r==="NHWC"?u.shape[3]:u.shape[1];H(f===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${l.shape[2]}.`),Er("depthwiseConv2d",s,a);const m={x:u,filter:l},y={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a},b=ie.runKernel(qx,m,y);return d?ce(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const kI=ue({depthwiseConv2d_:eX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tX(n,e,t,s,r=[1,1],i="NHWC"){const a=Y(n,"x","dilation2d"),o=Y(e,"filter","dilation2d");H(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),H(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),H(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=a,u=!1;a.rank===3&&(l=ce(a,[1,a.shape[0],a.shape[1],a.shape[2]]),u=!0),H(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const d={x:l,filter:o},f={strides:t,pad:s,dilations:r},m=ie.runKernel(Kx,d,f);return u?ce(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const nX=ue({dilation2d_:tX});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $d(n,e){const t=n.length,s=[];for(let r=0;r<t;r++){const i=t-1-r,a=n[i]||1;(e[e.length-1-r]||1)>1&&a===1&&s.unshift(i)}return s}function ts(n,e){const t=[];for(let s=0;s<e.length;s++){const r=n[n.length-s-1],i=e.length-s-1,a=e[i];(r==null||r===1&&a>1)&&t.unshift(i)}return t}function ot(n,e){const t=Math.max(n.length,e.length),s=new Array(t);for(let r=0;r<t;r++){let i=n[n.length-r-1];i==null&&(i=1);let a=e[e.length-r-1];if(a==null&&(a=1),i===1)s[t-r-1]=a;else if(a===1)s[t-r-1]=i;else if(i!==a){const o=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(o)}else s[t-r-1]=i}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sX(n,e){let t=Y(n,"a","equal","string_or_numeric"),s=Y(e,"b","equal","string_or_numeric");[t,s]=Fn(t,s),ot(t.shape,s.shape);const r={a:t,b:s};return ie.runKernel(Xx,r)}const Pa=ue({equal_:sX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rX(n,e,t){const s=Y(e,"a","where"),r=Y(t,"b","where"),i=Y(n,"condition","where","bool"),a=ot(ot(i.shape,s.shape),r.shape),o=Jp(i,a),l=Jp(s,a),u=Jp(r,a),d={condition:o,t:l,e:u};return ie.runKernel(_v,d)}const ar=ue({where_:rX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iX(n){const t={x:Y(n,"x","zerosLike")};return ie.runKernel(Dv,t)}const $t=ue({zerosLike_:iX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aX(n,e){let t=Y(n,"a","div"),s=Y(e,"b","div");[t,s]=Fn(t,s);const r=Je(t,s),i=$t(r),a=Pa(s,i);return ar(a,i,r)}const oX=ue({divNoNan_:aX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lX(n,e){const t=Y(n,"t1","dot"),s=Y(e,"t2","dot");H((t.rank===1||t.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${s.rank}.`);const r=t.rank===1?t.size:t.shape[1],i=s.rank===1?s.size:s.shape[0];if(H(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),t.rank===1&&s.rank===1){const a=ce(t,[1,-1]),o=ce(s,[-1,1]),l=jt(a,o);return ce(l,[])}else if(t.rank===1&&s.rank===2){const a=ce(t,[1,-1]),o=ce(s,[s.shape[0],s.shape[1]]),l=jt(a,o);return ce(l,[l.size])}else if(t.rank===2&&s.rank===1){const a=ce(s,[-1,1]),o=jt(t,a);return ce(o,[o.size])}else{const a=ce(s,[s.shape[0],s.shape[1]]);return jt(t,a)}}const cX=ue({dot_:lX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uX(n,...e){const t=e.map((r,i)=>Y(r,`tensors${i}`,"einsum")),s={equation:n};return ie.runKernel(Z_,t,s)}const kp=ue({einsum_:uX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hX(n){const t={x:Y(n,"x","elu","float32")};return ie.runKernel(sg,t)}const Bv=ue({elu_:hX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dX(n){let e=Y(n,"x","erf");H(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Ue(e,"float32"));const t={x:e};return ie.runKernel(rg,t)}const zP=ue({erf_:dX});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AI(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function UP(n,e,t){const s=n.length+e.length,r=[];let i=0,a=0;for(let o=0;o<s;o++)t.indexOf(o)===-1?r.push(n[i++]):r.push(e[a++]);return r}function ps(n,e){const t=[],s=n.length;for(let i=0;i<s;i++)e.indexOf(i)===-1&&t.push(n[i]);const r=e.map(i=>n[i]);return[t,r]}function jn(n,e){const t=e.map(s=>1);return UP(n,t,e)}function Ns(n,e,t){H(AI(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function Sn(n,e){if(AI(n,e))return null;const t=[];for(let s=0;s<e;++s)n.indexOf(s)===-1&&t.push(s);return n.forEach(s=>t.push(s)),t}function yc(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Ln(n,e){const t=[];for(let s=e-n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fX(n,e=null,t=!1){const r={x:Y(n,"x","max")},i={reductionIndices:e,keepDims:t};return ie.runKernel(ov,r,i)}const Gi=ue({max_:fX});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pX(n,e=null,t=!1){const r={x:Y(n,"x","min")},i={axis:e,keepDims:t};return ie.runKernel(hv,r,i)}const V0=ue({min_:pX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mX(n,e){let t=Y(n,"base","pow"),s=Y(e,"exp","pow");[t,s]=Fn(t,s);const r={a:t,b:s};return ie.runKernel(vg,r)}const Fu=ue({pow_:mX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wt(n,e){if((_i(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&_i(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Lv(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gX(n){const t={x:Y(n,"x","sqrt","float32")};return ie.runKernel(Rg,t)}const zs=ue({sqrt_:gX});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yX(n){const e=Y(n,"x","square"),t={};return ie.runKernel("Square",{x:e},t)}const gn=ue({square_:yX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bX(n,e=null,t=!1){let s=Y(n,"x","sum");s.dtype==="bool"&&(s=Ue(s,"int32"));const r={x:s},i={axis:e,keepDims:t};return ie.runKernel($v,r,i)}const Ze=ue({sum_:bX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xX(n,e="euclidean",t=null,s=!1){n=Y(n,"x","norm");const r=jP(n,e,t);let i=r.shape;if(s){const a=gt(t,n.shape);i=jn(r.shape,a)}return ce(r,i)}function jP(n,e,t=null){if(n.rank===0)return Qs(n);if(n.rank!==1&&t===null)return jP(ce(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Ze(Qs(n),t);if(e===1/0)return Gi(Qs(n),t);if(e===-1/0)return V0(Qs(n),t);if(e==="euclidean"||e===2)return zs(Ze(Fu(Qs(n),Wt(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return Gi(Ze(Qs(n),t[0]),t[1]-1);if(e===1/0)return Gi(Ze(Qs(n),t[1]),t[0]);if(e===-1/0)return V0(Ze(Qs(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return zs(Ze(gn(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const Cd=ue({norm_:xX});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vX(n,e=null,t=!1){return Cd(n,"euclidean",e,t)}const wX=ue({euclideanNorm_:vX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SX(n){const t={x:Y(n,"x","exp")};return ie.runKernel(ig,t)}const Ma=ue({exp_:SX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TX(n,e=0){const t=Y(n,"x","expandDims","string_or_numeric");H(e<=t.rank,()=>"Axis must be <= rank of the tensor");const s={input:t},r={dim:e};return ie.runKernel(Yx,s,r)}const br=ue({expandDims_:TX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EX(n){const t={x:Y(n,"x","expm1")};return ie.runKernel(ag,t)}const _X=ue({expm1_:EX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IX(n,e){const t=Y(n,"x","tile","string_or_numeric");H(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const s={x:t},r={reps:e};return ie.runKernel(Pg,s,r)}const ji=ue({tile_:IX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $X(n,e,t,s="float32"){e==null&&(e=n);const r=mt([n,e],s),i=n<=e?n:e;for(let o=0;o<i;++o)r.set(1,o,o);const a=ce(r.toTensor(),[n,e]);if(t==null)return a;if(t.length===1)return ji(br(a,0),[t[0],1,1]);if(t.length===2)return ji(br(br(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return ji(br(br(br(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const WP=ue({eye_:$X});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CX(n){const t={x:Y(n,"x","floor","float32")};return ie.runKernel(og,t)}const zv=ue({floor_:CX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NX(n,e,t=0,s=0){const r=Y(n,"x","gather"),i=Y(e,"indices","gather","int32"),a={x:r,indices:i},o={axis:t,batchDims:s};return ie.runKernel(Zx,a,o)}const RI=ue({gather_:NX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kX(n,e){let t=Y(n,"a","greater","string_or_numeric"),s=Y(e,"b","greater","string_or_numeric");[t,s]=Fn(t,s),ot(t.shape,s.shape);const r={a:t,b:s};return ie.runKernel(Jx,r)}const Qr=ue({greater_:kX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AX(n,e){let t=Y(n,"a","greaterEqual","string_or_numeric"),s=Y(e,"b","greaterEqual","string_or_numeric");[t,s]=Fn(t,s),ot(t.shape,s.shape);const r={a:t,b:s};return ie.runKernel(cg,r)}const Ju=ue({greaterEqual_:AX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RX(n){const t={input:Y(n,"input","imag")};return ie.runKernel(rI,t)}const DI=ue({imag_:RX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DX(n){const t={x:Y(n,"x","isFinite")};return ie.runKernel(hg,t)}const OX=ue({isFinite_:DX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FX(n){const t={x:Y(n,"x","isInf")};return ie.runKernel(dg,t)}const LX=ue({isInf_:FX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PX(n){const t={x:Y(n,"x","isNaN")};return ie.runKernel(fg,t)}const MX=ue({isNaN_:PX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VX(n,e=.2){const s={x:Y(n,"x","leakyRelu")},r={alpha:e};return ie.runKernel(ev,s,r)}const OI=ue({leakyRelu_:VX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BX(n,e){let t=Y(n,"a","less","string_or_numeric"),s=Y(e,"b","less","string_or_numeric");[t,s]=Fn(t,s),ot(t.shape,s.shape);const r={a:t,b:s};return ie.runKernel(tv,r)}const B0=ue({less_:BX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zX(n,e){let t=Y(n,"a","lessEqual","string_or_numeric"),s=Y(e,"b","lessEqual","string_or_numeric");[t,s]=Fn(t,s),ot(t.shape,s.shape);const r={a:t,b:s};return ie.runKernel(nv,r)}const rf=ue({lessEqual_:zX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UX(n,e=5,t=1,s=1,r=.5){const i=Y(n,"x","localResponseNormalization");H(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),H(_d(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=i,o=!1;i.rank===3&&(o=!0,a=ce(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:a},u={depthRadius:e,bias:t,alpha:s,beta:r},d=ie.runKernel(av,l,u);return o?ce(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const jX=ue({localResponseNormalization_:UX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WX(n){const t={x:Y(n,"x","log","float32")};return ie.runKernel(pg,t)}const Va=ue({log_:WX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GX(n){const t={x:Y(n,"x","log1p")};return ie.runKernel(mg,t)}const GP=ue({log1p_:GX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HX(n,e){H(RT(n),()=>"The f passed in variableGrads(f) must be a function"),H(e==null||Array.isArray(e)&&e.every(u=>u instanceof M0),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const u in ie.registeredVariables)e.push(ie.registeredVariables[u])}const s=t?e.filter(u=>!u.trainable):null,r=e.length;e=e.filter(u=>u.trainable),H(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:a,grads:o}=ie.gradients(n,e,null,i);H(o.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),H(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const l={};return e.forEach((u,d)=>{o[d]!=null&&(l[u.name]=o[d])}),s!=null&&s.forEach(u=>l[u.name]=null),{value:a,grads:l}}function Nd(n){return ie.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qX(n){const t={x:Y(n,"x","neg")};return ie.runKernel(fv,t)}const Dn=ue({neg_:qX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KX(n){const t={x:Y(n,"x","softplus")};return ie.runKernel(Ag,t)}const zg=ue({softplus_:KX});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XX(n){const e=Y(n,"x","logSigmoid");return Nd(s=>({value:Dn(zg(Dn(s))),gradFunc:a=>se(a,sf(Dn(s)))}))(e)}const YX=ue({logSigmoid_:XX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QX(n,e){let t=Y(n,"a","sub"),s=Y(e,"b","sub");[t,s]=Fn(t,s);const r={a:t,b:s};return ie.runKernel(Og,r)}const tt=ue({sub_:QX});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZX(n,e=-1){const t=Y(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Nd((r,i)=>{const o=Gi(r,e,!0),l=tt(r,o),u=tt(Ue(l,"float32"),Va(Ze(Ma(l),e,!0)));return i([u]),{value:u,gradFunc:(f,m)=>{const[y]=m,b=!0,w=Ma(y);return tt(f,se(Ze(f,e,b),w))}}})(t)}const HP=ue({logSoftmax_:ZX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JX(n,e=null,t=!1){const s=Y(n,"x","logSumExp"),r=gt(e,s.shape),i=Gi(s,r,!0),a=tt(s,i),o=Ma(a),l=Ze(o,r),u=Va(l),d=Oe(ce(i,u.shape),u);if(t){const f=jn(d.shape,r);return ce(d,f)}return d}const qP=ue({logSumExp_:JX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eY(n,e){const t=Y(n,"a","logicalAnd","bool"),s=Y(e,"b","logicalAnd","bool");ot(t.shape,s.shape);const r={a:t,b:s};return ie.runKernel(sv,r)}const Lo=ue({logicalAnd_:eY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tY(n){const t={x:Y(n,"x","logicalNot","bool")};return ie.runKernel(rv,t)}const FI=ue({logicalNot_:tY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nY(n,e){const t=Y(n,"a","logicalOr","bool"),s=Y(e,"b","logicalOr","bool");ot(t.shape,s.shape);const r={a:t,b:s};return ie.runKernel(iv,r)}const KP=ue({logicalOr_:nY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sY(n,e){const t=Y(n,"a","logicalXor","bool"),s=Y(e,"b","logicalXor","bool");return ot(t.shape,s.shape),Lo(KP(n,e),FI(Lo(n,e)))}const rY=ue({logicalXor_:sY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iY(n,e,t,s,r){const i=Y(n,"x","maxPool"),a=1;let o=i,l=!1;i.rank===3&&(l=!0,o=ce(i,[1,i.shape[0],i.shape[1],i.shape[2]])),H(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),H(js(t,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),Er("maxPool",s,r);const u={x:o},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r},f=ie.runKernel(lv,u,d);return l?ce(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const LI=ue({maxPool_:iY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aY(n,e=[1,1,1],t,s,r,i="NDHWC"){const a=Y(n,"x","maxPool3d");let o=a,l=!1;a.rank===4&&(l=!0,o=ce(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),H(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),H(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),Er("maxPool3d",s,r);const u={x:o},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:i},f=ie.runKernel(cv,u,d);return l?ce(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const oY=ue({maxPool3d_:aY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lY(n,e){let t=Y(n,"a","maximum"),s=Y(e,"b","maximum");[t,s]=Fn(t,s),t.dtype==="bool"&&(t=Ue(t,"int32"),s=Ue(s,"int32")),ot(t.shape,s.shape);const r={a:t,b:s};return ie.runKernel(gg,r)}const bc=ue({maximum_:lY});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cY(n,e=null,t=!1){const r={x:Y(n,"x","mean")},i={axis:e,keepDims:t};return ie.runKernel(uv,r,i)}const Un=ue({mean_:cY});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(n,e="float32"){if(Go(n),e==="complex64"){const s=cs(n,"float32"),r=cs(n,"float32");return Id(s,r)}const t=Bs(Ee(n),e);return ie.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xc(n,e="float32"){if(Go(n),e==="complex64"){const s=xc(n,"float32"),r=cs(n,"float32");return Id(s,r)}const t=R_(Ee(n),e);return ie.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uY(n,e){let t=Y(n,"a","minimum"),s=Y(e,"b","minimum");[t,s]=Fn(t,s),t.dtype==="bool"&&(t=Ue(t,"int32"),s=Ue(s,"int32")),ot(t.shape,s.shape);const r={a:t,b:s};return ie.runKernel(yg,r)}const mm=ue({minimum_:uY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hY(n,e,t){H(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const s=Y(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");H(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=t==="reflect"?1:0;for(let o=0;o<s.rank;o++)H(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),H(e[o][0]>=0&&e[o][0]<=s.shape[o]-r&&e[o][1]>=0&&e[o][1]<=s.shape[o]-r,()=>`Padding in dimension ${o} cannot be greater than or equal to ${s.shape[o]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:t},a={x:s};return ie.runKernel(dv,a,i)}const dY=ue({mirrorPad_:hY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fY(n,e){let t=Y(n,"a","mod"),s=Y(e,"b","mod");[t,s]=Fn(t,s);const r={a:t,b:s};return ie.runKernel(bg,r)}const pY=ue({mod_:fY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mY(n,e=null,t=!1){n=Y(n,"x","moments");const s=gt(e,n.shape),r=Un(n,s,t);let i=r.shape;t||(i=jn(r.shape,s));const a=gn(tt(Ue(n,"float32"),ce(r,i))),o=Un(a,s,t);return{mean:r,variance:o}}const PI=ue({moments_:mY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gY(n,e){let t=Y(n,"a","notEqual","string_or_numeric"),s=Y(e,"b","notEqual","string_or_numeric");[t,s]=Fn(t,s),ot(t.shape,s.shape);const r={a:t,b:s};return ie.runKernel(pv,r)}const z0=ue({notEqual_:gY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yY(n,e,t=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const a={indices:Y(n,"indices","oneHot","int32")},o={dtype:r,depth:e,onValue:t,offValue:s};return ie.runKernel(gv,a,o)}const XP=ue({oneHot_:yY});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bY(n){const t={x:Y(n,"x","onesLike")};return ie.runKernel(mv,t)}const Ii=ue({onesLike_:bY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xY(n,e,t=0){const s=Y(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:t},i={x:s};return ie.runKernel(bv,i,r)}const MI=ue({pad_:xY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vY(n,e,t){const s=Y(n,"x","spaceToBatchND");H(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),H(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),H(s.shape.reduce((a,o,l)=>l>0&&l<=e.length?a&&(o+t[l-1][0]+t[l-1][1])%e[l-1]===0:a,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:t};return ie.runKernel(Cv,r,i)}const VI=ue({spaceToBatchND_:vY});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wY(n,e,t,s,r,i,a){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const o=Y(n,"x","maxPool");let l=o,u=!1;o.rank===3&&(u=!0,l=ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),H(js(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const d=$i(l.shape,e,i,r,s),f=[d.dilationHeight,d.dilationWidth];let m;s==="same"?m=TY([d.filterHeight,d.filterWidth],f):m=[[0,0],[0,0]];const y=f[0]===1&&f[1]===1,[b,w]=SY([d.inHeight,d.inWidth],f,m),x=y?s:"valid",T=y?l:VI(l,f,b),$=(t==="avg"?()=>II(T,e,i,x,a):()=>LI(T,e,i,x,a))(),C=y?$:$I($,f,w);return u?ce(C,[C.shape[1],C.shape[2],C.shape[3]]):C}function SY(n,e,t){const s=t.map(d=>d[0]),r=t.map(d=>d[1]),i=n.concat(s,r),a=e.map((d,f)=>(d-i[f]%d)%d),o=r.map((d,f)=>d+a[f]),l=e.map((d,f)=>[s[f],o[f]]),u=e.map((d,f)=>[0,a[f]]);return[l,u]}function TY(n,e){const s=n.map((a,o)=>a+(a-1)*(e[o]-1)).map(a=>a-1),r=s.map(a=>Math.floor(a/2)),i=s.map((a,o)=>a-r[o]);return s.map((a,o)=>[r[o],i[o]])}const EY=ue({pool_:wY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Y(n,e){const t=Y(n,"x","prelu"),s=Y(e,"alpha","prelu"),r={x:t,alpha:s};return ie.runKernel(xv,r)}const BI=ue({prelu_:_Y});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IY(n,e=null,t=!1){let s=Y(n,"x","prod");s.dtype==="bool"&&(s=Ue(s,"int32"));const r={x:s},i={axis:e,keepDims:t};return ie.runKernel(vv,r,i)}const $Y=ue({prod_:IY});var l0={exports:{}},CY=l0.exports,kR;function NY(){return kR||(kR=1,function(n){(function(e,t,s){function r(l){var u=this,d=o();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=d(" "),u.s1=d(" "),u.s2=d(" "),u.s0-=d(l),u.s0<0&&(u.s0+=1),u.s1-=d(l),u.s1<0&&(u.s1+=1),u.s2-=d(l),u.s2<0&&(u.s2+=1),d=null}function i(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function a(l,u){var d=new r(l),f=u&&u.state,m=d.next;return m.int32=function(){return d.next()*4294967296|0},m.double=function(){return m()+(m()*2097152|0)*11102230246251565e-32},m.quick=m,f&&(typeof f=="object"&&i(f,d),m.state=function(){return i(d,{})}),m}function o(){var l=4022871197,u=function(d){d=String(d);for(var f=0;f<d.length;f++){l+=d.charCodeAt(f);var m=.02519603282416938*l;l=m>>>0,m-=l,m*=l,l=m>>>0,m-=l,l+=m*4294967296}return(l>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=a:this.alea=a})(CY,n)}(l0)),l0.exports}var c0={exports:{}},kY=c0.exports,AR;function AY(){return AR||(AR=1,function(n){(function(e,t,s){function r(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},o===(o|0)?l.x=o:u+=o;for(var d=0;d<u.length+64;d++)l.x^=u.charCodeAt(d)|0,l.next()}function i(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function a(o,l){var u=new r(o),d=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var m=u.next()>>>11,y=(u.next()>>>0)/4294967296,b=(m+y)/(1<<21);while(b===0);return b},f.int32=u.next,f.quick=f,d&&(typeof d=="object"&&i(d,u),f.state=function(){return i(u,{})}),f}t&&t.exports?t.exports=a:this.xor128=a})(kY,n)}(c0)),c0.exports}var u0={exports:{}},RY=u0.exports,RR;function DY(){return RR||(RR=1,function(n){(function(e,t,s){function r(o){var l=this,u="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(f^f<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var d=0;d<u.length+64;d++)l.x^=u.charCodeAt(d)|0,d==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function a(o,l){var u=new r(o),d=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var m=u.next()>>>11,y=(u.next()>>>0)/4294967296,b=(m+y)/(1<<21);while(b===0);return b},f.int32=u.next,f.quick=f,d&&(typeof d=="object"&&i(d,u),f.state=function(){return i(u,{})}),f}t&&t.exports?t.exports=a:this.xorwow=a})(RY,n)}(u0)),u0.exports}var h0={exports:{}},OY=h0.exports,DR;function FY(){return DR||(DR=1,function(n){(function(e,t,s){function r(o){var l=this;l.next=function(){var d=l.x,f=l.i,m,y;return m=d[f],m^=m>>>7,y=m^m<<24,m=d[f+1&7],y^=m^m>>>10,m=d[f+3&7],y^=m^m>>>3,m=d[f+4&7],y^=m^m<<7,m=d[f+7&7],m=m^m<<13,y^=m^m<<9,d[f]=y,l.i=f+1&7,y};function u(d,f){var m,y=[];if(f===(f|0))y[0]=f;else for(f=""+f,m=0;m<f.length;++m)y[m&7]=y[m&7]<<15^f.charCodeAt(m)+y[m+1&7]<<13;for(;y.length<8;)y.push(0);for(m=0;m<8&&y[m]===0;++m);for(m==8?y[7]=-1:y[m],d.x=y,d.i=0,m=256;m>0;--m)d.next()}u(l,o)}function i(o,l){return l.x=o.x.slice(),l.i=o.i,l}function a(o,l){o==null&&(o=+new Date);var u=new r(o),d=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var m=u.next()>>>11,y=(u.next()>>>0)/4294967296,b=(m+y)/(1<<21);while(b===0);return b},f.int32=u.next,f.quick=f,d&&(d.x&&i(d,u),f.state=function(){return i(u,{})}),f}t&&t.exports?t.exports=a:this.xorshift7=a})(OY,n)}(h0)),h0.exports}var d0={exports:{}},LY=d0.exports,OR;function PY(){return OR||(OR=1,function(n){(function(e,t,s){function r(o){var l=this;l.next=function(){var d=l.w,f=l.X,m=l.i,y,b;return l.w=d=d+1640531527|0,b=f[m+34&127],y=f[m=m+1&127],b^=b<<13,y^=y<<17,b^=b>>>15,y^=y>>>12,b=f[m]=b^y,l.i=m,b+(d^d>>>16)|0};function u(d,f){var m,y,b,w,x,T=[],E=128;for(f===(f|0)?(y=f,f=null):(f=f+"\0",y=0,E=Math.max(E,f.length)),b=0,w=-32;w<E;++w)f&&(y^=f.charCodeAt((w+32)%f.length)),w===0&&(x=y),y^=y<<10,y^=y>>>15,y^=y<<4,y^=y>>>13,w>=0&&(x=x+1640531527|0,m=T[w&127]^=y+x,b=m==0?b+1:0);for(b>=128&&(T[(f&&f.length||0)&127]=-1),b=127,w=4*128;w>0;--w)y=T[b+34&127],m=T[b=b+1&127],y^=y<<13,m^=m<<17,y^=y>>>15,m^=m>>>12,T[b]=y^m;d.w=x,d.X=T,d.i=b}u(l,o)}function i(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function a(o,l){o==null&&(o=+new Date);var u=new r(o),d=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var m=u.next()>>>11,y=(u.next()>>>0)/4294967296,b=(m+y)/(1<<21);while(b===0);return b},f.int32=u.next,f.quick=f,d&&(d.X&&i(d,u),f.state=function(){return i(u,{})}),f}t&&t.exports?t.exports=a:this.xor4096=a})(LY,n)}(d0)),d0.exports}var f0={exports:{}},MY=f0.exports,FR;function VY(){return FR||(FR=1,function(n){(function(e,t,s){function r(o){var l=this,u="";l.next=function(){var f=l.b,m=l.c,y=l.d,b=l.a;return f=f<<25^f>>>7^m,m=m-y|0,y=y<<24^y>>>8^b,b=b-f|0,l.b=f=f<<20^f>>>12^m,l.c=m=m-y|0,l.d=y<<16^m>>>16^b,l.a=b-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var d=0;d<u.length+20;d++)l.b^=u.charCodeAt(d)|0,l.next()}function i(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function a(o,l){var u=new r(o),d=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var m=u.next()>>>11,y=(u.next()>>>0)/4294967296,b=(m+y)/(1<<21);while(b===0);return b},f.int32=u.next,f.quick=f,d&&(typeof d=="object"&&i(d,u),f.state=function(){return i(u,{})}),f}t&&t.exports?t.exports=a:this.tychei=a})(MY,n)}(f0)),f0.exports}var p0={exports:{}};const BY={},zY=Object.freeze(Object.defineProperty({__proto__:null,default:BY},Symbol.toStringTag,{value:"Module"})),UY=bG(zY);var jY=p0.exports,LR;function WY(){return LR||(LR=1,function(n){(function(e,t,s){var r=256,i=6,a=52,o="random",l=s.pow(r,i),u=s.pow(2,a),d=u*2,f=r-1,m;function y(C,O,V){var F=[];O=O==!0?{entropy:!0}:O||{};var R=T(x(O.entropy?[C,$(t)]:C??E(),3),F),N=new b(F),D=function(){for(var k=N.g(i),z=l,B=0;k<u;)k=(k+B)*r,z*=r,B=N.g(1);for(;k>=d;)k/=2,z/=2,B>>>=1;return(k+B)/z};return D.int32=function(){return N.g(4)|0},D.quick=function(){return N.g(4)/4294967296},D.double=D,T($(N.S),t),(O.pass||V||function(k,z,B,ne){return ne&&(ne.S&&w(ne,N),k.state=function(){return w(N,{})}),B?(s[o]=k,z):k})(D,R,"global"in O?O.global:this==s,O.state)}function b(C){var O,V=C.length,F=this,R=0,N=F.i=F.j=0,D=F.S=[];for(V||(C=[V++]);R<r;)D[R]=R++;for(R=0;R<r;R++)D[R]=D[N=f&N+C[R%V]+(O=D[R])],D[N]=O;(F.g=function(k){for(var z,B=0,ne=F.i,J=F.j,K=F.S;k--;)z=K[ne=f&ne+1],B=B*r+K[f&(K[ne]=K[J=f&J+z])+(K[J]=z)];return F.i=ne,F.j=J,B})(r)}function w(C,O){return O.i=C.i,O.j=C.j,O.S=C.S.slice(),O}function x(C,O){var V=[],F=typeof C,R;if(O&&F=="object")for(R in C)try{V.push(x(C[R],O-1))}catch{}return V.length?V:F=="string"?C:C+"\0"}function T(C,O){for(var V=C+"",F,R=0;R<V.length;)O[f&R]=f&(F^=O[f&R]*19)+V.charCodeAt(R++);return $(O)}function E(){try{var C;return m&&(C=m.randomBytes)?C=C(r):(C=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(C)),$(C)}catch{var O=e.navigator,V=O&&O.plugins;return[+new Date,e,V,e.screen,$(t)]}}function $(C){return String.fromCharCode.apply(0,C)}if(T(s.random(),t),n.exports){n.exports=y;try{m=UY}catch{}}else s["seed"+o]=y})(typeof self<"u"?self:jY,[],Math)}(p0)),p0.exports}var HS,PR;function GY(){if(PR)return HS;PR=1;var n=NY(),e=AY(),t=DY(),s=FY(),r=PY(),i=VY(),a=WY();return a.alea=n,a.xor128=e,a.xorwow=t,a.xorshift7=s,a.xor4096=r,a.tychei=i,HS=a,HS}var af=GY();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let YP=class{constructor(e,t,s,r,i){this.mean=e,this.stdDev=t,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=i||Math.random();this.random=af.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,t,s=!1;for(;!s;){let r,i,a;do r=2*this.random()-1,i=2*this.random()-1,a=r*r+i*i;while(a>=1||a===0);const o=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*r*o,t=this.mean+this.stdDev*i*o,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}},HY=class{constructor(e=0,t=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=af.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qY(n,e=0,t=1,s,r){if(Go(n),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new YP(e,t,s,!1,r),a=mt(n,s);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const KY=ue({randomNormal_:qY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XY(n,e=0,t=1,s="float32",r){Go(n);const i=mt(n,s),a=new HY(e,t,null,r);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const Ug=ue({randomUniform_:XY});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gm(n,e,t=1,s="float32"){if(t===0)throw new Error("Cannot have a step of zero");const r={start:n,stop:e,step:t,dtype:s};return ie.runKernel(hI,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YY(n){const t={input:Y(n,"input","real")};return ie.runKernel(dI,t)}const U0=ue({real_:YY});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QY(n){const t={x:Y(n,"x","reciprocal")};return ie.runKernel(wg,t)}const ZY=ue({reciprocal_:QY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JY(n){const t={x:Y(n,"x","relu")};return ie.runKernel(Sg,t)}const eh=ue({relu_:JY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eQ(n){const t={x:Y(n,"x","relu6")};return ie.runKernel(Tg,t)}const QP=ue({relu6_:eQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tQ(n,e){const s={x:Y(n,"x","reverse")},r={dims:e};return ie.runKernel(Ev,s,r)}const Lu=ue({reverse_:tQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nQ(n){const t={x:Y(n,"x","round")};return ie.runKernel(Eg,t)}const ZP=ue({round_:nQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sQ(n){const t={x:Y(n,"x","rsqrt","float32")};return ie.runKernel(_g,t)}const JP=ue({rsqrt_:sQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rQ(n){const t={x:Y(n,"x","selu")};return ie.runKernel(Ig,t)}const e3=ue({selu_:rQ});function iQ(n,e,t,s,r,i=[1,1],a="NHWC"){const o=Y(n,"x","separableConv2d"),l=Y(e,"depthwiseFilter","separableConv2d"),u=Y(t,"pointwiseFilter","separableConv2d");let d=o,f=!1;if(o.rank===3&&(f=!0,d=ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");H(d.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${d.rank}.`),H(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),H(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),H(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),H(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const m=l.shape[2],y=l.shape[3];H(u.shape[2]===m*y,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${m*y}, but got ${u.shape[2]}.`);const b=kI(d,l,s,r,a,i),x=Ou(b,u,1,"valid",a);return f?ce(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const t3=ue({separableConv2d_:iQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aQ(n){const t={x:Y(n,"x","sign")};return ie.runKernel(Ng,t)}const oQ=ue({sign_:aQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lQ(n){const t={x:Y(n,"x","sin","float32")};return ie.runKernel($g,t)}const n3=ue({sin_:lQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cQ(n){const t={x:Y(n,"x","sinh")};return ie.runKernel(Cg,t)}const s3=ue({sinh_:cQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uQ(n,e,t){const s=Y(n,"x","slice1d");return H(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),sn(s,[e],[t])}const zI=ue({slice1d_:uQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hQ(n,e,t){const s=Y(n,"x","slice2d");return H(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),sn(s,e,t)}const r3=ue({slice2d_:hQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dQ(n,e,t){const s=Y(n,"x","slice3d");return H(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),sn(s,e,t)}const UI=ue({slice3d_:dQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fQ(n,e,t){const s=Y(n,"x","slice4d");return H(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),sn(s,e,t)}const j0=ue({slice4d_:fQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pQ(n,e=-1){const t=Y(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const s={logits:t},r={dim:e};return ie.runKernel(kv,s,r)}const jI=ue({softmax_:pQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mQ(n){H(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return ie.runKernel(eI,e)}const i3=ue({fft_:mQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gQ(n){H(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return ie.runKernel(sI,e)}const XT=ue({ifft_:gQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yQ(n){const e=n.shape[n.shape.length-1],t=n.size/e;let s;if(e<=2){const r=ce(n,[t,e]);s=XT(r)}else{const r=[t,2*(e-1)],i=ce(U0(n),[t,e]),a=ce(DI(n),[t,e]),o=Lu(sn(i,[0,1],[t,e-2]),1),l=se(Lu(sn(a,[0,1],[t,e-2]),1),Wt(-1)),u=wr([i,o],1),d=wr([a,l],1),f=ce(Id(u,d),[r[0],r[1]]);s=XT(f)}if(s=U0(s),n.rank===3&&n.shape[0]!==0){const r=s,i=n.shape[0];s=ce(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const bQ=ue({irfft_:yQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xQ(n,e,t=0){const r={x:Y(n,"x","split")},i={numOrSizeSplits:e,axis:t};return ie.runKernel(Nv,r,i)}const Kr=ue({split_:xQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vQ(n,e){H(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const s=n.size/t;let r;if(e!=null&&e<t){const b=n.shape.map(x=>0),w=n.shape.map(x=>x);w[n.shape.length-1]=e,r=sn(n,b,w),t=e}else if(e!=null&&e>t){const b=n.shape.map(w=>w);b[n.shape.length-1]=e-t,r=wr([n,cs(b)],n.shape.length-1),t=e}else r=n;const i=$t(r),a=ce(Id(r,i),[s,t]),o=i3(a),l=Math.floor(t/2)+1,u=U0(o),d=DI(o),f=Kr(u,[l,t-l],u.shape.length-1),m=Kr(d,[l,t-l],d.shape.length-1),y=r.shape.slice();return y[r.shape.length-1]=l,ce(Id(f[0],m[0]),y)}const wQ=ue({rfft_:vQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SQ(n,e){let t=Y(n,"a","squaredDifference"),s=Y(e,"b","squaredDifference");[t,s]=Fn(t,s),ot(t.shape,s.shape);const r={a:t,b:s},i={};return ie.runKernel(Dg,r,i)}const TQ=ue({squaredDifference_:SQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EQ(n,e){const t=Y(n,"x","squeeze","string_or_numeric");return ce(t,pc(t.shape,e).newShape)}const jg=ue({squeeze_:EQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Q(n,e=0){const t=EP(n,"tensors","stack","string_or_numeric");H(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&H(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const s=t,r={axis:e};return ie.runKernel(yv,s,r)}const Po=ue({stack_:_Q});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IQ(n,e=0){const s={x:Y(n,"x","step")},r={alpha:e};return ie.runKernel(Mg,s,r)}const Wg=ue({step_:IQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Q(n,e,t,s,r=0,i=0,a=0,o=0,l=0){const d={x:Y(n,"x","stridedSlice","string_or_numeric")},f={begin:e,end:t,strides:s,beginMask:r,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};return ie.runKernel(yI,d,f)}const CQ=ue({stridedSlice_:$Q});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NQ(n){const t={x:Y(n,"x","tan","float32")};return ie.runKernel(Fg,t)}const kQ=ue({tan_:NQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ar(n,e){OL(n);const t=Fv(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Lv(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qS(n,e,t){if(OL(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Fv(n,t);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Lv(n,e,s,t)}function a3(n,e,t){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${r}.`;if(t.rank<r)throw new Error(i+` update.rank < ${r}. `);if(n.length<s+(t.rank-r))throw new Error(i+` Output shape length < ${s+(t.rank-r)}`);if(t.rank!==r+n.length-s)throw new Error(i+` update.rank != ${r+n.length-s}`);for(let a=0;a<r;++a)if(t.shape[a]!==e.shape[a])throw new Error(i+` updates.shape[${a}] (${t.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<t.rank-r;++a)if(t.shape[a+r]!==n[a+s])throw new Error(i+` updates.shape[${a+r}] (${t.shape[a+r]}) != shape[${a+r}] (${n[a+r]})`)}function AQ(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}a3(t,e,n)}function th(n,e,t){const s=e.shape.length,r=s>1?e.shape[s-1]:1,i=t.length;let a=1;for(let f=r;f<i;++f)a*=t[f];const o=r<1?1:r,l=Ee(e.shape)/o,u=[...Ye(t.slice(0,r)),1],d=Ee(t);return{sliceRank:r,numUpdates:l,sliceSize:a,strides:u,outputSize:d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RQ(n,e=1,t=!0){const s=Y(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},a={k:e,sorted:t},[o,l]=ie.runKernel(bI,i,a);return{values:o,indices:l}}const DQ=ue({topk_:RQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OQ(n,e=0,t=1,s,r){if(Go(n),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new YP(e,t,s,!0,r),a=mt(n,s);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const o3=ue({truncatedNormal_:OQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FQ(n,e=0){const t=Y(n,"x","unique","string_or_numeric");H(t.rank>0,()=>"The input tensor must be at least 1D");const s={x:t},r={axis:e},[i,a]=ie.runKernel(vI,s,r);return{values:i,indices:a}}const LQ=ue({unique_:FQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PQ(n,e,t){const s=Y(n,"x","unsortedSegmentSum"),r=Y(e,"segmentIds","unsortedSegmentSum","int32");H(_d(t),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},a={numSegments:t};return ie.runKernel(Rv,i,a)}const l3=ue({unsortedSegmentSum_:PQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MQ(n,e=0){const t=Y(n,"x","unstack","string_or_numeric");H(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const s={value:t},r={axis:e};return ie.runKernel(Av,s,r)}const Pu=ue({unstack_:MQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VQ(n,e=!0,t,s){return ie.makeVariable(n,e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c3(n,e){const t=[];for(let i=0;i<e.length;i++)e[i]&&t.push(i);const s=mt(n,"int32"),r=mt([t.length,n.length],"int32");for(let i=0;i<t.length;i++){const a=s.indexToLoc(t[i]),o=i*n.length;r.values.set(a,o)}return r.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BQ(n,e,t){const s=Y(n,"x","transpose");if(e==null&&(e=s.shape.map((a,o)=>o).reverse()),H(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(a=>{H(a>=0&&a<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?ge(()=>{let a=U0(s),o=DI(s);return a=ie.runKernel(dd,{x:a},i),o=ie.runKernel(dd,{x:o},i),t&&(o=Dn(o)),Id(a,o)}):ie.runKernel(dd,r,i)}const It=ue({transpose_:BQ});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zQ(n,e){if(e==null)return n.shape.slice();if(Gt(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let s=0;s<n.shape.length;s++)e[s]==null&&n.shape[s]!=null?t.push(n.shape[s]):t.push(e[s]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UQ(n,e,t,s){const r=Y(n,"x","dropout");if(H(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),H(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof Xn?r.clone():r;const i=zQ(r,t),a=1-e,o=Je(zv(Oe(Ug(i,0,1,"float32",s),a)),a);return se(r,o)}const jQ=ue({dropout_:UQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WQ(n,e,t,s,r,i="NHWC",a){let o=n;n.rank===3&&(o=ce(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=ce(e,[1,e.shape[0],e.shape[1],e.shape[2]])),H(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),H(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),H(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const u=i==="NHWC"?o.shape[3]:o.shape[1],d=i==="NHWC"?l.shape[3]:l.shape[1];H(u===t[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${t[2]}.`),H(d===t[3],()=>`Error in conv2dDerFilter: depth of dy (${d}) must match output depth for filter (${t[3]}).`),Er("conv2dDerFilter",r,a);const f={x:o,dy:l},m={strides:s,pad:r,dataFormat:i,dimRoundingMode:a,filterShape:t};return ie.runKernel(j_,f,m)}const WI=ue({conv2DBackpropFilter_:WQ});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GI(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return se(n,Wg(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function HI(n,e){let t=e;const s=ts(n.shape,e.shape);return s.length>0&&(t=Ze(t,s)),ce(t,n.shape)}function qI(n,e,t,s){if(e==="linear")return n;if(e==="relu")return eh(n);if(e==="elu")return Bv(n);if(e==="relu6")return QP(n);if(e==="prelu")return BI(n,t);if(e==="leakyrelu")return OI(n,s);if(e==="sigmoid")return sf(n);throw new Error(`Unknown fused activation ${e}.`)}const KI=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GQ({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:d}){if(l=l||"linear",KI(ie.state.gradientDepth,l)===!1){H(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let V=Ou(n,e,t,s,r,i,a);return o!=null&&(V=Oe(V,o)),qI(V,l,u,d)}const f=Y(n,"x","conv2d","float32"),m=Y(e,"filter","conv2d","float32");let y=f,b=!1;f.rank===3&&(b=!0,y=ce(f,[1,f.shape[0],f.shape[1],f.shape[2]])),H(y.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${y.rank}.`),H(m.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${m.rank}.`),Er("fused conv2d",s,a);const w=r==="NHWC"?y.shape[3]:y.shape[1];H(m.shape[2]===w,()=>`Error in conv2d: depth of input (${w}) must match input depth for filter ${m.shape[2]}.`),H(js(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const x=Cs(y.shape,m.shape,t,i,s,a);let T;o!=null&&(T=Y(o,"bias","fused conv2d"),[T]=Fn(T,f),r==="NHWC"?ot(x.outShape,T.shape):(H(T.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${T.shape.length}.`),H(T.shape.length===0||T.shape[0]===x.outChannels||T.shape[0]===1,()=>`Error in fused conv2d: bias shape (${T.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let E;if(u!=null){const V=u.shape;if(H(V.length<=1||V.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${V.length}.`),V.length===1)H(V[0]===1||V[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${V}) is not compatible with the number of output channels (${x.outChannels}).`);else if(V.length===3)try{ot(V,x.outShape)}catch{const R=`Error in fused conv2d: PReLU activation weights (${V}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(R)}E=Y(u,"prelu weights","fused conv2d")}const $=(V,F)=>{H(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[R,N,D,k]=F,z=GI(V,D,l);H(Ru(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const B=CI(N.shape,z,R,t,s),ne=WI(N,z,R.shape,t,s),J=[B,ne];if(k!=null){const K=HI(k,z);J.push(K)}return J},C={x:y,filter:m,bias:T,preluActivationWeights:E},O={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a,activation:l,leakyreluAlpha:d};return o==null?Nd((F,R,N)=>{let D=ie.runKernel(L0,C,O);return N([R,F,D]),b&&(D=ce(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:$}})(y,m):Nd((F,R,N,D)=>{let k=ie.runKernel(L0,C,O);return D([R,F,k,N]),b&&(k=ce(k,[k.shape[1],k.shape[2],k.shape[3]])),{value:k,gradFunc:$}})(y,m,T)}const HQ=ue({fusedConv2d_:GQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qQ(n,e,t,s,r,i=[1,1],a){let o=n;n.rank===3&&(o=ce(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=ce(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:o,dy:l},d={strides:s,pad:r,dimRoundingMode:a,dilations:i,filterShape:t};return ie.runKernel(Y_,u,d)}const KQ=ue({depthwiseConv2dNativeBackpropFilter_:qQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XQ(n,e,t,s,r,i=[1,1],a){let o=e,l=!1;e.rank===3&&(l=!0,o=ce(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:o,filter:t},d={strides:s,pad:r,dimRoundingMode:a,dilations:i,inputShape:n},f=ie.runKernel(Q_,u,d);return l?ce(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const YQ=ue({depthwiseConv2dNativeBackpropInput_:XQ});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QQ({a:n,b:e,transposeA:t=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:a,leakyreluAlpha:o=.2}){if(KI(ie.state.gradientDepth,i)===!1){let k=jt(n,e,t,s);return r!=null&&(k=Oe(k,r)),qI(k,i,a,o)}let l=Y(n,"a","fused matMul"),u=Y(e,"b","fused matMul");[l,u]=Fn(l,u);const d=t?l.shape[l.rank-2]:l.shape[l.rank-1],f=s?u.shape[u.rank-1]:u.shape[u.rank-2],m=t?l.shape[l.rank-1]:l.shape[l.rank-2],y=s?u.shape[u.rank-2]:u.shape[u.rank-1],b=l.shape.slice(0,-2),w=u.shape.slice(0,-2),x=Ee(b),T=Ee(w);H(d===f,()=>`Error in fused matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${t} and transposeB=${s} must match.`);const $=ot(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([m,y]),C=t?ce(l,[x,d,m]):ce(l,[x,m,d]),O=s?ce(u,[T,y,f]):ce(u,[T,f,y]);let V;r!=null&&(V=Y(r,"bias","fused matMul"),[V]=Fn(V,l),ot($,V.shape));let F;a!=null&&(F=Y(a,"prelu weights","fused matMul"));const R=(k,z)=>{const[B,ne,J,K]=z,re=GI(ce(k,J.shape),J,i);let Z,he;if(!t&&!s?(Z=jt(re,ne,!1,!0),he=jt(B,re,!0,!1)):!t&&s?(Z=jt(re,ne,!1,!1),he=jt(re,B,!0,!1)):t&&!s?(Z=jt(ne,re,!1,!0),he=jt(B,re,!1,!1)):(Z=jt(ne,re,!0,!0),he=jt(re,B,!0,!0)),r!=null){const W=HI(K,re);return[Z,he,W]}else return[Z,he]},N={a:C,b:O,bias:V,preluActivationWeights:F},D={transposeA:t,transposeB:s,activation:i,leakyreluAlpha:o};return r==null?Nd((z,B,ne)=>{const J=ie.runKernel(F0,N,D);return ne([z,B,J]),{value:ce(J,$),gradFunc:R}})(C,O):Nd((z,B,ne,J)=>{const K=ie.runKernel(F0,N,D);return J([z,B,K,ne]),{value:ce(K,$),gradFunc:R}})(C,O,V)}const MR=ue({fusedMatMul_:QQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZQ(n,e,t,s,r="bilinear",i=0){const a=Y(n,"image","cropAndResize"),o=Y(e,"boxes","cropAndResize","float32"),l=Y(t,"boxInd","cropAndResize","int32"),u=o.shape[0];H(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),H(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`),H(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`),H(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),H(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),H(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const d={image:a,boxes:o,boxInd:l},f={method:r,extrapolationValue:i,cropSize:s};return ie.runKernel(q_,d,f)}const JQ=ue({cropAndResize_:ZQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eZ(n){const e=Y(n,"image","flipLeftRight","float32");H(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return ie.runKernel(nI,t,{})}const tZ=ue({flipLeftRight_:eZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nZ(n){const e=Y(n,"image","grayscaleToRGB"),t=e.rank-1,s=e.shape[t];H(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),H(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,t),r[t]=3,ji(e,r)}const sZ=ue({grayscaleToRGB_:nZ});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rZ(n){const e=Y(n,"image","RGBToGrayscale"),t=e.rank-1,s=e.shape[t];H(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),H(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,i=Ue(e,"float32"),a=Ar([.2989,.587,.114]);let o;switch(e.rank){case 2:o=kp("ij,j->i",i,a);break;case 3:o=kp("ijk,k->ij",i,a);break;case 4:o=kp("ijkl,l->ijk",i,a);break;case 5:o=kp("ijklm,m->ijkl",i,a);break;case 6:o=kp("ijklmn,n->ijklm",i,a);break;default:throw new Error("Not a valid tensor rank.")}return o=br(o,-1),Ue(o,r)}const iZ=ue({rgbToGrayscale_:rZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aZ(n,e,t=0,s=.5){const r=Y(n,"image","rotateWithOffset","float32");H(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},a={radians:e,fillValue:t,center:s};return ie.runKernel(wI,i,a)}const oZ=ue({rotateWithOffset_:aZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function of(n,e,t,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const a=n.shape[0];return t=Math.min(t,a),H(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),H(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),H(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),H(e.rank===1,()=>"scores must be a 1D tensor"),H(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${e.shape[0]}`),H(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lZ(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const i=Y(n,"boxes","nonMaxSuppression","float32"),a=Y(e,"scores","nonMaxSuppression","float32"),o=of(i,a,t,s,r);t=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l={maxOutputSize:t,iouThreshold:s,scoreThreshold:r};return ie.runKernel(lI,{boxes:i,scores:a},l)}const cZ=ue({nonMaxSuppression_:lZ});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uZ(n,e,t){const s=hZ(n,e,t),r=s<0?-(s+1):s;n.splice(r,0,e)}function hZ(n,e,t){return fZ(n,e,t||dZ)}function dZ(n,e){return n>e?1:n<e?-1:0}function fZ(n,e,t){let s=0,r=n.length,i=0,a=!1;for(;s<r;){i=s+(r-s>>>1);const o=t(e,n[i]);o>0?s=i+1:(r=i,a=!o)}return a?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XI(n,e,t,s,r){return ZI(n,e,t,s,r,0)}function YI(n,e,t,s,r,i){return ZI(n,e,t,s,r,0,!1,i,!0)}function QI(n,e,t,s,r,i){return ZI(n,e,t,s,r,i,!0)}function ZI(n,e,t,s,r,i,a=!1,o=!1,l=!1){const u=[];for(let x=0;x<e.length;x++)e[x]>r&&u.push({score:e[x],boxIndex:x,suppressBeginIndex:0});u.sort(VR);const d=i>0?-.5/i:0,f=[],m=[];for(;f.length<t&&u.length>0;){const x=u.pop(),{score:T,boxIndex:E,suppressBeginIndex:$}=x;if(T<r)break;let C=!1;for(let O=f.length-1;O>=$;--O){const V=pZ(n,E,f[O]);if(V>=s){C=!0;break}if(x.score=x.score*mZ(s,d,V),x.score<=r)break}x.suppressBeginIndex=f.length,C||(x.score===T?(f.push(E),m.push(x.score)):x.score>r&&uZ(u,x,VR))}const y=f.length,b=t-y;o&&b>0&&(f.push(...new Array(b).fill(0)),m.push(...new Array(b).fill(0)));const w={selectedIndices:f};return a&&(w.selectedScores=m),l&&(w.validOutputs=y),w}function pZ(n,e,t){const s=n.subarray(e*4,e*4+4),r=n.subarray(t*4,t*4+4),i=Math.min(s[0],s[2]),a=Math.min(s[1],s[3]),o=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),u=Math.min(r[0],r[2]),d=Math.min(r[1],r[3]),f=Math.max(r[0],r[2]),m=Math.max(r[1],r[3]),y=(o-i)*(l-a),b=(f-u)*(m-d);if(y<=0||b<=0)return 0;const w=Math.max(i,u),x=Math.max(a,d),T=Math.min(o,f),E=Math.min(l,m),$=Math.max(T-w,0)*Math.max(E-x,0);return $/(y+b-$)}function mZ(n,e,t){const s=Math.exp(e*t*t);return t<=n?s:0}function VR(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function gZ(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const i=Y(n,"boxes","nonMaxSuppressionAsync"),a=Y(e,"scores","nonMaxSuppressionAsync"),o=of(i,a,t,s,r);t=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l=await Promise.all([i.data(),a.data()]),u=l[0],d=l[1],{selectedIndices:f}=XI(u,d,t,s,r);return i!==n&&i.dispose(),a!==e&&a.dispose(),Ar(f,"int32")}const yZ=gZ;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bZ(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const a=Y(n,"boxes","nonMaxSuppression"),o=Y(e,"scores","nonMaxSuppression"),l=of(a,o,t,s,r,i);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const u={boxes:a,scores:o},d={maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},f=ie.runKernel(uI,u,d);return{selectedIndices:f[0],selectedScores:f[1]}}const xZ=ue({nonMaxSuppressionWithScore_:bZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function vZ(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const a=Y(n,"boxes","nonMaxSuppressionAsync"),o=Y(e,"scores","nonMaxSuppressionAsync"),l=of(a,o,t,s,r,i);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const u=await Promise.all([a.data(),o.data()]),d=u[0],f=u[1],{selectedIndices:m,selectedScores:y}=QI(d,f,t,s,r,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:Ar(m,"int32"),selectedScores:Ar(y)}}const wZ=vZ;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SZ(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const a=Y(n,"boxes","nonMaxSuppression"),o=Y(e,"scores","nonMaxSuppression"),l=of(a,o,t,s,r,null),u=l.maxOutputSize,d=l.iouThreshold,f=l.scoreThreshold,m={boxes:a,scores:o},y={maxOutputSize:u,iouThreshold:d,scoreThreshold:f,padToMaxOutputSize:i},b=ie.runKernel(cI,m,y);return{selectedIndices:b[0],validOutputs:b[1]}}const TZ=ue({nonMaxSuppressionPadded_:SZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function EZ(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const a=Y(n,"boxes","nonMaxSuppressionAsync"),o=Y(e,"scores","nonMaxSuppressionAsync"),l=of(a,o,t,s,r,null),u=l.maxOutputSize,d=l.iouThreshold,f=l.scoreThreshold,[m,y]=await Promise.all([a.data(),o.data()]),{selectedIndices:b,validOutputs:w}=YI(m,y,u,d,f,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:Ar(b,"int32"),validOutputs:Wt(w,"int32")}}const _Z=EZ;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IZ(n,e,t=!1,s=!1){const r=Y(n,"images","resizeBilinear");H(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),H(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),H(s===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,a=!1;r.rank===3&&(a=!0,i=ce(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:s,size:e},u=ie.runKernel(Tv,o,l);return a?ce(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const u3=ue({resizeBilinear_:IZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Z(n,e,t=!1,s=!1){const r=Y(n,"images","resizeNearestNeighbor");H(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),H(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),H(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),H(s===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,a=!1;r.rank===3&&(a=!0,i=ce(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:s,size:e},u=ie.runKernel(Sv,o,l);return a?ce(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const h3=ue({resizeNearestNeighbor_:$Z});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CZ(n,e="binary",t=!1,s=.5){const r=Y(n,"image","threshold"),i=.2989,a=.587,o=.114,l=r.shape[0]*r.shape[1];let u=se(Ar([s]),255),d,f,m,y;if(H(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),H(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),H(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),H(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[d,f,m]=Kr(r,[1,1,1],-1);const x=se(d,i),T=se(f,a),E=se(m,o);y=Oe(Oe(x,T),E)}else y=n;if(e==="otsu"){const x=_7(Ue(ZP(y),"int32"),_P([]),256);u=NZ(x,l)}const b=t?rf(y,u):Qr(y,u);return Ue(se(b,255),"int32")}function NZ(n,e){let t=Ar([-1]),s=Ar([0]),r=Ar([0]),i,a,o,l,u,d;for(let f=0;f<n.size-1;f++){i=sn(n,0,f+1),a=sn(n,f+1),u=Je(Ze(i),e),d=Je(Ze(a),e);const m=Ze(se(i,gm(0,i.size)));o=Je(m,Ze(i));const y=Vv(a.shape,i.size),b=Oe(gm(0,a.size),y),w=se(a,b);l=Je(Ze(w),Ze(a));const x=tt(o,l),T=tt(o,l),E=se(u,d);r=se(se(E,x),T);const $=Qr(r,s);s=ar($,r,s),t=ar($,Ar([f]),t)}return t}const kZ=ue({threshold_:CZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AZ(n,e,t="nearest",s="constant",r=0,i){const a=Y(n,"image","transform","float32"),o=Y(e,"transforms","transform","float32");H(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),H(o.rank===2&&(o.shape[0]===a.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),H(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:a,transforms:o},u={interpolation:t,fillMode:s,fillValue:r,outputShape:i};return ie.runKernel(xI,l,u)}const RZ=ue({transform_:AZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DZ(n,e,t){const s=Y(n,"a","bandPart");H(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,a]=s.shape.slice(-2);let o,l;typeof e=="number"?(H(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),H(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),o=Y(e<0?i:e,"numLower","bandPart")):(H(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=ar(B0(e,0),i,mm(e,i))),typeof t=="number"?(H(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),H(t<=a,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${a}).`),l=Y(t<0?a:t,"numUpper","bandPart")):(H(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=ar(B0(t,0),a,mm(t,a)));const u=ce(gm(0,i,1,"int32"),[-1,1]),d=gm(0,a,1,"int32"),f=tt(u,d),m=Lo(rf(f,o),Ju(f,Dn(l))),y=cs([i,a],s.dtype);return ce(Po(Pu(ce(s,[-1,i,a])).map(b=>ar(m,b,y))),r)}const OZ=ue({bandPart_:DZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FZ(n){let e;if(Array.isArray(n)){e=!1,H(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=n[0].shape[0];for(let i=1;i<n.length;++i)H(n[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[i].shape[0]} vs. ${r})`)}else e=!0,n=Kr(n,n.shape[0],0).map(r=>jg(r,[0]));H(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],s=n;for(let r=0;r<n.length;++r)t.push(ie.tidy(()=>{let i=s[r];if(r>0)for(let a=0;a<r;++a){const o=se(Ze(se(t[a],i)),t[a]);i=tt(i,o)}return Je(i,Cd(i,"euclidean"))}));return e?Po(t,0):t}const LZ=ue({gramSchmidt_:FZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PZ(n,e=!1){if(H(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return BR(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,u)=>l*u),s=Pu(ce(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[u,d]=BR(l,e);r.push(u),i.push(d)});const a=ce(Po(r,0),n.shape),o=ce(Po(i,0),n.shape);return[a,o]}}function BR(n,e=!1){return ie.tidy(()=>{H(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],s=n.shape[1];let r=WP(t),i=xu(n);const a=qS([[1]],[1,1]);let o=xu(a);const l=t>=s?s:t;for(let u=0;u<l;++u){const d=i,f=o,m=r;[o,i,r]=ie.tidy(()=>{const y=sn(i,[u,u],[t-u,1]),b=Cd(y),w=sn(i,[u,u],[1,1]),x=ar(Qr(w,0),qS([[-1]]),qS([[1]])),T=tt(w,se(x,b)),E=Je(y,T);E.shape[0]===1?o=xu(a):o=wr([a,sn(E,[1,0],[E.shape[0]-1,E.shape[1]])],0);const $=Dn(Je(jt(x,T),b)),C=sn(i,[u,0],[t-u,s]),O=se($,o),V=It(o);if(u===0)i=tt(C,jt(O,jt(V,C)));else{const N=tt(C,jt(O,jt(V,C)));i=wr([sn(i,[0,0],[u,s]),N],0)}const F=It(O),R=sn(r,[0,u],[t,r.shape[1]-u]);if(u===0)r=tt(R,jt(jt(R,o),F));else{const N=tt(R,jt(jt(R,o),F));r=wr([sn(r,[0,0],[t,u]),N],1)}return[o,i,r]}),vt([d,f,m])}return!e&&t>s&&(r=sn(r,[0,0],[t,s]),i=sn(i,[0,0],[s,s])),[r,i]})}const MZ=ue({qr_:PZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Co={flipLeftRight:tZ,grayscaleToRGB:sZ,resizeNearestNeighbor:h3,resizeBilinear:u3,rgbToGrayscale:iZ,rotateWithOffset:oZ,cropAndResize:JQ,nonMaxSuppression:cZ,nonMaxSuppressionAsync:yZ,nonMaxSuppressionWithScore:xZ,nonMaxSuppressionWithScoreAsync:wZ,nonMaxSuppressionPadded:TZ,nonMaxSuppressionPaddedAsync:_Z,threshold:kZ,transform:RZ},VZ={bandPart:OZ,gramSchmidt:LZ,qr:MZ};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BZ=new Map,zZ=new Map;class lf{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class wi{constructor(){this.classNameMap={}}static getMap(){return wi.instance==null&&(wi.instance=new wi),wi.instance}static register(e){wi.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Ae(n,e,t){H(n.className!=null,()=>"Class being registered does not have the static className property defined."),H(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),H(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const s=t,r=e+">"+s;return wi.register(n),BZ.set(r,n),zZ.set(n,r),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vc extends lf{minimize(e,t=!1,s){const{value:r,grads:i}=this.computeGradients(e,s);if(s!=null){const a=s.map(o=>({name:o.name,tensor:i[o.name]}));this.applyGradients(a)}else this.applyGradients(i);return vt(i),t?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return HX(e,t)}dispose(){this.iterations_!=null&&vt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Wt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(vc,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d3 extends vc{static get className(){return"Adadelta"}constructor(e,t,s=null){super(),this.learningRate=e,this.rho=t,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=ie.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=ie.registeredVariables[s],a=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:ge(()=>$t(i).variable(a))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:ge(()=>$t(i).variable(a))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedGrads[r].variable,u=this.accumulatedUpdates[r].variable;ge(()=>{const d=Oe(se(l,this.rho),se(gn(o),1-this.rho)),f=se(Je(zs(Oe(u,this.epsilon)),zs(Oe(l,this.epsilon))),o),m=Oe(se(u,this.rho),se(gn(f),1-this.rho));l.assign(d),u.assign(m);const y=Oe(se(f,-this.learningRate),i);i.assign(y)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(vt(this.accumulatedGrads.map(e=>e.variable)),vt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f3 extends vc{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=ie.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:ge(()=>Vv(i.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const o=this.accumulatedGrads[r].variable;ge(()=>{const l=Oe(o,gn(a));o.assign(l);const u=Oe(se(Je(a,zs(Oe(l,ie.backend.epsilon()))),-this.learningRate),i);i.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&vt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p3 extends vc{static get className(){return"Adam"}constructor(e,t,s,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ge(()=>{this.accBeta1=Wt(t).variable(),this.accBeta2=Wt(s).variable()}),r==null&&(this.epsilon=ie.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);ge(()=>{const s=tt(1,this.accBeta1),r=tt(1,this.accBeta2);t.forEach((i,a)=>{const o=ie.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:ge(()=>$t(o).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${i}/v`,variable:ge(()=>$t(o).variable(l))});const u=Array.isArray(e)?e[a].tensor:e[i];if(u==null)return;const d=this.accumulatedFirstMoment[a].variable,f=this.accumulatedSecondMoment[a].variable,m=Oe(se(d,this.beta1),se(u,1-this.beta1)),y=Oe(se(f,this.beta2),se(gn(u),1-this.beta2)),b=Je(m,s),w=Je(y,r);d.assign(m),f.assign(y);const x=Oe(se(Je(b,Oe(zs(w),this.epsilon)),-this.learningRate),o);o.assign(x)}),this.accBeta1.assign(se(this.accBeta1,this.beta1)),this.accBeta2.assign(se(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&vt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&vt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),ge(()=>{this.accBeta1.assign(Fu(this.beta1,this.iterations_+1)),this.accBeta2.assign(Fu(this.beta2,this.iterations_+1))});const t=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m3 extends vc{static get className(){return"Adamax"}constructor(e,t,s,r=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ge(()=>{this.iteration=Wt(0).variable(),this.accBeta1=Wt(t).variable()}),r==null&&(this.epsilon=ie.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);ge(()=>{const s=tt(1,this.accBeta1),r=Je(-this.learningRate,Oe(se(this.iteration,this.decay),1));t.forEach((i,a)=>{const o=ie.registeredVariables[i],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:$t(o).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${i}/v`,variable:$t(o).variable(l)});const u=Array.isArray(e)?e[a].tensor:e[i];if(u==null)return;const d=this.accumulatedFirstMoment[a].variable,f=this.accumulatedWeightedInfNorm[a].variable,m=Oe(se(d,this.beta1),se(u,1-this.beta1)),y=se(f,this.beta2),b=Qs(u),w=bc(y,b);d.assign(m),f.assign(w);const x=Oe(se(Je(r,s),Je(m,Oe(w,this.epsilon))),o);o.assign(x)}),this.iteration.assign(Oe(this.iteration,1)),this.accBeta1.assign(se(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&vt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&vt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JI extends vc{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const a=ie.registeredVariables[s];ge(()=>{const o=Oe(se(this.c,i),a);a.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Aa(Wt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g3 extends JI{static get className(){return"Momentum"}constructor(e,t,s=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=s,this.accumulations=[],this.m=Wt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=ie.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:ge(()=>$t(i).variable(!1))});const a=this.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[s];o!=null&&ge(()=>{let l;const u=Oe(se(this.m,a),o);this.useNesterov?l=Oe(se(this.c,Oe(o,se(u,this.m))),i):l=Oe(se(this.c,u),i),a.assign(u),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&vt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y3 extends vc{static get className(){return"RMSProp"}constructor(e,t=.9,s=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=ie.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=ie.registeredVariables[s],a=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:ge(()=>$t(i).variable(a))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:ge(()=>$t(i).variable(a))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:ge(()=>$t(i).variable(a))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedMeanSquares[r].variable,u=this.accumulatedMoments[r].variable;ge(()=>{const d=Oe(se(l,this.decay),se(gn(o),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[r].variable,m=Oe(se(f,this.decay),se(o,1-this.decay)),y=Je(se(o,this.learningRate),zs(tt(d,Oe(gn(m),this.epsilon)))),b=Oe(se(u,this.momentum),y);l.assign(d),f.assign(m),u.assign(b);const w=tt(i,b);i.assign(w)}else{const f=Oe(se(l,this.decay),se(gn(o),1-this.decay)),m=Oe(se(u,this.momentum),Je(se(o,this.learningRate),zs(Oe(f,this.epsilon))));l.assign(f),u.assign(m);const y=tt(i,m);i.assign(y)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&vt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&vt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&vt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UZ=[d3,f3,p3,m3,g3,y3,JI];function jZ(){for(const n of UZ)Ae(n)}function e$(n,e){const t=n.shape.length,s=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${t}`);if(Ee(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const r=e.shape,i=r[r.length-1];let a=1;for(let f=0;f<r.length-1;++f)a*=r[f];const o=n.shape,l=r.slice();l.pop();let u=1;for(let f=i;f<t;++f)u*=o[f],l.push(o[f]);const d=[...Ye(n.shape).map(f=>f/u),1].slice(0,i);return[l,a,u,d]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YT=-2,WZ=-1;function t$(n,e,t){const s=n.shape.length;H(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),H(s===t.length,()=>`Error in slice${s}D: Length of size ${t} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)H(e[r]+t[r]<=n.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+t[r]}) would overflow input.shape[${r}] (${n.shape[r]})`)}function GZ(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function n$(n,e,t){const s=[];for(let r=0;r<n.length;r++)s[r]=Math.ceil((e[r]-n[r])/t[r]);return s}function b3(n,e,t,s){const r=[...n];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<t;i++)i===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function x3(n,e,t){return t<=n?t:t-(e-1)}function v3(n,e){const t=[];for(let s=0;s<n;s++)t.push(e+s);return t}function HZ(n,e,t,s,r,i,a,o,l){const u=n.length;let d=new Array(u),f=new Array(u),m=new Array(u);if(e.length&&t>0){const y=e[0],b=t+1;d=w3(a,y,b,s,n),f=S3(o,y,b,r,n),m=b3(i,y,b,n)}else for(let y=0;y<u;y++)d[y]=E3(a,s,i,n,y,l),f[y]=_3(o,r,i,n,y,l),m[y]=T3(i,y,l);return{begin:d,end:f,strides:m}}function w3(n,e,t,s,r){const i=[...r],a=v3(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=0;else{const l=x3(e,t,o);let u=s[l];n&1<<l&&(u=0),i[o]=u}return i}function S3(n,e,t,s,r){const i=[...r],a=v3(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=Number.MAX_SAFE_INTEGER;else{const l=x3(e,t,o);let u=s[l];n&1<<l&&(u=Number.MAX_SAFE_INTEGER),i[o]=u}for(let o=0;o<i.length;o++){const l=r[o];i[o]<0&&(i[o]+=l),i[o]=Cu(0,i[o],r[o])}return i}function T3(n,e,t){let s=n[e];return(t&1<<e||s==null)&&(s=1),s}function E3(n,e,t,s,r,i){let a=e[r];const o=t[r]||1;(n&1<<r||i&1<<r||a==null)&&(o>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const l=s[r];return a<0&&(a+=l),a=Cu(0,a,l-1),a}function _3(n,e,t,s,r,i){let a=e[r];const o=t[r]||1;(n&1<<r||i&1<<r||a==null)&&(o>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const l=s[r];return a<0&&(a+=l),o>0?a=Cu(0,a,l):a=Cu(-1,a,l-1),a}function s$(n,e,t){let s=t.length;for(let r=0;r<t.length;r++)if(t[r]>1){s=r;break}for(let r=s+1;r<t.length;r++)if(e[r]>0||t[r]!==n[r])return!1;return!0}function r$(n,e){let t=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)t+=n[s]*e[s];return t}function Uv(n,e,t){let s;const r=n.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(a=>{H(a!==-1,()=>"slice() does not support negative begin indexing.")});let i;return t==null?i=new Array(r).fill(-1):typeof t=="number"?i=[t,...new Array(r-1).fill(-1)]:t.length<r?i=t.concat(new Array(r-t.length).fill(-1)):i=t,i=i.map((a,o)=>a>=0?a:(H(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${o}.`),n.shape[o]-s[o])),[s,i]}function i$(n,e,t,s,r,i,a,o,l){let u;if(s==null?(u=new Array(e.length),u.fill(1)):u=s,a!=null&&(a&a-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let d=!1;const f={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:u.slice(),beginMask:r,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};for(let $=0;$<f.dims;$++)d&&(1<<$&o)!==0&&f.numAddAxisAfterEllipsis++,1<<$&a&&(d=!0);d||(f.ellipsisMask|=1<<f.dims,f.dims++);const m={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};qZ(f,m);let y=!0,b=!0,w=!0;const x=[],T=[];for(let $=0;$<n.length;++$){if(m.strides[$]===0)throw Error(`strides[${$}] must be non-zero`);const C=!!(m.shrinkAxisMask&1<<$),O=n[$];if(O===-1){x.push(C?1:-1);continue}const V=[m.beginMask&1<<$,m.endMask&1<<$],F=[m.strides[$]>0?0:-1,m.strides[$]>0?O:O-1];if(C&&m.strides[$]<=0)throw Error("only stride 1 allowed on non-range indexing.");w=w&&m.strides[$]===1;const R=!!(m.beginMask&1<<$&&m.endMask&1<<$);if(m.beginValid&&m.endValid){if(C){const z=m.begin[$]<0?O+m.begin[$]:m.begin[$];if(m.begin[$]=z,m.end[$]=m.begin[$]+1,z<0||z>=O)throw Error(`slice index ${m.begin[$]} of dimension ${$} out of bounds.`)}else m.begin[$]=zR(m.begin[$],0,m.strides[$],O,V,F),m.end[$]=zR(m.end[$],1,m.strides[$],O,V,F);const k=m.strides[$]===1&&m.begin[$]===0&&m.end[$]===O;y=y&&k,b=b&&($===0&&m.strides[$]===1||k)}else y=y&&m.strides[$]===1&&R,b=b&&($===0&&m.strides[$]===1||R);let N,D=!1;if(m.beginValid&&m.endValid?(N=m.end[$]-m.begin[$],D=!0):C?(N=1,D=!0):R&&O>=0&&(m.strides[$]<0?N=-O:N=O,D=!0),D){let k;N===0||N<0!=m.strides[$]<0?k=0:k=Math.trunc(N/m.strides[$])+(N%m.strides[$]!==0?1:0),x.push(k)}else x.push(-1)}for(let $=0;$<m.finalShapeGatherIndices.length;++$){const C=m.finalShapeGatherIndices[$];C>=0?T.push(x[C]):C===YT&&T.push(1)}return{finalShapeSparse:T.filter(($,C)=>m.finalShapeGatherIndices[C]!==YT),finalShape:T,isIdentity:y,sliceDim0:b,isSimpleSlice:w,begin:m.begin,end:m.end,strides:m.strides}}function qZ(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const r=Math.min(e.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<r;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=s}else if(1<<s&n.newAxisMask)e.finalShapeGatherIndices.push(YT),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[s]),n.end!=null&&(e.end[t]=n.end[s]),e.strides[t]=n.strides[s],n.beginMask&1<<s&&(e.beginMask|=1<<t),n.endMask&1<<s&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(WZ),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[t]=s,t++}}function zR(n,e,t,s,r,i){if(r[e])return t>0?i[e]:i[e+1&1];{const a=n<0?s+n:n;return a<i[0]?i[0]:a>i[1]?i[1]:a}}const KZ=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:t$,computeFlatOffset:r$,computeOutShape:n$,getNormalizedAxes:HZ,isSliceContinous:s$,maskToAxes:GZ,parseSliceParams:Uv,sliceInfo:i$,startForAxis:E3,startIndicesWithElidedDims:w3,stopForAxis:_3,stopIndicesWithElidedDims:S3,stridesForAxis:T3,stridesWithElidedDims:b3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XZ{static sgd(e){return new JI(e)}static momentum(e,t,s=!1){return new g3(e,t,s)}static rmsprop(e,t=.9,s=0,r=null,i=!1){return new y3(e,t,s,r,i)}static adam(e=.001,t=.9,s=.999,r=null){return new p3(e,t,s,r)}static adadelta(e=.001,t=.95,s=null){return new d3(e,t,s)}static adamax(e=.002,t=.9,s=.999,r=null,i=0){return new m3(e,t,s,r,i)}static adagrad(e,t=.1){return new f3(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yh=XZ;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YZ=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function I3(){return new Promise(n=>YZ(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a$(n,e){const t=n[0].length;n.forEach((r,i)=>{H(r.length===t,()=>`Error in concat${t}D: rank of tensors[${i}] must be the same as the rank of the rest (${t})`)}),H(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const s=n[0];n.forEach((r,i)=>{for(let a=0;a<t;a++)H(a===e||r[a]===s[a],()=>`Error in concat${t}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function Ra(n,e){const t=n[0].slice();for(let s=1;s<n.length;s++)t[e]+=n[s][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zi;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(zi||(zi={}));function $3(n,e,t){let s=new Array;if(t==null&&e==null)return s;if(e==null)for(;s.length<n+t.length;)s.push(-1);else s=e.slice();if(t==null)return s;if(n+t.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${s.length}`);for(let r=1;r<t.length;++r){const i=t[r],a=s[s.length-t.length+r],o=s[a];if(i>=0)if(o>=0){if(o!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+n}] = ${i} but shape[${r+n}] = ${o}`)}else s[a]=i}return s}function C3(n){const e={FIRST_DIM_SIZE:zi.FIRST_DIM_SIZE,VALUE_ROWIDS:zi.VALUE_ROWIDS,ROW_LENGTHS:zi.ROW_LENGTHS,ROW_SPLITS:zi.ROW_SPLITS,ROW_LIMITS:zi.ROW_LIMITS,ROW_STARTS:zi.ROW_STARTS},t=[];for(const s of n)if(s in e)t.push(e[s]);else break;return t}function N3(n){return n.length===0?0:n[0]===zi.FIRST_DIM_SIZE?n.length-1:n.length}function k3(n,e){if(n==null||e==null)return;const t=n.length,s=e.length;if(t>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(t,s-1);++r){const i=n[r],a=e[r+1];if(i>=0&&a>=0&&i!==1&&i!==a)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-n.length}] = ${i} but ragged tensor input.flatValues.shape[${r-n.length}] = ${a}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o$=30;function jv(n){return n<=o$?n:DT(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l$(n,e,t){const s=t*(typeof n=="number"?n:n[0]),r=e*(typeof n=="number"?n:n[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gg(n,e,t,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(n[0]/t),r=r.concat(n.slice(1));else{r=r.concat(n[0]);const i=e.length;for(let a=0;a<i;++a)r=r.concat([n[a+1]/e[a],e[a]]);r=r.concat(n.slice(i+1))}return r}function Hg(n,e,t=!0){const s=[];if(t){s.push(e);for(let r=e+1;r<n;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],i=[];for(let a=1;a<n;++a)a>=e*2+1||a%2===1?i.push(a):r.push(a);s.push(...r),s.push(0),s.push(...i)}return s}function qg(n,e,t,s=!0){const r=[];s?r.push(n[0]/t):r.push(n[0]*t);for(let i=1;i<n.length;++i)i<=e.length?s?r.push(e[i-1]*n[i]):r.push(n[i]/e[i-1]):r.push(n[i]);return r}function c$(n,e){const t=[0];for(let s=0;s<e;++s)t.push(n[s][0]);return t}function u$(n,e,t){const s=n.slice(0,1);for(let r=0;r<t;++r)s.push(n[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wv=1.7580993408473768,Gv=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h$=.3275911,d$=.254829592,f$=-.284496736,p$=1.421413741,m$=-1.453152027,g$=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mo(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let s=0;s<t.length;s+=2)t[s]=n[s/2],t[s+1]=e[s/2];return t}function A3(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)e[s/2]=n[s],t[s/2]=n[s+1];return{real:e,imag:t}}function R3(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function D3(n){const e=Math.floor(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function y$(n,e){const t=n[e*2],s=n[e*2+1];return{real:t,imag:s}}function O3(n,e,t,s){n[s*2]=e,n[s*2+1]=t}function F3(n,e){const t=new Float32Array(n/2),s=new Float32Array(n/2);for(let r=0;r<Math.ceil(n/2);r++){const i=(e?2:-2)*Math.PI*(r/n);t[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:t,imag:s}}function L3(n,e,t){const s=(t?2:-2)*Math.PI*(n/e),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KS="->",QZ=/->/g,UR=",",jR="...";function b$(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(QZ,"").length)/KS.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${KS}").`);const[s,r]=n.split(KS);H(s.indexOf(jR)===-1,()=>`The ellipsis notation ("${jR}") is not supported yet.`);const i=s.split(UR),a=i.length;if(e!==a)throw new Error(`Expected ${a} input tensors, received ${e}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let m=0;m<r.length;++m){const y=r[m];if(!i.some(b=>b.indexOf(y)!==-1))throw new Error(`Output subscripts contain the label ${y} not present in the input subscripts.`);o.indexOf(y)===-1&&o.push(y)}for(let m=0;m<s.length;++m){const y=s[m];o.indexOf(y)===-1&&y!==UR&&o.push(y)}const l=new Array(i.length);for(let m=0;m<a;++m){if(new Set(i[m].split("")).size!==i[m].length)throw new Error(`Found duplicate axes in input component ${i[m]}. Support for duplicate axes in input is not implemented yet.`);l[m]=[];for(let y=0;y<i[m].length;++y)l[m].push(o.indexOf(i[m][y]))}const u=o.length,d=r.length,f=[];for(let m=d;m<u;++m)f.push(m);return{allDims:o,summedDims:f,idDims:l}}function x$(n,e){let t=new Array(n);t.fill(-1);for(let r=0;r<e.length;++r)t[e[r]]=r;const s=[];for(let r=0;r<n;++r)t[r]===-1&&s.push(r);return t=t.filter(r=>r!==-1),{permutationIndices:t,expandDims:s}}function v$(n,e,t){const s=new Array(n);for(let r=0;r<t.length;++r){const i=t[r].shape;for(let a=0;a<e[r].length;++a)s[e[r][a]]===void 0?s[e[r][a]]=i[a]:H(s[e[r][a]]===i[a],()=>`Expected dimension ${s[e[r][a]]} at axis ${a} of input shaped ${JSON.stringify(i)}, but got dimension ${i[a]}`)}}function w$(n,e){const t=n,s=[];let r=0;n.length===0&&t.push(-1),r=n.length+1;for(let a=0;a<r;++a)s.push([]);const i=[];for(let a=0;a<t.length;++a){const o=t[a],l=ZZ(e,o);for(const u of l)i.indexOf(u)===-1&&(s[a].push(u),i.push(u))}return{path:t,steps:s}}function S$(n){return n.every((e,t)=>e===t)}function ZZ(n,e){const t=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(e)!==-1||e===-1)&&t.push(s);return t}function T$(n,e,t=0){let s=[];if(typeof e=="number")H(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(n.shape[t]/e);else{const r=e.reduce((a,o)=>(o===-1&&(a+=1),a),0);H(r<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const a=e.reduce((o,l)=>l>0?o+l:o);e[i]=n.shape[t]-a}H(n.shape[t]===e.reduce((a,o)=>a+o),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P3(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function M3(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function V3(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function z3(n,e){return`size ${n} must be non-negative, not ${e}`}function U3(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function j3(n,e){const t=Ee(n),s=Ee(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${e}`}function W3(n,e){const t=Ee(n),s=Ee(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QT(){return"segment ids must be >= 0"}function G3(){return"segment ids are not increasing"}function H3(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function q3(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3(n,e){let t=!1,s;for(n<=o$?(s=n,t=!0):s=DT(n,Math.floor(Math.sqrt(n)));!t;)s>e||s===n?t=!0:s=DT(n,s+1);return s}function X3(n,e,t){const s=[],r=n.length;for(let i=0;i<r;i++)i!==e?s.push(n[i]):s.push(t);return s}function E$(n,e,t,s){const r=e.shape.length,i=n.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(t<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${t}).`);for(let f=0;f<s;++f)if(n.shape[f]!==e.shape[f])throw new Error(`x.shape[${f}]: ${n.shape[f]} should be equal to indices.shape[${f}]: ${e.shape[f]}.`);const a=n.shape[t],o=[];let l=1,u=1,d=1;for(let f=0;f<s;++f)o.push(n.shape[f]),l*=n.shape[f];for(let f=s;f<t;f++)o.push(n.shape[f]),u*=n.shape[f];for(let f=s;f<r;f++)o.push(e.shape[f]);for(let f=t+1;f<i;f++)o.push(n.shape[f]),d*=n.shape[f];return{batchSize:l,sliceSize:d,outerSize:u,dimSize:a,outputShape:o}}const JZ=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:E$,computeOutShape:X3,segOpComputeOptimalWindowSize:K3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vo(n){try{return n.map(e=>tc(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function Y3(n){return n.map(e=>Ql(e))}const eJ=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:d$,ERF_A2:f$,ERF_A3:p$,ERF_A4:m$,ERF_A5:g$,ERF_P:h$,PARALLELIZE_THRESHOLD:o$,get RowPartitionType(){return zi},SELU_SCALE:Gv,SELU_SCALEALPHA:Wv,applyActivation:qI,assertAndGetBroadcastShape:ot,assertAxesAreInnerMostDims:Ns,assertParamsConsistent:a$,assignToTypedArray:O3,axesAreInnerMostDims:AI,calculateShapes:th,checkEinsumDimSizes:v$,checkPadOnDimRoundingMode:Er,combineLocations:UP,combineRaggedTensorToTensorShapes:$3,complexWithEvenIndex:R3,complexWithOddIndex:D3,computeConv2DInfo:Cs,computeConv3DInfo:gc,computeDefaultPad:_I,computeDilation2DInfo:Bg,computeOptimalWindowSize:jv,computeOutAndReduceShapes:ps,computeOutShape:Ra,computePool2DInfo:$i,computePool3DInfo:Ho,convertConv2DDataFormat:qo,decodeEinsumEquation:b$,eitherStridesOrDilationsAreOne:js,expandShapeToKeepDim:jn,exponent:L3,exponents:F3,fromStringArrayToUint8:Y3,fromUint8ToStringArray:Vo,getAxesPermutation:Sn,getBroadcastDims:$d,getComplexWithIndex:y$,getEinsumComputePath:w$,getEinsumPermutation:x$,getFusedBiasGradient:HI,getFusedDyActivation:GI,getImageCenter:l$,getInnerMostAxes:Ln,getPermuted:Hg,getRaggedRank:N3,getReductionAxes:ts,getReshaped:Gg,getReshapedPermuted:qg,getRowPartitionTypesHelper:C3,getSliceBeginCoords:c$,getSliceSize:u$,getSparseFillEmptyRowsIndicesDenseShapeMismatch:P3,getSparseFillEmptyRowsNegativeIndexErrorMessage:M3,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:V3,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:U3,getSparseReshapeInputOutputMismatchErrorMessage:W3,getSparseReshapeInputOutputMultipleErrorMessage:j3,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:B3,getSparseReshapeNegativeOutputDimErrorMessage:z3,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:q3,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:QT,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:G3,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:H3,getUndoAxesPermutation:yc,isIdentityPermutation:S$,log:O9,mergeRealAndImagArrays:Mo,prepareAndValidate:e$,prepareSplitSize:T$,segment_util:JZ,shouldFuse:KI,slice_util:KZ,splitRealAndImagArrays:A3,stridesOrDilationsArePositive:Du,tupleValuesAreOne:Ru,upcastType:Rr,validateDefaultValueShape:k3,validateInput:AQ,validateUpdateShape:a3,warn:Hr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */jZ();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q3={kernelName:Ox,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(n,Wg(Ue(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tJ={kernelName:Wm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=gn(Ue(t,"float32")),r=zs(tt(Wt(1),s));return Dn(Je(n,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nJ={kernelName:Gm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=zs(tt(gn(Ue(t,"float32")),1));return Je(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sJ={kernelName:tf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=ot(t.shape,s.shape);return{a:()=>{let o=n;const l=ts(t.shape,r);return l.length>0&&(o=Ze(o,l)),ce(o,t.shape)},b:()=>{let o=n;const l=ts(s.shape,r);return l.length>0&&(o=Ze(o,l)),ce(o,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rJ={kernelName:F_,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((s,r)=>{t[r]=()=>n.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iJ={kernelName:Fx,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aJ={kernelName:Lx,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oJ={kernelName:Hm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Je(n,zs(tt(Wt(1),gn(Ue(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lJ={kernelName:qm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=zs(Oe(Wt(1),gn(Ue(t,"float32"))));return Je(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cJ={kernelName:Ym,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=ot(t.shape,s.shape);return{a:()=>{const o=Oe(gn(t),gn(s));let l=se(n,Je(s,o));const u=ts(t.shape,r);return u.length>0&&(l=Ze(l,u)),ce(l,t.shape)},b:()=>{const o=Oe(gn(t),gn(s));let l=Dn(se(n,Je(t,o)));const u=ts(s.shape,r);return u.length>0&&(l=Ze(l,u)),ce(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uJ={kernelName:Km,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Je(n,Oe(gn(Ue(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hJ={kernelName:Xm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Je(n,tt(Wt(1),gn(Ue(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dJ(n,e,t,s,r,i){const a=Y(n,"dy","avgPool3dGrad"),o=Y(e,"input","avgPool3dGrad");let l=a,u=o,d=!1;o.rank===4&&(d=!0,l=ce(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),u=ce(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),H(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),H(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),Er("avgPool3dGrad",r,i);const f={dy:l,input:u},m={filterSize:t,strides:s,pad:r,dimRoundingMode:i},y=ie.runKernel(V_,f,m);return d?ce(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const fJ=ue({avgPool3dGrad_:dJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pJ={kernelName:Mx,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:i,pad:a,dimRoundingMode:o}=t;return{x:()=>fJ(n,s,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mJ(n,e,t,s,r){const i=Y(n,"dy","avgPoolGrad"),a=Y(e,"input","avgPoolGrad");H(a.rank===i.rank,()=>`Rank of input (${a.rank}) does not match rank of dy (${i.rank})`);let o=a,l=i,u=!1;a.rank===3&&(u=!0,o=ce(a,[1,a.shape[0],a.shape[1],a.shape[2]]),l=ce(i,[1,i.shape[0],i.shape[1],i.shape[2]])),H(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),H(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const d={dy:l,input:o},f={filterSize:t,strides:s,pad:r},m=ie.runKernel(M_,d,f);return u?ce(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const gJ=ue({avgPoolGrad_:mJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yJ={kernelName:Px,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:i,pad:a}=t;return{x:()=>gJ(n,s,r,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bJ={kernelName:Vx,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[s,r]=e,{transposeA:i,transposeB:a}=t;return!i&&!a?{a:()=>jt(n,r,!1,!0),b:()=>jt(s,n,!0,!1)}:!i&&a?{a:()=>jt(n,r,!1,!1),b:()=>jt(n,s,!0,!1)}:i&&!a?{a:()=>jt(r,n,!1,!0),b:()=>jt(s,n,!1,!1)}:{a:()=>jt(r,n,!0,!0),b:()=>jt(n,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xJ={kernelName:Bx,gradFunc:(n,e,t)=>{const{blockShape:s,crops:r}=t;return{x:()=>VI(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vJ={kernelName:k9,gradFunc:(n,e,t)=>{const s=t,r=s.inputShape,i=s.shape,a=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])a[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const o=[];for(let l=0;l<a.length;l++)a[l]>1&&o.push(l);return{x:()=>Ze(n,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wJ={kernelName:Qm,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SJ={kernelName:Zm,gradFunc:n=>({x:()=>$t(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TJ={kernelName:Jm,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{clipValueMin:r,clipValueMax:i}=t;return{x:()=>ar(Lo(Ju(s,r),rf(s,i)),n,$t(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EJ={kernelName:zx,inputsToSave:["x"],gradFunc:Q3.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _J={kernelName:Ux,saveAllInputs:!0,gradFunc:(n,e,t)=>{const s=e.map(l=>l.shape),{axis:r}=t,i=gt(r,e[0].shape)[0],a=s.map(l=>l[i]);return Kr(n,a,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IJ={kernelName:jx,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{dilations:i,strides:a,pad:o,dataFormat:l}=t;return H(Ru(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>CI(s.shape,n,r,a,o,l),filter:()=>WI(s,n,r.shape,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $J={kernelName:Wx,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{strides:i,pad:a,dataFormat:o,dimRoundingMode:l}=t;return{dy:()=>Ou(n,r,i,a,o,1,l),filter:()=>WI(n,s,r.shape,i,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CJ(n,e,t,s,r){let i=n;n.rank===4&&(i=ce(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let a=e;a.rank===4&&(a=ce(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),H(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),H(a.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${a.shape}.`),H(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),H(i.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${t[3]}.`),H(a.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${a.shape[4]}) must match output depth for filter (${t[4]}).`);const o={x:i,dy:a},l={strides:s,pad:r,filterShape:t};return ie.runKernel(W_,o,l)}const NJ=ue({conv3DBackpropFilter_:CJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kJ={kernelName:Gx,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:i}=t;H(Ru(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[a,o]=e;return{x:()=>MP(a.shape,n,o,r,i),filter:()=>NJ(a,n,o.shape,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AJ={kernelName:eg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(Dn(n3(Ue(t,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RJ={kernelName:tg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(s3(Ue(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DJ={kernelName:Hx,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r,exclusive:i,reverse:a}=t;return{x:()=>{const o=Sn([r],s.rank);let l=BP(n,r,i,!a);return o!=null&&(l=It(l,o)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OJ={kernelName:qx,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:i,dimRoundingMode:a}=t,o=s??[1,1];H(Ru(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,u]=e;return H(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),H(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),H(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),H(js(r,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${o}'.`),Er("depthwiseConv2d",i,a),{x:()=>YQ(l.shape,n,u,r,i,o,a),filter:()=>KQ(l,n,u.shape,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FJ={kernelName:Kx,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,i={x:s,filter:r,dy:n},a={x:s,filter:r,dy:n};return{x:()=>ie.runKernel(OT,i,t),filter:()=>ie.runKernel(FT,a,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LJ={kernelName:sg,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,s={dy:n,y:t};return{x:()=>ie.runKernel(J_,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PJ={kernelName:rg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=se(Ma(Dn(gn(t))),2/Math.sqrt(Math.PI));return{x:()=>se(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MJ={kernelName:ig,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(n,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VJ={kernelName:Yx,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>ce(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BJ={kernelName:ag,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(n,Ma(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zJ={kernelName:og,gradFunc:n=>({x:()=>$t(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UJ={kernelName:lg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=ot(t.shape,s.shape);return{a:()=>{const o=Je(n,Ue(s,"float32")),l=ts(t.shape,r);return l.length>0?ce(Ze(o,l),t.shape):o},b:()=>{let o=se(n,Ue(t,"float32"));const l=ts(s.shape,r);l.length>0&&(o=ce(Ze(o,l),s.shape));const u=gn(s);return Dn(Je(o,Ue(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jJ={kernelName:Qx,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:s}=t,[r,i,a,o]=e,l=o??Wt(1),u=ts(i.shape,r.shape),d=[];if(i.rank===1){for(let C=0;C<r.shape.length-1;++C)d.push(r.shape[C]);d.push(1)}const f=tt(r,i),m=se(n,l),y=JP(Oe(a,Wt(s))),b=se(se(se(y,y),y),Wt(-.5));return{x:()=>i.rank===1?ce(se(se(n,ji(ce(y,[1,1,1,i.shape[0]]),d)),l),r.shape):ce(se(se(n,y),l),r.shape),mean:()=>{let C=se(se(y,Wt(-1)),m);return i.rank===1&&(C=Ze(C,u)),ce(C,i.shape)},variance:()=>{let C=se(se(b,f),m);return i.rank===1&&(C=Ze(C,u)),ce(C,i.shape)},scale:()=>{const C=se(f,y);let O=se(n,C);return i.rank===1&&(O=Ze(O,u)),ce(O,i.shape)},offset:()=>{let C=n;return i.rank===1&&(C=Ze(C,u)),ce(C,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WJ={kernelName:Zx,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[s,r]=e,{axis:i,batchDims:a}=t,o=gt(i,s.shape)[0],l=(u,d,f)=>()=>{const m=u.shape,y=d.size,b=m.slice(0,o),w=b.length,x=m.slice(i,m.length).slice(1),T=x.length,E=WR(0,w),$=WR(w+1,w+1+T),C=GR([b,[y],x]),O=ce(f,C),V=ce(d,[y]),F=GR([[w],E,$]),R=It(O,F);let N=l3(R,V,u.shape[o]);const D=yc(F);return N=It(N,D),N};if(a===1){const u=s.shape[0],d=s.split(u,0);return{x:()=>Po(d.map((y,b)=>l(y,r.slice(b,1),n.slice(b,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,n),indices:()=>r}}};function WR(n,e){const t=[];for(let s=n;s<e;++s)t.push(s);return t}function GR(n){const e=[];for(let t=0;t<n.length;++t)for(let s=0;s<n[t].length;++s)e.push(n[t][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GJ={kernelName:cg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>$t(t),b:()=>$t(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HJ={kernelName:ug,gradFunc:n=>({x:()=>Ue(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qJ={kernelName:hg,gradFunc:n=>({x:()=>$t(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KJ={kernelName:dg,gradFunc:n=>({x:()=>$t(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XJ={kernelName:fg,gradFunc:n=>({x:()=>$t(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YJ={kernelName:ev,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{alpha:r}=t,i=Qr(s,0);return{x:()=>ar(i,n,se(n,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QJ={kernelName:mg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Je(n,Oe(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZJ={kernelName:pg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Je(n,Ue(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JJ={kernelName:R9,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;return{logits:()=>{const a=Ma(s);return tt(n,se(Ze(n,r,!0),a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eee(n,e,t,s=5,r=1,i=1,a=.5){const o={x:n,y:e,dy:t},l={depthRadius:s,bias:r,alpha:i,beta:a};return ie.runKernel(iI,o,l)}const tee=ue({localResponseNormalizationBackprop_:eee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nee={kernelName:av,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{depthRadius:i,bias:a,alpha:o,beta:l}=t;return{x:()=>tee(s,r,n,i,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z3(n,e,t,s){return e.rank<t.rank&&(e=ce(e,jn(e.shape,s))),n.rank<t.rank&&(n=ce(n,jn(n.shape,s))),{x:()=>se(n,Ue(Pa(t,e),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HR={kernelName:ov,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{reductionIndices:r}=s,i=e[0],a=e[1],o=gt(r,i.shape),l=Z3(n,a,i,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const see={kernelName:gg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>se(n,Ue(Ju(t,s),"float32")),b:()=>se(n,Ue(B0(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ree(n,e,t,s,r,i,a){const o=Y(n,"dy","maxPool3dGrad"),l=Y(e,"input","maxPool3dGrad"),u=Y(t,"output","maxPool3dGrad");let d=o,f=l,m=u,y=!1;l.rank===4&&(y=!0,d=ce(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),f=ce(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),m=ce(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),H(d.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${d.rank}.`),H(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),H(m.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${m.rank}.`),Er("maxPool3dGrad",i,a);const b={dy:d,input:f,output:m},w={filterSize:s,strides:r,pad:i,dimRoundingMode:a},x=ie.runKernel(oI,b,w);return y?ce(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}const iee=ue({maxPool3dGrad_:ree});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aee={kernelName:cv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=t;return{x:()=>iee(n,s,r,i,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oee(n,e,t,s,r,i,a){const o=Y(n,"dy","maxPoolGrad"),l=Y(e,"input","maxPoolGrad"),u=Y(t,"output","maxPoolGrad");H(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),H(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),H(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Er("maxPoolGrad",i,a);const d={dy:o,input:l,output:u},f={filterSize:s,strides:r,pad:i,dimRoundingMode:a};return ie.runKernel(aI,d,f)}const lee=ue({maxPoolGrad_:oee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cee={kernelName:lv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:i,strides:a,pad:o}=t;return{x:()=>lee(n,s,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uee={kernelName:uv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t,i=gt(r,s.shape),o=ps(s.shape,i)[1],l=Ee(o);return{x:()=>{const d=s.shape.slice();i.forEach(y=>{d[y]=1});const f=ce(n,d);return Je(se(f,xc(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hee={kernelName:hv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{axis:r}=s,[i,a]=e,o=gt(r,i.shape),l=Z3(n,a,i,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dee={kernelName:yg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>se(n,Ue(rf(t,s),"float32")),b:()=>se(n,Ue(Qr(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fee={kernelName:dv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,i=r.map(a=>a[0]);return{x:()=>sn(n,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pee={kernelName:bg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=ot(t.shape,s.shape);return{a:()=>{const o=ts(t.shape,r);return o.length>0?ce(Ze(n,o),t.shape):n},b:()=>{const o=se(n,Dn(zv(Je(t,s)))),l=ts(s.shape,r);return l.length>0?ce(Ze(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mee={kernelName:xg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=ot(t.shape,s.shape);return{a:()=>{const o=se(n,Ue(s,"float32")),l=ts(t.shape,r);return l.length>0?ce(Ze(o,l),t.shape):o},b:()=>{const o=se(n,Ue(t,"float32")),l=ts(s.shape,r);return l.length>0?ce(Ze(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gee={kernelName:fv,gradFunc:n=>({x:()=>Dn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yee={kernelName:gv,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>cs(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bee={kernelName:mv,gradFunc:n=>({x:()=>$t(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xee={kernelName:yv,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:s}=t;return Pu(n,s).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qR={kernelName:bv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,i=r.map(a=>a[0]);return{x:()=>sn(n,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vee={kernelName:vg,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,s,r]=e,i=t,a=s,o=ot(i.shape,a.shape);return{a:()=>{const d=Ue(a,"float32");let f=se(n,se(d,Fu(i,tt(d,Wt(1)))));const m=ts(i.shape,o);return m.length>0&&(f=Ze(f,m)),ce(f,i.shape)},b:()=>{const d=Qr(i,0),f=ar(d,Va(i),$t(i));let m=se(n,se(r,f));const y=ts(a.shape,o);return y.length>0&&(m=Ze(m,y)),ce(m,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wee={kernelName:xv,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,s]=e,r=Qr(t,0);return{x:()=>ar(r,n,se(n,s)),alpha:()=>{let i=ar(r,$t(n),se(n,t));const a=ts(s.shape,n.shape);return a.length>0&&(i=Ze(i,a)),ce(i,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function See(n,e,t){const s=n.shape.slice();s[t]=1;const r=ce(e,s),i=KT(n,t,!0,!1),a=KT(n,t,!0,!0),o=se(i,a);return se(r,o)}function Tee(n,e,t){const s=n.shape.length,r=s-t.length,i=Sn(t,s);let a=n;i!=null&&(a=It(n,i));const o=a.shape.slice(),u=o.splice(s-t.length,t.length).reduce((m,y)=>m*y,1);o.push(u);const d=a.reshape(o);let f=See(d,e,r);if(f=f.reshape(a.shape),i!=null){const m=yc(i);f=It(f,m)}return f}const Eee={kernelName:vv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;let i=[];return r==null?i=s.shape.map((a,o)=>o):typeof r=="number"?i=[r]:i=r,{x:()=>Tee(s,n,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ee={kernelName:ng,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=ot(t.shape,s.shape);return{a:()=>{const o=Je(n,Ue(s,"float32")),l=ts(t.shape,r);return l.length>0?ce(Ze(o,l),t.shape):o},b:()=>{let o=se(n,Ue(t,"float32"));const l=ts(s.shape,r);l.length>0&&(o=ce(Ze(o,l),s.shape));const u=gn(s);return Dn(Je(o,Ue(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iee={kernelName:wg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Je(n,Dn(gn(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ee={kernelName:Tg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=se(rf(t,6),Wg(t));return{x:()=>se(n,Ue(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cee={kernelName:Sg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(n,Ue(Wg(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nee={kernelName:wv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ce(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kee={kernelName:Tv,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>ie.runKernel(pI,r,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aee={kernelName:Sv,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>ie.runKernel(fI,r,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ree={kernelName:Ev,gradFunc:(n,e,t)=>{const{dims:s}=t,r=gt(s,n.shape);return{x:()=>Lu(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dee={kernelName:Eg,gradFunc:n=>({x:()=>$t(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oee={kernelName:_g,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Dn(Je(n,se(Fu(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fee={kernelName:_v,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>Ue($t(t),"float32"),t:()=>se(n,Ue(t,n.dtype)),e:()=>se(n,Ue(FI(t),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lee={kernelName:Ig,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Qr(t,Wt(0)),r=Wt(Wv),i=Wt(Gv),a=se(n,i),o=se(se(n,r),Ma(Ue(t,"float32")));return ar(s,a,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pee={kernelName:kg,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(n,se(t,tt(Wt(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mee={kernelName:Ng,gradFunc:n=>({x:()=>$t(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vee={kernelName:$g,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(NI(Ue(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bee={kernelName:Cg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(VP(Ue(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zee={kernelName:Iv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{begin:r,size:i}=t,a=s.shape,[o,l]=Uv(s,r,i),u=[];for(let d=0;d<n.rank;d++)u.push([o[d],a[d]-o[d]-l[d]]);return{x:()=>MI(n,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uee={kernelName:kv,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{dim:r}=t,i=!0,a=se(n,s);return{logits:()=>tt(a,se(Ze(a,[r],i),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jee={kernelName:Ag,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(n,sf(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KR={kernelName:Cv,gradFunc:(n,e,t)=>{const{blockShape:s,paddings:r}=t;return{x:()=>$I(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XR={kernelName:Nv,gradFunc:(n,e,t)=>{const{axis:s}=t;return{x:()=>wr(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wee={kernelName:Rg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Je(n,se(zs(Ue(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gee={kernelName:mI,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(n,se(Ue(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hee={kernelName:Dg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Wt(2);return{a:()=>se(n,se(r,tt(t,s))),b:()=>se(n,se(r,tt(s,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qee={kernelName:Mg,gradFunc:n=>({x:()=>$t(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kee={kernelName:Og,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=ot(t.shape,s.shape);return{a:()=>{let o=n;const l=ts(t.shape,r);return l.length>0&&(o=Ze(o,l)),ce(o,t.shape)},b:()=>{let o=n;const l=ts(s.shape,r);return l.length>0&&(o=Ze(o,l)),ce(Dn(o),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xee={kernelName:$v,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,r=s.shape.slice(),{axis:i}=t;gt(i,s.shape).forEach(u=>{r[u]=1});const o=ce(n,r),l=se(o,xc(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yee={kernelName:Fg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Je(n,gn(NI(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qee={kernelName:Lg,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(tt(Wt(1),gn(t)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zee={kernelName:Pg,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{reps:r}=t;return{x:()=>{let a=$t(s);if(s.rank===1)for(let o=0;o<r[0];++o)a=Oe(a,sn(n,[o*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)a=Oe(a,sn(n,[o*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)for(let u=0;u<r[2];++u)a=Oe(a,sn(n,[o*s.shape[0],l*s.shape[1],u*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)for(let u=0;u<r[2];++u)for(let d=0;d<r[3];++d)a=Oe(a,sn(n,[o*s.shape[0],l*s.shape[1],u*s.shape[2],d*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jee={kernelName:dd,gradFunc:(n,e,t)=>{const s=t,{perm:r}=s,i=yc(r);return{x:()=>It(n,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ete={kernelName:Av,gradFunc:(n,e,t)=>{const s=t,{axis:r}=s;return{value:()=>Po(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tte={kernelName:Rv,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>nte(n,t)}}};function nte(n,e){const t=bc(e,$t(e)),s=RI(n,t);let r=Ju(e,Wt(0,"int32"));const i=s.rank-r.rank;for(let o=0;o<i;++o)r=br(r,o+1);r=Lo(r,xc(s.shape,"bool"));const a=$t(s);return ar(r,s,a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ste={kernelName:Dv,gradFunc:n=>({x:()=>$t(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rte=[Q3,tJ,nJ,sJ,rJ,iJ,aJ,oJ,lJ,cJ,uJ,hJ,pJ,yJ,bJ,xJ,vJ,wJ,SJ,TJ,EJ,_J,$J,IJ,kJ,AJ,RJ,DJ,OJ,FJ,_ee,LJ,PJ,MJ,VJ,BJ,UJ,zJ,jJ,WJ,GJ,HJ,qJ,KJ,XJ,YJ,QJ,ZJ,JJ,nee,HR,HR,see,aee,cee,uee,hee,dee,fee,pee,mee,gee,yee,bee,xee,qR,qR,vee,wee,Eee,Iee,$ee,Cee,Nee,kee,Aee,Ree,Dee,Oee,Fee,Lee,Pee,Mee,Vee,Bee,zee,Uee,jee,KR,KR,XR,XR,Wee,Hee,Gee,qee,Kee,Xee,Yee,Qee,Zee,Jee,ete,tte,ste];for(const n of rte)F9(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.abs=function(){return this.throwIfDisposed(),Qs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.acos=function(){return this.throwIfDisposed(),M8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.acosh=function(){return this.throwIfDisposed(),B8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.add=function(n){return this.throwIfDisposed(),Oe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.all=function(n,e){return this.throwIfDisposed(),FP(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.any=function(n,e){return this.throwIfDisposed(),HT(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.argMax=function(n){return this.throwIfDisposed(),dm(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.argMin=function(n){return this.throwIfDisposed(),G8(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.asScalar=function(){return this.throwIfDisposed(),H(this.size===1,()=>"The array must have only 1 element."),ce(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.asType=function(n){return this.throwIfDisposed(),Ue(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.as1D=function(){return this.throwIfDisposed(),ce(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.as2D=function(n,e){return this.throwIfDisposed(),ce(this,[n,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),ce(this,[n,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.as4D=function(n,e,t,s){return this.throwIfDisposed(),ce(this,[n,e,t,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.as5D=function(n,e,t,s,r){return this.throwIfDisposed(),ce(this,[n,e,t,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.asin=function(){return this.throwIfDisposed(),q8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.asinh=function(){return this.throwIfDisposed(),X8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.atan=function(){return this.throwIfDisposed(),Q8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.atan2=function(n){return this.throwIfDisposed(),J8(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.atanh=function(){return this.throwIfDisposed(),t7(this)};Se().prototype.avgPool=function(n,e,t,s){return this.throwIfDisposed(),II(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),$I(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.batchNorm=function(n,e,t,s,r){return this.throwIfDisposed(),Mv(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.broadcastTo=function(n){return this.throwIfDisposed(),Jp(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.cast=function(n){return this.throwIfDisposed(),Ue(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.ceil=function(){return this.throwIfDisposed(),C7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),Yr(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof Xn&&(n=[n]),wr([this,...n],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.conv1d=function(n,e,t,s,r,i){return this.throwIfDisposed(),LP(this,n,e,t,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.conv2dTranspose=function(n,e,t,s,r){return this.throwIfDisposed(),PP(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.conv2d=function(n,e,t,s,r,i){return this.throwIfDisposed(),Ou(this,n,e,t,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.cos=function(){return this.throwIfDisposed(),NI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.cosh=function(){return this.throwIfDisposed(),VP(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),KT(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),BP(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),J7(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.depthwiseConv2d=function(n,e,t,s,r,i){return this.throwIfDisposed(),kI(this,n,e,t,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.dilation2d=function(n,e,t,s,r){return this.throwIfDisposed(),nX(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.divNoNan=function(n){return this.throwIfDisposed(),oX(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.div=function(n){return this.throwIfDisposed(),Je(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.dot=function(n){return this.throwIfDisposed(),cX(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.elu=function(){return this.throwIfDisposed(),Bv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.equal=function(n){return this.throwIfDisposed(),Pa(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.erf=function(){return this.throwIfDisposed(),zP(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),wX(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.exp=function(){return this.throwIfDisposed(),Ma(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.expandDims=function(n){return this.throwIfDisposed(),br(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.expm1=function(){return this.throwIfDisposed(),_X(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.fft=function(){return this.throwIfDisposed(),i3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.flatten=function(){return this.throwIfDisposed(),ce(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.floor=function(){return this.throwIfDisposed(),zv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.floorDiv=function(n){return this.throwIfDisposed(),OP(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.gather=function(n,e,t){return this.throwIfDisposed(),RI(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.greaterEqual=function(n){return this.throwIfDisposed(),Ju(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.greater=function(n){return this.throwIfDisposed(),Qr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.ifft=function(){return this.throwIfDisposed(),XT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.irfft=function(){return this.throwIfDisposed(),bQ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.isFinite=function(){return this.throwIfDisposed(),OX(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.isInf=function(){return this.throwIfDisposed(),LX(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.isNaN=function(){return this.throwIfDisposed(),MX(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.leakyRelu=function(n){return this.throwIfDisposed(),OI(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.lessEqual=function(n){return this.throwIfDisposed(),rf(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.less=function(n){return this.throwIfDisposed(),B0(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.localResponseNormalization=function(n,e,t,s){return this.throwIfDisposed(),jX(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.logSigmoid=function(){return this.throwIfDisposed(),YX(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.logSoftmax=function(n){return this.throwIfDisposed(),HP(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),qP(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.log=function(){return this.throwIfDisposed(),Va(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.log1p=function(){return this.throwIfDisposed(),GP(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.logicalAnd=function(n){return this.throwIfDisposed(),Lo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.logicalNot=function(){return this.throwIfDisposed(),FI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.logicalOr=function(n){return this.throwIfDisposed(),KP(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.logicalXor=function(n){return this.throwIfDisposed(),rY(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),jt(this,n,e,t)};Se().prototype.maxPool=function(n,e,t,s){return this.throwIfDisposed(),LI(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.max=function(n,e){return this.throwIfDisposed(),Gi(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.maximum=function(n){return this.throwIfDisposed(),bc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.mean=function(n,e){return this.throwIfDisposed(),Un(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.min=function(n,e){return this.throwIfDisposed(),V0(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.minimum=function(n){return this.throwIfDisposed(),mm(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),dY(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.mod=function(n){return this.throwIfDisposed(),pY(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.mul=function(n){return this.throwIfDisposed(),se(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.neg=function(){return this.throwIfDisposed(),Dn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.norm=function(n,e,t){return this.throwIfDisposed(),Cd(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.notEqual=function(n){return this.throwIfDisposed(),z0(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),XP(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.onesLike=function(){return this.throwIfDisposed(),Ii(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.pad=function(n,e){return this.throwIfDisposed(),MI(this,n,e)};Se().prototype.pool=function(n,e,t,s,r,i){return this.throwIfDisposed(),EY(this,n,e,t,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.pow=function(n){return this.throwIfDisposed(),Fu(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.prelu=function(n){return this.throwIfDisposed(),BI(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.prod=function(n,e){return this.throwIfDisposed(),$Y(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.reciprocal=function(){return this.throwIfDisposed(),ZY(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.relu=function(){return this.throwIfDisposed(),eh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.relu6=function(){return this.throwIfDisposed(),QP(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.reshapeAs=function(n){return this.throwIfDisposed(),ce(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.reshape=function(n){return this.throwIfDisposed(),ce(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),u3(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),h3(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.reverse=function(n){return this.throwIfDisposed(),Lu(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.rfft=function(){return this.throwIfDisposed(),wQ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.round=function(){return this.throwIfDisposed(),ZP(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.rsqrt=function(){return this.throwIfDisposed(),JP(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.selu=function(){return this.throwIfDisposed(),e3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.separableConv2d=function(n,e,t,s,r,i){return this.throwIfDisposed(),t3(this,n,e,t,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.sigmoid=function(){return this.throwIfDisposed(),sf(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.sign=function(){return this.throwIfDisposed(),oQ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.sin=function(){return this.throwIfDisposed(),n3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.sinh=function(){return this.throwIfDisposed(),s3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.slice=function(n,e){return this.throwIfDisposed(),sn(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.softmax=function(n){return this.throwIfDisposed(),jI(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.softplus=function(){return this.throwIfDisposed(),zg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),VI(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.split=function(n,e){return this.throwIfDisposed(),Kr(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.sqrt=function(){return this.throwIfDisposed(),zs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.square=function(){return this.throwIfDisposed(),gn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.squaredDifference=function(n){return this.throwIfDisposed(),TQ(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.squeeze=function(n){return this.throwIfDisposed(),jg(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof Xn?[this,n]:[this,...n];return Po(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.step=function(n){return this.throwIfDisposed(),Wg(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.stridedSlice=function(n,e,t,s,r,i,a,o){return this.throwIfDisposed(),CQ(this,n,e,t,s,r,i,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.sub=function(n){return this.throwIfDisposed(),tt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.sum=function(n,e){return this.throwIfDisposed(),Ze(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.tan=function(){return this.throwIfDisposed(),kQ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.tanh=function(){return this.throwIfDisposed(),Pv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.tile=function(n){return this.throwIfDisposed(),ji(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.toBool=function(){return this.throwIfDisposed(),Ue(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.toFloat=function(){return this.throwIfDisposed(),Ue(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.toInt=function(){return this.throwIfDisposed(),Ue(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.topk=function(n,e){return this.throwIfDisposed(),DQ(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.transpose=function(n){return this.throwIfDisposed(),It(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.unique=function(n){return this.throwIfDisposed(),LQ(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),l3(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.unstack=function(n){return this.throwIfDisposed(),Pu(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.where=function(n,e){return this.throwIfDisposed(),ar(n,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Se().prototype.zerosLike=function(){return this.throwIfDisposed(),$t(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class wa extends Error{constructor(e){super(e),Object.setPrototypeOf(this,wa.prototype)}}class Si extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Si.prototype)}}class te extends Error{constructor(e){super(e),Object.setPrototypeOf(this,te.prototype)}}class ct extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ct.prototype)}}class _$ extends Error{constructor(e){super(e),Object.setPrototypeOf(this,_$.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class J3{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Mu(n,e){if(Array.isArray(n)){let t=[];for(let s=0;s<e;s++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function Sa(n,e){if(!n)throw new _$(e)}function YR(n,e){let t=0;for(const s of n)s===e&&t++;return t}function xr(n){return n.length===1?n[0]:n}function Xt(n){return Array.isArray(n)?n:[n]}function wo(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function du(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let mi={};function I$(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function ZT(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>ZT(e));else{const e=Object.keys(n);for(const t of e){const s=n[t];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?n[t]=s.value:ZT(s))}}}function Kg(n,e={},t={},s="object",r=!1){if(typeof n=="string"){const i=n;let a;if(i in t)a=t[i];else if(i in mi)a=mi[i];else if(a=e[i],a==null)throw new te(`Unknown ${s}: ${n}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}else{const i=n;if(i.className==null||i.config==null)throw new te(`${s}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const a=i.className;let o,l;if(a in t?[o,l]=t[a]:a in mi?[o,l]=mi.className:a in e&&([o,l]=e[a]),o==null)throw new te(`Unknown ${s}: ${a}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const y of Object.keys(mi))u[y]=mi[y];for(const y of Object.keys(t))u[y]=t[y];const d=i.config;d.customObjects=u;const f=Object.assign({},mi);for(const y of Object.keys(t))mi[y]=t[y];ZT(i.config);const m=l(o,i.config,t,r);return mi=Object.assign({},f),m}else{const u=Object.assign({},mi);for(const f of Object.keys(t))mi[f]=t[f];const d=new o(i.config);return mi=Object.assign({},u),d}}}function ite(n,e){return n<e?-1:n>e?1:0}function Lb(n,e){return-1*ite(n,e)}function Zl(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function ate(n){if(n==null)throw new te(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function nh(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new te(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function $$(n,e,t=0,s=1/0){return Sa(t>=0),Sa(s>=t),Array.isArray(n)&&n.length>=t&&n.length<=s&&n.every(r=>typeof r===e)}function us(n,e){Array.isArray(n)?(H(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,s)=>us(t,`element ${s+1} of ${e}`))):H(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${eM(n)}.`)}function eM(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>eM(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function ote(n,e,t){let s=t!=null?t():yr(),r;return(...a)=>{const o=t!=null?t():yr();return o-s<e||(s=o,r=n(...a)),r}}function tM(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let lte=0;function nM(){return lte++}const Pb={};function Hv(n=""){return n in Pb||(Pb[n]=0),Pb[n]+=1,n+Pb[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const cte=["channelsFirst","channelsLast"],ute=["nearest","bilinear"],hte=["valid","same","causal"],dte=["max","avg"],fte=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Qh=new Map;function Pn(n){nh(cte,"DataFormat",n)}function pte(n){nh(ute,"InterpolationFormat",n)}function Zr(n){nh(hte,"PaddingMode",n)}function sM(n){nh(dte,"PoolMode",n)}const em=[],QR="/";function vu(n,e){em.push(n);try{const t=e();return em.pop(),t}catch(t){throw em.pop(),t}}function mte(){return em.length===0?"":em.join(QR)+QR}function rM(n){if(!aM(n))throw new Error("Not a valid tensor name: '"+n+"'");return mte()+n}function iM(n){if(!aM(n))throw new Error("Not a valid tensor name: '"+n+"'");Qh.has(n)||Qh.set(n,0);const e=Qh.get(n);if(Qh.set(n,Qh.get(n)+1),e>0){const t=`${n}_${e}`;return Qh.set(t,1),t}else return n}const gte=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function aM(n){return!!n.match(gte)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yte(n){return n===parseInt(n.toString(),10)}function Jl(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let s=1;for(let r=e;r<t;++r)s*=n[r];return s}function kd(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s<e&&(e=s)}return e}function nc(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s>e&&(e=s)}return e}function Yi(n,e){if(e<n)throw new te(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let s=n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let XS;function Qn(){return XS==null&&(XS=l8().epsilon()),XS}function Qi(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Da(n,e){return Ue(n,e)}function Xg(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),ce(n,t)}function bte(n,e){return ge(()=>{if(n.shape.length!==2)throw new te(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=Xg(n,1);return JT(t,[1,e,1])})}function xte(n){const e=[Jl(n.shape)];return ce(n,e)}function vte(n){if(n.rank<=1)throw new te(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],Jl(n.shape,1)];return ce(n,e)}function wu(n,e,t){return ge(()=>{switch(n.rank){case 1:return zI(n,e,t);case 2:return r3(n,[e,0],[t,n.shape[1]]);case 3:return UI(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return j0(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return sn(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return sn(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new te(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function YS(n,e,t){return ge(()=>{switch(n.rank){case 1:return zI(n,e,t);case 2:return r3(n,[0,e],[n.shape[0],t]);case 3:return UI(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return j0(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new te(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function Mb(n,e,t,s){return ge(()=>{switch(n.rank){case 1:return zI(n,e,t);case 2:switch(s){case 1:return wu(n,e,t);case 2:return YS(n,e,t);default:throw new te(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return wu(n,e,t);case 2:return UI(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return YS(n,e,t);default:throw new te(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return wu(n,e,t);case 2:return j0(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return j0(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return YS(n,e,t);default:throw new te(`The axis is not within the rank of the tensor ${s}`)}default:throw new te(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function C$(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),wr(n,e)}function ZR(n,e){switch(n.rank){case 1:return A7([n,e]);case 2:return D7([n,e],0);case 3:return F7([n,e],0);case 4:return P7([n,e],0);default:throw new te(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function JT(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new te(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return ji(n,e)}function qv(n,e=0,t=1,s,r){return KY(n,e,t,s,r)}function Oa(n,e,t,s){if(n.rank<2||e.rank<2)throw new ct(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=n.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(r!==i)throw new ct(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return MR({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?eE(n.rank,s,Qi()):null,activation:t});{const r=n.shape.slice(),i=r.pop();n=ce(n,[-1,i]);const a=e.shape.slice(),o=a.pop(),l=a.pop(),u=[...a,o],d=Array.from({length:e.rank},(b,w)=>w===0?e.rank-2:w<=e.rank-2?w-1:w);e=ce(It(e,d),[l,-1]);const f=[...r,...u];return ce(MR({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?eE(n.rank,s,Qi()):null,activation:t}),f)}}function oM(n,e,t){return ge(()=>(Array.isArray(e)?e=Ar(e,"int32"):e=Ue(e,"int32"),RI(n,e,t)))}function Yg(n){return se(n,n)}function eE(n,e,t){const s=e.shape;if(e.rank!==1&&e.rank!==n)throw new te(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return s.length===1?ce(e,[1,s[0],1,1,1]):ce(e,[1,s[3],s[0],s[1],s[2]]);if(t==="channelsLast")return s.length===1?ce(e,[1,1,1,1,s[0]]):ce(e,[1].concat(s))}else if(n===4){if(t==="channelsFirst")return s.length===1?ce(e,[1,s[0],1,1]):ce(e,[1,s[2],s[0],s[1]]);if(t==="channelsLast")return s.length===1?ce(e,[1,1,1,s[0]]):ce(e,[1].concat(s))}else if(n===3){if(t==="channelsFirst")return s.length===1?ce(e,[1,s[0],1]):ce(e,[1,s[1],s[0]]);if(t==="channelsLast")return s.length===1?ce(e,[1,1,s[0]]):ce(e,[1].concat(s))}else if(n<3)return e;throw new te(`Unsupported input rank by biasAdd: ${e.rank}`)}function ta(n,e,t){return ge(()=>(t==null&&(t=Qi()),Pn(t),Oe(n,eE(n.rank,e,t))))}function wte(n,e=1){if(e!==1)throw new ct(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Bv(n)}function Ste(n){return ge(()=>Je(n,Oe(Qs(n),1)))}function lM(n,e,t,s){return ge(()=>jQ(n,e,t,s))}function Tte(n){return ge(()=>{const e=Oe(.5,se(.2,n));return Yr(e,0,1)})}function Qg(n,e,t=!1){return t?n():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ete=["fanIn","fanOut","fanAvg"],_te=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ite(n){nh(Ete,"FanMode",n)}function $te(n){nh(_te,"Distribution",n)}class Ci extends lf{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class cM extends Ci{apply(e,t){return cs(e,t)}}cM.className="Zeros";Ae(cM);class N$ extends Ci{apply(e,t){return xc(e,t)}}N$.className="Ones";Ae(N$);class uM extends Ci{constructor(e){if(super(),typeof e!="object")throw new te(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new te(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return ge(()=>se(Wt(this.value),xc(e,t)))}getConfig(){return{value:this.value}}}uM.className="Constant";Ae(uM);class hM extends Ci{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return Ug(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}hM.className="RandomUniform";Ae(hM);class dM extends Ci{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new ct(`randomNormal does not support dType ${t}.`);return qv(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}dM.className="RandomNormal";Ae(dM);class fM extends Ci{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new ct(`truncatedNormal does not support dType ${t}.`);return o3(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}fM.className="TruncatedNormal";Ae(fM);let pM=class extends Ci{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return ge(()=>{if(e.length!==2||e[0]!==e[1])throw new te("Identity matrix initializer can only be used for 2D square matrices.");return se(this.gain,WP(e[0]))})}getConfig(){return{gain:this.gain}}};pM.className="Identity";Ae(pM);function Cte(n,e="channelsLast"){let t,s;if(Pn(e),n.length===2)t=n[0],s=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const r=Jl(n,2);t=n[1]*r,s=n[0]*r}else if(e==="channelsLast"){const r=Jl(n,0,n.length-2);t=n[n.length-2]*r,s=n[n.length-1]*r}}else{const r=Jl(n);t=Math.sqrt(r),s=Math.sqrt(r)}return[t,s]}class Dr extends Ci{constructor(e){if(super(),e.scale<0)throw new te(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Ite(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,$te(this.distribution),this.seed=e.seed}apply(e,t){const s=Cte(e),r=s[0],i=s[1];let a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,r):this.mode==="fanOut"?a/=Math.max(1,i):a/=Math.max(1,(r+i)/2),this.distribution==="normal"){const o=Math.sqrt(a);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new ct(`${this.getClassName()} does not support dType ${t}.`);return o3(e,0,o,t,this.seed)}else{const o=Math.sqrt(3*a);return Ug(e,-o,o,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Dr.className="VarianceScaling";Ae(Dr);class k$ extends Dr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Dr.className}}k$.className="GlorotUniform";Ae(k$);class A$ extends Dr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Dr.className}}A$.className="GlorotNormal";Ae(A$);class R$ extends Dr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Dr.className}}R$.className="HeNormal";Ae(R$);class D$ extends Dr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Dr.className}}D$.className="HeUniform";Ae(D$);class O$ extends Dr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Dr.className}}O$.className="LeCunNormal";Ae(O$);class F$ extends Dr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Dr.className}}F$.className="LeCunUniform";Ae(F$);class mM extends Ci{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return ge(()=>{if(e.length<2)throw new ct("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;const s=Ee(e.slice(0,-1)),r=e[e.length-1],i=s*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const a=[Math.max(r,s),Math.min(r,s)],o=qv(a,0,1,t,this.seed),l=VZ.qr(o,!1);let u=l[0];const f=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return u=se(u,f.sign()),s<r&&(u=u.transpose()),se(Wt(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}mM.className="Orthogonal";Ae(mM);const JR={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function eD(n,e={}){return Kg(n,wi.getMap().classNameMap,e,"initializer")}function vn(n){return I$(n)}function yn(n){if(typeof n=="string"){const e=n in JR?JR[n]:n;if(e==="GlorotNormal")return new A$;if(e==="GlorotUniform")return new k$;if(e==="HeNormal")return new R$;if(e==="HeUniform")return new D$;if(e==="LeCunNormal")return new O$;if(e==="LeCunUniform")return new F$;{const t={};return t.className=e,t.config={},eD(t)}}else return n instanceof Ci?n:eD(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tE(n){return Array.isArray(n)&&Array.isArray(n[0])}function W0(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function rt(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new te(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function Ot(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new te(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function G0(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const tD="Variable";class Nte{constructor(e,t="float32",s=tD,r=!0,i=null){this.dtype=t??"float32",this.shape=e.shape,this.id=nM(),s=s??tD,this.originalName=rM(s),this.name=iM(this.originalName),this.trainable_=r,this.constraint=i,this.val=VQ(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),kte(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function kte(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function nE(n){return n.map(e=>e.read())}function L$(n){n.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Zn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Ba{constructor(e,t,s,r,i,a,o){this.dtype=e,this.shape=t,this.sourceLayer=s,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=nM(),a!=null&&(this.originalName=rM(a),this.name=iM(this.originalName)),this.rank=t.length}}let Ate=0;class Kv{constructor(e,t){this.callArgs=t,this.id=Ate++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Rte=0;class yt extends lf{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Rte++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const s=this.getClassName();t=wo(s)+"_"+Hv(s)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),s=[i].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new Si(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new te(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return xr(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return xr(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new wa(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new wa(`Layer ${this.name} is not connected, no input to return.`);return xr(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new wa(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new wa(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return xr(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=Xt(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Xt(this.inputSpec);if(t.length!==s.length)throw new te(`Layer ${this.name} expects ${s.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let r=0;r<t.length;r++){const i=t[r],a=s[r];if(a==null)continue;const o=i.rank;if(a.ndim!=null&&o!==a.ndim)throw new te(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${a.ndim}, found ndim=${o}`);if(a.maxNDim!=null&&o>a.maxNDim)throw new te(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${a.maxNDim}, found ndim=${o}`);if(a.minNDim!=null&&o<a.minNDim)throw new te(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${a.minNDim}, found ndim=${o}.`);if(a.dtype!=null&&i.dtype!==a.dtype)throw new te(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${a.dtype}, found dtype=${i.dtype}.`);if(a.axes){const l=i.shape;for(const u in a.axes){const d=Number(u),f=a.axes[u],m=d>=0?l[d]:l[l.length+d];if(f!=null&&[f,null].indexOf(m)===-1)throw new te(`Input ${r} is incompatible with layer ${this.name}: expected axis ${d} of input shape to have value ${f} but got shape ${l}.`)}}if(a.shape!=null)for(let l=0;l<a.shape.length;++l){const u=a.shape[l],d=i.shape[l];if(u!=null&&d!=null&&u!==d)throw new te(`Input ${r} is incompatible with layer ${this.name}: expected shape=${a.shape}, found shape=${i.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const s=Xt(e),r=Fte(e),i=Lte(e);if(r===i)throw new te("Arguments to apply() must be all SymbolicTensors or all Tensors");return vu(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const a=[];for(const o of Xt(e))a.push(o.shape);this.build(xr(a)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let a=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,a);const o=Xt(a),l=[];for(let u of o)s.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(a=xr(l),this.activityRegularizer!=null)throw new ct("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}else{const a=Dte(e),o=this.computeOutputShape(a);let l;const u=Ote(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?a[0]:a),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((d,f)=>new Ba(u,d,this,Xt(e),t,this.name,f)):l=new Ba(u,o,this,Xt(e),t,this.name),this.addInboundNode(e,l,null,null,a,o,t),this._refCount++,this.activityRegularizer!=null)throw new ct("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new wa(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const s=JSON.stringify(t.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new wa(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Si(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return G0(this.weights)}build(e){this.built=!0}getWeights(e=!1){return nE(e?this.trainableWeights:this.weights)}setWeights(e){ge(()=>{const t=this.weights;if(t.length!==e.length)throw new te(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const s=[],r=nE(t);for(let i=0;i<r.length;++i){const a=r[i],o=t[i],l=e[i];if(!Gt(a.shape,l.shape))throw new te(`Layer weight shape ${a.shape} not compatible with provided weight shape ${l.shape}`);s.push([o,l])}L$(s)})}addWeight(e,t,s,r,i,a,o,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new te(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():yn("zeros"));const u=r.apply(t,s),d=new Nte(u,s,e,a,o);return u.dispose(),i!=null&&this.addLoss(()=>i.apply(d.read())),a==null&&(a=!0),a?this._trainableWeights.push(d):this._nonTrainableWeights.push(d),d}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Xt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),i=Xt(t),a=Xt(r);if(i.length!==a.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let o=0;o<i.length;o++)i[o].kerasMask=a[o]}addInboundNode(e,t,s,r,i,a,o=null){const l=Xt(e);t=Xt(t),s=Xt(s),r=Xt(r),i=W0(i),a=W0(a);const u=[],d=[],f=[];for(const m of l)u.push(m.sourceLayer),d.push(m.nodeIndex),f.push(m.tensorIndex);new Kv({outboundLayer:this,inboundLayers:u,nodeIndices:d,tensorIndices:f,inputTensors:l,outputTensors:t,inputMasks:s,outputMasks:r,inputShapes:i,outputShapes:a},o);for(let m=0;m<t.length;m++)t[m].sourceLayer=this,t[m].nodeIndex=this.inboundNodes.length-1,t[m].tensorIndex=m}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function Dte(n){n=Xt(n);const e=[];for(const t of n)e.push(t.shape);return xr(e)}function Ote(n){return"float32"}function gM(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const s=e.inboundNodes[t];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let i=0;i<s.inboundLayers.length;i++){const a=s.inputTensors[i],o=s.inboundLayers[i],l=s.nodeIndices[i],u=gM(a,o,l);for(const d of u)r.indexOf(d)===-1&&r.push(d)}return r}}}function Fte(n){let e=!0;for(const t of Xt(n))if(!(t instanceof Ba)){e=!1;break}return e}function Lte(n){let e=!0;for(const t of Xt(n))if(t instanceof Ba){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Zg extends yt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Hv("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new te("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new te("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new te("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=t,this.dtype=s,this.inputSpec=[{shape:t}];const r=new Ba(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Kv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new te(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Zg.className="InputLayer";Ae(Zg);function Pte(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new te("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new Zg({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Mte(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return Ue(e,n.dtype)}catch{throw new te(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class Vl{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Vl)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=Mte(e,t),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new te(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Ba){if(this.id2Value[e.id]==null)throw new te(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new te(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof Ba){if(this.id2Value[e.id]==null)throw new te(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new te(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&vt(this.id2Mask)}}const H0=new J3,q0=new J3;function Vte(n){H0!=null&&H0.setMaxEntries(n),q0!=null&&q0.setMaxEntries(n)}function Up(n,e,t,s){const r=t==null?!1:t.training,i=Array.isArray(n),a=i?n:[n],o=a.map(b=>b.name),l=[],u=e.names();for(const b of o)u.indexOf(b)!==-1?l.push(e.getValue(b)):l.push(null);const d=o.join(",")+"|"+e.names().sort().join(",");let f=H0.get(d),m;if(f==null){const b=Bte(a,e);f=b.sorted,m=b.recipientCounts,H0.put(d,f),q0.put(d,m)}m={},r||Object.assign(m,q0.get(d));const y=new Vl(e);for(let b=0;b<f.length;++b){const w=f[b],x=w.sourceLayer;if(x instanceof Zg)continue;const T=[],E=[],$=[];let C=!1;for(const N of w.inputs){const D=y.getValue(N),k=y.getMask(N);T.push(D),E.push(k),k!=null&&(C=!0),r||(m[N.name]--,m[N.name]===0&&!e.hasKey(N)&&o.indexOf(N.name)===-1&&!D.isDisposed&&N.sourceLayer.stateful!==!0&&$.push(D))}C&&(t=t||{},t.mask=E[0]);const O=Xt(x.apply(T,t));let V=null;x.supportsMasking&&(V=x.computeMask(T,E));const F=Ute(w),R=Array.isArray(F)?F:[F];for(let N=0;N<R.length;++N){y.hasKey(R[N])||y.add(R[N],O[N],Array.isArray(V)?V[0]:V);const D=o.indexOf(R[N].name);D!==-1&&(l[D]=O[N])}r||vt($)}return y.disposeMasks(),i?l:l[0]}function Bte(n,e){H(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],s={};if(n.length===1){const r=nD(n[0],e);t=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of n){const{sorted:a,recipientMap:o}=nD(i,e);for(const l of a)r.has(l.name)||(t.push(l),r.add(l.name));for(const l in o)s[l]==null&&(s[l]=new Set),o[l].forEach(u=>s[l].add(u))}}return{sorted:t,recipientCounts:zte(s)}}function zte(n){const e={};for(const t in n)e[t]=n[t].size;return e}function nD(n,e){const t=new Set,s=[],r={};for(const o of e.names())t.add(o);const i=[],a=[];for(i.push(n);i.length>0;){const o=i[i.length-1];if(t.has(o.name)){i.pop();continue}const l=a[a.length-1]===i.length-1;if(o.inputs.length===0||l)i.pop(),s.push(o),t.add(o.name),l&&a.pop();else{a.push(i.length-1);for(const u of o.inputs)r[u.name]==null&&(r[u.name]=new Set),r[u.name].add(o.name),!t.has(u.name)&&i.push(u)}}return{sorted:s,recipientMap:r}}function Ute(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let s=0;s<n.sourceLayer.inboundNodes.length;++s)for(const r of n.sourceLayer.inboundNodes[s].outputTensors)if(r.id===n.id){t=s;break}e=n.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jte=xe();jte.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Vte);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function P$(n,e){return ge(()=>zs(Ze(se(n,n),e,!0)))}class Jg extends lf{getConfig(){return{}}}class yM extends Jg{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ge(()=>{const t=P$(e,this.axis),s=Yr(t,0,this.maxValue);return se(e,Je(s,Oe(Qn(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}yM.className="MaxNorm";Ae(yM);class bM extends Jg{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ge(()=>Je(e,Oe(Qn(),P$(e,this.axis))))}getConfig(){return{axis:this.axis}}}bM.className="UnitNorm";Ae(bM);class xM extends Jg{apply(e){return eh(e)}}xM.className="NonNeg";Ae(xM);class vM extends Jg{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ge(()=>{const t=P$(e,this.axis),s=Oe(se(this.rate,Yr(t,this.minValue,this.maxValue)),se(1-this.rate,t));return se(e,Je(s,Oe(Qn(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}vM.className="MinMaxNorm";Ae(vM);const sD={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Jn(n){return I$(n)}function rD(n,e={}){return Kg(n,wi.getMap().classNameMap,e,"constraint")}function es(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in sD?sD[n]:n,config:{}};return rD(t)}else return n instanceof Jg?n:rD(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function au(n){if(n==null)return;const e=[],t=[],s=[];for(const r in n){const i=n[r];if(typeof i!="number"){const a=i;e.push(a.data()),t.push(r),s.push(a)}}if(e.length>0){const r=await Promise.all(e);for(let i=0;i<r.length;++i)n[t[i]]=r[i][0];vt(s)}}function wM(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var iD;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(iD||(iD={}));const Wte=125;class ym{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Gte{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class Hte extends ym{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const s=t.size==null?0:t.size;this.seen+=s;for(const r in t){const i=t[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*s;else{let a;r in this.totals?a=this.totals[r]:this.totals[r]=0;const o=ge(()=>Oe(this.totals[r],se(i,s)));this.totals[r]=o,a!=null&&a.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?t[s]=this.totals[s]/this.seen:ge(()=>{const r=se(Je(1,this.seen),this.totals[s]);t[s]=r,this.totals[s].dispose(),Aa(t[s])}))}}class qte extends ym{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const s in t)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(t[s])}async syncData(){const e=[],t=[],s=[];for(const i in this.history){const a=this.history[i];for(let o=0;o<a.length;++o)if(typeof a[o]!="number"){const l=a[o];e.push(l.data()),t.push(i),s.push(o)}}const r=await Promise.all(e);for(let i=0;i<r.length;++i)this.history[t[i]][s[i]].dispose(),this.history[t[i]][s[i]]=r[i][0]}}class Kte extends ym{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||I3,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Wte),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");AT(this.yieldEvery)&&(this.maybeWait=ote(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,s){const r=[];this.yield!=null&&(await au(s),r.push(this.yield(e,t,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await au(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const s=[];this.epochEnd!=null&&(await au(t),s.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,t){this.batchBegin!=null&&(await au(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const s=[];this.batchEnd!=null&&(await au(t),s.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):AT(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await au(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await au(e),await this.trainEnd(e))}}function SM(n,e){return n==null&&(n={}),n instanceof ym?[n]:Array.isArray(n)&&n[0]instanceof ym?n:Xt(n).map(s=>new Kte(s,e))}class bi{constructor(){}static registerCallbackConstructor(e,t){H(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),bi.checkForDuplicate(t),bi.constructors[e]==null&&(bi.constructors[e]=[]),bi.constructors[e].push(t)}static checkForDuplicate(e){for(const t in bi.constructors)bi.constructors[+t].forEach(r=>{if(r===e)throw new te("Duplicate callback constructor.")})}static clear(){bi.constructors={}}static createCallbacks(e){const t=[];for(const s in bi.constructors){const r=+s;e>=r&&t.push(...bi.constructors[r])}return t.map(s=>new s)}}bi.constructors={};function TM(n,e,t,s,r,i,a,o,l){const u=new qte,d=[new Hte,...bi.createCallbacks(e)];n!=null&&d.push(...n),d.push(u);const f=new Gte(d);return f.setParams({epochs:t,initialEpoch:s,samples:r,steps:i,batchSize:a,verbose:e,doValidation:o,metrics:l}),{callbackList:f,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ao(n,e={},t=!1){return Kg(n,wi.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function K0(n,e){return ge(()=>{n.dtype!=="float32"&&(n=Ue(n,"float32"));const t=Ze(Yg(n),e,!0),s=Vv(t.shape,Qn()),r=zs(bc(t,s));return Je(n,r)})}function Xv(n,e){return ge(()=>Un(Yg(tt(e,n)),-1))}function M$(n,e){return ge(()=>Un(Qs(tt(e,n)),-1))}function V$(n,e){return ge(()=>{const t=tt(n,e),s=Yr(Qs(n),Qn(),Number.MAX_VALUE),r=Qs(Je(t,s));return se(100,Un(r,-1))})}function Xte(n,e){return ge(()=>{const t=Yr(e,Qn(),Number.MAX_VALUE),s=Va(Oe(1,t)),r=Yr(n,Qn(),Number.MAX_VALUE),i=Va(Oe(1,r));return Un(Yg(tt(s,i)),-1)})}function Yte(n,e){return ge(()=>{const t=bc(0,tt(1,se(n,e)));return Un(Yg(t),-1)})}function Qte(n,e){return ge(()=>{const t=bc(0,tt(1,se(n,e)));return Un(t,-1)})}function Zte(n,e){return ge(()=>{const t=Ze(se(n,e),-1),s=Gi(se(tt(1,n),e),-1);return bc(0,Oe(1,tt(s,t)))})}function Jte(n,e){return ge(()=>{const t=Math.log(2),s=tt(e,n),r=tt(Oe(s,zg(se(-2,s))),t);return Un(r,-1)})}function bm(n,e,t=!1){return ge(()=>{if(t)e=jI(e);else{const s=Ze(e,e.shape.length-1,!0);e=Je(e,s)}return e=Yr(e,Qn(),1-Qn()),Dn(Ze(se(Ue(n,"float32"),Va(e)),e.shape.length-1))})}function X0(n,e,t=!1){return ge(()=>{const s=Ue(zv(xte(n)),"int32");e=Yr(e,Qn(),1-Qn());const r=e.shape,i=ce(XP(s,r[r.length-1]),r);return bm(i,e,t)})}function ene(n,e){if(!Gt(n.shape,e.shape))throw new te(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return ge(()=>{const t=eh(e),s=Dn(Qs(e));return Oe(tt(t,se(e,n)),GP(Ma(s)))})}function Yv(n,e){return ge(()=>{let t;return t=Yr(e,Qn(),1-Qn()),t=Va(Je(t,tt(1,t))),Un(ene(n,t),-1)})}function tne(n,e){return ge(()=>{const t=Yr(n,Qn(),1),s=Yr(e,Qn(),1);return Ze(se(n,Va(Je(t,s))),-1)})}function nne(n,e){return ge(()=>{const t=Va(Oe(Qn(),e));return Un(tt(e,se(n,t)),-1)})}function EM(n,e){return ge(()=>{const t=K0(n,-1),s=K0(e,-1),r=se(t,s);return Dn(Ze(r,-1))})}const Y0={meanSquaredError:Xv,meanAbsoluteError:M$,meanAbsolutePercentageError:V$,meanSquaredLogarithmicError:Xte,squaredHinge:Yte,hinge:Qte,categoricalHinge:Zte,logcosh:Jte,categoricalCrossentropy:bm,sparseCategoricalCrossentropy:X0,binaryCrossentropy:Yv,kullbackLeiblerDivergence:tne,poisson:nne,cosineProximity:EM};function QS(n){if(typeof n=="string"){if(n in Y0)return Y0[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new te(e)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _M(n,e){return ge(()=>{const t=se(.5,Ii(e)),s=Da(Qr(e,t),n.dtype);return Un(Pa(n,s),-1)})}function IM(n,e){return ge(()=>Da(Pa(dm(n,-1),dm(e,-1)),"float32"))}function sne(n,e){return ge(()=>Ue(Ze(Lo(Pa(n,1),Pa(e,1))),"float32"))}function rne(n,e){return ge(()=>Ue(Ze(Lo(Pa(n,0),Pa(e,1))),"float32"))}function ine(n,e){return ge(()=>{const t=sne(n,e),s=rne(n,e),r=Oe(t,s);return Ue(ar(Qr(r,0),Je(t,r),0),"float32")})}function ane(n,e){return Yv(n,e)}function one(n,e){return n.rank===e.rank&&(n=jg(n,[n.rank-1])),e=dm(e,-1),e.dtype!==n.dtype&&(e=Ue(e,n.dtype)),Ue(Pa(n,e),"float32")}const lne=Xv,cne=Xv,une=M$,hne=M$,dne=V$,fne=V$,$M=bm,pne=EM,CM=X0,Q0={binaryAccuracy:_M,categoricalAccuracy:IM,precision:ine,categoricalCrossentropy:$M,sparseCategoricalCrossentropy:CM,mse:lne,MSE:cne,mae:une,MAE:hne,mape:dne,MAPE:fne,cosine:pne};function mne(n){if(typeof n=="string"&&n in Q0)return Q0[n];if(typeof n!="string"&&n!=null)return n;throw new te(`Unknown metric ${n}`)}function Vb(n){if(Sa(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(Y0))if(Y0[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(Q0))if(Q0[t]===n){e=t;break}return e!==void 0?e:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gne(n){const e={Adagrad:()=>Yh.adagrad(.01),Adadelta:()=>Yh.adadelta(1,.95,Qn()),Adam:()=>Yh.adam(.001,.9,.999,Qn()),Adamax:()=>Yh.adamax(.002,.9,.999,Qn(),0),RMSProp:()=>Yh.rmsprop(.001,.9,0,Qn()),SGD:()=>Yh.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new te(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const aD=1*1024*1024;function oD(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!sE(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const s=JSON.stringify(n);s.length>aD&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${aD}.`)}}function sE(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!sE(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!sE(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yne(n,e,t,s=console.log){const r=xne(n),i=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(d=>Math.floor(e*d)));let a;if(!r){i.push("Receives inputs"),a=[];for(const d in n.nodesByDepth)a.push(...n.nodesByDepth[d])}s("_".repeat(e)),Z0(i,t,s),s("=".repeat(e));const o=n.layers;for(let d=0;d<o.length;++d)r?vne(o[d],t,s):wne(o[d],t,a,s),s((d===o.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const l=bne(n),u=G0(n.nonTrainableWeights);s(`Total params: ${l+u}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${u}`),s("_".repeat(e))}function bne(n){let e;return n.collectedTrainableWeights!=null?e=G0(n.collectedTrainableWeights):e=G0(n.trainableWeights),e}function xne(n){let e=!0;const t=[],s=[];for(const r in n.nodesByDepth)t.push(n.nodesByDepth[r]);for(const r of t){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of n.layers){let i=!1;for(const a of r.inboundNodes)if(s.indexOf(a)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function Z0(n,e,t=console.log){let s="";for(let r=0;r<n.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=n[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);t(s)}function vne(n,e,t){let s,r;try{r=n.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const i=n.name,a=n.getClassName(),o=[`${i} (${a})`,r,s,n.countParams().toString()];Z0(o,e,t)}function wne(n,e,t,s){let r,i;try{i=n.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const a=[];for(const f of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(f)===-1))for(let m=0;m<f.inboundLayers.length;++m){const y=f.inboundLayers[m].name,b=f.nodeIndices[m],w=f.tensorIndices[m];a.push(`${y}[${b}][${w}]`)}const o=n.name,l=n.getClassName(),u=a.length===0?"":a[0],d=[`${o} (${l})`,i,r,n.countParams().toString(),u];Z0(d,e,s);for(let f=1;f<a.length;++f)Z0(["","","","",a[f]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function NM(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function rE(n,e){if(n===null)return null;if(typeof n=="string")return du(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const i=n[r];NM(e,r,i)?t.push(i):t.push(rE(i,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s];if(s==="name"&&typeof r=="string")t[s]=r;else{const i=du(s);t[i]=rE(r,i)}}return t}}function iE(n,e){if(n==null)return null;if(typeof n=="string")return wo(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const i=n[r];NM(e,r,i)?t.push(i):t.push(iE(i,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s],i=wo(s);(s==="name"||s==="className")&&typeof r=="string"?t[i]=r:t[i]=iE(r,s)}return t}}/** @license See the LICENSE file. */const kM="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Sne=n=>{const e=Object.keys(n);if(e.length===0)return!1;const t=e[0].split("/");return!isNaN(parseInt(t[t.length-1],10))};class Vi extends yt{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const E=this.getClassName().toLowerCase();this.name=Hv(E)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Zl(this.inputs).length!==this.inputs.length)throw new te(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(E=>E.name)}`);Zl(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(E=>E.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const E of this.outputs){const $=E.sourceLayer,C=E.nodeIndex,O=E.tensorIndex;this.outputLayers.push($),this.outputLayersNodeIndices.push(C),this.outputLayersTensorIndices.push(O)}for(const E of this.inputs){const $=E.sourceLayer,C=E.nodeIndex,O=E.tensorIndex;Sa(C===0,"input layer has >1 nodes"),Sa(O===0,"input layer has >1 tensors"),this.inputLayers.push($),this.inputLayersNodeIndices.push(C),this.inputLayersTensorIndices.push(O)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let E=0;E<this.inputLayers.length;E++){const $=this.inputLayers[E];if(!($ instanceof Zg))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${E} (0-based) originates from layer type ${$.getClassName()}.`);this.inputNames.push($.name),this.feedInputShapes.push($.batchInputShape),this.feedInputNames.push($.name)}for(const E of this.outputLayers)this.outputNames.push(E.name);this.internalInputShapes=this.inputs.map(E=>E.shape),this.internalOutputShapes=this.outputs.map(E=>E.shape);const t={},s={},r={},i={},a={},o=[],l=(E,$,C,O,V,F)=>{(O==null||V==null||F==null)&&(O=E.sourceLayer,V=E.nodeIndex,F=E.tensorIndex);const R=O.inboundNodes[V];if(C.indexOf(R)!==-1)throw new Si(`The tensor ${E.name} at layer "${O.name}" is part of a cycle.`);if($.indexOf(R)!==-1)return;this.containerNodes.add(Vi.nodeKey(O,V)),O.id in a||(a[O.id]=Object.keys(a).length),C.indexOf(R)===-1&&C.push(R);const N=R.inboundLayers.length;for(let D=0;D<N;D++){const k=R.inputTensors[D],z=R.inboundLayers[D],B=R.nodeIndices[D],ne=R.tensorIndices[D];l(k,$,C,z,B,ne)}for($.push(R);C.indexOf(R)>=0;)C.splice(C.indexOf(R),1);o.push(R)},u=[],d=[];for(const E of this.outputs)l(E,u,d);const f=o.slice().reverse();for(const E of f){s[E.id]=E,E.id in t||(t[E.id]=0);let $=t[E.id];const C=r[E.outboundLayer.id]==null?0:r[E.outboundLayer.id];$=Math.max($,C),r[E.outboundLayer.id]=$,i[E.outboundLayer.id]=E.outboundLayer,t[E.id]=$;for(let O=0;O<E.inboundLayers.length;O++){const V=E.inboundLayers[O],F=E.nodeIndices[O],R=V.inboundNodes[F],N=t[R.id]==null?0:t[R.id];t[R.id]=Math.max($+1,N),s[R.id]=R}}const m={};for(const E in t){const $=t[E];$ in m||(m[$]=[]),m[$].push(s[E])}const y={};for(const E in r){const $=r[E];$ in y||(y[$]=[]),y[$].push(i[E])}let b=Object.keys(y).map(E=>parseInt(E,10)).sort(Lb);this.layers=[];for(const E of b){const $=y[E];$.sort((C,O)=>{const V=a[C.id],F=a[O.id];return V<F?-1:V>F?1:0});for(const C of $)C instanceof Vi&&this.internalContainerRefs.push(C),this.layers.push(C)}this.layersByDepth=y,b=Object.keys(m).map(E=>parseInt(E,10)).sort(Lb);const w=this.inputs.slice(),x=[];for(const E of b)for(const $ of m[E]){const C=$.outboundLayer;if(C!=null){for(const O of $.inputTensors)if(w.indexOf(O)===-1)throw new Si(`Graph disconnected: cannot obtain value for tensor ${O} at layer "${C.name}". The following previous layers were accessed without issue: ${x}`);for(const O of $.outputTensors)w.push(O);x.push(C.name)}}this.nodesByDepth=m;const T=this.layers.map(E=>E.name);for(const E of T){const $=T.filter(C=>C===E).length;if($!==1)throw new Si(`The name "${E}" is used ${$} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(T))}this.outboundNodes=[],this.inboundNodes=[],new Kv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(E=>null),outputMasks:this.outputs.map(E=>null),inputShapes:this.inputs.map(E=>E.shape),outputShapes:this.outputs.map(E=>E.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new te("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.layers)t.push(...s.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const s={};let r=0;const i=Sne(e);i&&this.parseWeights(e);for(const o of this.layers)for(const[l,u]of o.weights.entries()){const d=i?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(s[d]!=null)throw new te(`Duplicate weight name: ${d}`);s[d]=u,r++}const a=[];for(const o in e){let l=o;if(s[o]==null){const u=o.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(s[l]!=null)a.push([s[l],e[o]]);else if(t)throw new te(`Provided weight data has no target variable: ${o}`);delete s[l]}if(t){const o=[];for(const l in s)o.push(l);if(o.length>0)throw new te(`${o.length} of ${r} weights are not set: ${o}`)}L$(a)}parseWeights(e){for(const t in Object.keys(e)){const s=t.split("/"),r=["vars","layer_checkpoint_dependencies"],i=s.map(a=>a.startsWith("_")?a.slice(1):a).filter(a=>!r.includes(a)).join("/");i!==t&&(e[i]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${kM}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const s=iE(this.updatedConfig());return t?JSON.stringify(s):s}call(e,t){return ge(()=>{e=Xt(e);const s=new Vl;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return Up(this.outputs,s,t)})}computeMask(e,t){return ge(()=>{e=Xt(e);let s;return t==null?s=Mu(null,e.length):s=Xt(t),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const t=W0(e);if(t.length!==this.inputLayers.length)throw new te(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let o=0;o<t.length;o++){const l=this.inputLayers[o],u=t[o],d=l.name+"_0_0";s[d]=u}const r=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(Lb);if(r.length>1)for(const o of r){const l=this.nodesByDepth[o];for(const u of l){const d=u.outboundLayer;if(this.inputLayers.map(w=>w.id).indexOf(d.id)!==-1)continue;const f=[];for(let w=0;w<u.inboundLayers.length;w++){const x=u.inboundLayers[w],T=u.nodeIndices[w],E=u.tensorIndices[w],$=`${x.name}_${T}_${E}`,C=s[$];f.push(C)}const m=d.computeOutputShape(xr(f)),y=W0(m),b=d.inboundNodes.indexOf(u);for(let w=0;w<y.length;w++){const x=`${d.name}_${b}_${w}`;s[x]=y[w]}}}const i=[],a=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],u=this.outputLayersNodeIndices[o],d=this.outputLayersTensorIndices[o],f=`${l.name}_${u}_${d}`;a.push(f)}for(let o=0;o<a.length;o++){const l=a[o];Sa(l in s),i.push(s[l])}return xr(i)}runInternalGraph(e,t){t==null&&(t=Mu(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],d=e[l],f=t[l];s[u.id]=[d,f]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Lb);for(const l of r){const u=this.nodesByDepth[l];for(const d of u){const f=d.outboundLayer,m=d.inputTensors,y=d.outputTensors,b=new Array;for(const w of m)w.id in s&&b.push(s[w.id]);if(b.length===m.length){let w={},x,T,E,$;if(d.callArgs!=null&&(w=d.callArgs),b.length===1){const[C,O]=b[0];w.mask==null&&(w.mask=O),E=Xt(f.call(C,w)),$=Xt(f.computeMask(C,O)),x=[C],T=[O]}else x=b.map(C=>C[0]),T=b.map(C=>C[1]),w.mask==null&&(w.mask=T),E=Xt(f.call(x,w)),$=Xt(f.computeMask(x,T));if(f.activityRegularizer)throw new ct("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let C=0;C<y.length;++C){const O=y[C],V=E[C],F=$[C];s[O.id]=[V,F]}}}}const i=[],a=[],o=[];for(const l of this.outputs){Sa(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[u,d]=s[l.id];o.push(u.shape),i.push(u),a.push(d)}return[i,a,o]}buildNodeConversionMap(e){const t={};let s;for(const r of this.layers){s=r instanceof Vi?1:0;for(let i=0;i<r.inboundNodes.length;i++){const a=Vi.nodeKey(r,i);this.containerNodes.has(a)&&(t[a]=s,s+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new te("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new te(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new te(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return ge(()=>{const e=[];for(const t of this.layers)for(let s=0;s<t.inboundNodes.length;++s){const r=Vi.nodeKey(t,s);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),s=[];for(const a of this.layers){const o=a.getClassName(),l=a.getConfig(),u=[];for(let f=0;f<a.inboundNodes.length;f++){const m=a.inboundNodes[f],y=Vi.nodeKey(a,f);let b={};if(this.containerNodes.has(y)){if(m.callArgs)try{JSON.stringify(m.callArgs),b=m.callArgs}catch{console.warn(`Layer ${a.name} was passed non-serializable keyword arguments: ${m.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),b={}}if(m.inboundLayers.length>0){const w=[];for(let x=0;x<m.inboundLayers.length;x++){const T=m.inboundLayers[x],E=m.nodeIndices[x],$=m.tensorIndices[x],C=Vi.nodeKey(T,E);let O=t[C];O==null&&(O=0),w.push([T.name,O,$,b])}u.push(w)}}}const d={};d.name=a.name,d.className=o,d.config=l,d.inboundNodes=u,s.push(d)}e.layers=s;const r=[];for(let a=0;a<this.inputLayers.length;a++){const o=this.inputLayers[a],l=this.inputLayersNodeIndices[a],u=Vi.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let d=t[u];d==null&&(d=0);const f=this.inputLayersTensorIndices[a];r.push([o.name,d,f])}e.inputLayers=r;const i=[];for(let a=0;a<this.outputLayers.length;a++){const o=this.outputLayers[a],l=this.outputLayersNodeIndices[a],u=Vi.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let d=t[u];d==null&&(d=0);const f=this.outputLayersTensorIndices[a];i.push([o.name,d,f])}return e.outputLayers=i,e}static fromConfig(e,t,s={},r=!1){const i={},a={};function o(x,T){x.name in a?a[x.name].push(T):a[x.name]=[T]}function l(x,T){const E=[];let $;for(const C of T){const O=C[0],V=C[1],F=C[2];if($=C[3]==null?{}:C[3],!(O in i)){o(x,T);return}const R=i[O];if(R.inboundNodes.length<=V){o(x,T);return}const N=R.inboundNodes[V];E.push(N.outputTensors[F])}E.length>0&&x.apply(xr(E),$)}function u(x){const T=x.name,E=Ao(x,t.customObjects!=null?t.customObjects:{});E.setFastWeightInitDuringBuild(r),i[T]=E,x.inboundNodes.forEach(C=>{if(!(C instanceof Array))throw new te(`Corrupted configuration, expected array for nodeData: ${C}`);o(E,C)})}const d=t.name,f=t.layers;for(const x of f)u(x);for(;!ate(a);)for(const x of f){const T=i[x.name];if(T.name in a){const E=a[T.name];delete a[T.name];for(const $ of E)l(T,$)}}const m=[],y=[],b=t.inputLayers;for(const x of b){const T=x[0],E=x[1],$=x[2];Sa(T in i);const O=i[T].inboundNodes[E].outputTensors;m.push(O[$])}const w=t.outputLayers;for(const x of w){const T=x[0],E=x[1],$=x[2];Sa(T in i);const O=i[T].inboundNodes[E].outputTensors;y.push(O[$])}return new e({inputs:m,outputs:y,name:d})}get stateful(){if(this._stateful)throw new te("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){ge(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Tne(n,e,t){const s=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(r=>null);if(s===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==s)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const r=[];return e.forEach(i=>{i in n?r.push(n[i]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${t} must be either an array with ${s} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function AM(n,e){return Tne(n,e,"classWeight")}async function RM(n,e,t,s){if(t!=null){const r=ge(()=>{if(n.shape.length===1)return xu(n);if(n.shape.length===2){if(n.shape[1]>1)return dm(n,1);if(n.shape[1]===1)return ce(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await r.data());vt(r);const a=[];return i.forEach(o=>{if(t[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);a.push(t[o])}),Ar(a,"float32")}else return null}function Ene(n,e){return se(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const _ne=32;function DM(n,e){let t,s;const r=e;t=r.xs,s=r.ys,H(t!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=lD("input",n.inputNames,t),a=lD("output",n.outputNames,s),o=i[0].shape[0];H(i.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),H(a.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${a.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let l=0;l<i.length;l++)H(i[l].shape[0]===o,()=>`Batch size mismatch: input ${n.inputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);for(let l=0;l<a.length;l++)H(a[l].shape[0]===o,()=>`Batch size mismatch: output ${n.outputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);return{xs:i,ys:a}}function lD(n,e,t){if(t instanceof Xn)return[t];if(Array.isArray(t))return H(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const s=[];for(const r of e){if(t[r]==null)throw new te(`The feature data generated by the dataset lacks the required ${n} key '${r}'.`);s.push(t[r])}return s}}function Ine(n){if(n.length===3)throw new ct("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function $ne(n,e,t){const s=t.batchesPerEpoch!=null;if(H(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),H(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),H(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),H(!s||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),H(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const r=t.validationData!=null;let i,a;if(r)if(cD(t.validationData))H(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const x=Ine(t.validationData);i=x.xs,a=x.ys}const o=n.makeTrainFunction(),l=n.getDedupedMetricsNames();let u;r?u=l.slice().concat(l.map(x=>"val_"+x)):u=l.slice();const d=SM(t.callbacks,t.yieldEvery),f=t.verbose==null?1:t.verbose,{callbackList:m,history:y}=TM(d,f,t.epochs,null,null,Cne(e,t),null,r,u);m.setModel(n),n.history=y,await m.onTrainBegin(),n.stopTraining_=!1;let b=t.initialEpoch==null?0:t.initialEpoch,w=await e.iterator();for(;b<t.epochs;){const x={};await m.onEpochBegin(b);let T=0,E=0;for(s||(w=await e.iterator());!s||T<t.batchesPerEpoch;){const $=await w.next();if(s&&$.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${T} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if($.value!=null){const{xs:C,ys:O}=DM(n,$.value),V={};V.batch=E,V.size=C[0].shape[0],await m.onBatchBegin(E,V);const F=[];if(t.classWeight!=null){const D=AM(t.classWeight,n.outputNames);for(let k=0;k<D.length;++k)F.push(await RM(O[k],null,D[k]))}const R=C.concat(O).concat(F),N=o(R);vt(R);for(let D=0;D<l.length;++D){const k=l[D],z=N[D];V[k]=z,Aa(z)}await m.onBatchEnd(E,V),wM(V),E++,T++}if(s?T>=t.batchesPerEpoch:$.done){if(r){let C;cD(t.validationData)?C=Xt(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):C=Xt(n.evaluate(i,a,{batchSize:t.validationBatchSize==null?_ne:t.validationBatchSize,verbose:0}));for(let O=0;O<n.metricsNames.length;++O)x[`val_${n.metricsNames[O]}`]=C[O]}break}if(n.stopTraining_)break}if(await m.onEpochEnd(b,x),b++,n.stopTraining_)break}return await m.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function Cne(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function cD(n){return typeof n.iterator=="function"}function Nne(n){return typeof n.next=="function"}async function kne(n,e,t){t=t||{};const s=t.batches!=null,r=n.testFunction;let i=[];if(t.verbose>0)throw new ct("Verbose mode is not implemented yet.");H(!s||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const a=Nne(e)?e:await e.iterator();let o=0,l=0;for(;!s||l<t.batches;){const u=await a.next();if(i=ge(()=>{if(u.value){const{xs:d,ys:f}=DM(n,u.value),m=d.concat(f),y=ge(()=>r(m));if(vt(m),l===0)for(let w=0;w<y.length;++w)i.push(Wt(0));const b=m[0].shape[0];for(let w=0;w<y.length;++w){const x=y[w],T=i[w];i[w]=ge(()=>Oe(i[w],se(b,x))),l>0&&vt(T)}vt(y),o+=b,++l}return i}),u.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<i.length;++u){const d=i[u];i[u]=Je(i[u],o),vt(d)}return xr(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ZS(n){H(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function Ap(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(s=>wu(s,e,t-e)):wu(n,e,t-e)}function aE(n,e){return ge(()=>n==null?null:Array.isArray(n)?n.map(t=>aE(t,e)):oM(n,e.dtype==="int32"?e:Ue(e,"int32")))}function JS(n,e){const t=[];let s=0,r=null;for(;s<n;)r=s+e,r>=n&&(r=n),t.push([s,r]),s=r;return t}function OM(n){const e=[];n instanceof Xn&&(n=[n]);for(let t=0;t<n.length;++t){const s=n[t];if(s.rank===1)e.push(Xg(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Pi(n,e){if(n==null)return;const t=[];if(e instanceof Xn)t.push(e.id);else if(Array.isArray(e))e.forEach(r=>t.push(r.id));else if(e!=null)for(const r in e){const i=e[r];t.push(i.id)}const s=[];if(n instanceof Xn)t.indexOf(n.id)===-1&&s.push(n);else if(Array.isArray(n))n.forEach(r=>{t.indexOf(r.id)===-1&&s.push(r)});else if(n!=null)for(const r in n){const i=n[r];t.indexOf(i.id)===-1&&s.push(i)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ane(n){return n instanceof Xn}function oE(n){return Array.isArray(n)}function uD(n){return!Ane(n)&&!oE(n)}function hD(n,e,t,s=!0,r=""){if(e==null||e.length===0){if(n!=null){let a=!1;if(oE(n)&&n.length>0)a=!0;else if(uD(n)){for(const o in n)if(n.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new te(`Error when checking model ${r} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(a=>null);let i;if(uD(n)){n=n,i=[];for(const a of e){if(n[a]==null)throw new te(`No data provided for "${a}". Need data for each key in: ${e}`);i.push(n[a])}}else if(oE(n)){if(n=n,n.length!==e.length)throw new te(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);i=n}else{if(n=n,e.length>1)throw new te(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);i=[n]}if(i=OM(i),t!=null)for(let a=0;a<e.length;++a){if(t[a]==null)continue;const o=i[a];if(o.shape.length!==t[a].length)throw new te(`Error when checking ${r}: expected ${e[a]} to have ${t[a].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<t[a].length;++l){if(l===0&&!s)continue;const u=o.shape[l],d=t[a][l];if(d!=null&&d>=0&&u!==d)throw new te(`${r} expected a batch of elements where each example has shape [${t[a].slice(1,t[a].length)}] (i.e.,tensor shape [*,${t[a].slice(1,t[a].length)}]) but the ${r} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return i}function Rne(n,e,t){const s=Zl(n.map(i=>i.shape[0]));s.sort();const r=Zl(e.map(i=>i.shape[0]));if(r.sort(),s.length>1)throw new te(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(i=>i.shape))}`);if(r.length>1)throw new te(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(s.length>0&&r.length>0&&!Gt(s,r))throw new te(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function Dne(n,e,t){const s=[Xv,Yv,bm];for(let r=0;r<n.length;++r){const i=n[r],a=e[r],o=t[r];if(a!=null){if(a===bm&&i.shape[i.shape.length-1]===1)throw new te(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(a)!==-1){const l=i.shape.slice(1),u=o.slice(1);for(let d=0;d<l.length;++d){const f=l[d],m=u[d];if(m!=null&&f!==m)throw new te(`A target Tensor with shape ${i.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function dD(n,e,t,s=!0,r=""){let i;if(Array.isArray(n)){if(n.length!==e.length)throw new te(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);i=n}else{if(e.length>1)throw new te(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);i=[n]}if(t!=null)for(let a=0;a<e.length;++a){if(t[a]==null)continue;const o=i[a];if(o.shape.length!==t[a].length)throw new te(`Error when checking ${r}: expected ${e[a]} to have ${t[a].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<t[a].length;++l){if(l===0&&!s)continue;const u=o.shape[l],d=t[a][l];if(d!=null&&d!==u)throw new te(`Error when checking ${r}: expected ${e[a]} to have shape ${JSON.stringify(t[a])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function One(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(s=>t);{const s=[];for(const r of e){let i=t.hasOwnProperty(r)?t[r]:[];Array.isArray(i)||(i=[i]),s.push(i)}return s}}const Fne="layers-model";class pd extends Vi{constructor(e){super(e),this.isTraining=!1}summary(e,t,s=console.log){if(!this.built)throw new te("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");yne(this,e,t,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=gne(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof vc))throw new te("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const a in e.loss)if(this.outputNames.indexOf(a)===-1)throw new te(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(const a of this.outputNames)e.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),t.push(QS(e.loss[a]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new te(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(o=>QS(o))}else{const a=QS(e.loss);this.outputs.forEach(o=>{t.push(a)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const o=this.internalOutputShapes[a],l=this.outputNames[a];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[a])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],vu("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(s.indexOf(a)!==-1)continue;const o=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([o,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});const r=One(e.metrics,this.outputNames),i=(a,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[a]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,a])};vu("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(s.indexOf(a)!==-1)continue;const o=r[a];(u=>{const d="";let f,m,y;for(const b of u){if(typeof b=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(b)!==-1){const x=this.internalOutputShapes[a];x[x.length-1]===1||this.lossFunctions[a]===Yv?["accuracy","acc"].indexOf(b)!==-1?m=_M:["crossentropy","ce"].indexOf(b)!==-1&&(m=ane):this.lossFunctions[a]===X0?["accuracy","acc"].indexOf(b)!==-1?m=one:["crossentropy","ce"].indexOf(b)!==-1&&(m=CM):["accuracy","acc"].indexOf(b)!==-1?m=IM:["crossentropy","ce"].indexOf(b)!==-1&&(m=$M);let T;["accuracy","acc"].indexOf(b)!==-1?T="acc":["crossentropy","ce"].indexOf(b)!==-1&&(T="ce"),y=m,f=d+T}else y=mne(b),f=d+Vb(b);let w;vu(f,()=>{w=y}),i(a,f,w)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,s={}){const r=s.batchSize==null?32:s.batchSize;ZS(r);const a=this.standardizeUserDataXY(e,t,!0,r);try{const o=a[0].concat(a[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,o,r,s.verbose,s.steps);return xr(u)}finally{Pi(a[0],e),Pi(a[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),kne(this,e,t)}checkNumSamples(e,t,s,r="steps"){let i;if(s!=null){if(i=null,t!=null)throw new te(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new te(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new te("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(t),r=s?t:[t],i=this.retrieveSymbolicTensors(r),a=new Vl;if(e instanceof Xn&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new te(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)a.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new te(`No value is provided for the model's input ${l.name}`);a.add(l,u)}const o=Up(i,a);return s?o:o[0]}retrieveSymbolicTensors(e){const t=Mu(null,e.length);let s=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],a=i.map(o=>o.name);for(let o=0;o<e.length;++o){const l=a.indexOf(e[o]);if(l!==-1&&(t[o]=i[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw t.forEach((i,a)=>{i==null&&r.push(e[a])}),new te(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return t}predictLoop(e,t=32,s=!1){return ge(()=>{const r=this.checkNumSamples(e);if(s)throw new ct("Verbose predictLoop() is not implemented yet.");const i=JS(r,t),a=this.outputs.map(o=>[]);for(let o=0;o<i.length;++o)ge(()=>{const u=i[o][0],d=i[o][1],f=Ap(e,u,d),m=[];if(Array.isArray(f))for(let b=0;b<f.length;++b)m.push({key:this.inputs[b],value:f[b]});else m.push({key:this.inputs[0],value:f});const y=new Vl(m);return Up(this.outputs,y)}).forEach((u,d)=>a[d].push(u));return xr(a.map(o=>wr(o,0)))})}predict(e,t={}){const s=OM(e);dD(s,this.inputNames,this.feedInputShapes,!1);try{const r=t.batchSize==null?32:t.batchSize;return ZS(r),this.predictLoop(s,r)}finally{Pi(s,e)}}predictOnBatch(e){dD(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,s=!0,r){if(this.optimizer_==null)throw new Si("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let a=0;a<this.feedOutputShapes.length;++a){const o=this.feedOutputShapes[a];this.feedLossFns[a]===X0?i.push(o.slice(0,o.length-1).concat([1])):i.push(o)}if(e=hD(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=hD(t,this.feedOutputNames,i,!1,"target"),Rne(e,t),Dne(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new te(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,s,r,i=!0,a){const[o,l]=this.standardizeUserDataXY(e,t,i,a);if(s!=null)throw new Error("sample weight is not supported yet.");let u=null;if(r!=null){const d=AM(r,this.outputNames);u=[];for(let f=0;f<d.length;++f)u.push(await RM(l[f],null,d[f]))}return[o,l,u]}testLoop(e,t,s,r=0,i){return ge(()=>{const a=this.checkNumSamples(t,s,i,"steps"),o=[];if(r>0)throw new ct("Verbose mode is not implemented yet.");if(i!=null)throw new ct("steps mode in testLoop() is not implemented yet");{const l=JS(a,s),u=Ar(Yi(0,a));for(let d=0;d<l.length;++d){const f=l[d][0],m=l[d][1],y=wu(u,f,m-f),b=aE(t,y),w=e(b);if(d===0)for(let x=0;x<w.length;++x)o.push(Wt(0));for(let x=0;x<w.length;++x){const T=w[x];o[x]=Oe(o[x],se(m-f,T))}}for(let d=0;d<o.length;++d)o[d]=Je(o[d],a)}return o})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let s=0;s<e.length;++s){const r=e[s];let i=r;if(YR(e,r)>1){const a=YR(e.slice(0,s),r);i+=`_${a}`}t.push(i)}return t}makeTrainFunction(){return e=>{const t=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],o=()=>{const f=[];for(let w=0;w<this.inputs.length;++w)f.push({key:this.inputs[w],value:s[w]});const m=new Vl(f),y=Up(this.outputs,m,{training:!0});let b;for(let w=0;w<this.lossFunctions.length;++w){const x=this.lossFunctions[w];let T=x(r[w],y[w]);i[w]!=null&&(T=Ene(T,i[w]));const E=Un(T);t.push(E),w===0?b=T:b=Oe(b,T)}for(let w=0;w<this.metricsTensors.length;++w){let x;if(this.outputs.length>1&&w<this.outputs.length)x=t[w];else{const T=this.metricsTensors[w][0],E=this.metricsTensors[w][1];x=Un(T(r[E],y[E]))}Aa(x),a.push(x)}return b=Un(b),this.calculateLosses().forEach(w=>{b=Oe(b,w)}),b},l=this.collectedTrainableWeights.map(f=>f.read());return[this.optimizer_.minimize(o,!0,l)].concat(a)}}makeTestFunction(){this.testFunction=e=>ge(()=>{const t=[];let s;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let u=0;u<this.inputs.length;++u)a.push({key:this.inputs[u],value:r[u]});const o=new Vl(a),l=Up(this.outputs,o);for(let u=0;u<this.lossFunctions.length;++u){const d=this.lossFunctions[u],f=Un(d(i[u],l[u]));u===0?s=f:s=Oe(s,f),t.push(s)}for(let u=0;u<this.metricsTensors.length;++u){const d=this.metricsTensors[u][0],f=this.metricsTensors[u][1],m=Un(d(i[f],l[f]));t.push(m)}return t})}async fit(e,t,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,i,a,o,l,u,d,f,m;try{const y=s.batchSize==null?32:s.batchSize;ZS(y);const w=await this.standardizeUserData(e,t,s.sampleWeight,s.classWeight,!1,y);r=w[0],i=w[1],m=w[2];let x=!1,T;if(s.validationData!=null&&s.validationData.length>0){if(x=!0,s.validationData.length===2)l=s.validationData[0],u=s.validationData[1];else throw s.validationData.length===3?new ct("validationData including sample weights is not supported yet."):new te(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const D=await this.standardizeUserData(l,u,null,null,!0,y);d=D[0],f=D[1],T=d.concat(f)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){x=!0;const N=Math.floor(r[0].shape[0]*(1-s.validationSplit)),D=r[0].shape[0];d=Ap(r,N,D),a=r,r=Ap(r,0,N),f=Ap(i,N,D),o=i,i=Ap(i,0,N),T=d.concat(f)}else s.validationSteps!=null&&(x=!0);const E=r.concat(i).concat(m);this.checkTrainableWeightsConsistency();const $=this.makeTrainFunction(),C=this.getDedupedMetricsNames();let O,V;x?(this.makeTestFunction(),O=this.testFunction,V=C.slice().concat(C.map(N=>"val_"+N))):(O=null,T=[],V=C.slice());const F=SM(s.callbacks,s.yieldEvery);return await this.fitLoop($,E,C,y,s.epochs,s.verbose,F,O,T,s.shuffle,V,s.initialEpoch,null,null)}finally{this.isTraining=!1,Pi(r,e),Pi(i,t),Pi(a,e),Pi(o,t),Pi(d,l),Pi(f,u),m!=null&&vt(m)}}async fitLoop(e,t,s,r,i,a,o,l,u,d,f,m,y,b){r==null&&(r=32),i==null&&(i=1),d==null&&(d=!0),m==null&&(m=0);let w=!1;if(l!=null&&u!=null&&(w=!0),b!=null&&(w=!0,y==null))throw new te("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const x=this.checkNumSamples(t,r,y,"steps_per_epoch");let T;x!=null&&(T=Yi(0,x)),a==null&&(a=1);const{callbackList:E,history:$}=TM(o,a,i,m,x,y,r,w,f);E.setModel(this),this.history=$,await E.onTrainBegin(),this.stopTraining_=!1;for(let C=m;C<i;++C){await E.onEpochBegin(C);const O={};if(y!=null)throw new ct("stepsPerEpoch mode is not implemented yet.");{if(d==="batch")throw new ct("batch shuffling is not implemneted yet");d&&y9(T);const V=Ar(T),F=JS(x,r);for(let R=0;R<F.length;++R){const N={};if(await E.onBatchBegin(R,N),ge(()=>{const D=F[R][0],k=F[R][1],z=wu(V,D,k-D);N.batch=R,N.size=k-D;const B=aE(t,z),ne=e(B);for(let J=0;J<s.length;++J){const K=s[J],re=ne[J];N[K]=re,Aa(re)}if(R===F.length-1&&w){const J=this.testLoop(l,u,r);for(let K=0;K<s.length;++K){const re=s[K],Z=J[K];Aa(Z),O["val_"+re]=Z}}}),await E.onBatchEnd(R,N),wM(N),this.stopTraining_)break}V.dispose()}if(await E.onEpochEnd(C,O),this.stopTraining_)break}return await E.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return $ne(this,e,t)}async trainOnBatch(e,t){const s=await this.standardizeUserData(e,t),r=s[0],i=s[1],o=this.makeTrainFunction()(r.concat(i)),l=[];for(const u of o){const d=await u.data();l.push(d[0])}return vt(o),Pi(s[0],e),Pi(s[1],t),xr(l)}getNamedWeights(e){const t=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,i=this.getWeights(s);for(let a=0;a<r.length;++a)s&&!r[a].trainable||t.push({name:r[a].originalName,tensor:i[a]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=TR().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-TR().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=wo(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>wo(t))}else{const t=Object.keys(this.loss);e={};const s=this.loss;for(const r of t)if(typeof s[r]=="string")e[r]=wo(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[wo(Vb(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>wo(Vb(e)));{const e={};for(const t in this.metrics)e[t]=wo(Vb(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=rE(e.optimizer_config),s=Ao(t);let r;if(typeof e.loss=="string")r=du(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(a=>du(a));else if(e.loss!=null){r={};for(const a in e.loss)r[a]=du(e.loss[a])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(a=>du(a));else if(e.metrics!=null){i={};for(const a in e.metrics)i[a]=du(e.metrics[a])}this.compile({loss:r,metrics:i,optimizer:s})}async save(e,t){if(typeof e=="string"){const u=f8(e);if(u.length===0)throw new te(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new te(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new te("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await _R(this.getNamedWeights(t)),o={modelTopology:this.toJSON(null,!1),format:Fne,generatedBy:`TensorFlow.js tfjs-layers v${kM}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:d,specs:f}=await _R(await this.optimizer.getWeights(),u);s.specs.push(...f),s.data=d8([s.data,d])}return this.userDefinedMetadata!=null&&(oD(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=s.data,o.weightSpecs=s.specs,e.save(o)}setUserDefinedMetadata(e){oD(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}pd.className="Model";Ae(pd);class FM extends pd{}FM.className="Functional";Ae(FM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class xm extends pd{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Hv("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new te(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof xm||e instanceof pd;let s;if(t){if(s=e,s.outputs.length!==1)throw new te("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new te("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new te("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=Pte({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(t)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new te(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new te("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=gM(this.outputs[0])}this.inboundNodes=[],new Kv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Mu(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(Ot(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new pd({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,s=console.log){this.built||this.build(),super.summary(e,t,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,s={}){if(!this.built)throw new Si("The model needs to be compiled before being used.");return this.model.evaluate(e,t,s)}async evaluateDataset(e,t){if(!this.built)throw new Si("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,s={}){if(!this.built)throw new Si("The model needs to be compiled before being used.");return this.model.fit(e,t,s)}async fitDataset(e,t){if(!this.built)throw new Si("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,s={},r=!1){let i,a={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new te("Legacy serialization format not supported yet.");i=t}else H(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=t.layers,delete t.layers,a=t;const o=new e(a);if(!(o instanceof xm))throw new ct(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of i){const d=Ao(l,void 0,r);r&&d.setFastWeightInitDuringBuild(!0),o.add(d)}return o}set stopTraining(e){if(this.model==null)throw new te("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new te("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const s={};s.className=t.getClassName(),s.config=t.getConfig(),e.push(s)}return{name:this.name,layers:e}}}xm.className="Sequential";Ae(xm);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Ws=class extends lf{getConfig(){return{}}},LM=class extends Ws{apply(e,t=1){return wte(e,t)}};LM.className="elu";Ae(LM);let PM=class extends Ws{apply(e){return e3(e)}};PM.className="selu";Ae(PM);let MM=class extends Ws{apply(e){return eh(e)}};MM.className="relu";Ae(MM);let VM=class extends Ws{apply(e){return ge(()=>mm(6,eh(e)))}};VM.className="relu6";Ae(VM);class BM extends Ws{apply(e){return e}}BM.className="linear";Ae(BM);let zM=class extends Ws{apply(e){return sf(e)}};zM.className="sigmoid";Ae(zM);class UM extends Ws{apply(e){return Tte(e)}}UM.className="hardSigmoid";Ae(UM);let jM=class extends Ws{apply(e){return zg(e)}};jM.className="softplus";Ae(jM);class WM extends Ws{apply(e){return Ste(e)}}WM.className="softsign";Ae(WM);let GM=class extends Ws{apply(e){return Pv(e)}};GM.className="tanh";Ae(GM);let B$=class extends Ws{apply(e,t=-1){return jI(e,t)}};B$.className="softmax";Ae(B$);class HM extends Ws{apply(e,t=-1){return HP(e,t)}}HM.className="logSoftmax";Ae(HM);class qM extends Ws{apply(e){return ge(()=>ge(()=>{const t=Math.sqrt(2),s=se(.5,Oe(1,zP(Je(e,t))));return se(e,s)}))}}qM.className="gelu";Ae(qM);class KM extends Ws{apply(e){return ge(()=>se(.5,se(e,Oe(1,Pv(se(zs(Je(2,Math.PI)),Oe(e,se(.044715,Fu(e,3)))))))))}}KM.className="gelu_new";Ae(KM);class XM extends Ws{apply(e){return ge(()=>se(e,Pv(zg(e))))}}XM.className="mish";Ae(XM);class YM extends Ws{apply(e,t=1){return ge(()=>se(sf(se(e,t)),e))}}YM.className="swish";Ae(YM);function sc(n){return n.getClassName()}function eT(n,e={}){return Kg(n,wi.getMap().classNameMap,e,"activation")}function rc(n){if(n==null){const e={};return e.className="linear",e.config={},eT(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},eT(e)}else return n instanceof Ws?n:eT(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lne(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class QM extends lf{}class ZM extends QM{constructor(e){super(),Lne(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return ge(()=>{let t=cs([1]);return this.hasL1&&(t=Oe(t,Ze(se(this.l1,Qs(e))))),this.hasL2&&(t=Oe(t,Ze(se(this.l2,Yg(e))))),ce(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}ZM.className="L1L2";Ae(ZM);const fD={l1l2:"L1L2"};function rn(n){return I$(n)}function pD(n,e={}){return Kg(n,wi.getMap().classNameMap,e,"regularizer")}function bn(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in fD?fD[n]:n,config:{}};return pD(t)}else return n instanceof QM?n:pD(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class JM extends yt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=rt(e);let s=eh(e);return this.maxValue!=null&&(s=Yr(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}JM.className="ReLU";Ae(JM);class eV extends yt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=rt(e);return OI(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}eV.className="LeakyReLU";Ae(eV);class tV extends yt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=yn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=bn(e.alphaRegularizer),this.alphaConstraint=es(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new te(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ot(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Zn({ndim:e.length,axes:s})],this.built=!0}call(e,t){return e=rt(e),BI(e,this.alpha.read())}getConfig(){const e={alphaInitializer:vn(this.alphaInitializer),alphaRegularizer:rn(this.alphaRegularizer),alphaConstraint:Jn(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}tV.className="PReLU";Ae(tV);let nV=class extends yt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new ct(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=rt(e);return Bv(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};nV.className="ELU";Ae(nV);class sV extends yt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const s=rt(e);return se(s,Ue(Qr(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}sV.className="ThresholdedReLU";Ae(sV);let rV=class extends yt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new B$().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return ge(()=>{let s=rt(e);const r=t.mask;if(r!=null){const i=se(tt(xc(s.shape),Ue(r,s.dtype)),Wt(-1e9));s=Oe(s,i)}return this.axis instanceof Array?this.axis.length>1?Ma(tt(s,qP(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};rV.className="Softmax";Ae(rV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function md(n,e,t){if(typeof n=="number")return Mu(n,e);if(n.length!==e)throw new te(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let s=0;s<e;++s){const r=n[s];if(!yte(r))throw new te(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${r}`)}return n}function Hi(n,e,t,s,r=1){if(n==null)return n;const i=e+(e-1)*(r-1);let a;return t==="same"?a=n:a=n-i+1,Math.floor((a+s-1)/s)}function Ta(n,e,t,s){if(n==null)return null;if(s==="valid")n=n*e+nc([t-e,0]);else if(s==="same")n=n*e;else throw new te(`Unsupport padding mode: ${s}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function z$(n,e){return ge(()=>(Pn(e),e==="channelsFirst"?It(n,[0,2,3,1]):n))}function iV(n,e){return ge(()=>(Pn(e),e==="channelsFirst"?It(n,[0,2,3,4,1]):n))}function Pne(n,e,t,s=1,r="valid",i,a=1){return ge(()=>{if(i==null&&(i=Qi()),Pn(i),n.shape.length!==3)throw new te(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new te(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new te(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(i==="channelsFirst"&&(n=It(n,[0,2,1])),r==="causal")throw new ct("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=LP(n,e,s,r==="same"?"same":"valid","NWC",a);return t!=null&&(o=ta(o,t)),o})}function mD(n,e,t,s=[1,1],r="valid",i,a,o=null){return ge(()=>{if(i==null&&(i=Qi()),Pn(i),n.rank!==3&&n.rank!==4)throw new te(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new te(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let l=z$(n,i);if(r==="causal")throw new ct("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=HQ({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:a,dataFormat:"NHWC",bias:t,activation:o}),i==="channelsFirst"&&(l=It(l,[0,3,1,2])),l})}function Mne(n,e,t,s=[1,1,1],r="valid",i,a){return ge(()=>{if(i==null&&(i=Qi()),Pn(i),n.rank!==4&&n.rank!==5)throw new te(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new te(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let o=iV(n,i);if(r==="causal")throw new ct("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=j7(o,e,s,r==="same"?"same":"valid","NDHWC",a),t!=null&&(o=ta(o,t)),i==="channelsFirst"&&(o=It(o,[0,4,1,2,3])),o})}class Qv extends yt{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Qv.verifyArgs(t),this.rank=e,us(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new ct(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=md(t.kernelSize,e,"kernelSize"),this.strides=md(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,Zr(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Pn(this.dataFormat),this.activation=rc(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=yn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=es(t.biasConstraint),this.biasRegularizer=bn(t.biasRegularizer),this.activityRegularizer=bn(t.activityRegularizer),this.dilationRate=md(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new te(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new te(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new te(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Sa("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!$$(e.kernelSize,"number",1,3))throw new te(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:sc(this.activation),useBias:this.useBias,biasInitializer:vn(this.biasInitializer),biasRegularizer:rn(this.biasRegularizer),activityRegularizer:rn(this.activityRegularizer),biasConstraint:Jn(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class cf extends Qv{constructor(e,t){super(e,t),this.kernel=null,cf.verifyArgs(t),this.filters=t.filters,us(this.filters,"filters"),this.kernelInitializer=yn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=es(t.kernelConstraint),this.kernelRegularizer=bn(t.kernelRegularizer)}build(e){e=Ot(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new te(`The channel dimension of the input should be defined. Found ${e[t]}`);const s=e[t],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:s}}],this.built=!0}call(e,t){return ge(()=>{e=rt(e);let s;const r=this.bias==null?null:this.bias.read(),i=tM(this.activation.getClassName());if(i!=null&&this.rank===2)s=mD(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)s=Pne(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=mD(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=Mne(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new ct("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=Ot(e);const t=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<s.length;++i){const a=Hi(s[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);t.push(a)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:vn(this.kernelInitializer),kernelRegularizer:rn(this.kernelRegularizer),kernelConstraint:Jn(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new te(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}let U$=class aV extends cf{constructor(e){super(2,e),aV.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!$$(e.kernelSize,"number",1,2))throw new te(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}};U$.className="Conv2D";Ae(U$);let j$=class oV extends cf{constructor(e){super(3,e),oV.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new te(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}};j$.className="Conv3D";Ae(j$);class lV extends U${constructor(e){if(super(e),this.inputSpec=[new Zn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new te(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ot(e),e.length!==4)throw new te("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new te("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Zn({ndim:4,axes:{[t]:s}})],this.built=!0}call(e,t){return ge(()=>{let s=rt(e);if(s.shape.length!==4)throw new te(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let a,o;this.dataFormat==="channelsFirst"?(a=2,o=3):(a=1,o=2);const l=r[a],u=r[o],d=this.kernelSize[0],f=this.kernelSize[1],m=this.strides[0],y=this.strides[1],b=Ta(l,m,d,this.padding),w=Ta(u,y,f,this.padding),x=[i,b,w,this.filters];this.dataFormat!=="channelsLast"&&(s=It(s,[0,2,3,1]));let T=PP(s,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(T=It(T,[0,3,1,2])),this.bias!=null&&(T=ta(T,this.bias.read(),this.dataFormat)),this.activation!=null&&(T=this.activation.apply(T)),T})}computeOutputShape(e){e=Ot(e);const t=e.slice();let s,r,i;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3):(s=3,r=1,i=2);const a=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return t[s]=this.filters,t[r]=Ta(t[r],l,a,this.padding),t[i]=Ta(t[i],u,o,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}lV.className="Conv2DTranspose";Ae(lV);class cV extends j${constructor(e){if(super(e),this.inputSpec=[new Zn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new te(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ot(e),e.length!==5)throw new te("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new te("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Zn({ndim:5,axes:{[t]:s}})],this.built=!0}call(e,t){return ge(()=>{let s=rt(e);if(s.shape.length!==5)throw new te(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let a,o,l;this.dataFormat==="channelsFirst"?(l=2,a=3,o=4):(l=1,a=2,o=3);const u=r[l],d=r[a],f=r[o],m=this.kernelSize[0],y=this.kernelSize[1],b=this.kernelSize[2],w=this.strides[0],x=this.strides[1],T=this.strides[2],E=Ta(u,w,m,this.padding),$=Ta(d,x,y,this.padding),C=Ta(f,T,b,this.padding),O=[i,E,$,C,this.filters];this.dataFormat!=="channelsLast"&&(s=It(s,[0,2,3,4,1]));let V=H7(s,this.kernel.read(),O,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(V=It(V,[0,4,1,2,3])),this.bias!==null&&(V=ta(V,this.bias.read(),this.dataFormat)),this.activation!==null&&(V=this.activation.apply(V)),V})}computeOutputShape(e){e=Ot(e);const t=e.slice();let s,r,i,a;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3,a=4):(s=4,r=1,i=2,a=3);const o=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],d=this.strides[0],f=this.strides[1],m=this.strides[2];return t[s]=this.filters,t[r]=Ta(t[r],d,o,this.padding),t[i]=Ta(t[i],f,l,this.padding),t[a]=Ta(t[a],m,u,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}cV.className="Conv3DTranspose";Ae(cV);class uV extends cf{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new te("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new te("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new te(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=yn(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=bn(t.depthwiseRegularizer),this.depthwiseConstraint=es(t.depthwiseConstraint),this.pointwiseInitializer=yn(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=bn(t.pointwiseRegularizer),this.pointwiseConstraint=es(t.pointwiseConstraint)}build(e){if(e=Ot(e),e.length<this.rank+2)throw new te(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new te(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const s=e[t],r=this.kernelSize.concat([s,this.depthMultiplier]),i=[];for(let o=0;o<this.rank;++o)i.push(1);i.push(s*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new Zn({ndim:this.rank+2,axes:{[t]:s}})],this.built=!0}call(e,t){return ge(()=>{e=rt(e);let s;if(this.rank===1)throw new ct("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=It(e,[0,2,3,1])),s=t3(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=ta(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=It(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=vn(this.depthwiseInitializer),e.pointwiseInitializer=vn(this.pointwiseInitializer),e.depthwiseRegularizer=rn(this.depthwiseRegularizer),e.pointwiseRegularizer=rn(this.pointwiseRegularizer),e.depthwiseConstraint=Jn(this.depthwiseConstraint),e.pointwiseConstraint=Jn(this.pointwiseConstraint),e}}uV.className="SeparableConv";class hV extends uV{constructor(e){super(2,e)}}hV.className="SeparableConv2D";Ae(hV);class Zv extends cf{constructor(e){super(1,e),Zv.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!$$(e.kernelSize,"number",1,1))throw new te(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Zv.className="Conv1D";Ae(Zv);class dV extends yt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return ge(()=>{if(e=rt(e),this.dataFormat==="channelsLast"){const s=Mb(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Mb(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=Mb(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Mb(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}dV.className="Cropping2D";Ae(dV);class fV extends yt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Pn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,pte(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,s]}else{const t=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],t,s,e[3]]}}call(e,t){return ge(()=>{let s=rt(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=It(s,[0,2,3,1]);const i=this.size[0]*r[2],a=this.size[1]*r[3],o=this.interpolation==="nearest"?Co.resizeNearestNeighbor(s,[i,a]):Co.resizeBilinear(s,[i,a]);return It(o,[0,3,1,2])}else{const i=this.size[0]*r[1],a=this.size[1]*r[2];return this.interpolation==="nearest"?Co.resizeNearestNeighbor(s,[i,a]):Co.resizeBilinear(s,[i,a])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}fV.className="UpSampling2D";Ae(fV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vne(n,e,t=[1,1],s="valid",r,i){return ge(()=>{r==null&&(r=Qi()),Pn(r);let a=z$(n,r);if(n.rank!==4)throw new te(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new te(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return a=kI(a,e,t,s==="same"?"same":"valid","NHWC",i),r==="channelsFirst"&&(a=It(a,[0,3,1,2])),a})}class pV extends Qv{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=yn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=es(e.depthwiseConstraint),this.depthwiseRegularizer=bn(e.depthwiseRegularizer)}build(e){if(e=Ot(e),e.length<4)throw new te(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new te(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const s=e[t],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ge(()=>{e=rt(e);let s=Vne(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=ta(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=Ot(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Hi(t,this.kernelSize[0],this.padding,this.strides[0]),a=Hi(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,i,a]:[e[0],i,a,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=vn(this.depthwiseInitializer),e.depthwiseRegularizer=rn(this.depthwiseRegularizer),e.depthwiseConstraint=Jn(this.depthwiseRegularizer),e}}pV.className="DepthwiseConv2D";Ae(pV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mV(n,e,t,s){if(Array.isArray(n)){if(e!=null||t!=null)throw new te("When inputs is an array, neither initialState or constants should be provided");s!=null&&(t=n.slice(n.length-s,n.length),n=n.slice(0,n.length-s)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function r(i){return i==null||Array.isArray(i)?i:[i]}return e=r(e),t=r(t),{inputs:n,initialState:e,constants:t}}function gV(n,e,t,s=!1,r,i,a=!1,o=!1){return ge(()=>{const l=e.shape.length;if(l<3)throw new te(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(Yi(2,l));e=It(e,u),a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=Ue(Ue(r,"bool"),"float32"),r.rank===l-1&&(r=br(r,-1)),r=It(r,u)),s&&(e=Lu(e,0),r!=null&&(r=Lu(r,0)));const d=[];let f,m=t;const y=e.shape[0],b=Pu(e);let w;r!=null&&(w=Pu(r));for(let T=0;T<y;++T){const E=b[T],$=ge(()=>n(E,m));if(r==null)f=$[0],m=$[1];else{const C=ge(()=>{const O=w[T],V=tt(Ii(O),O),F=Oe(se($[0],O),se(m[0],V)),R=m.map((N,D)=>Oe(se($[1][D],O),se(N,V)));return{output:F,newStates:R}});f=C.output,m=C.newStates}o&&d.push(f)}let x;return o&&(x=Po(d,1)),[f,x,m]})}class wc extends yt{constructor(e){super(e);let t;if(e.cell==null)throw new te("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new H$({cells:e.cell}):t=e.cell,t.stateSize==null)throw new te("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Zn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Yi(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){tE(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const s=t[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const i=[];for(const a of t)i.push([e[0],a]);return[r].concat(i)}else return r}computeMask(e,t){return ge(()=>{Array.isArray(t)&&(t=t[0]);const s=this.returnSequences?t:null;if(this.returnState){const r=this.states.map(i=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let s=0;s<e;++s)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new ct("Constants support is not implemented in RNN yet.");tE(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Zn({shape:[t,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!Gt(this.stateSpec.map(a=>a.shape[a.shape.length-1]),i))throw new te(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(a=>new Zn({shape:[null,a]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){ge(()=>{if(!this.stateful)throw new wa("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new te("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>cs([s,r])):this.states_=[cs([s,this.cell.stateSize])];else if(e==null)vt(this.states_),this.keptStates!=null&&(vt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>cs([s,r])):this.states_[0]=cs([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new te(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):vt(this.states_);for(let r=0;r<this.states_.length;++r){const i=e[r],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,o=[s,a];if(!Gt(i.shape,o))throw new te(`State ${r} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${i.shape}`);this.states_[r]=i}}this.states_=this.states_.map(r=>Aa(r.clone()))})}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const i=mV(e,s,r,this.numConstants);e=i.inputs,s=i.initialState,r=i.constants;let a=[],o=[];if(s!=null){t.initialState=s,a=a.concat(s),this.stateSpec=[];for(const u of s)this.stateSpec.push(new Zn({shape:u.shape}));o=o.concat(this.stateSpec)}if(r!=null&&(t.constants=r,a=a.concat(r),this.numConstants=r.length),a[0]instanceof Ba){const u=[e].concat(a),d=this.inputSpec.concat(o),f=this.inputSpec;this.inputSpec=d;const m=super.apply(u,t);return this.inputSpec=f,m}else return super.apply(e,t)}call(e,t){return ge(()=>{const s=t==null?null:t.mask,r=t==null?null:t.training;let i=t==null?null:t.initialState;e=rt(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new te(`RNN Layer has ${a} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},u=gV((b,w)=>{const x=this.cell.call([b].concat(w),o);return[x[0],x.slice(1)]},e,i,this.goBackwards,s,null,this.unroll,this.returnSequences),d=u[0],f=u[1],m=u[2];this.stateful&&this.resetStates(m,r);const y=this.returnSequences?f:d;return this.returnState?[y].concat(m):y})}getInitialState(e){return ge(()=>{let t=cs(e.shape);return t=Ze(t,[1,2]),t=Xg(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?JT(t,[1,s]):t):this.cell.stateSize>1?[JT(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===wc.className&&(t.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),t)}static fromConfig(e,t,s={}){const r=t.cell,i=Ao(r,s);return new e(Object.assign(t,{cell:i}))}}wc.className="RNN";Ae(wc);class Jv extends yt{}class W$ extends Jv{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,us(this.units,"units"),this.activation=rc(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=yn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=yn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=yn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=bn(e.kernelRegularizer),this.recurrentRegularizer=bn(e.recurrentRegularizer),this.biasRegularizer=bn(e.biasRegularizer),this.kernelConstraint=es(e.kernelConstraint),this.recurrentConstraint=es(e.recurrentConstraint),this.biasConstraint=es(e.biasConstraint),this.dropout=kd([1,nc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=kd([1,nc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ot(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ge(()=>{if(e=e,e.length!==2)throw new te(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ic({ones:()=>Ii(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ic({ones:()=>Ii(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i;const a=this.dropoutMask,o=this.recurrentDropoutMask;a!=null?i=Oa(se(e,a),this.kernel.read()):i=Oa(e,this.kernel.read()),this.bias!=null&&(i=ta(i,this.bias.read())),o!=null&&(s=se(s,o));let l=Oe(i,Oa(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:sc(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:rn(this.kernelRegularizer),recurrentRegularizer:rn(this.recurrentRegularizer),biasRegularizer:rn(this.biasRegularizer),activityRegularizer:rn(this.activityRegularizer),kernelConstraint:Jn(this.kernelConstraint),recurrentConstraint:Jn(this.recurrentConstraint),biasConstraint:Jn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}W$.className="SimpleRNNCell";Ae(W$);class yV extends wc{constructor(e){e.cell=new W$(e),super(e)}call(e,t){return ge(()=>{this.cell.dropoutMask!=null&&(vt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(vt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,t){return new e(t)}}yV.className="SimpleRNN";Ae(yV);class G$ extends Jv{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new te("GRUCell does not support reset_after parameter set to true.");this.units=e.units,us(this.units,"units"),this.activation=rc(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=rc(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=yn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=yn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=yn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=bn(e.kernelRegularizer),this.recurrentRegularizer=bn(e.recurrentRegularizer),this.biasRegularizer=bn(e.biasRegularizer),this.kernelConstraint=es(e.kernelConstraint),this.recurrentConstraint=es(e.recurrentConstraint),this.biasConstraint=es(e.biasConstraint),this.dropout=kd([1,nc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=kd([1,nc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ot(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ge(()=>{if(e=e,e.length!==2)throw new te(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training==null?!1:t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ic({ones:()=>Ii(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ic({ones:()=>Ii(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let o,l,u;0<this.dropout&&this.dropout<1&&(e=se(e,i[0]));let d=Oa(e,this.kernel.read());this.useBias&&(d=ta(d,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=se(r,a[0]));const f=this.recurrentKernel.read(),[m,y]=Kr(f,[2*this.units,this.units],f.rank-1),b=Oa(r,m),[w,x,T]=Kr(d,3,d.rank-1),[E,$]=Kr(b,2,b.rank-1);o=this.recurrentActivation.apply(Oe(w,E)),l=this.recurrentActivation.apply(Oe(x,$));const C=Oa(se(l,r),y);u=this.activation.apply(Oe(T,C));const O=Oe(se(o,r),se(Oe(1,Dn(o)),u));return[O,O]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:sc(this.activation),recurrentActivation:sc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:rn(this.kernelRegularizer),recurrentRegularizer:rn(this.recurrentRegularizer),biasRegularizer:rn(this.biasRegularizer),activityRegularizer:rn(this.activityRegularizer),kernelConstraint:Jn(this.kernelConstraint),recurrentConstraint:Jn(this.recurrentConstraint),biasConstraint:Jn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}G$.className="GRUCell";Ae(G$);class bV extends wc{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new G$(e),super(e)}call(e,t){return ge(()=>{this.cell.dropoutMask!=null&&(vt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(vt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}bV.className="GRU";Ae(bV);class e1 extends Jv{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,us(this.units,"units"),this.activation=rc(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=rc(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=yn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=yn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=yn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=bn(e.kernelRegularizer),this.recurrentRegularizer=bn(e.recurrentRegularizer),this.biasRegularizer=bn(e.biasRegularizer),this.kernelConstraint=es(e.kernelConstraint),this.recurrentConstraint=es(e.recurrentConstraint),this.biasConstraint=es(e.biasConstraint),this.dropout=kd([1,nc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=kd([1,nc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=Ot(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,a=this.units;r=new(t=class extends Ci{apply(l,u){const d=i.apply([a]),f=new N$().apply([a]),m=i.apply([a*2]);return ZR(ZR(d,f),m)}},t.className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return ge(()=>{const s=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new te(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ic({ones:()=>Ii(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ic({ones:()=>Ii(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,o=this.recurrentDropoutMask;let l,u,d,f;0<this.dropout&&this.dropout<1&&(e=se(e,a[0]));let m=Oa(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=se(r,o[0])),m=Oe(m,Oa(r,this.recurrentKernel.read())),this.useBias&&(m=ta(m,this.bias.read()));const[y,b,w,x]=Kr(m,4,m.rank-1);l=this.recurrentActivation.apply(y),u=this.recurrentActivation.apply(b),d=Oe(se(u,i),se(l,this.activation.apply(w))),f=this.recurrentActivation.apply(x);const T=se(f,this.activation.apply(d));return[T,T,d]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:sc(this.activation),recurrentActivation:sc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:rn(this.kernelRegularizer),recurrentRegularizer:rn(this.recurrentRegularizer),biasRegularizer:rn(this.biasRegularizer),activityRegularizer:rn(this.activityRegularizer),kernelConstraint:Jn(this.kernelConstraint),recurrentConstraint:Jn(this.recurrentConstraint),biasConstraint:Jn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}e1.className="LSTMCell";Ae(e1);class xV extends wc{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new e1(e),super(e)}call(e,t){return ge(()=>{this.cell.dropoutMask!=null&&(vt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(vt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}xV.className="LSTM";Ae(xV);class H$ extends Jv{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return ge(()=>{e=e;let s=e.slice(1);const r=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?r.push(s.splice(0,o.stateSize.length)):r.push(s.splice(0,1));r.reverse();const i=[];let a;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];s=r[o],o===0?a=[e[0]].concat(s):a=[a[0]].concat(s),a=l.call(a,t),i.push(a.slice(1))}s=[];for(const o of i.slice().reverse())s.push(...o);return[a[0]].concat(s)})}build(e){tE(e)&&(e=e[0]),e=e;let t;this.cells.forEach((s,r)=>{vu(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?t=s.stateSize[0]:t=s.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=i=>({className:i.getClassName(),config:i.getConfig()}),r={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,t,s={}){const r=[];for(const i of t.cells)r.push(Ao(i,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.cells)t.push(...s.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return nE(e)}setWeights(e){const t=[];for(const s of this.cells){const r=s.weights.length,i=e.splice(r);for(let a=0;a<s.weights.length;++a)t.push([s.weights[a],i[a]])}L$(t)}}H$.className="StackedRNNCells";Ae(H$);function ic(n){const{ones:e,rate:t,training:s=!1,count:r=1,dropoutFunc:i}=n,a=()=>i!=null?i(e(),t):lM(e(),t),o=()=>Qg(a,e,s);return!r||r<=1?Aa(o().clone()):Array(r).fill(void 0).map(o).map(u=>Aa(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Bne=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class vV extends wc{constructor(e){if(e.unroll)throw new ct("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new ct("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Zn({ndim:5})]}call(e,t){return ge(()=>{if(this.cell.dropoutMask!=null&&(vt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(vt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new te("ConvRNN2D cell does not support constants");const s=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return ge(()=>{const{stateSize:t}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)],a=cs(i);return Array.isArray(t)?Array(t.length).fill(a):[a]})}resetStates(e,t=!1){ge(()=>{if(!this.stateful)throw new wa("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)];if(s[0]==null)throw new te("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>cs(i)):this.states_=[cs(i)];else if(e==null)vt(this.states_),this.keptStates!=null&&(vt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>cs(i)):this.states_[0]=cs(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new te(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):vt(this.states_);for(let o=0;o<this.states_.length;++o){const l=e[o],u=i;if(!Gt(l.shape,u))throw new te(`State ${o} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>Aa(o.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:s,kernelSize:r,padding:i,strides:a,dilationRate:o}=this.cell,l=t==="channelsFirst",u=e[l?3:2],d=e[l?4:3],f=Hi(u,r[0],i,a[0],o[0]),m=Hi(d,r[1],i,a[1],o[1]);return[...e.slice(0,2),...l?[s,f,m]:[f,m,s]]}}vV.className="ConvRNN2D";class q$ extends e1{constructor(e){const{filters:t,kernelSize:s,strides:r,padding:i,dataFormat:a,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,us(this.filters,"filters"),this.kernelSize=md(s,2,"kernelSize"),this.kernelSize.forEach(l=>us(l,"kernelSize")),this.strides=md(r||1,2,"strides"),this.strides.forEach(l=>us(l,"strides")),this.padding=i||"valid",Zr(this.padding),this.dataFormat=a||"channelsLast",Pn(this.dataFormat),this.dilationRate=md(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>us(l,"dilationRate"))}build(e){var t;e=Ot(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new te(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],i=4,a=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,d=this.filters;l=new(t=class extends Ci{apply(m,y){const b=u.apply([d]),w=xc([d]),x=u.apply([d*2]);return C$([b,w,x])}},t.className="CustomInit",t)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return ge(()=>{if(e.length!==3)throw new te(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training||!1,r=e[0],i=e[1],a=e[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ic({ones:()=>Ii(r),rate:this.dropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(W,ee,me)=>!ee||!ee[me]?W:se(ee[me],W);let d=u(r,l,0),f=u(r,l,1),m=u(r,l,2),y=u(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ic({ones:()=>Ii(i),rate:this.recurrentDropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const b=this.recurrentDropoutMask;let w=u(i,b,0),x=u(i,b,1),T=u(i,b,2),E=u(i,b,3);const $=3,[C,O,V,F]=Kr(this.kernel.read(),o,$),[R,N,D,k]=this.useBias?Kr(this.bias.read(),o):[null,null,null,null];d=this.inputConv(d,C,R,this.padding),f=this.inputConv(f,O,N,this.padding),m=this.inputConv(m,V,D,this.padding),y=this.inputConv(y,F,k,this.padding);const[z,B,ne,J]=Kr(this.recurrentKernel.read(),o,$);w=this.recurrentConv(w,z),x=this.recurrentConv(x,B),T=this.recurrentConv(T,ne),E=this.recurrentConv(E,J);const K=this.recurrentActivation.apply(Oe(d,w)),re=this.recurrentActivation.apply(Oe(f,x)),Z=Oe(se(re,a),se(K,this.activation.apply(Oe(m,T)))),he=se(this.recurrentActivation.apply(Oe(y,E)),this.activation.apply(Z));return[he,he,Z]})}getConfig(){const e=super.getConfig(),{units:t}=e,s=Bne(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(e,t,s,r){const i=Ou(e,t,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?ta(i,s,this.dataFormat):i}recurrentConv(e,t){return Ou(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}q$.className="ConvLSTM2DCell";Ae(q$);class wV extends vV{constructor(e){const t=new q$(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}wV.className="ConvLSTM2D";Ae(wV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class K$ extends yt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?t[r]:this.noiseShape[r]);return s}call(e,t){return ge(()=>{this.invokeCallHook(e,t);const s=rt(e);if(0<this.rate&&this.rate<1){const r=t.training==null?!1:t.training,i=this.getNoiseShape(s);return Qg(()=>lM(s,this.rate,i,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}K$.className="Dropout";Ae(K$);class SV extends K${constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}SV.className="SpatialDropout1D";Ae(SV);class TV extends yt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,us(this.units,"units"),this.activation=rc(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=yn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=yn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=es(e.kernelConstraint),this.biasConstraint=es(e.biasConstraint),this.kernelRegularizer=bn(e.kernelRegularizer),this.biasRegularizer=bn(e.biasRegularizer),this.activityRegularizer=bn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ot(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=Ot(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return ge(()=>{this.invokeCallHook(e,t);const s=rt(e),r=tM(this.activation.getClassName());let i;return r!=null?i=Oa(s,this.kernel.read(),r,this.bias?this.bias.read():null):(i=Oa(s,this.kernel.read()),this.bias!=null&&(i=ta(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:sc(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:rn(this.kernelRegularizer),biasRegularizer:rn(this.biasRegularizer),activityRegularizer:rn(this.activityRegularizer),kernelConstraint:Jn(this.kernelConstraint),biasConstraint:Jn(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}TV.className="Dense";Ae(TV);class EV extends yt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ot(e);for(const t of e.slice(1))if(t==null)throw new te(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Jl(e,1)]}call(e,t){return ge(()=>{this.invokeCallHook(e,t);let s=rt(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let i=2;i<s.rank;++i)r.push(i);r.push(1),s=It(s,r)}return vte(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}EV.className="Flatten";Ae(EV);class _V extends yt{constructor(e){super(e),this.supportsMasking=!0,this.activation=rc(e.activation)}call(e,t){return ge(()=>{this.invokeCallHook(e,t);const s=rt(e);return this.activation.apply(s)})}getConfig(){const e={activation:sc(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}_V.className="Activation";Ae(_V);class IV extends yt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return ge(()=>(e=rt(e),bte(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}IV.className="RepeatVector";Ae(IV);let $V=class extends yt{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const s="Total size of new array must be unchanged.",r=t.slice();let i=1,a=null;for(let l=0;l<r.length;++l){const u=r[l];if(this.isUnknown(u))if(a===null)a=l;else throw new te("Can only specifiy one unknown dimension.");else i*=u}const o=Jl(e);if(a!==null){if(i===0||o%i!==0)throw new te(s);r[a]=o/i}else if(o!==i)throw new te(s);return r}computeOutputShape(e){let t=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return ge(()=>{this.invokeCallHook(e,t);const s=rt(e),r=s.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return ce(s,i)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}};$V.className="Reshape";Ae($V);class CV extends yt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=Yi(1,e.dims.length+1);if(!Gt(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Zn({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ot(e);const t=e.slice();return this.dims.forEach((s,r)=>{t[r+1]=e[s]}),t}call(e,t){return It(rt(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}CV.className="Permute";Ae(CV);class NV extends yt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const s=rt(e);return HT(z0(s,this.maskValue),-1)}call(e,t){return ge(()=>{this.invokeCallHook(e,t);const s=rt(e),a=HT(z0(s,this.maskValue),-1,!0);return se(s,Ue(a,s.dtype))})}}NV.className="Masking";Ae(NV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kV extends yt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Xt(e.inputLength))}this.inputDim=e.inputDim,us(this.inputDim,"inputDim"),this.outputDim=e.outputDim,us(this.outputDim,"outputDim"),this.embeddingsInitializer=yn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=bn(e.embeddingsRegularizer),this.activityRegularizer=bn(e.activityRegularizer),this.embeddingsConstraint=es(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return ge(()=>this.maskZero?(e=rt(e),z0(e,$t(e))):null)}computeOutputShape(e){if(e=Ot(e),this.inputLength==null)return[...e,this.outputDim];const t=Xt(this.inputLength);if(t.length!==e.length-1)throw new te(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<t.length;++r){const i=t[r],a=e[r+1];if(i!=null&&a!=null&&i!==a)throw new te(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(t[s]=a),s++}}return[e[0],...t,this.outputDim]}call(e,t){return ge(()=>{this.invokeCallHook(e,t);let s=rt(e);s.dtype!=="int32"&&(s=Da(s,"int32"));const r=oM(this.embeddings.read(),ce(s,[s.size]));return ce(r,Ot(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:vn(this.embeddingsInitializer),embeddingsRegularizer:rn(this.embeddingsRegularizer),activityRegularizer:rn(this.activityRegularizer),embeddingsConstraint:Jn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}kV.className="Embedding";Ae(kV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sh extends yt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new ct}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const s=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const i=e[e.length-t.length+r],a=t[r];if(i==null||a==null||i<0||a<0)s.push(null);else if(i===1)s.push(a);else if(a===1)s.push(i);else{if(i!==a)throw new te("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));s.push(i)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ot(e)]),e=e,e.length<2)throw new te(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const i of e)i!=null&&i[0]!==null&&t.push(i[0]);if(t=Zl(t),t.length>1)throw new te(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const a=e[i]==null?null:e[i].slice(1);s=this.computeElementwiseOpOutputShape(s,a)}const r=e.map(i=>i.length);e.indexOf(null)===-1&&Zl(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return ge(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(i=>i.rank);if(r.indexOf(null)===-1){const i=nc(r);for(let a of e){const o=a.rank;for(let l=0;l<i-o;++l)a=Xg(a,1);s.push(a)}return this.mergeFunction(s)}else{let i=!1;for(const l of e){const u=l.rank;if(u==null){const d=l.shape,f=d[0],m=d.slice(1).concat([f]);let y=ce(l,[f].concat(Jl(d.slice(1))));y=It(y,[1,0]),y=ce(y,m),s.push(y),i=!0}else if(u>1){const d=Yi(1,u).concat([0]);s.push(It(l,d)),i=!0}else s.push(l)}let a=this.mergeFunction(s);const o=a.rank;if(i){if(o==null){const l=a.shape,u=l.length,d=l[u-1],f=[d].concat(l.slice(0,l.length-1));a=ce(It(ce(a,[-1,d]),[1,0]),f)}else if(o>1){const l=[o-1].concat(Yi(0,o-1));a=It(a,l)}}return a}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,i)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Zl(s),s.length===1?t=s.concat(t):t=[null].concat(t),t}computeMask(e,t){return ge(()=>{if(t==null)return null;if(!Array.isArray(t))throw new te("`mask` should be an Array");if(!Array.isArray(e))throw new te("`inputs` should be an Array");if(t.length!==e.length)throw new te(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(r=>r==null))return null;t=t.map(r=>r==null?r:br(r,0));let s=t[0];for(let r=1;r<t.length-1;++r)s=Lo(s,t[r]);return s})}}let AV=class extends sh{constructor(e){super(e)}mergeFunction(e){return ge(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=Oe(t,e[s]);return t})}};AV.className="Add";Ae(AV);let RV=class extends sh{constructor(e){super(e)}mergeFunction(e){return ge(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=se(t,e[s]);return t})}};RV.className="Multiply";Ae(RV);class DV extends sh{constructor(e){super(e)}mergeFunction(e){return ge(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=Oe(t,e[s]);return se(1/e.length,t)})}}DV.className="Average";Ae(DV);let OV=class extends sh{constructor(e){super(e)}mergeFunction(e){return ge(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=bc(t,e[s]);return t})}};OV.className="Maximum";Ae(OV);let FV=class extends sh{constructor(e){super(e)}mergeFunction(e){return ge(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=mm(t,e[s]);return t})}};FV.className="Minimum";Ae(FV);class LV extends sh{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new te("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const r of e)if(r!=null){t=!1;break}if(t)return;const s=[];for(let r=0;r<e.length;++r){const i=e[r].slice();i.splice(this.axis,1);let a=!1;for(const o of s)if(Gt(o,i)){a=!0;break}a||s.push(i)}if(s.length>1)throw new te("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return ge(()=>C$(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new te("A `Concatenate` layer should be called on a list of inputs.");const t=e,s=t[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const i of t.slice(1)){if(s[r]==null||i[r]==null){s[r]=null;break}s[r]+=i[r]}return s}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new te("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new te("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new te(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return ge(()=>{let s=!0;if(t.forEach(a=>{if(a!=null){s=!1;return}}),s)return null;const r=[];for(let a=0;a<e.length;++a)t[a]==null?r.push(Ue(Ii(e[a]),"bool")):t[a].rank<e[a].rank?r.push(br(t[a],-1)):r.push(t[a]);const i=wr(r,this.axis);return FP(i,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}LV.className="Concatenate";Ae(LV);function Rp(n,e){for(;n<0;)n+=e;return n}function zne(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new ct("batchDot is not implemented for tensors of 4D or higher rank yet");if(H(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),H(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new ct("batchDot is not implemented for complex64-type Tensors yet.");const s=n.shape.length,r=e.shape.length;t==null&&(t=[s-1,r-2]);const i=t;return ge(()=>{let a;if(s>r){a=s-r;const l=[];for(let u=0;u<a;++u)l.push(1);e=ce(e,e.shape.concat(l))}else if(r>s){a=r-s;const l=[];for(let u=0;u<a;++u)l.push(1);n=ce(n,n.shape.concat(l))}else a=0;let o;if(n.shape.length===2&&e.shape.length===2)i[0]===i[1]?o=Ze(se(n,e),i[0]):o=Ze(se(It(n,[1,0]),e),i[1]);else{const l=i[0]!==n.shape.length-1,u=i[1]===e.shape.length-1;o=jt(n,e,l,u)}if(a>0){let l;s>r?l=s+r-3:l=s-1;const u=[];for(let d=l;d<l+a;++d)u.push(d);o=jg(o,u)}return o.shape.length===1&&(o=br(o,1)),o})}class PV extends sh{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){H(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],s=e[1];if(t.length>3||s.length>3)throw new ct("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);if(t[r[0]]!==s[r[1]])throw new te(`Dimension incompatibility: ${t[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new te(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,a)=>Rp(i,e[a].shape.length)):r=[Rp(this.axes,t.shape.length),Rp(this.axes,s.shape.length)],this.normalize&&(t=K0(t,r[0]),s=K0(s,r[1])),zne(t,s,r)}interpretAxes(e,t){let s;return Array.isArray(this.axes)?s=this.axes:s=[Rp(this.axes,e.length),Rp(this.axes,t.length)],s}computeOutputShape(e){H(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),s=e[1].slice();if(t.length>3||s.length>3)throw new ct("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);t.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const i=t.concat(s);return i.length===1&&i.push(1),i}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}PV.className="Dot";Ae(PV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class MV extends yt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return ge(()=>{this.invokeCallHook(e,t);const s=rt(e);return Qg(()=>Oe(qv(s.shape,0,this.stddev),s),()=>s,t.training||!1)})}}MV.className="GaussianNoise";Ae(MV);class VV extends yt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return ge(()=>{this.invokeCallHook(e,t);const s=rt(e);return this.rate>0&&this.rate<1?Qg(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return se(s,qv(s.shape,1,i))},()=>s,t.training||!1):s})}}VV.className="GaussianDropout";Ae(VV);class BV extends yt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||rt(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return ge(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return Qg(()=>{const i=rt(e),o=-1.6732632423543772*1.0507009873554805;let l=Ju(Ug(s),this.rate);l=Da(l,"float32");const u=((1-this.rate)*(1+this.rate*o**2))**-.5,d=-u*o*this.rate,f=Oe(se(i,l),se(Oe(l,-1),o));return Oe(se(f,u),d)},()=>rt(e),t.training||!1)}return e})}}BV.className="AlphaDropout";Ae(BV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vm(n,e,t,s,r,i=.001){let a;if(n.rank===2)a=x7(n,e,t,s,r,i);else if(n.rank===3)a=w7(n,e,t,s,r,i);else if(n.rank===4)a=T7(n,e,t,s,r,i);else throw new ct(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return a}function Une(n,e,t,s,r=.001){return ge(()=>{const i=PI(n,s),a=i.mean,o=i.variance;return[vm(n,a,o,t,e,r),a,o]})}function jne(n,e,t,s,r=.001){return ge(()=>{const i=PI(n,s),a=i.mean,o=i.variance,l=[];for(const b of Yi(0,n.rank))s.indexOf(b)!==-1?l.push(1):l.push(n.shape[b]);const u=ce(a,l),d=ce(o,l),f=e==null?null:ce(e,l),m=t==null?null:ce(t,l);return[vm(n,u,d,m,f,r),a,o]})}function Wne(n,e,t,s,r=.001){return Gt(s.slice().sort(),Yi(0,n.rank-1))?Une(n,e,t,s,r):jne(n,e,t,s,r)}class zV extends yt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=yn(e.betaInitializer||"zeros"),this.gammaInitializer=yn(e.gammaInitializer||"ones"),this.movingMeanInitializer=yn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=yn(e.movingVarianceInitializer||"ones"),this.betaConstraint=es(e.betaConstraint),this.gammaConstraint=es(e.gammaConstraint),this.betaRegularizer=bn(e.betaRegularizer),this.gammaRegularizer=bn(e.gammaRegularizer)}build(e){e=Ot(e);const t=this.axis>=0?this.axis:this.axis+e.length,s=e[t];if(s==null)throw new te(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Zn({ndim:e.length,axes:{[t]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return ge(()=>{const s=t.training==null?!1:t.training,r=rt(e),i=r.shape,a=i.length,o=Yi(0,a),l=this.axis>=0?this.axis:this.axis+a;o.splice(l,1);const u=Mu(1,a);u[l]=i[l];const d=o.slice();d.sort();const f=!Gt(d,Yi(0,a).slice(0,a-1)),m=()=>{if(f){const E=ce(this.movingMean.read(),u),$=ce(this.movingVariance.read(),u),C=this.center?ce(this.beta.read(),u):null,O=this.scale?ce(this.gamma.read(),u):null;return vm(r,E,$,C,O,this.epsilon)}else return vm(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return m();const[y,b,w]=Wne(r,this.gamma.read(),this.beta.read(),o,this.epsilon),x=(E,$,C)=>{ge(()=>{const O=1-C,V=E.read(),F=se(tt(V,$),O);E.write(tt(V,F))})};return(()=>{x(this.movingMean,b,this.momentum),x(this.movingVariance,w,this.momentum)})(),y})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vn(this.betaInitializer),gammaInitializer:vn(this.gammaInitializer),movingMeanInitializer:vn(this.movingMeanInitializer),movingVarianceInitializer:vn(this.movingVarianceInitializer),betaRegularizer:rn(this.betaRegularizer),gammaRegularizer:rn(this.gammaRegularizer),betaConstraint:Jn(this.betaConstraint),gammaConstraint:Jn(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}zV.className="BatchNormalization";Ae(zV);class UV extends yt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=yn(e.betaInitializer||"zeros"),this.gammaInitializer=yn(e.gammaInitializer||"ones"),this.betaRegularizer=bn(e.betaRegularizer),this.gammaRegularizer=bn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ot(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=t);for(const i of this.axis)if(i<0||i>=t)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Zl(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(i=>e[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){const s=rt(e),r=s.shape,i=r.length;return ge(()=>{let{mean:o,variance:l}=PI(s,this.axis,!0);const u=Mu(1,i);for(const w of this.axis)u[w]=r[w];const d=w=>w!=null&&w.shape.length!==i?ce(w,u):w;let f=this.scale?d(this.gamma.read()):null,m=this.center?d(this.beta.read()):null;const y=[],b=[];for(let w=0;w<i;++w)this.axis.indexOf(w)!==-1?(y.push(r[w]),b.push(1)):(y.push(1),b.push(r[w]));return o=ji(o,y),l=ji(l,y),f!=null&&(f=ji(f,b)),m!=null&&(m=ji(m,b)),vm(s,o,l,m,f,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vn(this.betaInitializer),gammaInitializer:vn(this.gammaInitializer),betaRegularizer:rn(this.betaRegularizer),gammaRegularizer:rn(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}UV.className="LayerNormalization";Ae(UV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gne(n,e,t){return ge(()=>{if(n.rank!==4)throw new te(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new te("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=Qi()),t!=="channelsLast"&&t!=="channelsFirst")throw new te(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return t==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],MI(n,s)})}class jV extends yt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Qi():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new te(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,s;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new te(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new te(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[t,s]}this.inputSpec=[new Zn({ndim:4})]}computeOutputShape(e){e=Ot(e);let t,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],t,s]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],t,s,e[3]])}call(e,t){return ge(()=>Gne(rt(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}jV.className="ZeroPadding2D";Ae(jV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function t1(n,e,t,s,r,i){return ge(()=>{Pn(r),sM(i),Zr(s),t==null&&(t=[1,1]),s==null&&(s="valid"),r==null&&(r=Qi()),i==null&&(i="max"),n=z$(n,r);let a;const o=s==="same"?"same":"valid";return i==="max"?a=LI(n,e,t,o):a=II(n,e,t,o),r==="channelsFirst"&&(a=It(a,[0,3,1,2])),a})}function WV(n,e,t,s,r,i){return ge(()=>{Pn(r),sM(i),Zr(s),t==null&&(t=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Qi()),i==null&&(i="max"),n=iV(n,r);let a;const o=s==="same"?"same":"valid";return i==="max"?a=oY(n,e,t,o):a=c7(n,e,t,o),r==="channelsFirst"&&(a=It(a,[0,4,1,2,3])),a})}class GV extends yt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new te(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(us(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new te(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);us(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Zr(this.padding),this.inputSpec=[new Zn({ndim:3})]}computeOutputShape(e){e=Ot(e);const t=Hi(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return ge(()=>{this.invokeCallHook(e,t),e=Xg(rt(e),2);const s=this.poolingFunction(rt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return jg(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class HV extends GV{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Pn(i),Zr(r),t1(e,t,s,r,i,"max")}}HV.className="MaxPooling1D";Ae(HV);class qV extends GV{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Pn(i),Zr(r),t1(e,t,s,r,i,"avg")}}qV.className="AveragePooling1D";Ae(qV);class KV extends yt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new te(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];us(this.poolSize,"poolSize"),us(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Pn(this.dataFormat),Zr(this.padding),this.inputSpec=[new Zn({ndim:4})]}computeOutputShape(e){e=Ot(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=Hi(t,this.poolSize[0],this.padding,this.strides[0]),s=Hi(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s]:[e[0],t,s,e[3]]}call(e,t){return ge(()=>(this.invokeCallHook(e,t),this.poolingFunction(rt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class XV extends KV{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Pn(i),Zr(r),t1(e,t,s,r,i,"max")}}XV.className="MaxPooling2D";Ae(XV);class YV extends KV{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Pn(i),Zr(r),t1(e,t,s,r,i,"avg")}}YV.className="AveragePooling2D";Ae(YV);class QV extends yt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new te(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];us(this.poolSize,"poolSize"),us(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Pn(this.dataFormat),Zr(this.padding),this.inputSpec=[new Zn({ndim:5})]}computeOutputShape(e){e=Ot(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=Hi(t,this.poolSize[0],this.padding,this.strides[0]),s=Hi(s,this.poolSize[1],this.padding,this.strides[1]),r=Hi(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s,r]:[e[0],t,s,r,e[4]]}call(e,t){return ge(()=>(this.invokeCallHook(e,t),this.poolingFunction(rt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class ZV extends QV{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Pn(i),Zr(r),WV(e,t,s,r,i,"max")}}ZV.className="MaxPooling3D";Ae(ZV);class JV extends QV{constructor(e){super(e)}poolingFunction(e,t,s,r,i){return Pn(i),Zr(r),WV(e,t,s,r,i,"avg")}}JV.className="AveragePooling3D";Ae(JV);class eB extends yt{constructor(e){super(e),this.inputSpec=[new Zn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new ct}}class tB extends eB{constructor(e){super(e||{})}call(e,t){return ge(()=>{const s=rt(e);return Un(s,1)})}}tB.className="GlobalAveragePooling1D";Ae(tB);class nB extends eB{constructor(e){super(e||{})}call(e,t){return ge(()=>{const s=rt(e);return Gi(s,1)})}}nB.className="GlobalMaxPooling1D";Ae(nB);class sB extends yt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Pn(this.dataFormat),this.inputSpec=[new Zn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new ct}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class rB extends sB{call(e,t){return ge(()=>{const s=rt(e);return this.dataFormat==="channelsLast"?Un(s,[1,2]):Un(s,[2,3])})}}rB.className="GlobalAveragePooling2D";Ae(rB);class iB extends sB{call(e,t){return ge(()=>{const s=rt(e);return this.dataFormat==="channelsLast"?Gi(s,[1,2]):Gi(s,[2,3])})}}iB.className="GlobalMaxPooling2D";Ae(iB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class aB extends yt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,s={}){const r=t.layer,i=Ao(r,s);delete t.layer;const a={layer:i};return Object.assign(a,t),new e(a)}}class oB extends aB{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ot(e),e.length<3)throw new te(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ot(e);const t=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(t),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,t){return ge(()=>(e=rt(e),gV((a,o)=>[rt(this.layer.call(a,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}oB.className="TimeDistributed";Ae(oB);function Hne(n){nh(fte,"BidirectionalMergeMode",n)}const qne="concat";class lB extends aB{constructor(e){super(e);const t=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=t,this.forwardLayer=Ao(s),t.goBackwards=t.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=Ao(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?qne:e.mergeMode,Hne(this.mergeMode),e.weights)throw new ct("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,s=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let s,r,i;return this.returnState&&(i=t.slice(1)),s=t[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[s].concat(i).concat(i.slice()):xr(r)}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const i=mV(e,s,r,this.numConstants);if(e=i.inputs,s=i.initialState,r=i.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,t);const a=[],o=[];if(s!=null){const u=s.length;if(u%2>0)throw new te("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=s,a.push(...s);const d=s.map(f=>new Zn({shape:f.shape}));this.forwardLayer.stateSpec=d.slice(0,u/2),this.backwardLayer.stateSpec=d.slice(u/2),o.push(...d)}if(r!=null)throw new ct("Support for constants in Bidirectional layers is not implemented yet.");const l=a[0]instanceof Ba;for(const u of a)if(u instanceof Ba!==l)throw new te("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(a),d=this.inputSpec.concat(o),f=this.inputSpec;this.inputSpec=d;const m=super.apply(u,t);return this.inputSpec=f,m}else return super.apply(e,t)}call(e,t){return ge(()=>{const s=t.initialState;let r,i;if(s==null)r=this.forwardLayer.call(e,t),i=this.backwardLayer.call(e,t);else{const l=s.slice(0,s.length/2),u=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(t,{initialState:u}))}let a;this.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=Lu(i,1));let o;return this.mergeMode==="concat"?o=C$([r,i]):this.mergeMode==="sum"?o=Oe(r,i):this.mergeMode==="ave"?o=se(.5,Oe(r,i)):this.mergeMode==="mul"?o=se(r,i):this.mergeMode==null&&(o=[r,i]),this.returnState?this.mergeMode==null?o.concat(a):[o].concat(a):o})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){vu(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),vu(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[t,t]:s=t:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const i=this.forwardLayer.states.map(a=>null);return Array.isArray(s)?s.concat(i).concat(i):[s].concat(i).concat(i)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const s=Ao(t.layer);if(delete t.layer,t.numConstants!=null)throw new ct("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=s,new e(r)}}lB.className="Bidirectional";Ae(lB);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cB extends yt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return ge(()=>(e=rt(e),e.dtype!=="float32"&&(e=Da(e,"float32")),Oe(se(e,this.scale),this.offset)))}}cB.className="Rescaling";Ae(cB);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Kne,cropAndResize:Xne}=Co;class uB extends yt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,s,r,i,a,o,l){return ge(()=>{let u,d=!1;const f=t/a,m=s/o,y=(r+t)/a,b=(i+s)/o,w=[f,m,y,b],x=[];e.rank===3?(d=!0,u=Po([e])):u=e;for(let O=0;O<u.shape[0];O++)x.push(w);const T=_P(x,[x.length,4]),E=gm(0,x.length,1,"int32"),C=Xne(u,T,E,[r,i],"nearest");return Da(d?rt(Pu(C)):C,l)})}upsize(e,t,s,r){return ge(()=>{const i=Kne(e,[t,s]);return Da(i,r)})}call(e,t){return ge(()=>{const s=rt(e),r=s.dtype,i=s.shape,a=i[i.length-3],o=i[i.length-2];let l=0;a!==this.height&&(l=Math.floor((a-this.height)/2));let u=0;return o!==this.width&&(u=Math.floor((o-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(s,l,u,this.height,this.width,a,o,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Ot(e);const t=e.length-3,s=e.length-2;return e[t]=this.height,e[s]=this.width,e}}uB.className="CenterCrop";Ae(uB);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yne(n,e,t,s){let r=rt(n);if(r.dtype!=="int32"&&(r=Da(r,"int32")),e==="int")return r;const i=r.shape;if(r.rank===0&&(r=br(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=br(r,-1)),r.rank>2)throw new te(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${r.rank}.`);const a=["multiHot","oneHot"].includes(e),o=r;let l;if(typeof s<"u"&&e==="count"?l=NR(o,s,t,a):l=NR(o,[],t,a),e!=="tfIdf")return l;if(s)return se(l,s);throw new te("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class hB extends yt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=Ot(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return ge(()=>{e=rt(e),e.dtype!=="int32"&&(e=Da(e,"int32"));let s;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new te(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);s=rt(t.countWeights)}const r=Gi(e),i=V0(e),a=Qr(this.numTokens,r).bufferSync().get(0),o=Ju(i,0).bufferSync().get(0);if(!(a&&o))throw new te(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return Yne(e,this.outputMode,this.numTokens,s)})}}hB.className="CategoryEncoding";Ae(hB);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Qne=["bilinear","nearest"],gD=new Set(Qne);class dB extends yt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(gD.has(e.interpolation))this.interpolation=e.interpolation;else throw new te(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Ot(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return ge(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Co.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Co.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...gD]} are supported`)})}}dB.className="Resizing";Ae(dB);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fB{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}fB.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class pB extends yt{constructor(e){super(e),this.randomGenerator=new fB(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}pB.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Zne=["bilinear","nearest"],yD=new Set(Zne);class mB extends pB{constructor(e){super(e);const{factor:t,interpolation:s="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new te(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new te(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new te(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(yD.has(s))this.interpolation=s;else throw new te(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Ot(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return ge(()=>{const s=rt(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Ug([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*r;i=Math.round(i);const a=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Co.resizeBilinear(e,a);case"nearest":return Co.resizeNearestNeighbor(e,a);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...yD]} are supported`)}})}}mB.className="RandomWidth";Ae(mB);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jne=xe();Jne.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var bD;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(bD||(bD={}));var xD;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(xD||(xD={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var vD;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(vD||(vD={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function We(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&H(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ese=c3;class n1 extends N_{nextDataId(){return n1.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new DL(this,va())}write(e,t,s){this.firstUse&&(this.firstUse=!1,xe().get("IS_NODE")&&Hr(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&jm(s[0])){const i=s.map(a=>Ql(a));r=this.write(i,e,t)}else r=this.write(s,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,s,r,i){this.data.set(e,{values:t,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:s}=this.data.get(e);if(t==="complex64"){const r=this.readSync(s.real.dataId),i=this.readSync(s.imag.dataId);return Mo(r,i)}return T9(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>tc(r));return mt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return mt(e.shape,e.dtype,t)}makeOutput(e,t,s){return va().makeTensorFromTensorInfo(this.makeTensorInfo(t,s,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=yr();return e(),{kernelMs:yr()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){We([e],"where");const t=this.readSync(e.dataId);return ese(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}n1.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gB(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const tse=n=>{const{x:e}=n.inputs,t=n.backend;We(e,"abs");let s=new Float32Array(Ee(e.shape));const r=t.data.get(e.dataId).values;return s=gB(r),t.makeOutput(s,e.shape,e.dtype)},nse={kernelName:Ox,backendName:"cpu",kernelFunc:tse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mn(n){return(e,t,s,r,i)=>{const a=ot(e,t),o=a.length,l=Ye(a),u=Ee(a),d=Vs(i,u),f=e.length,m=t.length,y=Ye(e),b=Ye(t),w=$d(e,a),x=$d(t,a);if(w.length+x.length===0)for(let T=0;T<d.length;++T)d[T]=n(s[T%s.length],r[T%r.length]);else for(let T=0;T<d.length;++T){const E=ef(T,o,l),$=E.slice(-f);w.forEach(F=>$[F]=0);const C=ka($,f,y),O=E.slice(-m);x.forEach(F=>O[F]=0);const V=ka(O,m,b);d[T]=n(s[C],r[V])}return[d,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kr(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,i=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values,o=t.makeTensorInfo(s.shape,"complex64"),l=t.data.get(o.dataId);return l.complexTensorInfos={real:t.makeTensorInfo(s.shape,"float32",i),imag:t.makeTensorInfo(r.shape,"float32",a)},o}const sse={kernelName:U_,backendName:"cpu",kernelFunc:kr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J0(n,e,t="float32"){if(t==="complex64"){const r=J0(n,e,"float32"),i=J0(n,e,"float32");return kr({inputs:{real:r,imag:i},backend:n})}const s=Bs(Ee(e),t);return n.makeTensorInfo(e,t,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function za(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const rse={kernelName:ug,backendName:"cpu",kernelFunc:za};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vu(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.real,i=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,i)}const ise={kernelName:dI,backendName:"cpu",kernelFunc:Vu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yB(n,e,t,s){if(s==="int32"){const r=Int32Array.from(n);return[e,"int32",r]}if(s==="bool"){const r=Zu([0],t),[i,a]=Mn((o,l)=>o!==l?1:0)(e,[],n,r,"bool");return[a,"bool",i]}throw new Error(`Error in Cast: failed to cast ${t} to ${s}`)}function ac(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return za({inputs:{x:r},backend:t});const d=J0(t,r.shape,r.dtype),f=ac({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),m=kr({inputs:{real:f,imag:d},backend:t});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f),m}if(r.dtype==="complex64"){const d=Vu({inputs:{input:r},backend:t}),f=ac({inputs:{x:d},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(d),f}if(!LL(r.dtype,i)){const d=za({inputs:{x:r},backend:t});return{dataId:d.dataId,shape:d.shape,dtype:i}}const a=t.data.get(r.dataId).values,[o,l,u]=yB(a,r.shape,r.dtype,i);return t.makeTensorInfo(o,l,u)}const ase={kernelName:Qm,backendName:"cpu",kernelFunc:ac};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ns(n,e,t,s){return t==null?({inputs:r,backend:i})=>{const{a,b:o}=r,l=i;We([a,o],n);const u=l.data.get(a.dataId).values,d=l.data.get(o.dataId).values,f=a.dtype==="string"?Vo(u):u,m=a.dtype==="string"?Vo(d):d,y=s||a.dtype,[b,w]=e(a.shape,o.shape,f,m,y);return l.makeTensorInfo(w,y,b)}:({inputs:r,backend:i})=>{const{a,b:o}=r,l=i;if(a.dtype==="complex64"||o.dtype==="complex64"){const u=ac({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),d=l.data.get(u.dataId),f=d.complexTensorInfos.real,m=d.complexTensorInfos.imag,y=l.data.get(f.dataId).values,b=l.data.get(m.dataId).values,w=ac({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),x=l.data.get(w.dataId),T=x.complexTensorInfos.real,E=x.complexTensorInfos.imag,$=l.data.get(T.dataId).values,C=l.data.get(E.dataId).values,[O,V,F]=t(a.shape,o.shape,y,b,$,C),R=l.makeTensorInfo(F,"float32",O),N=l.makeTensorInfo(F,"float32",V),D=kr({inputs:{real:R,imag:N},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(w),l.disposeIntermediateTensorInfo(R),l.disposeIntermediateTensorInfo(N),D}else{const u=l.data.get(a.dataId).values,d=l.data.get(o.dataId).values,f=s||a.dtype,[m,y]=e(a.shape,o.shape,u,d,f);return l.makeTensorInfo(y,f,m)}}}function X$(n){return(e,t,s,r,i,a)=>{const o=ot(e,t),l=Ee(o),u=o.length,d=Ye(o),f=Vs("float32",l),m=Vs("float32",l),y=$d(e,o),b=$d(t,o),w=Mo(s,r),x=Mo(i,a),T=e.length,E=Ye(e),$=t.length,C=Ye(t);if(y.length+b.length===0)for(let O=0;O<f.length;O++){const V=O%w.length,F=O%x.length,R=n(w[V*2],w[V*2+1],x[F*2],x[F*2+1]);f[O]=R.real,m[O]=R.imag}else for(let O=0;O<f.length;O++){const V=ef(O,u,d),F=V.slice(-T);y.forEach(z=>F[z]=0);const R=ka(F,T,E),N=V.slice(-$);b.forEach(z=>N[z]=0);const D=ka(N,$,C),k=n(w[R*2],w[R*2+1],x[D*2],x[D*2+1]);f[O]=k.real,m[O]=k.imag}return[f,m,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bB=Mn((n,e)=>n+e),ose=X$((n,e,t,s)=>({real:n+t,imag:e+s})),Ad=ns(tf,bB,ose),lse={kernelName:tf,backendName:"cpu",kernelFunc:Ad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$(n,e,t,s,r){const i=Ee(s),a=Bs(r,t);for(let o=0;o<n.length;o++){const l=n[o];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(i>0?a[l]+=e[o]:a[l]+=1)}return a}function xB(n,e,t,s=!1){const r=n.shape[0],i=n.shape[1],a=mt([r,t],e.dtype);for(let o=0;o<r;o++)for(let l=0;l<i;l++){const u=n.get(o,l);if(u<0)throw new Error("Input x must be non-negative!");u>=t||(s?a.set(1,o,u):e.size>0?a.set(a.get(o,u)+e.get(o,l),o,u):a.set(a.get(o,u)+1,o,u))}return a}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vB=Mn((n,e)=>n&e),cse=ns(z_,vB),use={kernelName:z_,backendName:"cpu",kernelFunc:cse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ha(n){return(e,t,s)=>{const r=Rn(t,e.length);for(let i=0;i<e.length;++i)r[i]=n(e[i],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qt(n,e,t){const s=Ha(e);return Sc(n,s,t)}function Sc(n,e,t){return({inputs:s,attrs:r,backend:i})=>{const{x:a}=s;We(a,n);const o=i,l=o.data.get(a.dataId).values;let u;if(a.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=Vo(l)}else u=l;const d=t||a.dtype,f=e(u,d,r);return o.makeTensorInfo(a.shape,d,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wB=Ha(n=>Math.ceil(n)),hse=Sc(Zm,wB),dse={kernelName:Zm,backendName:"cpu",kernelFunc:hse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SB(n,e,t,s){const r=Rn(t,Ee(e));if(s&&t!=="string"){let i=0;n.forEach(a=>{const o=Ee(a.shape);r.set(a.vals,i),i+=o})}else{let i=0;n.forEach(a=>{const o=t==="string"?Vo(a.vals):a.vals;let l=0;for(let u=0;u<a.shape[0];++u){const d=u*e[1]+i;for(let f=0;f<a.shape[1];++f)r[d+f]=o[l++]}i+=a.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TB=Mn((n,e)=>n===e?1:0),EB=ns(Xx,TB,null,"bool"),fse={kernelName:Xx,backendName:"cpu",kernelFunc:EB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _B=Ha(n=>Math.exp(n)),IB=Sc(ig,_B,"float32"),pse={kernelName:ig,backendName:"cpu",kernelFunc:IB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $B=Ha(n=>Math.expm1(n)),mse=Sc(ag,$B),gse={kernelName:ag,backendName:"cpu",kernelFunc:mse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CB=Ha(n=>Math.floor(n)),yse=Sc(og,CB),bse={kernelName:og,backendName:"cpu",kernelFunc:yse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NB=Mn((n,e)=>Math.floor(n/e)),xse=ns(lg,NB,null,"int32"),vse={kernelName:lg,backendName:"cpu",kernelFunc:xse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kB(n,e,t,s,r,i,a,o,l){const u=mt([s,i],t);for(let d=0;d<s;d++){const f=[];let m=0;for(let y=0;y<r;y++){const b=n[d*r+y];m+=b*a[y],f.push(b)}if(m<0||m>=l/i)throw new Error(`Invalid indices: ${f} does not index into ${o}`);for(let y=0;y<i;y++)u.values[d*i+y]=e.get(...e.indexToLoc(m*i+y))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AB(n,e,t){const s=mt(t,n.dtype);for(let r=0;r<s.size;++r){const a=s.indexToLoc(r).slice(),o=a[0],l=a[2],u=e.locToIndex([o,l]);a[2]=e.values[u];const d=n.locToIndex(a);0<=d&&d<n.values.length&&(s.values[r]=n.values[d])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RB=Mn((n,e)=>n>e?1:0),wse=ns(Jx,RB,null,"bool"),Sse={kernelName:Jx,backendName:"cpu",kernelFunc:wse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DB=Mn((n,e)=>n>=e?1:0),Tse=ns(cg,DB,null,"bool"),Ese={kernelName:cg,backendName:"cpu",kernelFunc:Tse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OB=Mn((n,e)=>n<e?1:0),_se=ns(tv,OB,null,"bool"),Ise={kernelName:tv,backendName:"cpu",kernelFunc:_se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FB=Mn((n,e)=>n<=e?1:0),$se=ns(nv,FB,null,"bool"),Cse={kernelName:nv,backendName:"cpu",kernelFunc:$se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LB(n,e,t){const s=(e-n)/(t-1),r=Bs(t,"float32");r[0]=n;for(let i=1;i<r.length;i++)r[i]=r[i-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PB=Ha(n=>Math.log(n)),Nse=Sc(pg,PB),kse={kernelName:pg,backendName:"cpu",kernelFunc:Nse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MB(n,e,t,s){const r=Vs(s,Ee(t));for(let i=0;i<r.length;++i){const a=i*e;let o=n[a];for(let l=0;l<e;++l){const u=n[a+l];(Number.isNaN(u)||u>o)&&(o=u)}r[i]=o}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VB=Mn((n,e)=>Math.max(n,e)),Ase=ns(gg,VB),Rse={kernelName:gg,backendName:"cpu",kernelFunc:Ase};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BB=Mn((n,e)=>Math.min(n,e)),Dse=ns(yg,BB),Ose={kernelName:yg,backendName:"cpu",kernelFunc:Dse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q$=Mn((n,e)=>n*e),Fse=X$((n,e,t,s)=>({real:n*t-e*s,imag:n*s+e*t})),s1=ns(xg,Q$,Fse),Lse={kernelName:xg,backendName:"cpu",kernelFunc:s1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zB(n,e,t){const s=mc(-1,t);return Q$([],e,s,n,t)}function Pse(n){const{inputs:e,backend:t}=n,{x:s}=e;We(s,"neg");const r=t.data.get(s.dataId).values,[i,a]=zB(r,s.shape,s.dtype);return t.makeTensorInfo(a,s.dtype,i)}const Mse={kernelName:fv,backendName:"cpu",kernelFunc:Pse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UB=Mn((n,e)=>n!==e?1:0),Vse=ns(pv,UB,null,"bool"),Bse={kernelName:pv,backendName:"cpu",kernelFunc:Vse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z$(n,e,t,s,r){const i=e.length,a=Ee(e),o=Ye(e),l=Ye(r),u=Vs(t,Ee(r));for(let d=0;d<a;++d){const f=ef(d,i,o),m=new Array(f.length);for(let b=0;b<m.length;b++)m[b]=f[s[b]];const y=ka(m,i,l);u[y]=n[d]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tr(n){const{inputs:e,attrs:t,backend:s}=n,{x:r}=e,{perm:i}=t;We(r,"transpose");const a=r.shape.length,o=new Array(a);for(let f=0;f<o.length;f++)o[f]=r.shape[i[f]];const l=s.data.get(r.dataId).values,u=Z$(l,r.shape,r.dtype,i,o);return{dataId:s.write(u,o,r.dtype),shape:o,dtype:r.dtype}}const zse={kernelName:dd,backendName:"cpu",kernelFunc:Tr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jB(n,e,t,s){const[r,i]=ps(n,s),a=Rr(e,"int32"),o=Bs(Ee(r),a),l=Ee(i);for(let u=0;u<o.length;++u){const d=u*l;let f=1;for(let m=0;m<l;++m)f*=t[d+m];o[u]=f}return{outVals:o,outShape:r,outDtype:a}}function Use(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;We(r,"prod");const o=r.shape.length,l=gt(i,r.shape),u=Sn(l,o);let d=l,f=r;const m=[];u!=null&&(f=Tr({inputs:{x:r},backend:t,attrs:{perm:u}}),m.push(f),d=Ln(d.length,o));const y=t.data.get(f.dataId).values,{outVals:b,outShape:w,outDtype:x}=jB(f.shape,f.dtype,y,d);let T=w;return a&&(T=jn(w,l)),m.forEach(E=>t.disposeIntermediateTensorInfo(E)),t.makeTensorInfo(T,x,b)}const jse={kernelName:vv,backendName:"cpu",kernelFunc:Use};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wse(n,e,t){n.forEach((s,r)=>{if(s<0||s>=t){const i=ef(r,e.length,Ye(e)).join(",");throw new Error(`indices[${i}] = ${s} is not in [0, ${t})`)}})}function Gse(n,e){for(let t=0;t<n.length;++t){const s=n[t],r=t===n.length-1?e:n[t+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let i=1;i<s.length;++i)if(s[i-1]>s[i])throw new Error("Ragged splits must be sorted in ascending order")}}function Hse(n,e,t,s){const r=[];let i=0;const a=e.length-1+t.length,o=new Array(a).fill(null).map(()=>[0]);Gse(t,s);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const d=e[u+1];for(let f=1;f<l+1;++f)o[u].push(f*d)}for(let u=0;u<n.length;++u){let d=n[u],f=n[u]+1;for(let m=0;m<t.length;++m){const y=t[m],b=m+e.length-1;if(b>=0){const w=o[b],x=w[w.length-1]-y[d];for(let T=d;T<f;++T)o[b].push(y[T+1]+x)}d=y[d],f=y[f]}f!==d&&(r.push([d,f]),i+=f-d)}return{outSplits:o,valueSlices:r,numValues:i}}function qse(n){const e=[];for(let t=0;t<n.length;++t){const s=n[t].length,r=Rn("int32",s);e.push(r),n[t].forEach((i,a)=>r[a]=i)}return e}function wD(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let s=e;s<n.length;s++)t[e-1]*=n[s];return t}function Kse(n,e,t,s,r,i){const a=wD(e,2)[1],o=wD(i,2)[1];let l=0;for(const u of t)for(let d=u[0];d<u[1];++d){for(let f=0;f<s;++f)r[l*o+f]=n[d*a+f];++l}}function Xse(n,e,t,s,r){const i=e.slice();i[0]=r;const a=Rn(t,Ee(i)),o=n.length,l=o===0?0:o/e[0];return Kse(n,e,s,l,a,i),[a,i]}function WB(n,e,t,s,r,i,a,o){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(Wse(i,a,l),s.length===0)throw new Error("params.rank must be nonzero");const u=s[0],{outSplits:d,valueSlices:f,numValues:m}=Hse(i,a,n,u),y=qse(d),b=Xse(t,s,r,f,m);return[y,b[0],b[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SD=2147483647;function GB(n,e,t,s,r,i,a){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(a.length>1)throw new Error("deltas must be a scalar or vector");const o=e.length===0,l=r.length===0,u=a.length===0,d=[];o||d.push(e[0]),l||d.push(r[0]),u||d.push(a[0]);for(let x=1;x<d.length;++x)if(d[x]!==d[x-1])throw new Error("starts, limits, and deltas must have the same shape");const f=d.length===0?1:d[0],m=Rn("int32",f+1);m[0]=0;for(let x=0;x<f;++x){const T=o?n[0]:n[x],E=l?s[0]:s[x],$=u?i[0]:i[x];if($===0)throw new Error("Requires delta != 0");let C;if($>0&&E<T||$<0&&E>T)C=0;else if(C=Math.ceil(Math.abs((E-T)/$)),C>SD)throw new Error(`Requires ((limit - start) / delta) <= ${SD}`);m[x+1]=m[x]+C}const y=m[f],b=Rn(t,y);let w=0;for(let x=0;x<f;++x){const T=m[x+1]-m[x];let E=o?n[0]:n[x];const $=u?i[0]:i[x];for(let C=0;C<T;++C)b[w++]=E,E+=$}return[m,b]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var gi=zi;class ex{constructor(e,t,s,r,i,a,o,l,u,d){this.shape=e,this.shapeShape=t,this.values=s,this.valuesShape=r,this.valuesDType=i,this.defaultValue=a,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=C3(d),this.raggedRank=N3(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===gi.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===gi.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case gi.VALUE_ROWIDS:return ex.getMaxWidthValueRowID(t);case gi.ROW_SPLITS:return ex.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${gi[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let s=0;for(let r=0;r<t-1;++r){const i=e[r+1]-e[r];i>s&&(s=i)}return s}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let s=0,r=e[0],i=0;for(let a=1;a<t;++a){const o=e[a];o!==r&&(r=o,i=Math.max(a-s,i),s=a)}return Math.max(t-s,i)}tensorShapeFromTensor(e,t,s=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return ED(e,s)}calculateOutputSize(e){const t=this.valuesShape,s=this.defaultValueShape;k3(s,t);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=$3(this.raggedRank,r,t);a[0]<0&&(a[0]=e);for(let o=1;o<=this.raggedRank;++o)a[o]<0&&(a[o]=this.getMaxWidth(o));return a}calculateFirstParentOutputIndex(e,t,s){const r=Math.min(e,s),i=[];let a=0;for(let o=0;o<r;++o,a+=t)i.push(a);for(let o=r;o<e;++o)i.push(-1);return H(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,t,s,r){const i=e.length,a=[];for(let o=0;o<i-1;++o){const l=e[o+1]-e[o];let u=Math.min(r,l),d=t[o];d===-1&&(u=0);for(let f=0;f<u;++f)a.push(d),d+=s;for(let f=0;f<l-u;++f)a.push(-1)}if(i>0&&a.length!==e[i-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(e,t,s,r){const i=e.length,a=[];if(i===0)return[];let o=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let u=t[l];a.push(u);for(let d=1;d<i;++d){const f=e[d];if(f===l)u>=0&&(++o,o<r?u+=s:u=-1);else{if(o=0,l=f,f>=t.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${t.length}`);u=t[f]}a.push(u)}if(a.length!==e.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(e,t,s,r){const i=this.getRowPartitionTensor(e),a=this.getRowPartitionTypeByDimension(e);switch(a){case gi.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,t,s,r);case gi.ROW_SPLITS:if(i.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(i,t,s,r);default:throw new Error(`Unsupported partition type: ${gi[a]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case gi.FIRST_DIM_SIZE:return e[0];case gi.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case gi.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${gi[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),s=this.calculateOutputSize(t),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const i=ED(s,!1),a=Rn(this.valuesDType,Ee(i));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(t,r[0],s[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,r[u],s[u]);this.setOutput(this.raggedRank,l,a,i)}return[i,a]}setOutput(e,t,s,r){if(s.length===0)return;const i=this.values,a=s;let o=r.slice();o=o.slice(e+1);const l=Ee(o),u=t.length;let d=this.defaultValue;if(d.length!==l&&d.length!==1){const b=this.defaultValueShape;ge(()=>{const w=ce(d,b);d=Jp(w,o).dataSync()})}let f=0,m=0,y=0;for(let b=0;b<=u;++b){let w=b<u?t[b]:-1;if(w===y){++y;continue}if(m<y){const x=i.subarray(f*l),T=a.subarray(m*l),E=(y-m)*l;TD(T,x,E)}if(b>=u){const x=s.length;w=Math.floor(x/l)}if(w>y)if(this.defaultValue.length===1)a.subarray(y*l,w*l).fill(this.defaultValue[0]),y=w;else for(;w>y;){const x=a.slice(y*l);TD(x,d,l),++y}w<0?(f=b+1,m=y):(f=b,m=y,y=m+1)}}}function TD(n,e,t){for(let s=0;s<t;s++)n[s]=e[s]}function ED(n,e){const t=[];for(let s of n){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}t.push(s)}return t}function HB(n,e,t,s,r,i,a,o,l,u){return new ex(n,e,t,s,r,i,a,o,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qB(n,e,t,s){const r=n===e,i=n<e&&t<0,a=e<n&&t>1;if(r||i||a)return Bs(0,s);const o=Math.abs(Math.ceil((e-n)/t)),l=Bs(o,s);e<n&&t===1&&(t=-1),l[0]=n;for(let u=1;u<l.length;u++)l[u]=l[u-1]+t;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KB=Ha(n=>1/Math.sqrt(n)),Yse=Sc(_g,KB),Qse={kernelName:_g,backendName:"cpu",kernelFunc:Yse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mu(n,e,t,s,r,i,a,o,l,u){const d=[s/r,r],f=n.values,m=e.values;if(s===0)return mt(t,e.dtype);const y=l instanceof _s?l:mt(d,e.dtype);typeof l=="string"||typeof l=="number"?y.values.fill(l):typeof l=="boolean"&&y.values.fill(+l);for(let b=0;b<i;b++){const w=[];let x=0;for(let T=0;T<a;T++){const E=f[b*a+T];w.push(E),x+=E*o[T]}if(x<0||x>=s/r)throw new Error(`Invalid indices: ${w} does not index into ${t}`);for(let T=0;T<r;T++)u?y.values[x*r+T]+=m[b*r+T]:y.values[x*r+T]=e.rank===0?m[0]:m[b*r+T]}return y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zse=Ha(n=>1/(1+Math.exp(-n))),XB=Qt(kg,n=>1/(1+Math.exp(-n))),Jse={kernelName:kg,backendName:"cpu",kernelFunc:XB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YB(n,e,t,s,r){const i=s$(s,e,t),a=Ee(t),o=Ye(s);if(i){const f=r$(e,o);return r==="string"?n.slice(f,f+a):n.subarray(f,f+a)}const l=r==="string"?Vo(n):n,u=mt(s,r,l),d=mt(t,r);for(let f=0;f<d.size;++f){const m=d.indexToLoc(f),y=m.map((b,w)=>b+e[w]);d.set(u.get(...y),...m)}return r==="string"?Y3(d.values):d.values}function Bu(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:i,size:a}=s;We(r,"slice");const[o,l]=Uv(r,i,a);t$(r,o,l);const u=t.data.get(r.dataId).values,d=YB(u,o,l,r.shape,r.dtype);return t.makeTensorInfo(l,r.dtype,d)}const ere={kernelName:Iv,backendName:"cpu",kernelFunc:Bu};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QB(n,e,t,s,r,i,a){const o=e[0],l=i[0],u=new Array(l),d=new Array(o),f=e[1];if(l===0){if(o!==0)throw new Error(P3(o));const x=Rn(t,0),T=Rn(r,0);return[x,[0,f],T,u,d]}let m=!0,y=0;const b=new Array(l).fill(0);for(let x=0;x<o;++x){const T=n[x*f];if(T<0)throw new Error(M3(x,T));if(T>=l)throw new Error(V3(x,T,l));++b[T],m=m&&T>=y,y=T}let w=!0;for(let x=0;x<l;++x){const T=b[x]===0;u[x]=T,w=w&&!T,b[x]=Math.max(b[x],1),x>0&&(b[x]+=b[x-1])}if(w&&m){const x=n,T=s;for(let E=0;E<o;++E)d[E]=E;return[x,[o,f],T,u,d]}else{const x=b[l-1],T=Rn(t,x*f),E=Rn(r,x),$=new Array(l).fill(0);for(let C=0;C<o;++C){const O=n[C*f],V=$[O],F=(O===0?0:b[O-1])+V;$[O]++;for(let R=0;R<f;++R)T[F*f+R]=n[C*f+R];E[F]=s[C],d[C]=F}for(let C=0;C<l;++C)if($[C]===0){const V=C===0?0:b[C-1];T[V*f+0]=C;for(let F=1;F<f;++F)T[V*f+F]=0;E[V]=a}return[T,[x,f],E,u,d]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(n,e,t,s,r){const i=Ee(s),a=e[0],o=r.length,l=[];let u=1,d=-1;for(let x=0;x<o;++x){const T=r[x];if(T===-1){if(d!==-1)throw new Error(B3(d,x));d=x,l.push(1)}else{if(T<0)throw new Error(z3(x,T));u*=T,l.push(T)}}if(d!==-1){if(u<=0)throw new Error(U3());const x=Math.trunc(i/u);if(u*x!==i)throw new Error(j3(s,l));l[d]=x}if(Ee(l)!==i)throw new Error(W3(s,l));const m=s.length,y=[];if(m>0){y[m-1]=1;for(let x=m-2;x>=0;--x)y[x]=y[x+1]*s[x+1]}const b=[];if(o>0){b[o-1]=1;for(let x=o-2;x>=0;--x)b[x]=b[x+1]*l[x+1]}const w=Rn(t,a*o);for(let x=0;x<a;++x){let T=0;for(let E=0;E<m;++E)T+=n[x*m+E]*y[E];for(let E=0;E<o;++E)w[x*o+E]=Math.trunc(T/b[E]),T%=b[E]}return[w,[a,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$(n,e,t,s,r,i=!1,a=0){const o=s.length,l=[e[0],n.length/e[0]],u=l[1],f=o>0?r[o-1]+1:0;if(f<0)throw new Error(QT());const m=e.slice();m[0]=f;const y=m.reduce(($,C)=>$*C,1),b=Rn(t,y);if(o===0)return f>0&&b.fill(a),[b,m];if(f<=0)throw new Error(QT());let w=0,x=1,T=0,E=r[w];for(;;){let $=0;if(x<o){if($=r[x],E===$){++x;continue}if(E>=$)throw new Error(G3())}if(E<0||E>=f)throw new Error(H3(E,f));E>T&&b.fill(a,T*u,E*u);for(let C=w;C<x;++C){const O=s[C];if(O<0||O>=l[0])throw new Error(q3(C,s[C],l[0]));for(let V=0;V<u;V++)b[E*u+V]+=n[O*u+V]}if(i)for(let C=0;C<u;C++)b[E*u+C]/=x-w;if(w=x,++x,T=E+1,E=$,x>o)break}return T<f&&b.fill(a,T*u,f*u),[b,m]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tre=Ha(n=>Math.sqrt(n)),nre=Qt(Rg,n=>Math.sqrt(n)),sre={kernelName:Rg,backendName:"cpu",kernelFunc:nre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JB=Mn((n,e)=>{const t=n-e;return t*t}),rre=ns(Dg,JB),ire={kernelName:Dg,backendName:"cpu",kernelFunc:rre};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ez=Ha((n,e)=>{const{pattern:t,replaceGlobal:s,rewrite:r}=e;return n.replace(new RegExp(t,s?"g":""),r)}),are=Sc(gI,ez),ore={kernelName:gI,backendName:"cpu",kernelFunc:are};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(n,e,t,s){const r=mt(n,e.dtype);for(let i=0;i<r.size;i++){const a=r.indexToLoc(i),o=new Array(a.length);for(let l=0;l<o.length;l++)o[l]=a[l]*t[l]+s[l];r.set(e.get(...o),...a)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lre{constructor(e,t,s,r,i,a){this.separator=Ql(e),this.nGramWidths=t,this.leftPad=Ql(s),this.rightPad=Ql(r),this.padWidth=i,this.preserveShort=a}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const s=this.getPadWidth(t);return Math.max(0,e+2*s-t+1)}createNGrams(e,t,s,r,i,a){for(let o=0;o<i;++o){const l=this.getPadWidth(a),u=Math.max(0,l-o),d=Math.max(0,l-(i-(o+1))),f=a-(u+d),m=t+(u>0?0:o-l);let y=0;y+=u*this.leftPad.length;for(let E=0;E<f;++E)y+=e[m+E].length;y+=d*this.rightPad.length;const b=u+d+f-1;y+=b*this.separator.length,s[r+o]=new Uint8Array(y);const w=s[r+o];let x=0;const T=E=>E.forEach($=>w[x++]=$);for(let E=0;E<u;++E)T(this.leftPad),T(this.separator);for(let E=0;E<f-1;++E)T(e[m+E]),T(this.separator);if(f>0){T(e[m+f-1]);for(let E=0;E<d;++E)T(this.separator),T(this.rightPad)}else{for(let E=0;E<d-1;++E)T(this.rightPad),T(this.separator);T(this.rightPad)}}}compute(e,t){const s=e.length,r=t.length;if(r>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<r;++u){let d=t[u]>=l;if(d=d&&t[u]<=s,!d)throw new Error(`Invalid split value ${t[u]}, must be in [${l}, ${s}]`);l=t[u]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const i=r-1,a=Rn("int32",r);if(s===0||r===0){const l=new Array(s);for(let u=0;u<=i;++u)a[u]=0;return[l,a]}a[0]=0;for(let l=1;l<=i;++l){const u=t[l]-t[l-1];let d=0;this.nGramWidths.forEach(f=>{d+=this.getNumNGrams(u,f)}),this.preserveShort&&u>0&&d===0&&(d=1),a[l]=a[l-1]+d}const o=new Array(a[i]);for(let l=0;l<i;++l){const u=t[l];let d=a[l];if(this.nGramWidths.forEach(f=>{const m=t[l+1]-t[l],y=this.getNumNGrams(m,f);this.createNGrams(e,u,o,d,y,f),d+=y}),this.preserveShort&&d===a[l]){const f=t[l+1]-t[l];if(f===0)continue;const m=f+2*this.padWidth;this.createNGrams(e,u,o,d,1,m)}}return[o,a]}}function nz(n,e,t,s,r,i,a,o){return new lre(t,s,r,i,a,o).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cre(n,e,t,s){if(!n.length)return;if(e.length===0){for(let i=0;i<n.length;++i)s.push(n.subarray(i,i+1));return}if(e.length===1){const i=e[0];let a=n.indexOf(i);for(;a!==-1;){const o=n.subarray(0,a);(!t||o.length!==0)&&s.push(o),n=n.subarray(a+1),a=n.indexOf(i)}(!t||n.length!==0)&&s.push(n);return}let r=0;for(let i=0;i<n.length+1;i++)if(i===n.length||e.indexOf(n[i])!==-1){const a=n.subarray(r,i);(!t||a.length!==0)&&s.push(a),r=i+1}}function sz(n,e,t){const s=n.length,r=[];let i=0,a=0;const o=new Array(s);for(let m=0;m<s;++m){const y=r.length;cre(n[m],e,t,r);const b=r.length-y;o[m]=b,i+=b,a=Math.max(a,b)}const l=Rn("int32",i*2),u=new Array(i),d=[s,a];let f=0;for(let m=0;m<s;++m)for(let y=0;y<o[m];++y)l[f*2]=m,l[f*2+1]=y,u[f]=r[f],++f;return[l,u,d]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(n,e){const t=Rn("int32",n.length);for(let s=0;s<n.length;++s)t[s]=U9(n[s]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iz=Mn((n,e)=>n-e),ure=X$((n,e,t,s)=>({real:n-t,imag:e-s})),eC=ns(Og,iz,ure),hre={kernelName:Og,backendName:"cpu",kernelFunc:eC};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function az(n,e){const t=new Array(n.rank);for(let r=0;r<t.length;r++)t[r]=n.shape[r]*e[r];const s=mt(t,n.dtype);for(let r=0;r<s.values.length;++r){const i=s.indexToLoc(r),a=new Array(n.rank);for(let l=0;l<a.length;l++)a[l]=i[l]%n.shape[l];const o=n.locToIndex(a);s.values[r]=n.values[o]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jp=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function oz(n,e,t=0,s=n.length-1){for(;s>t;){if(s-t>600){const o=s-t+1,l=e-t+1,u=Math.log(o),d=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*d*(o-d)/o)*Math.sign(l-o/2),m=Math.max(t,Math.floor(e-l*d/o+f)),y=Math.min(s,Math.floor(e+(o-l)*d/o+f));oz(n,e,m,y)}const r=n[e];let i=t,a=s;for(Jh(n,t,e),jp(n[s],r)>0&&Jh(n,t,s);i<a;){for(Jh(n,i,a),i++,a--;jp(n[i],r)<0;)i=i+1;for(;jp(n[a],r)>0;)a=a-1}jp(n[t],r)===0?Jh(n,t,a):(a=a+1,Jh(n,a,s)),a<=e&&(t=a+1),e<=a&&(s=a-1)}}function lz(n,e,t,s,r){const i=e[e.length-1],[a,o]=[n.length/i,i],l=Vs(t,a*s),u=Vs("int32",a*s);for(let f=0;f<a;f++){const m=f*o,y=n.subarray(m,m+o);let b=new Array(y.length);y.forEach((E,$)=>b[$]={value:E,index:$}),s<b.length&&(oz(b,s),b=b.slice(0,s)),r&&b.sort(jp);const w=f*s,x=l.subarray(w,w+s),T=u.subarray(w,w+s);for(let E=0;E<s;E++)x[E]=b[E].value,T[E]=b[E].index}const d=e.slice();return d[d.length-1]=s,[mt(d,t,l),mt(d,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cz(n,e,t,s){const r=gt(e,t)[0],i=[1,t[0],1];for(let b=0;b<r;b++)i[0]*=t[b];i[1]=t[r];for(let b=r+1;b<t.length;b++)i[2]*=t[b];const a=new Map,o=new Int32Array(t[r]),l=new _s(i,s,n),u=[],d=i[0]===1&&i[2]===1;for(let b=0;b<t[r];b++){let w;if(d)w=n[b].toString();else{const T=[];for(let E=0;E<i[0];E++)for(let $=0;$<i[2];$++)T.push(l.get(E,b,$));w=T.join(",")}const x=a.get(w);if(x!=null)o[b]=x;else{const T=a.size;a.set(w,T),o[b]=T,u.push(b)}}const f=i.slice();f[1]=a.size;const m=new _s(f,s);u.forEach((b,w)=>{for(let x=0;x<i[0];x++)for(let T=0;T<i[2];T++)m.set(l.get(x,b,T),x,w,T)});const y=t.slice();return y[r]=f[1],{outputValues:m.values,outputShape:y,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dre=Object.freeze(Object.defineProperty({__proto__:null,addImpl:bB,bincountImpl:Y$,bincountReduceImpl:xB,bitwiseAndImpl:vB,castImpl:yB,ceilImpl:wB,concatImpl:SB,equalImpl:TB,expImpl:_B,expm1Impl:$B,floorDivImpl:NB,floorImpl:CB,gatherNdImpl:kB,gatherV2Impl:AB,greaterEqualImpl:DB,greaterImpl:RB,lessEqualImpl:FB,lessImpl:OB,linSpaceImpl:LB,logImpl:PB,maxImpl:MB,maximumImpl:VB,minimumImpl:BB,multiplyImpl:Q$,negImpl:zB,notEqualImpl:UB,prodImpl:jB,raggedGatherImpl:WB,raggedRangeImpl:GB,raggedTensorToTensorImpl:HB,rangeImpl:qB,rsqrtImpl:KB,scatterImpl:mu,sigmoidImpl:Zse,simpleAbsImpl:gB,sliceImpl:YB,sparseFillEmptyRowsImpl:QB,sparseReshapeImpl:ZB,sparseSegmentReductionImpl:J$,sqrtImpl:tre,squaredDifferenceImpl:JB,staticRegexReplaceImpl:ez,stridedSliceImpl:tz,stringNGramsImpl:nz,stringSplitImpl:sz,stringToHashBucketFastImpl:rz,subImpl:iz,tileImpl:az,topKImpl:lz,transposeImpl:Z$,uniqueImpl:cz},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */IP("cpu",()=>new n1,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uz=Qt(sg,n=>n>=0?n:Math.exp(n)-1),fre={kernelName:sg,backendName:"cpu",kernelFunc:uz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hz(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:i}=s;We([r],"leakyRelu");const a=Ee(r.shape),o=t.data.get(r.dataId).values,l=Vs("float32",a);for(let u=0;u<o.length;u++)l[u]=o[u]<0?i*o[u]:o[u];return t.makeTensorInfo(r.shape,"float32",l)}const pre={kernelName:ev,backendName:"cpu",kernelFunc:hz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mre=Mn((n,e)=>n<0?e*n:n);function dz(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e;We([s,r],"prelu");const i=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values,[o,l]=mre(s.shape,r.shape,i,a,"float32");return t.makeTensorInfo(l,"float32",o)}const gre={kernelName:xv,backendName:"cpu",kernelFunc:dz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fz=Qt(Sg,n=>Math.max(0,n)),yre={kernelName:Sg,backendName:"cpu",kernelFunc:fz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pz=Qt(Tg,n=>Math.min(Math.max(0,n),6)),bre={kernelName:Tg,backendName:"cpu",kernelFunc:pz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tx(n,e,t,s,r){if(t==="linear")return za({inputs:{x:e},backend:n});if(t==="relu")return fz({inputs:{x:e},backend:n});if(t==="elu")return uz({inputs:{x:e},backend:n});if(t==="relu6")return pz({inputs:{x:e},backend:n});if(t==="prelu")return dz({inputs:{x:e,alpha:s},backend:n});if(t==="leakyrelu")return hz({inputs:{x:e},backend:n,attrs:{alpha:r}});if(t==="sigmoid")return XB({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function un(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:i}=s,a=Ee(r.shape),o=FL(i,a),l=Ee(o);H(a===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`),t.incRef(r.dataId);const u=t.data.get(r.dataId);if(u.complexTensorInfos!=null){const d=u.complexTensorInfos.real,f=u.complexTensorInfos.imag;d.shape=o,f.shape=o}return{dataId:r.dataId,shape:o,dtype:r.dtype}}const xre={kernelName:wv,backendName:"cpu",kernelFunc:un};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mz(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:i}=e,{transposeA:a,transposeB:o}=s;We([r,i],"matMul");const l=r.shape.length,u=i.shape.length,d=a?r.shape[l-2]:r.shape[l-1],f=o?i.shape[u-1]:i.shape[u-2],m=a?r.shape[l-1]:r.shape[l-2],y=o?i.shape[u-2]:i.shape[u-1],b=r.shape.slice(0,-2),w=i.shape.slice(0,-2),x=Ee(b),T=Ee(w),$=ot(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([m,y]);H(d===f,()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${r.shape} and ${i.shape} and transposeA=${a} and transposeB=${o} must match.`);const C=a?[x,d,m]:[x,m,d],O=o?[T,y,f]:[T,f,y],V=un({inputs:{x:r},backend:t,attrs:{shape:C}}),F=un({inputs:{x:i},backend:t,attrs:{shape:O}}),R=a?V.shape[1]:V.shape[2],N=a?V.shape[2]:V.shape[1],D=o?F.shape[1]:F.shape[2],k=Math.max(x,T),z=t.data.get(V.dataId).values,B=t.data.get(F.dataId).values,ne=Ye(V.shape),J=Ye(F.shape),[K,re,Z]=a?[ne[0],1,ne[1]]:[ne[0],ne[1],1],[he,W,ee]=o?[1,J[1],J[0]]:[J[1],1,J[0]],me=N*D,de=mt([k,N,D],V.dtype),be=de.values,_e=t.blockSize;for(let Ne=0;Ne<k;Ne++){const Ve=Ne%x,Le=Ne%T;for(let Be=0;Be<N;Be+=_e){const je=Math.min(Be+_e,N);for(let Qe=0;Qe<D;Qe+=_e){const ft=Math.min(Qe+_e,D);for(let pt=0;pt<R;pt+=_e){const Mt=Math.min(pt+_e,R);for(let Tt=Be;Tt<je;Tt++)for(let bt=Qe;bt<ft;bt++){let qt=0;for(let Vt=pt;Vt<Mt;Vt++){const qs=z[Ve*K+Tt*re+Vt*Z],hn=B[Vt*he+bt*W+Le*ee];qt+=qs*hn}be[Ne*me+(Tt*D+bt)]+=qt}}}}}return t.disposeIntermediateTensorInfo(V),t.disposeIntermediateTensorInfo(F),t.makeTensorInfo($,de.dtype,de.values)}const vre={kernelName:Vx,backendName:"cpu",kernelFunc:mz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wre(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:i,bias:a,preluActivationWeights:o}=e,{transposeA:l,transposeB:u,activation:d,leakyreluAlpha:f}=s;let m,y,b;const w=[];m=mz({inputs:{a:r,b:i},attrs:{transposeA:l,transposeB:u},backend:t}),a&&(y=Ad({inputs:{a:m,b:a},backend:t}),w.push(m),m=y),d&&(b=tx(t,m,d,o,f),w.push(m),m=b);for(const T of w)t.disposeIntermediateTensorInfo(T);return m}const Sre={kernelName:F0,backendName:"cpu",kernelFunc:wre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tre=Qt(Wm,n=>Math.acos(n)),Ere={kernelName:Wm,backendName:"cpu",kernelFunc:Tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _re=Qt(Gm,n=>Math.acosh(n)),Ire={kernelName:Gm,backendName:"cpu",kernelFunc:_re};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $re(n){const{inputs:e,backend:t}=n,s=e;We(e,"addN");const r=s.map(o=>t.data.get(o.dataId).values),i=mt(s[0].shape,s[0].dtype),a=i.values;for(let o=0;o<s.length;o++){const l=r[o];for(let u=0;u<a.length;u++)a[u]+=l[u]}return t.makeTensorInfo(i.shape,i.dtype,i.values)}const Cre={kernelName:F_,backendName:"cpu",kernelFunc:$re};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;We(r,"all");const o=gt(i,r.shape);let l=o;const u=Sn(l,r.shape.length);let d=r;u!=null&&(d=Tr({inputs:{x:r},backend:t,attrs:{perm:u}}),l=Ln(l.length,r.shape.length)),Ns("all",l,d.shape.length);const[f,m]=ps(d.shape,l),y=Ee(m),b=Bs(Ee(f),d.dtype),w=t.data.get(d.dataId).values;for(let T=0;T<b.length;++T){const E=T*y;let $=w[E];for(let C=0;C<y;++C){const O=w[E+C];$=$&&O}b[T]=$}u!=null&&t.disposeIntermediateTensorInfo(d);const x=t.makeTensorInfo(f,d.dtype,b);if(a){const T=jn(f,o),E=un({inputs:{x},backend:t,attrs:{shape:T}});return t.disposeIntermediateTensorInfo(x),E}return x}const kre={kernelName:L_,backendName:"cpu",kernelFunc:Nre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Are(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;We(r,"any");const o=gt(i,r.shape);let l=o;const u=Sn(l,r.shape.length);let d=r;u!=null&&(d=Tr({inputs:{x:r},backend:t,attrs:{perm:u}}),l=Ln(l.length,r.shape.length)),Ns("any",l,d.shape.length);const[f,m]=ps(d.shape,l),y=Ee(m),b=Bs(Ee(f),d.dtype),w=t.data.get(d.dataId).values;for(let T=0;T<b.length;++T){const E=T*y;let $=w[E];for(let C=0;C<y;++C){const O=w[E+C];$=$||O}b[T]=$}u!=null&&t.disposeIntermediateTensorInfo(d);const x=t.makeTensorInfo(f,d.dtype,b);if(a){const T=jn(f,o),E=un({inputs:{x},backend:t,attrs:{shape:T}});return t.disposeIntermediateTensorInfo(x),E}return x}const Rre={kernelName:P_,backendName:"cpu",kernelFunc:Are};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i}=s;We(r,"argMax");let a=gt(i,r.shape);const o=Sn(a,r.shape.length);let l=r;const u=[];o!=null&&(l=Tr({inputs:{x:r},backend:t,attrs:{perm:o}}),u.push(l),a=Ln(a.length,l.shape.length)),a=[a[0]],Ns("argMax",a,l.shape.length);const[d,f]=ps(l.shape,a),m=Ee(d),y=Bs(m,"int32"),b=Ee(f),w=t.data.get(l.dataId).values;for(let x=0;x<y.length;++x){const T=x*b;let E=w[T],$=0;for(let C=0;C<b;++C){const O=w[T+C];O>E&&(E=O,$=C)}y[x]=$}return u.forEach(x=>t.disposeIntermediateTensorInfo(x)),t.makeTensorInfo(d,"int32",y)}const Ore={kernelName:Fx,backendName:"cpu",kernelFunc:Dre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i}=s;We(r,"argMin");let a=gt(i,r.shape);const o=Sn(a,r.shape.length);let l=r;const u=[];o!=null&&(l=Tr({inputs:{x:r},backend:t,attrs:{perm:o}}),u.push(l),a=Ln(a.length,l.shape.length)),a=[a[0]],Ns("argMin",a,l.shape.length);const[d,f]=ps(l.shape,a),m=Ee(d),y=Bs(m,"int32"),b=Ee(f),w=t.data.get(l.dataId).values;for(let x=0;x<y.length;++x){const T=x*b;let E=w[T],$=0;for(let C=0;C<b;++C){const O=w[T+C];O<E&&(E=O,$=C)}y[x]=$}return u.forEach(x=>t.disposeIntermediateTensorInfo(x)),t.makeTensorInfo(d,"int32",y)}const Lre={kernelName:Lx,backendName:"cpu",kernelFunc:Fre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pre=Qt(Hm,n=>Math.asin(n)),Mre={kernelName:Hm,backendName:"cpu",kernelFunc:Pre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vre=Qt(qm,n=>Math.asinh(n)),Bre={kernelName:qm,backendName:"cpu",kernelFunc:Vre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zre=Qt(Km,n=>Math.atan(n)),Ure={kernelName:Km,backendName:"cpu",kernelFunc:zre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jre=Mn((n,e)=>Math.atan2(n,e)),Wre=ns(Ym,jre),Gre={kernelName:Ym,backendName:"cpu",kernelFunc:Wre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hre=Qt(Xm,n=>Math.atanh(n)),qre={kernelName:Xm,backendName:"cpu",kernelFunc:Hre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tC(n,e,t,s,r,i){const a=r.strideHeight,o=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,m=r.padInfo.top,y=r.padInfo.left,b=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=mt(r.outShape,t),x=w.values,T=r.outShape[1]*r.outShape[2]*r.outShape[3],E=r.outShape[2]*r.outShape[3],$=r.outShape[3];for(let C=0;C<r.batchSize;++C){const O=C*T,V=C*s[0];for(let F=0;F<r.inChannels;++F)for(let R=0;R<r.outHeight;++R){const N=R*a-m,D=Math.max(0,N),k=Math.min(r.inHeight,d+N),z=O+R*E;for(let B=0;B<r.outWidth;++B){const ne=B*o-y,J=Math.max(0,ne),K=Math.min(r.inWidth,f+ne);let re=b,Z=0,he=0;for(let ee=D;ee<k;ee+=l){const me=V+ee*s[1];for(let de=J;de<K;de+=u){const be=me+de*s[2],_e=n[be+F];i==="max"&&_e>re?re=_e:i==="avg"&&(Z+=_e,he++)}if(isNaN(re))break}const W=z+B*$+F;x[W]=i==="avg"?Z/he:re}}}return w}function gz(n,e,t,s,r=!1,i=!1){const a=mt(s.outShape,"int32"),o=s.strideHeight,l=s.strideWidth,u=s.dilationHeight,d=s.dilationWidth,f=s.effectiveFilterHeight,m=s.effectiveFilterWidth,y=s.padInfo.top,b=s.padInfo.left,w=mt(e,t,n);for(let x=0;x<s.batchSize;++x)for(let T=0;T<s.inChannels;++T)for(let E=0;E<s.outHeight;++E){const $=E*o-y;let C=$;for(;C<0;)C+=u;const O=Math.min(s.inHeight,f+$);for(let V=0;V<s.outWidth;++V){const F=V*l-b;let R=F;for(;R<0;)R+=d;const N=Math.min(s.inWidth,m+F);let D=Number.NEGATIVE_INFINITY,k=-1;for(let z=C;z<O;z+=u){const B=z-$;for(let ne=R;ne<N;ne+=d){const J=ne-F,K=w.get(x,z,ne,T);K>D&&(D=K,r?k=i?((x*s.inHeight+z)*s.inWidth+ne)*s.inChannels+T:(z*s.inWidth+ne)*s.inChannels+T:k=B*m+J)}}a.set(k,x,E,V,T)}}return a}function yz(n,e,t,s,r,i){const a=r.strideDepth,o=r.strideHeight,l=r.strideWidth,u=r.dilationDepth,d=r.dilationHeight,f=r.dilationWidth,m=r.effectiveFilterDepth,y=r.effectiveFilterHeight,b=r.effectiveFilterWidth,w=r.padInfo.front,x=r.padInfo.top,T=r.padInfo.left,E=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,$=mt(r.outShape,t),C=$.values,O=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],V=r.outShape[2]*r.outShape[3]*r.outShape[4],F=r.outShape[3]*r.outShape[4],R=r.outShape[4];for(let N=0;N<r.batchSize;++N){const D=N*O,k=N*s[0];for(let z=0;z<r.inChannels;++z)for(let B=0;B<r.outDepth;++B){const ne=B*a-w;let J=ne;for(;J<0;)J+=u;const K=Math.min(r.inDepth,m+ne),re=D+B*V;for(let Z=0;Z<r.outHeight;++Z){const he=Z*o-x;let W=he;for(;W<0;)W+=d;const ee=Math.min(r.inHeight,y+he),me=re+Z*F;for(let de=0;de<r.outWidth;++de){const be=de*l-T;let _e=be;for(;_e<0;)_e+=f;const Ne=Math.min(r.inWidth,b+be),Ve=me+de*R;let Le=E,Be=0,je=0;for(let ft=J;ft<K;ft+=u){const pt=k+ft*s[1];for(let Mt=W;Mt<ee;Mt+=d){const Tt=pt+Mt*s[2];for(let bt=_e;bt<Ne;bt+=f){const qt=Tt+bt*s[3],Vt=n[qt+z];if(i==="max"&&Vt>Le?Le=Vt:i==="avg"&&(Be+=Vt,je++),isNaN(Le))break}if(isNaN(Le))break}if(isNaN(Le))break}const Qe=Ve+z;C[Qe]=i==="avg"?Be/Math.max(je,1):Le}}}}return $}function Kre(n,e){const t=mt(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,a=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,y=e.padInfo.top,b=e.padInfo.left;for(let w=0;w<e.batchSize;++w)for(let x=0;x<e.inChannels;++x)for(let T=0;T<e.outDepth;++T){const E=T*s-m;let $=E;for(;$<0;)$+=a;const C=Math.min(e.inDepth,u+E);for(let O=0;O<e.outHeight;++O){const V=O*r-y;let F=V;for(;F<0;)F+=o;const R=Math.min(e.inHeight,d+V);for(let N=0;N<e.outWidth;++N){const D=N*i-b;let k=D;for(;k<0;)k+=l;const z=Math.min(e.inWidth,f+D);let B=Number.NEGATIVE_INFINITY,ne=-1;for(let J=$;J<C;J+=a){const K=J-E;for(let re=F;re<R;re+=o){const Z=re-V;for(let he=k;he<z;he+=l){const W=he-D,ee=n.get(w,J,re,he,x);ee>=B&&(B=ee,ne=K*d*f+Z*d+W)}}}t.set(ne,w,T,O,N,x)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;We(r,"avgPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=s,u=1;H(js(a,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const d=$i(r.shape,i,a,u,o,l);let f;if(d.filterWidth===1&&d.filterHeight===1&&Gt(d.inShape,d.outShape))f=za({inputs:{x:r},backend:t});else{const m=t.data.get(r.dataId).values,y=Ye(r.shape),b=tC(m,r.shape,r.dtype,y,d,"avg");f=t.makeTensorInfo(d.outShape,r.dtype,b.values)}return f}const Yre={kernelName:Px,backendName:"cpu",kernelFunc:Xre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l,dataFormat:u}=s;We(r,"avgPool3d");const d=Ho(r.shape,i,a,1,o,l,u),f=t.data.get(r.dataId).values,m=yz(f,r.shape,r.dtype,Ye(r.shape),d,"avg");return t.makeTensorInfo(m.shape,"float32",m.values)}const Zre={kernelName:Mx,backendName:"cpu",kernelFunc:Qre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jre(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:u}=s;We([r,i],"avgPool3DGrad");const d=Ho(i.shape,a,o,1,l,u),f=d.strideDepth,m=d.strideHeight,y=d.strideWidth,b=d.filterDepth,w=d.filterHeight,x=d.filterWidth,T=d.dilationDepth,E=d.dilationHeight,$=d.dilationWidth,C=d.effectiveFilterDepth,O=d.effectiveFilterHeight,V=d.effectiveFilterWidth,F=C-1-d.padInfo.front,R=V-1-d.padInfo.left,N=O-1-d.padInfo.top,D=mt(i.shape,"float32"),k=1/(b*w*x),z=t.bufferSync(r);for(let B=0;B<d.batchSize;++B)for(let ne=0;ne<d.inChannels;++ne)for(let J=0;J<d.inDepth;++J)for(let K=0;K<d.inHeight;++K)for(let re=0;re<d.inWidth;++re){const Z=J-F,he=K-N,W=re-R;let ee=0;for(let me=0;me<C;me+=T){const de=(Z+me)/f;if(!(de<0||de>=d.outDepth||Math.floor(de)!==de))for(let be=0;be<O;be+=E){const _e=(he+be)/m;if(!(_e<0||_e>=d.outHeight||Math.floor(_e)!==_e))for(let Ne=0;Ne<V;Ne+=$){const Ve=(W+Ne)/y;if(Ve<0||Ve>=d.outWidth||Math.floor(Ve)!==Ve)continue;const Le=z.get(B,de,_e,Ve,ne);ee+=Le}}}D.set(ee*k,B,J,K,re,ne)}return t.makeTensorInfo(D.shape,D.dtype,D.values)}const eie={kernelName:V_,backendName:"cpu",kernelFunc:Jre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tie(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,a=i;We([r,i],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=s,d=$i(a.shape,o,l,1,u),f=d.strideHeight,m=d.strideWidth,y=d.filterHeight,b=d.filterWidth,w=d.dilationHeight,x=d.dilationWidth,T=d.effectiveFilterHeight,E=d.effectiveFilterWidth,$=E-1-d.padInfo.left,C=T-1-d.padInfo.top,O=mt(a.shape,"float32"),V=1/(y*b),F=t.data.get(r.dataId).values,R=mt(r.shape,"float32",F);for(let N=0;N<d.batchSize;++N)for(let D=0;D<d.inChannels;++D)for(let k=0;k<d.inHeight;++k)for(let z=0;z<d.inWidth;++z){const B=k-C,ne=z-$;let J=0;for(let K=0;K<T;K+=w){const re=(B+K)/f;if(!(re<0||re>=d.outHeight||Math.floor(re)!==re))for(let Z=0;Z<E;Z+=x){const he=(ne+Z)/m;if(he<0||he>=d.outWidth||Math.floor(he)!==he)continue;const W=R.get(N,re,he,D);J+=W}}O.set(J*V,N,k,z,D)}return t.makeTensorInfo(O.shape,O.dtype,O.values)}const nie={kernelName:M_,backendName:"cpu",kernelFunc:tie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,scale:i,offset:a,mean:o,variance:l}=e;H(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),H(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),H(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),We([r,o,l,i,a],"batchNorm");let{varianceEpsilon:u}=s;u==null&&(u=.001);const d=t.data.get(r.dataId).values,f=t.data.get(o.dataId).values,m=t.data.get(l.dataId).values,y=i?t.data.get(i.dataId).values:new Float32Array([1]),b=a?t.data.get(a.dataId).values:new Float32Array([0]),w=new Float32Array(d.length),x=b.length,T=y.length,E=m.length,$=f.length;let C=0,O=0,V=0,F=0;for(let R=0;R<d.length;++R)w[R]=b[C++]+(d[R]-f[O++])*y[V++]/Math.sqrt(m[F++]+u),C>=x&&(C=0),O>=$&&(O=0),V>=T&&(V=0),F>=E&&(F=0);return t.makeTensorInfo(r.shape,r.dtype,w)}const rie={kernelName:Qx,backendName:"cpu",kernelFunc:sie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:i,crops:a}=s;We([r],"batchToSpaceND");const o=i.reduce((T,E)=>T*E),l=Gg(r.shape,i,o),u=Hg(l.length,i.length),d=qg(r.shape,i,o),f=c$(a,i.length),m=u$(d,a,i.length),y=un({inputs:{x:r},backend:t,attrs:{shape:l}}),b=Tr({inputs:{x:y},backend:t,attrs:{perm:u}}),w=un({inputs:{x:b},backend:t,attrs:{shape:d}}),x=Bu({inputs:{x:w},backend:t,attrs:{begin:f,size:m}});return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(w),x}const aie={kernelName:Bx,backendName:"cpu",kernelFunc:iie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:i}=e,{size:a}=s,o=t.data.get(r.dataId).values,l=t.data.get(i.dataId).values,u=Y$(o,l,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,u)}const lie={kernelName:B_,backendName:"cpu",kernelFunc:oie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cie(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,i=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values,o=ot(Array.from(i),Array.from(a));return t.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const uie={kernelName:zL,backendName:"cpu",kernelFunc:cie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hie=Qt(Jm,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),die={kernelName:Jm,backendName:"cpu",kernelFunc:hie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fie=n=>{const{x:e}=n.inputs,t=n.backend,s=new Float32Array(Ee(e.shape)),r=t.data.get(e.dataId),i=r.complexTensorInfos.real,a=r.complexTensorInfos.imag,o=t.data.get(i.dataId).values,l=t.data.get(a.dataId).values;for(let u=0;u<o.length;u++){const d=o[u],f=l[u];s[u]=Math.hypot(d,f)}return t.makeOutput(s,e.shape,"float32")},pie={kernelName:zx,backendName:"cpu",kernelFunc:fie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rd(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.imag,i=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,i)}const mie={kernelName:rI,backendName:"cpu",kernelFunc:Rd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dd(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,i=gt(r,e[0].shape)[0],a=e.map(w=>w.shape);a$(a,i);let o=Ra(e.map(w=>w.shape),i);if(Ee(o)===0)return t.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(w=>Ee(w.shape)>0);if(l.length===1)return za({inputs:{x:l[0]},backend:t});if(l[0].dtype==="complex64"){const w=l.map(C=>Vu({inputs:{input:C},backend:t})),x=l.map(C=>Rd({inputs:{input:C},backend:t})),T=Dd({inputs:w,backend:t,attrs:{axis:i}}),E=Dd({inputs:x,backend:t,attrs:{axis:i}}),$=kr({inputs:{real:T,imag:E},backend:t});return w.forEach(C=>t.disposeIntermediateTensorInfo(C)),x.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.disposeIntermediateTensorInfo(T),t.disposeIntermediateTensorInfo(E),$}const u=l.map(w=>{const T=[-1,Ee(w.shape.slice(i))];return un({inputs:{x:w},backend:t,attrs:{shape:T}})}),d=u.map(w=>({vals:t.data.get(w.dataId).values,shape:w.shape}));o=Ra(u.map(w=>w.shape),1);const f=u[0].shape[0]===1,m=SB(d,o,e[0].dtype,f),y=Ra(l.map(w=>w.shape),i),b=t.makeTensorInfo(y,e[0].dtype,m);return u.forEach(w=>t.disposeIntermediateTensorInfo(w)),b}const gie={kernelName:Ux,backendName:"cpu",kernelFunc:Dd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bz(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dataFormat:l,dilations:u,dimRoundingMode:d}=s;We([r,i],"conv2d");const f=qo(l),m=Cs(r.shape,i.shape,a,u,o,d,!1,f),y=m.filterHeight,b=m.filterWidth,w=m.dilationHeight,x=m.dilationWidth,T=m.padInfo.left,E=m.padInfo.top,$=m.dataFormat==="channelsLast",C=new _s(m.outShape,r.dtype),O=Ye(r.shape),V=Ye(i.shape),F=O[0],R=$?O[1]:O[2],N=$?O[2]:1,D=$?1:O[1],k=C.strides[0],z=$?C.strides[1]:C.strides[2],B=$?C.strides[2]:1,ne=$?1:C.strides[1],J=t.data.get(r.dataId).values,K=t.data.get(i.dataId).values,re=C.values;for(let Z=0;Z<m.batchSize;++Z){const he=Z*F,W=Z*k;for(let ee=0;ee<m.outHeight;++ee){const me=W+ee*z,de=ee*m.strideHeight-E;for(let be=0;be<y;++be){const _e=de+be*w;if(_e<0||_e>=m.inHeight)continue;const Ne=be*V[0],Ve=he+_e*R;for(let Le=0;Le<m.outWidth;++Le){const Be=me+Le*B,je=Le*m.strideWidth-T;for(let Qe=0;Qe<b;++Qe){const ft=je+Qe*x;if(ft<0||ft>=m.inWidth)continue;const pt=Ne+Qe*V[1],Mt=Ve+ft*N;let Tt=pt;for(let bt=0;bt<m.inChannels;++bt){const qt=J[Mt+bt*D];for(let Vt=0;Vt<m.outChannels;++Vt)re[Be+Vt*ne]+=qt*K[Tt+Vt];Tt+=m.outChannels}}}}}}return t.makeTensorInfo(C.shape,C.dtype,re)}const yie={kernelName:jx,backendName:"cpu",kernelFunc:bz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:d}=s;We([r,i],"conv2dBackpropFilter");const f=qo(l),m=Cs(r.shape,d,a,1,o,u,!1,f),{strideHeight:y,strideWidth:b,filterHeight:w,filterWidth:x}=m,T=m.dataFormat==="channelsLast",E=new _s(m.filterShape,"float32"),$=m.padInfo.left,C=m.padInfo.top,O=t.data.get(r.dataId).values,V=t.data.get(i.dataId).values,F=new _s(r.shape,r.dtype,O),R=new _s(i.shape,i.dtype,V);for(let N=0;N<w;++N){const D=Math.max(0,Math.ceil((C-N)/y)),k=Math.min(m.outHeight,(m.inHeight+C-N)/y);for(let z=0;z<x;++z){const B=Math.max(0,Math.ceil(($-z)/b)),ne=Math.min(m.outWidth,(m.inWidth+$-z)/b);for(let J=0;J<m.inChannels;++J)for(let K=0;K<m.outChannels;++K){let re=0;for(let Z=0;Z<m.batchSize;++Z)for(let he=D;he<k;++he){const W=N+he*y-C;for(let ee=B;ee<ne;++ee){const me=z+ee*b-$;T?re+=F.get(Z,W,me,J)*R.get(Z,he,ee,K):re+=F.get(Z,J,W,me)*R.get(Z,K,he,ee)}}E.set(re,N,z,J,K)}}}return t.makeTensorInfo(E.shape,E.dtype,E.values)}const xie={kernelName:j_,backendName:"cpu",kernelFunc:bie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{inputShape:a,strides:o,pad:l,dataFormat:u,dimRoundingMode:d}=s;We([r,i],"conv2dBackpropInput");const f=Ye(i.shape),m=Ye(r.shape);let y=qo(u);const b=Cs(a,i.shape,o,1,l,d,!1,y),w=new _s(b.inShape,"float32"),x=w.values,T=t.data.get(r.dataId).values,E=t.data.get(i.dataId).values,[$,C,O]=f,{batchSize:V,filterHeight:F,filterWidth:R,inChannels:N,inHeight:D,inWidth:k,outChannels:z,outHeight:B,outWidth:ne,strideHeight:J,strideWidth:K}=b;y=b.dataFormat;const re=F-1-b.padInfo.top,Z=R-1-b.padInfo.left,he=y==="channelsLast",W=w.strides[0],ee=he?w.strides[1]:w.strides[2],me=he?w.strides[2]:1,de=he?1:w.strides[1],be=m[0],_e=he?m[1]:m[2],Ne=he?m[2]:1,Ve=he?1:m[1];for(let Le=0;Le<V;++Le)for(let Be=0;Be<N;++Be)for(let je=0;je<D;++je){const Qe=je-re,ft=Math.max(0,Math.ceil(Qe/J)),pt=Math.min(B,(F+Qe)/J);for(let Mt=0;Mt<k;++Mt){const Tt=Mt-Z,bt=Math.max(0,Math.ceil(Tt/K)),qt=Math.min(ne,(R+Tt)/K);let Vt=0;for(let hn=ft;hn<pt;++hn){const hr=hn*J-Qe;for(let As=bt;As<qt;++As){const Lr=As*K-Tt,dn=be*Le+_e*hn+Ne*As,_r=$*(F-1-hr)+C*(R-1-Lr)+O*Be;for(let en=0;en<z;++en){const an=T[dn+Ve*en],ms=E[_r+en];Vt+=an*ms}}}const qs=W*Le+ee*je+me*Mt+de*Be;x[qs]=Vt}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const wie={kernelName:Wx,backendName:"cpu",kernelFunc:vie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dilations:l}=s;We([r,i],"conv3d");const u=gc(r.shape,i.shape,a,l,o),{filterDepth:d,filterHeight:f,filterWidth:m,dilationDepth:y,dilationHeight:b,dilationWidth:w,padInfo:x}=u,T=x.front,E=x.left,$=x.top,C=new _s(u.outShape,r.dtype),O=t.data.get(r.dataId).values,V=t.data.get(i.dataId).values,F=C.values,R=Ye(r.shape),N=Ye(i.shape);for(let D=0;D<u.batchSize;++D){const k=D*R[0],z=D*C.strides[0];for(let B=0;B<u.outDepth;++B){const ne=z+B*C.strides[1],J=B*u.strideDepth-T;for(let K=0;K<d;++K){const re=J+K*y;if(re<0||re>=u.inDepth)continue;const Z=K*N[0],he=k+re*R[1];for(let W=0;W<u.outHeight;++W){const ee=ne+W*C.strides[2],me=W*u.strideHeight-$;for(let de=0;de<f;++de){const be=me+de*b;if(be<0||be>=u.inHeight)continue;const _e=Z+de*N[1],Ne=he+be*R[2];for(let Ve=0;Ve<u.outWidth;++Ve){const Le=ee+Ve*u.outChannels,Be=Ve*u.strideWidth-E;for(let je=0;je<m;++je){const Qe=Be+je*w;if(Qe<0||Qe>=u.inWidth)continue;const ft=_e+je*N[2],pt=Ne+Qe*u.inChannels;let Mt=ft;for(let Tt=0;Tt<u.inChannels;++Tt){const bt=O[pt+Tt];for(let qt=0;qt<u.outChannels;++qt)F[Le+qt]+=bt*V[Mt+qt];Mt+=u.outChannels}}}}}}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const Tie={kernelName:Gx,backendName:"cpu",kernelFunc:Sie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,pad:o,filterShape:l}=s;We([r,i],"conv3dBackpropFilterV2");const u=Ye(r.shape),d=Ye(i.shape),f=gc(r.shape,l,a,1,o),m=f.strideDepth,y=f.strideHeight,b=f.strideWidth,w=f.filterDepth,x=f.filterHeight,T=f.filterWidth,E=new _s(f.filterShape,"float32"),$=E.values,[C,O,V,F]=E.strides,R=t.data.get(i.dataId).values,[N,D,k,z]=d,B=t.data.get(r.dataId).values,[ne,J,K,re]=u,Z=f.padInfo.front,he=f.padInfo.left,W=f.padInfo.top;for(let ee=0;ee<w;++ee){const me=Math.max(0,Math.ceil((Z-ee)/m)),de=Math.min(f.outDepth,(f.inDepth+Z-ee)/m),be=ee*C;for(let _e=0;_e<x;++_e){const Ne=Math.max(0,Math.ceil((W-_e)/y)),Ve=Math.min(f.outHeight,(f.inHeight+W-_e)/y),Le=_e*O+be;for(let Be=0;Be<T;++Be){const je=Math.max(0,Math.ceil((he-Be)/b)),Qe=Math.min(f.outWidth,(f.inWidth+he-Be)/b),ft=Be*V+Le;for(let pt=0;pt<f.inChannels;++pt){const Mt=pt*F+ft;for(let Tt=0;Tt<f.outChannels;++Tt){let bt=0;for(let qt=0;qt<f.batchSize;++qt){const Vt=qt*ne,qs=qt*N;for(let hn=me;hn<de;++hn){const As=(ee+hn*m-Z)*J+Vt,Lr=hn*D+qs;for(let dn=Ne;dn<Ve;++dn){const en=(_e+dn*y-W)*K+As,an=dn*k+Lr;for(let ms=je;ms<Qe;++ms){const qa=(Be+ms*b-he)*re+en,Cc=ms*z+an;bt+=B[qa+pt]*R[Cc+Tt]}}}}$[Mt+Tt]=bt}}}}}return t.makeTensorInfo(E.shape,E.dtype,E.values)}const _ie={kernelName:W_,backendName:"cpu",kernelFunc:Eie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iie(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{pad:a,strides:o,inputShape:l}=s;We([r],"conv3dBackpropInputV2");const u=Ye(r.shape),d=Ye(i.shape),f=gc(l,i.shape,o,1,a),m=new _s(f.inShape,"float32"),y=m.values,[b,w,x,T]=m.strides,E=t.data.get(r.dataId).values,[$,C,O,V]=u,F=t.data.get(i.dataId).values,[R,N,D,k]=d,{batchSize:z,filterDepth:B,filterHeight:ne,filterWidth:J,inChannels:K,inDepth:re,inHeight:Z,inWidth:he,outChannels:W,outDepth:ee,outHeight:me,outWidth:de,strideDepth:be,strideHeight:_e,strideWidth:Ne}=f,Ve=B-1-f.padInfo.front,Le=ne-1-f.padInfo.top,Be=J-1-f.padInfo.left;for(let je=0;je<z;++je)for(let Qe=0;Qe<K;++Qe)for(let ft=0;ft<re;++ft){const pt=ft-Ve,Mt=Math.max(0,Math.ceil(pt/be)),Tt=Math.min(ee,(B+pt)/be);for(let bt=0;bt<Z;++bt){const qt=bt-Le,Vt=Math.max(0,Math.ceil(qt/_e)),qs=Math.min(me,(ne+qt)/_e);for(let hn=0;hn<he;++hn){const hr=hn-Be,As=Math.max(0,Math.ceil(hr/Ne)),Lr=Math.min(de,(J+hr)/Ne);let dn=0;for(let _r=Mt;_r<Tt;++_r){const en=_r*be-pt;for(let an=Vt;an<qs;++an){const ms=an*_e-qt;for(let sa=As;sa<Lr;++sa){const qa=sa*Ne-hr,Cc=$*je+C*_r+O*an+V*sa,Ka=R*(B-1-en)+N*(ne-1-ms)+D*(J-1-qa)+k*Qe;for(let Pr=0;Pr<W;++Pr){const gs=E[Cc+Pr],Nc=F[Ka+Pr];dn+=gs*Nc}}}}y[b*je+w*ft+x*bt+T*hn+Qe]=dn}}}return t.makeTensorInfo(m.shape,m.dtype,m.values)}const $ie={kernelName:G_,backendName:"cpu",kernelFunc:Iie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cie=Qt(eg,n=>Math.cos(n)),Nie={kernelName:eg,backendName:"cpu",kernelFunc:Cie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kie=Qt(tg,n=>Math.cosh(n)),Aie={kernelName:tg,backendName:"cpu",kernelFunc:kie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rie(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:i,boxInd:a}=e,{cropSize:o,method:l,extrapolationValue:u}=s,[d,f,m,y]=r.shape,b=i.shape[0],[w,x]=o,T=mt([b,w,x,y],"float32"),E=t.data.get(i.dataId).values,$=t.data.get(a.dataId).values,C=t.data.get(r.dataId).values,O=Ye(r.shape),V=Ye(T.shape);for(let F=0;F<b;F++){const R=F*4,N=E[R],D=E[R+1],k=E[R+2],z=E[R+3],B=$[F];if(B>=d)continue;const ne=w>1?(k-N)*(f-1)/(w-1):0,J=x>1?(z-D)*(m-1)/(x-1):0;for(let K=0;K<w;K++){const re=w>1?N*(f-1)+K*ne:.5*(N+k)*(f-1);if(re<0||re>f-1){for(let Z=0;Z<x;Z++)for(let he=0;he<y;he++){const W=he+Z*V[2]+K*V[1]+F*V[0];T.values[W]=u}continue}if(l==="bilinear"){const Z=Math.floor(re),he=Math.ceil(re),W=re-Z;for(let ee=0;ee<x;ee++){const me=x>1?D*(m-1)+ee*J:.5*(D+z)*(m-1);if(me<0||me>m-1){for(let Ne=0;Ne<y;Ne++){const Ve=Ne+ee*V[2]+K*V[1]+F*V[0];T.values[Ve]=u}continue}const de=Math.floor(me),be=Math.ceil(me),_e=me-de;for(let Ne=0;Ne<y;Ne++){let Ve=Ne+de*O[2]+Z*O[1]+B*O[0];const Le=C[Ve];Ve=Ne+be*O[2]+Z*O[1]+B*O[0];const Be=C[Ve];Ve=Ne+de*O[2]+he*O[1]+B*O[0];const je=C[Ve];Ve=Ne+be*O[2]+he*O[1]+B*O[0];const Qe=C[Ve],ft=Le+(Be-Le)*_e,pt=je+(Qe-je)*_e;Ve=Ne+ee*V[2]+K*V[1]+F*V[0],T.values[Ve]=ft+(pt-ft)*W}}}else for(let Z=0;Z<x;++Z){const he=x>1?D*(m-1)+Z*J:.5*(D+z)*(m-1);if(he<0||he>m-1){for(let me=0;me<y;me++){const de=me+Z*V[2]+K*V[1]+F*V[0];T.values[de]=u}continue}const W=Math.round(he),ee=Math.round(re);for(let me=0;me<y;me++){const de=me+W*O[2]+ee*O[1]+B*O[0],be=me+Z*V[2]+K*V[1]+F*V[0];T.values[be]=C[de]}}}}return t.makeTensorInfo(T.shape,T.dtype,T.values)}const Die={kernelName:q_,backendName:"cpu",kernelFunc:Rie};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,exclusive:a,reverse:o}=s;We(r,"cumprod");const l=Sn([i],r.shape.length);let u=r;l!=null&&(u=Tr({inputs:{x:r},backend:t,attrs:{perm:l}}));const d=Ln(1,r.shape.length)[0];if(d!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${d}`);const f=Rr(u.dtype,"int32"),m=R_(Ee(u.shape),f),y=t.data.get(u.dataId).values,b=u.shape[u.shape.length-1],w=o?(T,E)=>T+b-E-1:(T,E)=>T+E;for(let T=0;T<y.length;T+=b)for(let E=0;E<b;E++){const $=w(T,E);if(E===0)m[$]=a?1:y[$];else{const C=w(T,E-1);m[$]=a?y[C]*m[C]:y[$]*m[C]}}const x=t.makeTensorInfo(u.shape,f,m);if(l!=null){const T=yc(l),E=Tr({inputs:{x},backend:t,attrs:{perm:T}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(u),E}return x}const Fie={kernelName:H_,backendName:"cpu",kernelFunc:Oie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,exclusive:a,reverse:o}=s;We(r,"cumsum");const l=Sn([i],r.shape.length);let u=r;l!=null&&(u=Tr({inputs:{x:r},backend:t,attrs:{perm:l}}));const d=Ln(1,r.shape.length)[0];if(d!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${d}`);const f=Rr(u.dtype,"int32"),m=Bs(Ee(u.shape),f),y=t.data.get(u.dataId).values,b=u.shape[u.shape.length-1],w=o?(T,E)=>T+b-E-1:(T,E)=>T+E;for(let T=0;T<y.length;T+=b)for(let E=0;E<b;E++){const $=w(T,E);if(E===0)m[$]=a?0:y[$];else{const C=w(T,E-1);m[$]=a?y[C]+m[C]:y[$]+m[C]}}const x=t.makeTensorInfo(u.shape,f,m);if(l!=null){const T=yc(l),E=Tr({inputs:{x},backend:t,attrs:{perm:T}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(u),E}return x}const Pie={kernelName:Hx,backendName:"cpu",kernelFunc:Lie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:i}=e,{size:a,binaryOutput:o}=s;if(r.shape.length===1){const l=t.data.get(r.dataId).values,u=t.data.get(i.dataId).values,d=Y$(l,u,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,d)}else if(r.shape.length===2){const l=t.bufferSync(r),u=t.bufferSync(i),d=xB(l,u,a,o);return t.makeTensorInfo(d.shape,i.dtype,d.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Vie={kernelName:K_,backendName:"cpu",kernelFunc:Mie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:i,dataFormat:a}=s;H(a==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${a}`);const o=r.shape[0],l=r.shape[1],u=r.shape[2],d=r.shape[3],f=l*i,m=u*i,y=d/(i*i),b=t.data.get(r.dataId).values,w=new Float32Array(o*f*m*y);let x=0;for(let T=0;T<o;++T)for(let E=0;E<f;++E){const $=Math.floor(E/i),C=E%i;for(let O=0;O<m;++O){const V=Math.floor(O/i),F=O%i,R=(C*i+F)*y;for(let N=0;N<y;++N){const k=N+R+d*(V+u*($+l*T));w[x++]=b[k]}}}return t.makeTensorInfo([o,f,m,y],r.dtype,w)}const zie={kernelName:X_,backendName:"cpu",kernelFunc:Bie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xz(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dilations:l,dimRoundingMode:u}=s;We([r,i],"depthwiseConv2DNative");const d=Ye(r.shape),f=Ye(i.shape);let m=l;m==null&&(m=[1,1]),H(js(a,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${m}'`);const y=Cs(r.shape,i.shape,a,m,o,u,!0),{filterHeight:b,filterWidth:w,dilationHeight:x,dilationWidth:T,padInfo:E}=y,$=E.left,C=E.top,O=y.outChannels/y.inChannels,V=new _s(y.outShape,r.dtype),F=t.data.get(r.dataId).values,R=t.data.get(i.dataId).values,N=V.values;for(let D=0;D<y.batchSize;++D){const k=D*d[0],z=D*V.strides[0];for(let B=0;B<y.outHeight;++B){const ne=z+B*V.strides[1],J=B*y.strideHeight-C;for(let K=0;K<b;++K){const re=J+K*x;if(re<0||re>=y.inHeight)continue;const Z=K*f[0],he=k+re*d[1];for(let W=0;W<y.outWidth;++W){const ee=ne+W*V.strides[2],me=W*y.strideWidth-$;for(let de=0;de<w;++de){const be=me+de*T;if(be<0||be>=y.inWidth)continue;const _e=Z+de*f[1],Ne=he+be*y.inChannels;let Ve=ee,Le=_e;for(let Be=0;Be<y.inChannels;++Be){const je=F[Ne+Be];for(let Qe=0;Qe<O;++Qe)N[Ve+Qe]+=je*R[Le+Qe];Ve+=O,Le+=O}}}}}}return t.makeTensorInfo(V.shape,V.dtype,V.values)}const Uie={kernelName:qx,backendName:"cpu",kernelFunc:xz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:u,filterShape:d}=s;We([r,i],"depthwiseConv2dNativeBackpropFilter");const f=Cs(r.shape,d,a,o,l,u,!0),{strideHeight:m,strideWidth:y,filterHeight:b,filterWidth:w}=f,x=new _s(f.filterShape,"float32"),T=f.padInfo.left,E=f.padInfo.top,$=f.outChannels/f.inChannels,C=t.data.get(r.dataId).values,O=new _s(r.shape,r.dtype,C),V=t.data.get(i.dataId).values,F=new _s(i.shape,i.dtype,V);for(let R=0;R<b;++R){const N=Math.max(0,Math.ceil((E-R)/m)),D=Math.min(f.outHeight,(f.inHeight+E-R)/m);for(let k=0;k<w;++k){const z=Math.max(0,Math.ceil((T-k)/y)),B=Math.min(f.outWidth,(f.inWidth+T-k)/y);for(let ne=0;ne<f.outChannels;++ne){const J=Math.trunc(ne/$),K=ne%$;let re=0;for(let Z=0;Z<f.batchSize;++Z)for(let he=N;he<D;++he){const W=R+he*m-E;for(let ee=z;ee<B;++ee){const me=k+ee*y-T;re+=O.get(Z,W,me,J)*F.get(Z,he,ee,ne)}}x.set(re,R,k,J,K)}}}return t.makeTensorInfo(x.shape,x.dtype,x.values)}const Wie={kernelName:Y_,backendName:"cpu",kernelFunc:jie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gie(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:u,inputShape:d}=s;We([r,i],"depthwiseConv2DNativeBackpropInput");const f=Ye(r.shape),m=Ye(i.shape),y=Cs(d,i.shape,a,o,l,u,!0),b=new _s(y.inShape,"float32"),w=b.values,[x,T,E]=b.strides,$=t.data.get(r.dataId).values,[C,O,V]=f,F=t.data.get(i.dataId).values,[R,N,D]=m,{batchSize:k,filterHeight:z,filterWidth:B,inChannels:ne,inHeight:J,inWidth:K,outChannels:re,outHeight:Z,outWidth:he,strideHeight:W,strideWidth:ee}=y,me=z-1-y.padInfo.top,de=B-1-y.padInfo.left,be=re/ne;for(let _e=0;_e<k;++_e)for(let Ne=0;Ne<ne;++Ne)for(let Ve=0;Ve<J;++Ve){const Le=Ve-me,Be=Math.max(0,Math.ceil(Le/W)),je=Math.min(Z,(z+Le)/W);for(let Qe=0;Qe<K;++Qe){const ft=Qe-de,pt=Math.max(0,Math.ceil(ft/ee)),Mt=Math.min(he,(B+ft)/ee);let Tt=0;for(let bt=Be;bt<je;++bt){const qt=bt*W-Le;for(let Vt=pt;Vt<Mt;++Vt){const qs=Vt*ee-ft,hn=C*_e+O*bt+V*Vt,hr=R*(z-1-qt)+N*(B-1-qs)+D*Ne;for(let As=0;As<be;++As){const Lr=Ne*be+As,dn=$[hn+Lr],_r=F[hr+As];Tt+=dn*_r}}}w[x*_e+T*Ve+E*Qe+Ne]=Tt}}return t.makeTensorInfo(b.shape,b.dtype,b.values)}const Hie={kernelName:Q_,backendName:"cpu",kernelFunc:Gie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qie(n){const{inputs:e,backend:t}=n,{x:s}=e,r=Ee(s.shape),i=t.data.get(s.dataId).values,a=mt([r,r],s.dtype),o=a.values;for(let u=0;u<i.length;u++)o[u*r+u]=i[u];const l=[...s.shape,...s.shape];return t.makeTensorInfo(l,a.dtype,a.values)}const Kie={kernelName:UL,backendName:"cpu",kernelFunc:qie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xie={kernelName:Kx,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r}=n,{strides:i,pad:a,dilations:o}=t,l=e,u=l.data.get(s.dataId).values,d=s.shape.length,f=l.data.get(r.dataId).values,m=r.shape.length,{batchSize:y,inHeight:b,inWidth:w,inChannels:x,outHeight:T,outWidth:E,padInfo:$,strideHeight:C,strideWidth:O,filterHeight:V,filterWidth:F,dilationHeight:R,dilationWidth:N,outShape:D}=Bg(s.shape,r.shape,i,a,"NHWC",o),k=Ee(D),z=D.length,B=Rn(s.dtype,k);for(let J=0;J<y;++J)for(let K=0;K<T;++K){const re=K*C-$.top;for(let Z=0;Z<E;++Z){const he=Z*O-$.left;for(let W=0;W<x;++W){let ee=Number.MIN_SAFE_INTEGER;for(let de=0;de<V;++de){const be=re+de*R;if(be>=0&&be<b)for(let _e=0;_e<F;++_e){const Ne=he+_e*N;if(Ne>=0&&Ne<w){const Ve=ka([J,be,Ne,W],d,Ye(s.shape)),Le=ka([de,_e,W],m,Ye(r.shape)),Be=u[Ve]+f[Le];Be>ee&&(ee=Be)}}}const me=ka([J,K,Z,W],z,Ye(D));B[me]=ee}}}return{dataId:l.write(Zu(B,s.dtype),D,s.dtype),shape:D,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yie={kernelName:FT,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:i}=n,{strides:a,pad:o,dilations:l}=t,u=e,d=Wi(s.shape,u.data.get(s.dataId).values),f=Wi(r.shape,u.data.get(r.dataId).values),{batchSize:m,inHeight:y,inWidth:b,inChannels:w,outHeight:x,outWidth:T,padInfo:E,strideHeight:$,strideWidth:C,filterHeight:O,filterWidth:V,dilationHeight:F,dilationWidth:R,outShape:N}=Bg(s.shape,r.shape,a,o,"NHWC",l);H(i.rank===N.length,()=>`Error in ${FT}, dy must have the same rank as output ${N.length}, but got ${i.rank}`);const D=Wi(N,u.data.get(i.dataId).values),k=ML(r.shape,r.dtype);for(let B=0;B<m;++B)for(let ne=0;ne<x;++ne){const J=ne*$-E.top;for(let K=0;K<T;++K){const re=K*C-E.left;for(let Z=0;Z<w;++Z){let he=Number.MIN_SAFE_INTEGER,W=0,ee=0;for(let me=0;me<O;++me){const de=J+me*F;if(de>=0&&de<y)for(let be=0;be<V;++be){const _e=re+be*R;if(_e>=0&&_e<b){const Ne=d[B][de][_e][Z]+f[me][be][Z];Ne>he&&(he=Ne,W=me,ee=be)}}}k[W][ee][Z]+=D[B][ne][K][Z]}}}return{dataId:u.write(Zu(k,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qie={kernelName:OT,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:i}=n,{strides:a,pad:o,dilations:l}=t,u=e,d=Wi(s.shape,u.data.get(s.dataId).values),f=Wi(r.shape,u.data.get(r.dataId).values),{batchSize:m,inHeight:y,inWidth:b,inChannels:w,outHeight:x,outWidth:T,padInfo:E,strideHeight:$,strideWidth:C,filterHeight:O,filterWidth:V,dilationHeight:F,dilationWidth:R,outShape:N}=Bg(s.shape,r.shape,a,o,"NHWC",l);H(i.rank===N.length,()=>`Error in ${OT}, dy must have the same rank as output ${N.length}, but got ${i.rank}`);const D=Wi(N,u.data.get(i.dataId).values),k=ML(s.shape,s.dtype);for(let B=0;B<m;++B)for(let ne=0;ne<x;++ne){const J=ne*$-E.top;for(let K=0;K<T;++K){const re=K*C-E.left;for(let Z=0;Z<w;++Z){let he=Number.MIN_SAFE_INTEGER,W=J<0?0:J,ee=re<0?0:re;for(let me=0;me<O;++me){const de=J+me*F;if(de>=0&&de<y)for(let be=0;be<V;++be){const _e=re+be*R;if(_e>=0&&_e<b){const Ne=d[B][de][_e][Z]+f[me][be][Z];Ne>he&&(he=Ne,W=de,ee=_e)}}}k[B][W][ee][Z]+=D[B][ne][K][Z]}}}return{dataId:u.write(Zu(k,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zie(n){const{inputs:e,backend:t,attrs:s}=n,{image:r}=e,{canvas:i,options:a}=s,{contextOptions:o,imageOptions:l}=a||{},u=(l==null?void 0:l.alpha)||1,d=(o==null?void 0:o.contextType)||"2d";if(d!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const f=i.getContext(d,(o==null?void 0:o.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${d} type.`);const[m,y]=r.shape.slice(0,2),b=r.shape.length===2?1:r.shape[2],w=t.data.get(r.dataId).values,x=r.dtype==="float32"?255:1,T=new Uint8ClampedArray(y*m*4);for(let $=0;$<m*y;++$){const C=[0,0,0,255*u];for(let V=0;V<b;V++){const F=w[$*b+V];if(r.dtype==="float32"){if(F<0||F>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${F}.`)}else if(r.dtype==="int32"&&(F<0||F>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${F}.`);b===1?(C[0]=F*x,C[1]=F*x,C[2]=F*x):C[V]=F*x}const O=$*4;T[O+0]=Math.round(C[0]),T[O+1]=Math.round(C[1]),T[O+2]=Math.round(C[2]),T[O+3]=Math.round(C[3])}i.width=y,i.height=m;const E=new ImageData(T,y,m);return f.putImageData(E,0,0),r}const Jie={kernelName:A9,backendName:"cpu",kernelFunc:Zie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ey(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;We(r,"sum");let o;r.dtype==="bool"?o=ac({inputs:{x:r},backend:t,attrs:{dtype:"int32"}}):o=za({inputs:{x:r},backend:t});const l=o.shape.length,u=gt(i,o.shape),d=Sn(u,l);let f=u,m=o;d!=null&&(m=Tr({inputs:{x:o},backend:t,attrs:{perm:d}}),f=Ln(f.length,l)),Ns("sum",f,m.shape.length);const[y,b]=ps(m.shape,f),w=Rr(m.dtype,"int32");let x=J0(t,y,w);const T=Ee(b),E=t.data.get(x.dataId).values,$=t.data.get(m.dataId).values;for(let C=0;C<E.length;++C){const O=C*T;let V=0;for(let F=0;F<T;++F)V+=$[O+F];E[C]=V}if(a){const C=jn(x.shape,u),O=x;x=un({inputs:{x},backend:t,attrs:{shape:C}}),t.disposeIntermediateTensorInfo(O)}return t.disposeIntermediateTensorInfo(o),d!=null&&t.disposeIntermediateTensorInfo(m),x}const eae={kernelName:$v,backendName:"cpu",kernelFunc:ey};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tae(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,i=e,{allDims:a,summedDims:o,idDims:l}=b$(r,i.length);v$(a.length,l,i);const{path:u,steps:d}=w$(o,l),f=d.length;let m=null,y=a.length;const b=[];for(let w=0;w<f;++w){for(const x of d[w]){const{permutationIndices:T,expandDims:E}=x$(y,l[x]);let $;S$(T)?$=i[x]:($=Tr({inputs:{x:i[x]},backend:t,attrs:{perm:T}}),b.push($));const C=$.shape.slice();for(let O=0;O<E.length;++O)C.splice(E[O],0,1);Gt($.shape,C)||($=un({inputs:{x:$},backend:t,attrs:{shape:C}}),b.push($)),m===null?m=$:(m=s1({inputs:{a:$,b:m},backend:t}),b.push(m))}w<f-1&&(u[w]>=0&&(m=ey({inputs:{x:m},backend:t,attrs:{axis:u[w]-(a.length-y),keepDims:!1}}),b.push(m)),y--)}for(const w of b)w!==m&&t.disposeIntermediateTensorInfo(w);return m}const nae={kernelName:Z_,backendName:"cpu",kernelFunc:tae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sae(n){const{inputs:e,backend:t}=n,{dy:s,y:r}=e;We([s,r],"eluGrad");const i=new Float32Array(Ee(r.shape)),a=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values;for(let l=0;l<a.length;++l){const u=a[l];u>=0?i[l]=o[l]:i[l]=o[l]*(u+1)}return t.makeTensorInfo(r.shape,"float32",i)}const rae={kernelName:J_,backendName:"cpu",kernelFunc:sae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iae=h$,aae=d$,oae=f$,lae=p$,cae=m$,uae=g$,hae=Qt(rg,n=>{const e=Math.sign(n),t=Math.abs(n),s=1/(1+iae*t);return e*(1-((((uae*s+cae)*s+lae)*s+oae)*s+aae)*s*Math.exp(-t*t))}),dae={kernelName:rg,backendName:"cpu",kernelFunc:hae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nx(n){const{inputs:e,backend:t,attrs:s}=n,{input:r}=e,{dim:i}=s,a=r.shape.length,o=r.shape.slice();let l=i;return i<0&&(H(-(a+1)<=i,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+i+1),o.splice(l,0,1),un({inputs:{x:r},backend:t,attrs:{shape:o}})}const fae={kernelName:Yx,backendName:"cpu",kernelFunc:nx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pae=Mn((n,e)=>n/e),nC=ns(ng,pae),lE={kernelName:ng,backendName:"cpu",kernelFunc:nC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vz(n,e,t){const s=n.shape,r=s[0],i=s[1],a=t.data.get(n.dataId),o=a.complexTensorInfos.real,l=a.complexTensorInfos.imag,u=[r,i],d=Ee(u),f=Vs("float32",d),m=Vs("float32",d);for(let x=0;x<r;x++){const T=Bu({inputs:{x:o},backend:t,attrs:{begin:[x,0],size:[1,i]}}),E=Bu({inputs:{x:l},backend:t,attrs:{begin:[x,0],size:[1,i]}}),$=kr({inputs:{real:T,imag:E},backend:t}),{real:C,imag:O}=mae($,e,t),V=Mo(C,O);for(let F=0;F<i;F++){const R=y$(V,F);f[x*i+F]=R.real,m[x*i+F]=R.imag}t.disposeIntermediateTensorInfo(T),t.disposeIntermediateTensorInfo(E),t.disposeIntermediateTensorInfo($)}const y=t.makeTensorInfo(u,"float32",f),b=t.makeTensorInfo(u,"float32",m),w=kr({inputs:{real:y,imag:b},backend:t});return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(b),w}function mae(n,e,t){const s=Ee(n.shape),r=t.data.get(n.dataId),i=t.data.get(r.complexTensorInfos.real.dataId).values,a=t.data.get(r.complexTensorInfos.imag.dataId).values;if(gae(s)){const o=cE(i,a,s,e,t),l=[n.shape[0],n.shape[1]];if(e){const u=t.makeTensorInfo(l,"float32",o.real),d=t.makeTensorInfo(l,"float32",o.imag),f=t.makeTensorInfo([],"float32",mc(s,"float32")),m=za({inputs:{x:f},backend:t}),y=lE.kernelFunc({inputs:{a:u,b:f},backend:t}),b=lE.kernelFunc({inputs:{a:d,b:m},backend:t}),w=t.data.get(y.dataId).values,x=t.data.get(b.dataId).values;return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(b),{real:w,imag:x}}return o}else{const o=Mo(i,a),l=yae(o,s,e);return A3(l)}}function gae(n){return(n&n-1)===0}function cE(n,e,t,s,r){if(t===1)return{real:n,imag:e};const i=Mo(n,e),a=t/2,o=R3(i),l=o.real,u=o.imag,d=[l.length],f=r.makeTensorInfo(d,"float32",l),m=r.makeTensorInfo(d,"float32",u),y=kr({inputs:{real:f,imag:m},backend:r}),b=D3(i),w=b.real,x=b.imag,T=[w.length],E=r.makeTensorInfo(T,"float32",w),$=r.makeTensorInfo(T,"float32",x),C=kr({inputs:{real:E,imag:$},backend:r}),O=cE(l,u,a,s,r),V=O.real,F=O.imag,R=[V.length],N=r.makeTensorInfo(R,"float32",V),D=r.makeTensorInfo(R,"float32",F),k=kr({inputs:{real:N,imag:D},backend:r}),z=cE(w,x,a,s,r),B=z.real,ne=z.imag,J=[B.length],K=r.makeTensorInfo(J,"float32",B),re=r.makeTensorInfo(J,"float32",ne),Z=kr({inputs:{real:K,imag:re},backend:r}),he=F3(t,s),W=[he.real.length],ee=r.makeTensorInfo(W,"float32",he.real),me=r.makeTensorInfo(W,"float32",he.imag),de=kr({inputs:{real:ee,imag:me},backend:r}),be=s1({inputs:{a:de,b:Z},backend:r}),_e=Ad({inputs:{a:k,b:be},backend:r}),Ne=eC({inputs:{a:k,b:be},backend:r}),Ve=Vu({inputs:{input:_e},backend:r}),Le=Vu({inputs:{input:Ne},backend:r}),Be=Rd({inputs:{input:_e},backend:r}),je=Rd({inputs:{input:Ne},backend:r}),Qe=Dd({inputs:[Ve,Le],backend:r,attrs:{axis:0}}),ft=Dd({inputs:[Be,je],backend:r,attrs:{axis:0}}),pt=r.data.get(Qe.dataId).values,Mt=r.data.get(ft.dataId).values;return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(C),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(k),r.disposeIntermediateTensorInfo(K),r.disposeIntermediateTensorInfo(re),r.disposeIntermediateTensorInfo(Z),r.disposeIntermediateTensorInfo(ee),r.disposeIntermediateTensorInfo(me),r.disposeIntermediateTensorInfo(de),r.disposeIntermediateTensorInfo(be),r.disposeIntermediateTensorInfo(_e),r.disposeIntermediateTensorInfo(Ne),r.disposeIntermediateTensorInfo(Ve),r.disposeIntermediateTensorInfo(Be),r.disposeIntermediateTensorInfo(Le),r.disposeIntermediateTensorInfo(je),r.disposeIntermediateTensorInfo(Qe),r.disposeIntermediateTensorInfo(ft),{real:pt,imag:Mt}}function yae(n,e,t){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let i=0,a=0;for(let o=0;o<e;o++){const l=L3(r*o,e,t),u=y$(n,o);i+=u.real*l.real-u.imag*l.imag,a+=u.real*l.imag+u.imag*l.real}t&&(i/=e,a/=e),O3(s,i,a,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bae(n){const{inputs:e,backend:t}=n,{input:s}=e,r=Ee(s.shape),i=s.shape[s.shape.length-1],a=r/i,o=un({inputs:{x:s},backend:t,attrs:{shape:[a,i]}}),l=vz(o,!1,t),u=un({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),u}const xae={kernelName:eI,backendName:"cpu",kernelFunc:bae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sC(n){const{backend:e,attrs:t}=n,{shape:s,value:r,dtype:i}=t,a=i||Jd(r),o=Rn(a,Ee(s));return wae(o,r,a),e.makeTensorInfo(s,a,o)}const vae={kernelName:tI,backendName:"cpu",kernelFunc:sC};function wae(n,e,t){n.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sae={kernelName:nI,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,r=t,i=Vs(s.dtype,Ee(s.shape)),[a,o,l,u]=s.shape,d=r.data.get(s.dataId).values;for(let m=0;m<a;m++){const y=m*l*o*u;for(let b=0;b<o;b++){const w=b*(l*u);for(let x=0;x<l;x++){const T=x*u;for(let E=0;E<u;E++){const $=Math.round(l-x-1),C=y+w+T+E;let O=d[C];if($>=0&&$<l){const V=$*u,F=y+w+V+E;O=d[F]}i[C]=O}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tae(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:d,dilations:f,dimRoundingMode:m,activation:y,leakyreluAlpha:b}=s;let w=bz({inputs:{x:r,filter:i},backend:t,attrs:{strides:l,pad:u,dataFormat:d,dilations:f,dimRoundingMode:m}});if(a){const x=w;if(d==="NCHW"&&a.shape.length===1&&a.shape[0]!==1){const T=un({inputs:{x:a},backend:t,attrs:{shape:[a.shape[0],1,1]}});w=Ad({inputs:{a:w,b:T},backend:t}),t.disposeIntermediateTensorInfo(T)}else w=Ad({inputs:{a:w,b:a},backend:t});t.disposeIntermediateTensorInfo(x)}if(y){const x=w;if(d==="NCHW"&&y==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const T=un({inputs:{x:o},backend:t,attrs:{shape:[o.shape[0],1,1]}});w=tx(t,w,y,T,b),t.disposeIntermediateTensorInfo(T)}else w=tx(t,w,y,o,b);t.disposeIntermediateTensorInfo(x)}return w}const Eae={kernelName:L0,backendName:"cpu",kernelFunc:Tae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ae(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:d,dilations:f,dimRoundingMode:m,activation:y,leakyreluAlpha:b}=s;let w=xz({inputs:{x:r,filter:i},backend:t,attrs:{strides:l,pad:u,dataFormat:d,dilations:f,dimRoundingMode:m}});if(a){const x=w;w=Ad({inputs:{a:w,b:a},backend:t}),t.disposeIntermediateTensorInfo(x)}if(y){const x=w;w=tx(t,w,y,o,b),t.disposeIntermediateTensorInfo(x)}return w}const Iae={kernelName:oP,backendName:"cpu",kernelFunc:_ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ae(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,i=Ee(s.shape),a=r.shape,o=a[a.length-1],[l,u,d,f]=e$(s,r);if(u===0)return t.makeTensorInfo(l,s.dtype,[]);const m=t.data.get(r.dataId).values,y=t.bufferSync(s),b=kB(m,y,s.dtype,u,o,d,f,s.shape,i);return t.makeTensorInfo(l,s.dtype,b.values)}const Cae={kernelName:jL,backendName:"cpu",kernelFunc:$ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nae(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:i}=e,{axis:a,batchDims:o}=s;We([r,i],"gatherV2");const l=gt(a,r.shape)[0],u=t.data.get(i.dataId).values,d=r.shape[l];for(let C=0;C<u.length;++C){const O=u[C];H(O<=d-1&&O>=0,()=>`GatherV2: the index value ${O} is not in [0, ${d-1}]`)}let f=o;o==null&&(f=0);const m=Ee(i.shape),y=E$(r,i,l,f),b=un({inputs:{x:r},backend:t,attrs:{shape:[y.batchSize,y.outerSize,y.dimSize,y.sliceSize]}}),w=un({inputs:{x:i},backend:t,attrs:{shape:[y.batchSize,m/y.batchSize]}}),x=[y.batchSize,y.outerSize,m/y.batchSize,y.sliceSize],T=t.bufferSync(w),E=t.bufferSync(b),$=AB(E,T,x);return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(w),t.makeTensorInfo(y.outputShape,$.dtype,$.values)}const kae={kernelName:Zx,backendName:"cpu",kernelFunc:Nae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aae(n){const{inputs:e,backend:t}=n,{input:s}=e,r=Ee(s.shape),i=s.shape[s.shape.length-1],a=r/i,o=un({inputs:{x:s},backend:t,attrs:{shape:[a,i]}}),l=vz(o,!0,t),u=un({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),u}const Rae={kernelName:sI,backendName:"cpu",kernelFunc:Aae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dae=Qt(hg,n=>Number.isFinite(n)?1:0,"bool"),Oae={kernelName:hg,backendName:"cpu",kernelFunc:Dae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fae=Qt(dg,n=>Math.abs(n)===1/0?1:0,"bool"),Lae={kernelName:dg,backendName:"cpu",kernelFunc:Fae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pae=Qt(fg,n=>Number.isNaN(n)?1:0,"bool"),Mae={kernelName:fg,backendName:"cpu",kernelFunc:Pae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vae(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:i}=t,a=LB(s,r,i);return e.makeTensorInfo([a.length],"float32",a)}const Bae={kernelName:WL,backendName:"cpu",kernelFunc:Vae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zae=Qt(mg,n=>Math.log1p(n)),Uae={kernelName:mg,backendName:"cpu",kernelFunc:zae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jae=Mn((n,e)=>n&&e),Wae=ns(sv,jae,null,"bool"),Gae={kernelName:sv,backendName:"cpu",kernelFunc:Wae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hae=Qt(rv,n=>n?0:1,"bool"),qae={kernelName:rv,backendName:"cpu",kernelFunc:Hae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kae=Mn((n,e)=>n||e),Xae=ns(iv,Kae,null,"bool"),Yae={kernelName:iv,backendName:"cpu",kernelFunc:Xae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qae(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:i,bias:a,alpha:o,beta:l}=s;We(r,"LRN");const u=r.shape[3],d=u-1,f=t.data.get(r.dataId).values,m=Ee(r.shape),y=new Float32Array(m);function b(w){const x=w%u;let T=w-x+Math.max(0,x-i);const E=w-x+Math.min(x+i,d);let $=0;for(;T<=E;T++){const C=f[T];$+=C*C}return $}for(let w=0;w<m;w++){const x=b(w),T=f[w]*Math.pow(a+o*x,-l);y[w]=T}return t.makeTensorInfo(r.shape,r.dtype,y)}const Zae={kernelName:av,backendName:"cpu",kernelFunc:Qae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jae(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,y:i,dy:a}=e,{depthRadius:o,bias:l,alpha:u,beta:d}=s;We(a,"LRNGrad");const f=Ee(a.shape),m=a.shape[3],y=t.data.get(a.dataId).values,b=t.data.get(r.dataId).values,w=t.data.get(i.dataId).values,x=new Float32Array(f),T=f;for(let E=0;E<T;E++){const $=E%m,C=E-$+Math.max(0,$-o),O=E-$+Math.min(m,$+o+1);let V=0;for(let F=C;F<O;F++)V+=Math.pow(b[F],2);V=u*V+l;for(let F=C;F<O;F++){let R=-2*u*d*b[F]*w[E]/V;E===F&&(R+=Math.pow(V,-d)),R*=y[E],x[F]+=R}}return t.makeTensorInfo(a.shape,r.dtype,x)}const eoe={kernelName:iI,backendName:"cpu",kernelFunc:Jae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wz(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:i,keepDims:a}=s,o=t;let l=r.shape;const u=l.length,d=gt(i,l);let f=d;const m=Sn(f,u);let y=o.data.get(r.dataId).values;if(m!=null){const C=new Array(u);for(let O=0;O<C.length;O++)C[O]=l[m[O]];y=Z$(y,l,r.dtype,m,C),f=Ln(f.length,u),l=C}We(r,"max"),Ns("max",f,u);const[b,w]=ps(l,f),x=Ee(w),T=MB(y,x,b,r.dtype),E=o.write(T,b,r.dtype);let $=b;return a&&($=jn(b,d)),{dataId:E,shape:$,dtype:r.dtype}}const toe={kernelName:ov,backendName:"cpu",kernelFunc:wz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function noe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;We(r,"maxPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=s,u=1;H(js(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const d=$i(r.shape,i,a,u,o,l);let f;if(d.filterWidth===1&&d.filterHeight===1&&Gt(d.inShape,d.outShape))f=za({inputs:{x:r},backend:t});else{const m=t.data.get(r.dataId).values,y=Ye(r.shape),b=tC(m,r.shape,r.dtype,y,d,"max");f=t.makeTensorInfo(d.outShape,r.dtype,b.values)}return f}const soe={kernelName:lv,backendName:"cpu",kernelFunc:noe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function roe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l,dataFormat:u}=s;We(r,"maxPool3d");const d=Ho(r.shape,i,a,1,o,l,u),f=t.data.get(r.dataId).values,m=yz(f,r.shape,r.dtype,Ye(r.shape),d,"max");return t.makeTensorInfo(m.shape,"float32",m.values)}const ioe={kernelName:cv,backendName:"cpu",kernelFunc:roe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aoe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:u}=s;We([r,i],"maxPool3DGrad");const d=Ho(i.shape,a,o,1,l,u),f=t.bufferSync(i),m=Kre(f,d),y=d.strideDepth,b=d.strideHeight,w=d.strideWidth,x=d.dilationDepth,T=d.dilationHeight,E=d.dilationWidth,$=d.effectiveFilterDepth,C=d.effectiveFilterHeight,O=d.effectiveFilterWidth,V=$-1-d.padInfo.front,F=O-1-d.padInfo.left,R=C-1-d.padInfo.top,N=mt(i.shape,"float32"),D=t.bufferSync(r);for(let k=0;k<d.batchSize;++k)for(let z=0;z<d.inChannels;++z)for(let B=0;B<d.inDepth;++B)for(let ne=0;ne<d.inHeight;++ne)for(let J=0;J<d.inWidth;++J){const K=B-V,re=ne-R,Z=J-F;let he=0;for(let W=0;W<$;W+=x){const ee=(K+W)/y;if(!(ee<0||ee>=d.outDepth||Math.floor(ee)!==ee))for(let me=0;me<C;me+=T){const de=(re+me)/b;if(!(de<0||de>=d.outHeight||Math.floor(de)!==de))for(let be=0;be<O;be+=E){const _e=(Z+be)/w;if(_e<0||_e>=d.outWidth||Math.floor(_e)!==_e)continue;const Ne=$*C*O-1-m.get(k,ee,de,_e,z),Ve=W*C*O+me*O+be,Le=Ne===Ve?1:0;if(Le===0)continue;const Be=D.get(k,ee,de,_e,z);he+=Be*Le}}}N.set(he,k,B,ne,J,z)}return t.makeTensorInfo(N.shape,N.dtype,N.values)}const ooe={kernelName:oI,backendName:"cpu",kernelFunc:aoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i,output:a}=e,o=i;We([i,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:d,dimRoundingMode:f}=s,m=$i(o.shape,l,u,1,d,f),y=t.data.get(o.dataId).values,b=mt(m.outShape,o.dtype,gz(y,o.shape,o.dtype,m).values),w=m.strideHeight,x=m.strideWidth,T=m.dilationHeight,E=m.dilationWidth,$=m.effectiveFilterHeight,C=m.effectiveFilterWidth,O=C-1-m.padInfo.left,V=$-1-m.padInfo.top,F=mt(o.shape,"float32"),R=t.data.get(r.dataId).values,N=mt(r.shape,"float32",R);for(let D=0;D<m.batchSize;++D)for(let k=0;k<m.inChannels;++k)for(let z=0;z<m.inHeight;++z)for(let B=0;B<m.inWidth;++B){const ne=z-V,J=B-O;let K=0;for(let re=0;re<$;re+=T){const Z=(ne+re)/w;if(!(Z<0||Z>=m.outHeight||Math.floor(Z)!==Z))for(let he=0;he<C;he+=E){const W=(J+he)/x;if(W<0||W>=m.outWidth||Math.floor(W)!==W)continue;const ee=$*C-1-b.get(D,Z,W,k),me=re*C+he,de=ee===me?1:0;if(de===0)continue;const be=N.get(D,Z,W,k);K+=be*de}}F.set(K,D,z,B,k)}return t.makeTensorInfo(F.shape,F.dtype,F.values)}const coe={kernelName:aI,backendName:"cpu",kernelFunc:loe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uoe(n,e,t,s,r){const i=Ye(e),a=tC(n,e,t,i,r,"max"),o=gz(n,e,t,r,!0,s);return[a.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hoe={kernelName:GL,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:i,pad:a,includeBatchInIndex:o}=e,l=t;We(s,"MaxPoolWithArgmax");const u=l.data.get(s.dataId).values,d=$i(s.shape,r,i,[1,1],a),[f,m]=uoe(u,s.shape,s.dtype,o,d),y=l.write(f,d.outShape,s.dtype),b=l.write(m,d.outShape,s.dtype);return[{dataId:y,shape:d.outShape,dtype:s.dtype},{dataId:b,shape:d.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s,o=gt(i,r.shape),u=ps(r.shape,o)[1],d=Ee(u),f=[],m=t.makeTensorInfo([],"float32",new Float32Array([d]));f.push(m);const y=ac({inputs:{x:r},backend:t,attrs:{dtype:"float32"}});f.push(y);const b=nC({inputs:{a:y,b:m},backend:t});f.push(b);const w=ey({inputs:{x:b},backend:t,attrs:{axis:i,keepDims:a}});return f.forEach(x=>t.disposeIntermediateTensorInfo(x)),w}const foe={kernelName:uv,backendName:"cpu",kernelFunc:doe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function poe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;We(r,"min");const o=gt(i,r.shape);let l=o;const u=Sn(l,r.shape.length);let d=r;u!=null&&(d=Tr({inputs:{x:r},backend:t,attrs:{perm:u}}),l=Ln(l.length,r.shape.length)),Ns("min",l,d.shape.length);const[f,m]=ps(d.shape,l),y=Ee(m),b=Bs(Ee(f),d.dtype),w=t.data.get(d.dataId).values;for(let T=0;T<b.length;++T){const E=T*y;let $=w[E];for(let C=0;C<y;++C){const O=w[E+C];(Number.isNaN(O)||O<$)&&($=O)}b[T]=$}u!=null&&t.disposeIntermediateTensorInfo(d);const x=t.makeTensorInfo(f,d.dtype,b);if(a){const T=jn(f,o),E=un({inputs:{x},backend:t,attrs:{shape:T}});return t.disposeIntermediateTensorInfo(x),E}return x}const moe={kernelName:hv,backendName:"cpu",kernelFunc:poe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function goe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:i,mode:a}=s;We(r,"mirrorPad");const o=i.map(($,C)=>$[0]+r.shape[C]+$[1]),l=i.map($=>$[0]),u=i.map(($,C)=>$[0]+r.shape[C]),d=a==="reflect"?0:1,f=t.data.get(r.dataId).values,m=r.shape.length,y=Ye(r.shape),b=Ee(o),w=o.length,x=Ye(o),T=Vs(r.dtype,b);for(let $=0;$<b;$++){let C=ef($,w,x);for(let V=0;V<w;V++)C[V]<l[V]?C[V]=l[V]*2-C[V]-d:C[V]>=u[V]&&(C[V]=(u[V]-1)*2-C[V]+d);C=C.map((V,F)=>V-l[F]);const O=ka(C,m,y);T[$]=f[O]}return{dataId:t.write(T,o,r.dtype),shape:o,dtype:r.dtype}}const yoe={kernelName:dv,backendName:"cpu",kernelFunc:goe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const boe=Mn((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e}),xoe=ns(bg,boe),voe={kernelName:bg,backendName:"cpu",kernelFunc:xoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sz(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:i}=s,a=r.shape.length;let o=i;if(o===-1&&(o=a-1),o!==a-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${a} and dim was ${o}`);const l=gt([o],r.shape),u=wz({inputs:{x:r},backend:t,attrs:{reductionIndices:l,keepDims:!1}}),d=jn(u.shape,l),f=un({inputs:{x:u},backend:t,attrs:{shape:d}}),m=eC({inputs:{a:r,b:f},backend:t}),y=IB({inputs:{x:m},backend:t}),b=ey({inputs:{x:y},backend:t,attrs:{axis:l,keepDims:!1}}),w=un({inputs:{x:b},backend:t,attrs:{shape:d}}),x=nC({inputs:{a:y,b:w},backend:t});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(w),x}const woe={kernelName:kv,backendName:"cpu",kernelFunc:Sz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Soe(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:i,seed:a,normalized:o}=s;We(r,"multinomial");const l=o?r:Sz({inputs:{logits:r},backend:t,attrs:{dim:-1}}),u=l.shape[0],d=l.shape[1],f=t.data.get(l.dataId).values,m=[u,i],y=Bs(Ee(m),"int32");for(let b=0;b<u;++b){const w=b*d,x=new Float32Array(d-1);x[0]=f[w];for(let $=1;$<x.length;++$)x[$]=x[$-1]+f[w+$];const T=af.alea(a.toString()),E=b*i;for(let $=0;$<i;++$){const C=T();y[E+$]=x.length;for(let O=0;O<x.length;O++)if(C<x[O]){y[E+$]=O;break}}}return o||t.disposeIntermediateTensorInfo(l),t.makeTensorInfo(m,"int32",y)}const Toe={kernelName:HL,backendName:"cpu",kernelFunc:Soe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eoe=XI;function _oe(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=s;We(r,"NonMaxSuppression");const u=t.data.get(r.dataId).values,d=t.data.get(i.dataId).values,{selectedIndices:f}=Eoe(u,d,a,o,l);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const Ioe={kernelName:lI,backendName:"cpu",kernelFunc:_oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $oe=YI;function Coe(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=s;We(r,"NonMaxSuppressionPadded");const d=t.data.get(r.dataId).values,f=t.data.get(i.dataId).values,{selectedIndices:m,validOutputs:y}=$oe(d,f,a,o,l,u);return[t.makeTensorInfo([m.length],"int32",new Int32Array(m)),t.makeTensorInfo([],"int32",new Int32Array([y]))]}const Noe={kernelName:cI,backendName:"cpu",kernelFunc:Coe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const koe=QI;function Aoe(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=s;We(r,"NonMaxSuppressionWithScore");const d=t.data.get(r.dataId).values,f=t.data.get(i.dataId).values,m=a,y=o,b=l,w=u,{selectedIndices:x,selectedScores:T}=koe(d,f,m,y,b,w);return[t.makeTensorInfo([x.length],"int32",new Int32Array(x)),t.makeTensorInfo([T.length],"float32",new Float32Array(T))]}const Roe={kernelName:uI,backendName:"cpu",kernelFunc:Aoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Doe(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:i,depth:a,onValue:o,offValue:l}=s;We(r,"oneHot");const u=Ee(r.shape),d=new Float32Array(u*a);d.fill(l);const f=t.data.get(r.dataId).values;for(let m=0;m<u;++m)f[m]>=0&&f[m]<a&&(d[m*a+f[m]]=o);return t.makeTensorInfo([...r.shape,a],i,d)}const Ooe={kernelName:gv,backendName:"cpu",kernelFunc:Doe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sx(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Vu({inputs:{input:s},backend:t}),i=sx({inputs:{x:r},backend:t}),a=Rd({inputs:{input:s},backend:t}),o=sx({inputs:{x:a},backend:t}),l=kr({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return sC({backend:t,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const Foe={kernelName:Dv,backendName:"cpu",kernelFunc:sx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tz(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Vu({inputs:{input:s},backend:t}),i=Tz({inputs:{x:r},backend:t}),a=Rd({inputs:{input:s},backend:t}),o=sx({inputs:{x:a},backend:t}),l=kr({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return sC({backend:t,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const Loe={kernelName:mv,backendName:"cpu",kernelFunc:Tz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ez(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return nx({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const i=e[0].shape,a=e[0].dtype;e.forEach(d=>{A_(i,d.shape,"All tensors passed to stack must have matching shapes"),H(a===d.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(d=>{const f=nx({inputs:{input:d},backend:t,attrs:{dim:r}});return o.push(f),f}),u=Dd({inputs:l,backend:t,attrs:{axis:r}});return o.forEach(d=>t.disposeIntermediateTensorInfo(d)),u}const Poe={kernelName:yv,backendName:"cpu",kernelFunc:Ez};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Moe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:i,constantValue:a}=s;We(r,"pad");const o=i.map((E,$)=>E[0]+r.shape[$]+E[1]),l=i.map(E=>E[0]),u=t.data.get(r.dataId).values,d=Ee(r.shape),f=r.shape.length,m=Ye(r.shape),y=Ee(o),b=o.length,w=Ye(o),x=Vs(r.dtype,y);a!==0&&x.fill(a);for(let E=0;E<d;E++){const C=ef(E,f,m).map((V,F)=>V+l[F]),O=ka(C,b,w);x[O]=u[E]}return{dataId:t.write(x,o,r.dtype),shape:o,dtype:r.dtype}}const _z={kernelName:bv,backendName:"cpu",kernelFunc:Moe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Voe=Mn((n,e)=>Math.pow(n,e)),Boe=ns(vg,Voe),zoe={kernelName:vg,backendName:"cpu",kernelFunc:Boe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:i,indices:a}=e,{outputRaggedRank:o}=s,l=r.map(T=>t.data.get(T.dataId).values),u=r.map(T=>T.shape),d=t.data.get(i.dataId).values,f=t.data.get(a.dataId).values,[m,y,b]=WB(l,u,d,i.shape,i.dtype,f,a.shape),w=m.map(T=>t.makeTensorInfo([T.length],"int32",T)),x=t.makeTensorInfo(b,i.dtype,y);return w.concat([x])}const joe={kernelName:qL,backendName:"cpu",kernelFunc:Uoe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Woe(n){const{inputs:e,backend:t}=n,{starts:s,limits:r,deltas:i}=e,a=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,l=t.data.get(i.dataId).values,[u,d]=GB(a,s.shape,s.dtype,o,r.shape,l,i.shape),f=t.makeTensorInfo([u.length],"int32",u),m=t.makeTensorInfo([d.length],s.dtype,d);return[f,m]}const Goe={kernelName:KL,backendName:"cpu",kernelFunc:Woe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hoe(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:i,defaultValue:a,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,u=t.data.get(r.dataId).values,d=t.data.get(i.dataId).values,f=t.data.get(a.dataId).values,m=o.map(x=>t.data.get(x.dataId).values),y=o.map(x=>x.shape),[b,w]=HB(u,r.shape,d,i.shape,i.dtype,f,a.shape,m,y,l);return t.makeTensorInfo(b,i.dtype,w)}const qoe={kernelName:XL,backendName:"cpu",kernelFunc:Hoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Koe(n){const{backend:e,attrs:t}=n,{start:s,stop:r,dtype:i,step:a}=t,o=qB(s,r,a,i);return e.makeTensorInfo([o.length],i,o)}const Xoe={kernelName:hI,backendName:"cpu",kernelFunc:Koe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yoe=Qt(wg,n=>1/n),Qoe={kernelName:wg,backendName:"cpu",kernelFunc:Yoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zoe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:i,halfPixelCenters:a,size:o}=s;We(r,"resizeBilinear");const l=Ye(r.shape),[u,d]=o,[f,m,y,b]=r.shape,w=t.data.get(r.dataId).values,x=new Float32Array(Ee([f,u,d,b])),T=[i&&u>1?m-1:m,i&&d>1?y-1:y],E=[i&&u>1?u-1:u,i&&d>1?d-1:d];let $=0;const C=T[0]/E[0],O=T[1]/E[1];for(let V=0;V<f;V++)for(let F=0;F<u;F++){let R;a?R=C*(F+.5)-.5:R=C*F;const N=Math.max(0,Math.floor(R)),D=R-N,k=Math.min(m-1,Math.ceil(R)),z=V*l[0]+N*l[1],B=V*l[0]+k*l[1];for(let ne=0;ne<d;ne++){let J;a?J=O*(ne+.5)-.5:J=O*ne;const K=Math.max(0,Math.floor(J)),re=J-K,Z=Math.min(y-1,Math.ceil(J)),he=z+K*l[2],W=B+K*l[2],ee=z+Z*l[2],me=B+Z*l[2];for(let de=0;de<b;de++){const be=w[he+de],_e=w[W+de],Ne=w[ee+de],Ve=w[me+de],Le=be+(Ne-be)*re,Be=_e+(Ve-_e)*re,je=Le+(Be-Le)*D;x[$++]=je}}}return t.makeTensorInfo([f,u,d,b],"float32",x)}const Joe={kernelName:Tv,backendName:"cpu",kernelFunc:Zoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ele(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:i}=e,{alignCorners:a}=s;We([i,r],"resizeBilinearGrad");const o=Ye(r.shape),[l,u,d,f]=r.shape,[,m,y]=i.shape,b=new Float32Array(l*u*d*f),w=[a&&m>1?u-1:u,a&&y>1?d-1:d],x=[a&&m>1?m-1:m,a&&y>1?y-1:y],T=w[0]/x[0],E=w[1]/x[1],$=t.data.get(i.dataId).values;let C=0;for(let O=0;O<l;O++){const V=O*o[0];for(let F=0;F<m;F++){const R=F*T,N=Math.floor(R),D=Math.min(Math.ceil(R),u-1),k=V+N*o[1],z=V+D*o[1],B=R-N,ne=1-B;for(let J=0;J<y;J++){const K=J*E,re=Math.floor(K),Z=Math.min(Math.ceil(K),d-1),he=K-re,W=1-he,ee=k+re*o[2],me=k+Z*o[2],de=z+re*o[2],be=z+Z*o[2],_e=ne*W,Ne=ne*he,Ve=B*W,Le=B*he;for(let Be=0;Be<f;Be++){const je=$[C++];b[ee+Be]+=je*_e,b[me+Be]+=je*Ne,b[de+Be]+=je*Ve,b[be+Be]+=je*Le}}}}return t.makeTensorInfo([l,d,u,f],"float32",b)}const tle={kernelName:pI,backendName:"cpu",kernelFunc:ele};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nle(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:i,halfPixelCenters:a,size:o}=s;We(r,"resizeNearestNeighbor");const l=Ye(r.shape),[u,d]=o,[f,m,y,b]=r.shape,w=t.data.get(r.dataId).values,x=new Float32Array(f*u*d*b),T=[i&&u>1?m-1:m,i&&d>1?y-1:y],E=[i&&u>1?u-1:u,i&&d>1?d-1:d],$=T[0]/E[0],C=T[1]/E[1];let O=0;for(let V=0;V<f;V++){const F=V*l[0];for(let R=0;R<u;R++){const N=a?$*(R+.5):$*R;let D=Math.min(m-1,i?Math.round(N):Math.floor(N));a&&(D=Math.max(0,D));const k=F+D*l[1];for(let z=0;z<d;z++){const B=a?C*(z+.5):C*z;let ne=Math.min(y-1,i?Math.round(B):Math.floor(B));a&&(ne=Math.max(0,ne));const J=k+ne*l[2];for(let K=0;K<b;K++){const re=w[J+K];x[O++]=re}}}}return t.makeTensorInfo([f,u,d,b],r.dtype,x)}const sle={kernelName:Sv,backendName:"cpu",kernelFunc:nle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rle(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:i}=e,{alignCorners:a}=s;We([i,r],"resizeNearestNeighborGrad");const o=Ye(r.shape),l=Ye(i.shape),[u,d,f,m]=r.shape,[,y,b]=i.shape,w=new Float32Array(u*d*f*m),x=t.data.get(i.dataId).values,T=[a&&y>1?d-1:d,a&&b>1?f-1:f],E=[a&&y>1?y-1:y,a&&b>1?b-1:b],$=T[0]/E[0],C=T[1]/E[1],O=1/$,V=1/C,F=Math.ceil(O)*2+2,R=Math.ceil(V)*2+2;for(let N=0;N<u;N++){const D=N*o[0];for(let k=0;k<d;k++){const z=D+k*o[1],B=Math.floor(k*O),ne=Math.floor(B-F/2);for(let J=0;J<f;J++){const K=z+J*o[2],re=Math.floor(J*V),Z=Math.floor(re-R/2);for(let he=0;he<m;he++){let W=0;for(let ee=0;ee<F;ee++){const me=ee+ne;if(me<0||me>=y)continue;const de=D+me*l[1],be=me*$,_e=Math.min(d-1,a?Math.round(be):Math.floor(be));if(k===_e)for(let Ne=0;Ne<R;Ne++){const Ve=Ne+Z;if(Ve<0||Ve>=b)continue;const Le=de+Ve*l[2],Be=Ve*C,je=Math.min(f-1,a?Math.round(Be):Math.floor(Be));J===je&&(W+=x[Le+he])}}w[K+he]=W}}}}return t.makeTensorInfo(r.shape,r.dtype,w)}const ile={kernelName:fI,backendName:"cpu",kernelFunc:rle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ale(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:i}=s;We(r,"reverse");const a=r.shape.length,o=gt(i,r.shape);if(a===0)return za({inputs:{x:r},backend:t});const l=new _s(r.shape,r.dtype),u=t.bufferSync(r);for(let d=0;d<l.size;d++){const f=l.indexToLoc(d),m=f.slice();o.forEach(y=>m[y]=r.shape[y]-1-m[y]),l.set(u.get(...m),...f)}return t.makeTensorInfo(l.shape,l.dtype,l.values)}const ole={kernelName:Ev,backendName:"cpu",kernelFunc:ale};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lle={kernelName:wI,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:i,center:a}=e,o=t,l=Vs(s.dtype,Ee(s.shape)),[u,d,f,m]=s.shape,[y,b]=l$(a,d,f),w=255,x=Math.sin(r),T=Math.cos(r),E=o.data.get(s.dataId).values;for(let C=0;C<u;C++){const O=C*f*d*m;for(let V=0;V<d;V++){const F=V*(f*m);for(let R=0;R<f;R++){const N=R*m;for(let D=0;D<m;D++){const k=[u,V,R,D],z=k[2],B=k[1];let ne=(z-y)*T-(B-b)*x,J=(z-y)*x+(B-b)*T;ne=Math.round(ne+y),J=Math.round(J+b);let K=i;if(typeof i!="number"&&(D===3?K=w:K=i[D]),ne>=0&&ne<f&&J>=0&&J<d){const Z=J*(f*m),he=ne*m,W=O+Z+he+D;K=E[W]}const re=O+F+N+D;l[re]=K}}}}return{dataId:o.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cle=Qt(Eg,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),ule={kernelName:Eg,backendName:"cpu",kernelFunc:cle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hle(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:i}=e,{shape:a}=s,{sliceRank:o,numUpdates:l,sliceSize:u,strides:d,outputSize:f}=th(i,r,a),m=!0,y=t.bufferSync(r),b=t.bufferSync(i),w=mu(y,b,a,f,u,l,o,d,0,m);return t.makeTensorInfo(a,w.dtype,w.values)}const dle={kernelName:YL,backendName:"cpu",kernelFunc:hle};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fle(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<e?t=r+1:s=r;return s}function ple(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<=e?t=r+1:s=r;return s}function mle(n,e,t,s,r,i){const a=Rn("int32",t*r);for(let o=0;o<t;++o){const l=n.slice(o*s,(o+1)*s),u=o*r;for(let d=0;d<r;++d)a[u+d]=i==="left"?fle(l,e[d+u]):ple(l,e[d+u])}return a}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gle(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:i}=e,{side:a}=s,o=t.data.get(r.dataId).values,l=t.data.get(i.dataId).values,u=mle(o,l,r.shape[0],r.shape[1],i.shape[1],a);return t.makeTensorInfo(i.shape,"int32",u)}const yle={kernelName:ZL,backendName:"cpu",kernelFunc:gle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ble(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:i}=e;We([s,r,i],"select");const a=s.shape.length,o=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,u=t.data.get(i.dataId).values,d=Rr(r.dtype,i.dtype),f=Bs(Ee(r.shape),d);let m=0;const y=a===0||a>1||r.shape.length===1?1:Ee(r.shape.slice(1));for(let b=0;b<o.length;b++)for(let w=0;w<y;w++)o[b]===1?f[m++]=l[b]:f[m++]=u[b];return t.makeTensorInfo(r.shape,d,f)}const xle={kernelName:_v,backendName:"cpu",kernelFunc:ble};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vle=Wv,wle=Gv,Sle=Qt(Ig,n=>n>=0?wle*n:vle*(Math.exp(n)-1)),Tle={kernelName:Ig,backendName:"cpu",kernelFunc:Sle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ele=Qt(Ng,n=>n<0?-1:n>0?1:0),_le={kernelName:Ng,backendName:"cpu",kernelFunc:Ele};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile=Qt($g,n=>Math.sin(n)),$le={kernelName:$g,backendName:"cpu",kernelFunc:Ile};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cle=Qt(Cg,n=>Math.sinh(n)),Nle={kernelName:Cg,backendName:"cpu",kernelFunc:Cle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kle=11920928955078125e-23,_D=Math.log(kle)+2,Ale=Qt(Ag,n=>{const e=n>-_D,t=n<_D,s=Math.exp(n);let r;return t?r=s:e?r=n:r=Math.log(1+s),r}),Rle={kernelName:Ag,backendName:"cpu",kernelFunc:Ale};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:i,paddings:a}=s;We([r],"spaceToBatchND");const o=Ee(i),l=[[0,0]];l.push(...a);for(let V=1+i.length;V<r.shape.length;++V)l.push([0,0]);const u=_z.kernelFunc({inputs:{x:r},backend:t,attrs:{paddings:l,constantValue:0}}),d=Gg(u.shape,i,o,!1),f=Hg(d.length,i.length,!1),m=qg(u.shape,i,o,!1),w=un({inputs:{x:u},backend:t,attrs:{shape:d}}),E=Tr({inputs:{x:w},backend:t,attrs:{perm:f}}),O=un({inputs:{x:E},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(E),O}const Ole={kernelName:Cv,backendName:"cpu",kernelFunc:Dle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fle(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:i,defaultValue:a}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,u=t.data.get(i.dataId).values,d=t.data.get(a.dataId).values[0],[f,m,y,b,w]=QB(o,s.shape,s.dtype,l,r.dtype,u,d);return[t.makeTensorInfo(m,s.dtype,f),t.makeTensorInfo([m[0]],r.dtype,y),t.makeTensorInfo([b.length],"bool",new Uint8Array(b.map(x=>Number(x)))),t.makeTensorInfo([w.length],s.dtype,new Int32Array(w))]}const Lle={kernelName:JL,backendName:"cpu",kernelFunc:Fle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ple(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const a=Array.from(t.data.get(r.dataId).values),o=t.data.get(s.dataId).values,l=Array.from(t.data.get(i.dataId).values),[u,d,f]=ZB(o,s.shape,s.dtype,a,l);return[t.makeTensorInfo(d,s.dtype,u),t.makeTensorInfo([f.length],i.dtype,new Int32Array(f))]}const Mle={kernelName:eP,backendName:"cpu",kernelFunc:Ple};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vle(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const a=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,l=t.data.get(i.dataId).values,[u,d]=J$(a,s.shape,s.dtype,o,l,!0);return t.makeTensorInfo(d,s.dtype,u)}const Ble={kernelName:tP,backendName:"cpu",kernelFunc:Vle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zle(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const a=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values,l=t.data.get(i.dataId).values,[u,d]=J$(a,s.shape,s.dtype,o,l);return t.makeTensorInfo(d,s.dtype,u)}const Ule={kernelName:nP,backendName:"cpu",kernelFunc:zle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jle(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:i,defaultValue:a}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:u,sliceSize:d,strides:f,outputSize:m}=th(i,r,o),y=!1,b=t.bufferSync(r);let w;switch(i.dtype){case"bool":{const x=t.bufferSync(i),T=!!t.data.get(a.dataId).values[0];w=mu(b,x,o,m,d,u,l,f,T,y);break}case"float32":{const x=t.bufferSync(i),T=t.data.get(a.dataId).values[0];w=mu(b,x,o,m,d,u,l,f,T,y);break}case"int32":{const x=t.bufferSync(i),T=t.data.get(a.dataId).values[0];w=mu(b,x,o,m,d,u,l,f,T,y);break}case"string":{const x=t.bufferSync(i),T=tc(t.data.get(a.dataId).values[0]);w=mu(b,x,o,m,d,u,l,f,T,y);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return t.makeTensorInfo(o,w.dtype,w.values)}const Wle={kernelName:sP,backendName:"cpu",kernelFunc:jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gle(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:i,axis:a}=s,o=gt(a,r.shape)[0],l=T$(r,i,o),u=new Array(r.shape.length).fill(0),d=r.shape.slice();return l.map(f=>{const m=[...d];m[o]=f;const y=Bu({inputs:{x:r},backend:t,attrs:{begin:u,size:m}});return u[o]+=f,y})}const Hle={kernelName:Nv,backendName:"cpu",kernelFunc:Gle};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qle={kernelName:mI,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,s=e;We(t,"square");const r=s.data.get(t.dataId).values,i=new Float32Array(r.length);for(let o=0;o<r.length;++o){const l=r[o];i[o]=l*l}return{dataId:s.write(i,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kle=Qt(Mg,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),Xle={kernelName:Mg,backendName:"cpu",kernelFunc:Kle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yle(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:i,end:a,strides:o,beginMask:l,endMask:u,ellipsisMask:d,newAxisMask:f,shrinkAxisMask:m}=s;We(r,"stridedSlice");const{finalShapeSparse:y,finalShape:b,isIdentity:w,sliceDim0:x,isSimpleSlice:T,begin:E,end:$,strides:C}=i$(r.shape,i,a,o,l,u,d,f,m);let O;if(w)O=un({inputs:{x:r},backend:t,attrs:{shape:b}});else if(x||T){H(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const V=n$(E,$,C),F=Bu({inputs:{x:r},backend:t,attrs:{begin:E,size:V}});O=un({inputs:{x:F},backend:t,attrs:{shape:b}}),t.disposeIntermediateTensorInfo(F)}else{const V=t.bufferSync(r),F=tz(y,V,C,E);O=t.makeTensorInfo(b,F.dtype,F.values)}return O}const Qle={kernelName:yI,backendName:"cpu",kernelFunc:Yle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zle(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:i,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:u}=s,{data:d,dataSplits:f}=e,m=t.data.get(d.dataId).values,y=t.data.get(f.dataId).values,[b,w]=nz(m,y,r,i,a,o,l,u);return[t.makeTensorInfo([b.length],"string",b),t.makeTensorInfo(f.shape,"int32",w)]}const Jle={kernelName:rP,backendName:"cpu",kernelFunc:Zle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ece(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:i,delimiter:a}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=t.data.get(i.dataId).values,l=t.data.get(a.dataId).values[0],[u,d,f]=sz(o,l,r),m=d.length;return[t.makeTensorInfo([m,2],"int32",u),t.makeTensorInfo([m],"string",d),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const tce={kernelName:iP,backendName:"cpu",kernelFunc:ece};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nce(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const a=t.data.get(i.dataId).values,o=rz(a,r);return t.makeTensorInfo(i.shape,"int32",o)}const sce={kernelName:aP,backendName:"cpu",kernelFunc:nce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rce=Qt(Fg,n=>Math.tan(n)),ice={kernelName:Fg,backendName:"cpu",kernelFunc:rce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ace=Qt(Lg,n=>Math.tanh(n)),oce={kernelName:Lg,backendName:"cpu",kernelFunc:ace};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(n){const{inputs:e,backend:t}=n,{tensor:s,indices:r,updates:i}=e,{sliceRank:a,numUpdates:o,sliceSize:l,strides:u,outputSize:d}=th(i,r,s.shape),f=!1,m=t.bufferSync(r),y=t.bufferSync(i),b=t.bufferSync(s),w=mu(m,y,s.shape,d,l,o,a,u,b,f);return t.makeTensorInfo(s.shape,w.dtype,w.values)}const cce={kernelName:QL,backendName:"cpu",kernelFunc:lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:i}=s;We(r,"tile");const a=az(t.bufferSync(r),i);return t.makeTensorInfo(a.shape,a.dtype,a.values)}const hce={kernelName:Pg,backendName:"cpu",kernelFunc:uce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:i,sorted:a}=s;We(r,"topk");const o=t.data.get(r.dataId).values,[l,u]=lz(o,r.shape,r.dtype,i,a);return[t.makeTensorInfo(l.shape,l.dtype,l.values),t.makeTensorInfo(u.shape,u.dtype,u.values)]}const fce={kernelName:bI,backendName:"cpu",kernelFunc:dce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pce(n){const{inputs:e,attrs:t,backend:s}=n,{image:r,transforms:i}=e,{interpolation:a,fillMode:o,fillValue:l,outputShape:u}=t,[d,f,m,y]=r.shape,[b,w]=u??[f,m],x=[d,b,w,y],T=Ye(r.shape),E=T[0],$=T[1],C=T[2],O=Ye(x),V=O[0],F=O[1],R=O[2],N=Vs(r.dtype,Ee(x));N.fill(l);const D=s.data.get(r.dataId).values,k=s.data.get(i.dataId).values;for(let B=0;B<d;++B){const ne=i.shape[0]===1?k:k.subarray(B*8,B*8+8);for(let J=0;J<b;++J)for(let K=0;K<w;++K)for(let re=0;re<y;++re){let Z;const he=ne[6]*K+ne[7]*J+1;if(he===0)continue;const W=(ne[0]*K+ne[1]*J+ne[2])/he,ee=(ne[3]*K+ne[4]*J+ne[5])/he,me=ID(W,m,o),de=ID(ee,f,o);switch(a){case"nearest":Z=vce(D,f,m,E,$,C,B,de,me,re,l);break;case"bilinear":Z=wce(D,f,m,E,$,C,B,de,me,re,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${a}`)}const be=B*V+J*F+K*R+re;N[be]=Z}return s.makeTensorInfo(x,r.dtype,N)}return{dataId:s.write(N,x,r.dtype),shape:r.shape,dtype:r.dtype}}const mce={kernelName:xI,backendName:"cpu",kernelFunc:pce};function ID(n,e,t){switch(t){case"reflect":return gce(n,e);case"wrap":return yce(n,e);case"nearest":return xce(n,e);case"constant":default:return bce(n)}}function gce(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=2*e;t<s&&(t=s*Math.trunc(-t/s)+t),t=t<-e?t+s:-t-1}else if(t>e-1)if(e<=1)t=0;else{const s=2*e;t-=s*Math.trunc(t/s),t>=e&&(t=s-t-1)}return Cu(0,t,e-1)}function yce(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=e-1;t+=e*(Math.trunc(-t/s)+1)}else if(t>e-1)if(e<=1)t=0;else{const s=e-1;t-=e*Math.trunc(t/s)}return Cu(0,t,e-1)}function bce(n,e){return n}function xce(n,e){return Cu(0,n,e-1)}function Wp(n,e,t,s,r,i,a,o,l,u,d){const f=a*s+o*r+l*i+u;return 0<=o&&o<e&&0<=l&&l<t?n[f]:d}function vce(n,e,t,s,r,i,a,o,l,u,d){const f=Math.round(o),m=Math.round(l);return Wp(n,e,t,s,r,i,a,f,m,u,d)}function wce(n,e,t,s,r,i,a,o,l,u,d){const f=Math.floor(o),m=Math.floor(l),y=f+1,b=m+1,w=(b-l)*Wp(n,e,t,s,r,i,a,f,m,u,d)+(l-m)*Wp(n,e,t,s,r,i,a,f,b,u,d),x=(b-l)*Wp(n,e,t,s,r,i,a,y,m,u,d)+(l-m)*Wp(n,e,t,s,r,i,a,y,b,u,d);return(y-o)*w+(o-f)*x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sce(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:i}=e;We(i,"unique");const a=s.data.get(i.dataId).values,{outputValues:o,outputShape:l,indices:u}=cz(a,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,o),s.makeTensorInfo([u.length],"int32",u)]}const Tce={kernelName:vI,backendName:"cpu",kernelFunc:Sce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ece(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const a=r.shape.length,o=r.shape[i],l=new Array(a-1);let u=0;for(let y=0;y<a;y++)y!==i&&(l[u++]=r.shape[y]);const d=new Array(a).fill(0),f=r.shape.slice();f[i]=1;const m=new Array(o);for(let y=0;y<m.length;y++){d[i]=y;const b=Bu({inputs:{x:r},backend:t,attrs:{begin:d,size:f}});m[y]=un({inputs:{x:b},backend:t,attrs:{shape:l}}),t.disposeIntermediateTensorInfo(b)}return m}const _ce={kernelName:Av,backendName:"cpu",kernelFunc:Ece};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ice(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:i}=e,{numSegments:a}=s;We(r,"unsortedSegmentSum");const o=r.shape.length,l=i.shape.length,u=[],d=[],f=o-l;let m=i;for(let b=0;b<f;++b){const w=nx({inputs:{input:m},backend:t,attrs:{dim:b+1}});m=w,d.push(w)}for(let b=0;b<a;++b){const w=mc(b,"int32"),x=t.makeTensorInfo([],"int32",w),T=EB({inputs:{a:x,b:m},backend:t}),E=ac({inputs:{x:T},backend:t,attrs:{dtype:"float32"}}),$=s1({inputs:{a:E,b:r},backend:t}),C=ey({inputs:{x:$},backend:t,attrs:{axis:0,keepDims:!1}});u.push(C),d.push(x),d.push(T),d.push(E),d.push($),d.push(C)}const y=Ez({inputs:u,backend:t,attrs:{axis:0}});return d.forEach(b=>t.disposeIntermediateTensorInfo(b)),y}const $ce={kernelName:Rv,backendName:"cpu",kernelFunc:Ice};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cce=[Sre,nse,Ere,Ire,lse,Cre,kre,Rre,Ore,Lre,Mre,Bre,Ure,Gre,qre,Yre,Zre,eie,nie,vre,rie,aie,lie,use,uie,ase,dse,die,sse,pie,gie,yie,xie,wie,Tie,_ie,$ie,Nie,Aie,Die,Fie,Pie,Vie,zie,Uie,Wie,Hie,Kie,Xie,Yie,Qie,Jie,nae,fre,rae,fse,dae,pse,fae,gse,xae,vae,Sae,bse,vse,Eae,Iae,Cae,kae,Sse,Ese,rse,Rae,mie,Oae,Lae,Mae,pre,Ise,Cse,Bae,kse,Uae,Gae,qae,Yae,Zae,eoe,toe,Rse,soe,ioe,ooe,coe,hoe,foe,moe,Ose,yoe,voe,Toe,Lse,Mse,Ioe,Noe,Roe,Bse,Ooe,Loe,Poe,_z,zoe,gre,jse,joe,Goe,qoe,Xoe,ise,lE,Qoe,yre,bre,xre,Joe,tle,sle,ile,ole,lle,ule,Qse,dle,yle,xle,Tle,Jse,_le,$le,Nle,ere,woe,Rle,Ole,Lle,Mle,Ble,Ule,Wle,Hle,sre,qle,ire,ore,Xle,Qle,Jle,tce,sce,hre,eae,ice,oce,cce,hce,fce,mce,zse,Tce,_ce,$ce,Foe];for(const n of Cce)lP(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fu={},Bb={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Nce(n,e){fu[n]=e}function Zi(n,e){if(!(n in fu)||e!=null){const s=Ace(n,e);if(s!==null)fu[n]=s;else return console.log("Could not get context for WebGL version",n),null}const t=fu[n];return t==null||t.isContextLost()?(delete fu[n],Zi(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),fu[n])}function kce(n){if(!xe().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Ace(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??kce(n);return t.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete fu[n]},!1),xe().getBool("SOFTWARE_WEBGL_ENABLED")&&(Bb.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",Bb)||t.getContext("experimental-webgl",Bb):t.getContext("webgl2",Bb)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wm;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(wm||(wm={}));var qr;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(qr||(qr={}));var Es;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Es||(Es={}));function ty(n,e){return[e,n]}function Rce(n,e){return n*e}function zb(n){const e=Ee(n),t=Math.ceil(e/4);return kT(t)}function uf(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function Dce(n,e){const[t,s]=uf(n,e);return t*s*4}function rC(n,e){const t=n;let s,r,i,a,o,l,u,d,f,m;return xe().getNumber("WEBGL_VERSION")===2?(s=t.R32F,r=t.R16F,i=t.RGBA16F,a=t.RGBA32F,o=t.RED,u=4,d=1,f=t.HALF_FLOAT,m=t.FLOAT,l=t.RGBA8):(s=n.RGBA,r=n.RGBA,i=n.RGBA,a=t.RGBA,o=n.RGBA,u=4,d=4,f=e!=null?e.HALF_FLOAT_OES:null,m=n.FLOAT,l=n.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:d,textureTypeHalfFloat:f,textureTypeFloat:m}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ze(n,e){const t=e();return xe().getBool("DEBUG")&&Oce(n),t}function Oce(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+Mce(n,e))}const Fce=596e-10,Lce=65504;function Pce(n){return!!(xe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||Fce<Math.abs(n)&&Math.abs(n)<Lce)}function Mce(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Ub(n,e){return Ko(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function Vce(n,e){const t=Ko(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ze(n,()=>n.shaderSource(t,e)),ze(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function Bce(n,e){const t=Ko(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ze(n,()=>n.shaderSource(t,e)),ze(n,()=>n.compileShader(t)),xe().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw Iz(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const zce=/ERROR: [0-9]+:([0-9]+):/g;function Iz(n,e){const t=zce.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const s=+t[1],r=n.split(`
`),i=r.length.toString().length+2,a=r.map((f,m)=>hd((m+1).toString(),i)+f);let o=0;for(let f=0;f<a.length;f++)o=Math.max(a[f].length,o);const l=a.slice(0,s-1),u=a.slice(s-1,s),d=a.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${hd(u[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join(`
`))}function Uce(n){return Ko(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function jce(n,e){if(ze(n,()=>n.linkProgram(e)),!xe().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function tT(n,e){if(ze(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Wce(n,e){const t=Ko(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return ze(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),ze(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function Gce(n,e){const t=Ko(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return ze(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),ze(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function Hce(n){return Ko(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function qce(n,e){const t=xe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const s=`[${n}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(n>t||e>t){const s=`[${n}x${e}]`,r=`[${t}x${t}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function Kce(n){return Ko(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function $D(n,e,t,s,r,i,a){const o=n.getAttribLocation(e,t);return o===-1?!1:(ze(n,()=>n.bindBuffer(n.ARRAY_BUFFER,s)),ze(n,()=>n.vertexAttribPointer(o,r,n.FLOAT,!1,i,a)),ze(n,()=>n.enableVertexAttribArray(o)),!0)}function Xce(n,e,t){eue(n,t),ze(n,()=>n.activeTexture(n.TEXTURE0+t)),ze(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function Yce(n,e,t){return Ko(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function Qce(n,e,t){return n.getUniformLocation(e,t)}function Zce(n,e,t,s){ze(n,()=>Xce(n,e,s)),ze(n,()=>n.uniform1i(t,s))}function nT(n,e,t){ze(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),ze(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function CD(n,e){ze(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),ze(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function jb(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Jce(n,e))}function Jce(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Ko(n,e,t){const s=ze(n,()=>e());if(s==null)throw new Error(t);return s}function eue(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+n.TEXTURE0;if(s<n.TEXTURE0||s>t){const r=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Od(n,e=2){return Ee(n.slice(0,n.length-e))}function Fd(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Wb(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Od(n),...Fd(n)]),e}function tue(n,e=!1){let t=xe().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=xe().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&xe().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=t/2),e&&(t=t*2,s=s*2,n=n.map((o,l)=>l>=n.length-2?k_(n[l]):n[l]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=pc(n).newShape);let r=Ee(n),i=null;n.length<=1&&r<=t?i=[1,r]:n.length===2&&n[0]<=t&&n[1]<=t?i=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?i=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?i=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?i=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(i=[n[0],n[1]*n[2]*n[3]]);const a=i!=null&&Math.max(...i)>s&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||a)if(e){const o=Od(n);let l=2,u=2;n.length&&([l,u]=Fd(n)),r=o*(l/2)*(u/2),i=kT(r).map(d=>d*2)}else i=kT(r);return i}function Gb(n){return n%2===0}function rx(n,e){if(n=n.slice(-2),e=e.slice(-2),Gt(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],s=e[e.length-1];if(t===s||Gb(t)&&Gb(s)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&Gb(n[0])&&Gb(e[0])}let sT,rT;function nue(n){if(sT==null){const e=Zi(n);sT=e.getParameter(e.MAX_TEXTURE_SIZE)}return sT}function sue(n){if(rT==null){const e=Zi(n);rT=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,rT)}function rue(n){if(n===0)return 0;let e;const t=Zi(n);return Ti(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:Ti(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function Ti(n,e){return n.getExtension(e)!=null}function ND(n){try{if(Zi(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function iue(n){if(n===0)return!1;const e=Zi(n);if(n===1){if(!Ti(e,"OES_texture_float"))return!1}else if(!Ti(e,"EXT_color_buffer_float"))return!1;return uE(e)}function aue(n){if(n===0)return!1;const e=Zi(n);if(n===1){if(!Ti(e,"OES_texture_float")||!Ti(e,"WEBGL_color_buffer_float"))return!1}else{if(Ti(e,"EXT_color_buffer_float"))return uE(e);const s="EXT_color_buffer_half_float";if(Ti(e,s)){const r=e.getExtension(s);return oue(e,r)}return!1}return uE(e)}function uE(n){const e=rC(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(i),a}function oue(n,e){const t=rC(n,e),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(a),o}function lue(n){return n!==2?!1:Zi(n).fenceSync!=null}function ny(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&H(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const He=xe();He.registerFlag("HAS_WEBGL",()=>He.getNumber("WEBGL_VERSION")>0);He.registerFlag("WEBGL_VERSION",()=>ND(2)?2:ND(1)?1:0);He.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);He.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>He.get("WEBGL_VERSION")===2);He.registerFlag("WEBGL_CPU_FORWARD",()=>!0);He.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);He.registerFlag("WEBGL_PACK",()=>He.getBool("HAS_WEBGL"));He.registerFlag("WEBGL_PACK_NORMALIZATION",()=>He.getBool("WEBGL_PACK"));He.registerFlag("WEBGL_PACK_CLIP",()=>He.getBool("WEBGL_PACK"));He.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>He.getBool("WEBGL_PACK"));He.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>He.getBool("WEBGL_PACK"));He.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>He.getBool("WEBGL_PACK"));He.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>He.getBool("WEBGL_PACK"));He.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>He.getBool("WEBGL_PACK"));He.registerFlag("WEBGL_PACK_REDUCE",()=>He.getBool("WEBGL_PACK"));He.registerFlag("WEBGL_LAZILY_UNPACK",()=>He.getBool("WEBGL_PACK"));He.registerFlag("WEBGL_CONV_IM2COL",()=>He.getBool("WEBGL_PACK"));He.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>He.getBool("WEBGL_PACK"));He.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>nue(He.getNumber("WEBGL_VERSION")));He.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>sue(He.getNumber("WEBGL_VERSION")));He.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=He.getNumber("WEBGL_VERSION");return n===0?0:rue(n)});He.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>He.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!wP());He.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>iue(He.getNumber("WEBGL_VERSION")));He.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>He.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:He.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));He.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>aue(He.getNumber("WEBGL_VERSION")));He.registerFlag("WEBGL_FENCE_API_ENABLED",()=>lue(He.getNumber("WEBGL_VERSION")));He.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>He.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);He.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});He.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>wP()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});He.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);He.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);He.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);He.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);He.registerFlag("WEBGL_EXP_CONV",()=>!1);He.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>He.getBool("IS_TEST"));He.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);He.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);He.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);He.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ur(){let n,e,t,s,r,i,a,o,l,u;return xe().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",s="in",r="texture",i="outputColor",a="out vec4 outputColor;",o=xe().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",s="varying",r="texture2D",i="gl_FragColor",a="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:s,texture2D:r,output:i,defineOutput:a,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rh(n,e,t="index"){const s=Ye(e);return s.map((r,i)=>{const a=`int ${n[i]} = ${t} / ${r}`,o=i===s.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${r}`:`index -= ${n[i]} * ${r}`;return`${a}; ${o};`}).join("")}function r1(n,e,t="index"){const s=Ye(e);return s.map((r,i)=>{const a=`int ${n[i]} = ${t} / outShapeStrides[${i}]`,o=i===s.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * outShapeStrides[${i}]`:`index -= ${n[i]} * outShapeStrides[${i}]`;return`${a}; ${o};`}).join("")}function cue(n,e){const t=n.length,s=n.map(i=>`${e}[${i}]`),r=new Array(t-1);r[t-2]=s[t-1];for(let i=t-3;i>=0;--i)r[i]=`(${r[i+1]} * ${s[i+1]})`;return r}function uue(n,e,t="index"){const s=n.map((i,a)=>a),r=cue(s,e);return r.map((i,a)=>{const o=`int ${n[a]} = ${t} / ${r[a]}`,l=a===r.length-1?`int ${n[a+1]} = ${t} - ${n[a]} * ${r[a]}`:`index -= ${n[a]} * ${r[a]}`;return`${o}; ${l};`}).join("")}function iC(n){const e=Ye(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function aC(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const $z=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:Cz}=eJ;function hue(n,e,t){const s=[];if(n.forEach(y=>{const b=Ee(y.shapeInfo.logicalShape);if(y.shapeInfo.isUniform?s.push(`uniform float ${y.name}${b>1?`[${b}]`:""};`):(s.push(`uniform sampler2D ${y.name};`),s.push(`uniform int offset${y.name};`)),t.enableShapeUniforms){const{uniformShape:w}=oC(t.packedInputs,y.shapeInfo.logicalShape,y.shapeInfo.texShape);switch(w.length){case 1:s.push(`uniform int ${y.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${y.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${y.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${y.name}Shape;`);break}s.push(`uniform ivec2 ${y.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(y=>{s.push(`uniform ${y.type} ${y.name}${y.arrayIndex?`[${y.arrayIndex}]`:""};`)});const r=s.join(`
`),i=n.map(y=>due(y,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),a=e.texShape,o=ur(),l=mue(o);let u,d,f=bue(o);return e.isPacked?(u=fue(e.logicalShape,a,t.enableShapeUniforms),d=yue(o)):(u=pue(e.logicalShape,a,t.enableShapeUniforms),d=gue(o)),t.packedInputs&&(f+=Sue),[f,l,d,r,u,i,t.userCode].join(`
`)}function hf(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return Oue(n,e);case 1:return Lue(n,e);case 2:return Mue(n,e);case 3:return Bue(n,e);case 4:return Uue(n,e);case 5:return jue(n);case 6:return Wue(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function Nz(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return Due(n);case 1:return Fue(n,e);case 2:return Pue(n,e);case 3:return Vue(n,e);default:return zue(n,e)}}function due(n,e,t=!1,s){let r="";t?r+=Nz(n,s):r+=hf(n,s);const i=n.shapeInfo.logicalShape,a=e.logicalShape;return i.length<=a.length&&(t?r+=Gue(n,e):r+=Hue(n,e)),r}function fue(n,e,t){switch(n.length){case 0:return kz();case 1:return Tue(n,e,t);case 2:return Aue(n,e,t);case 3:return _ue(n,e,t);default:return $ue(n,e,t)}}function pue(n,e,t){switch(n.length){case 0:return kz();case 1:return Eue(n,e,t);case 2:return Rue(n,e,t);case 3:return Iue(n,e,t);case 4:return Cue(n,e,t);case 5:return Nue(n,e);case 6:return kue(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function mue(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function gue(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function yue(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function bue(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${xue}
    ${vue}
    ${wue}
  `}const xue=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,vue=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,wue=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Sue=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function kz(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Tue(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function Eue(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function _ue(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[2]/2),i=r*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function Iue(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${r1(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const s=rh(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function $ue(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[n.length-1]/2),i=r*Math.ceil(n[n.length-2]/2);let a=i,o="",l="b, r, c";for(let u=2;u<n.length-1;u++)a*=n[n.length-u-1],o=`
      int b${u} = index / ${a};
      index -= b${u} * ${a};
    `+o,l=`b${u}, `+l;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${o}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${n.length}(${l});
    }
  `}function Cue(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${r1(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const s=rh(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function Nue(n,e){const t=rh(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function kue(n,e){const t=rh(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Aue(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Gt(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function Rue(n,e,t){return Gt(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function ih(n){return`offset${n}`}function Due(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),s=ur();return`
    vec4 ${t}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function Oue(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${s}() {return ${t};}`;const[r,i]=n.shapeInfo.texShape;if(r===1&&i===1)return`
      float ${s}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=ih(t);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${a});
      return sampleTexture(${t}, uv);
    }
  `;const[o,l]=n.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${a});
      return sampleTexture(${t}, uv);
    }
  `}function Fue(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=n.shapeInfo.texShape,i=ur();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${t}, uv);
    }
  `;const a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${a[0]}, ${a[1]}, index);
      return ${i.texture2D}(${t}, uv);
    }
  `}function Lue(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${df(n)}
      }
    `;const r=n.shapeInfo.texShape,i=r[0],a=r[1];if(a===1&&i===1)return`
      float ${s}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const o=ih(t);return a===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${i}.0);
        return sampleTexture(${t}, uv);
      }
    `:i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${a}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${o});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${i}, ${a}, index + ${o});
      return sampleTexture(${t}, uv);
    }
  `}function Pue(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n.shapeInfo.texShape,a=i[0],o=i[1],l=ur();if(i!=null&&Gt(t,i))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${a}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],d=Math.ceil(t[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${d}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function Mue(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n.shapeInfo.texShape;if(i!=null&&Gt(t,i)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const m=i[0],y=i[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${y}.0, ${m}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:a,keptDims:o}=pc(t),l=a;if(l.length<t.length){const m=ff(n,l),y=["row","col"];return`
      ${hf(m,e)}
      float ${r}(int row, int col) {
        return ${r}(${pf(y,o)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${df(n)}
      }
    `;const u=i[0],d=i[1],f=ih(s);return d===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${s}, uv);
    }
  `:u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${d}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${f};
    vec2 uv = uvFromFlat(${u}, ${d}, index);
    return sampleTexture(${s}, uv);
  }
`}function Vue(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n.shapeInfo.texShape,a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(t[0]===1){const m=t.slice(1),y=[1,2],b=ff(n,m),w=["b","row","col"];return`
        ${Nz(b,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${pf(w,y)});
        }
      `}const o=ur();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `;const l=a[0],u=a[1],d=Math.ceil(t[2]/2),f=d*Math.ceil(t[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${f}, ${d}, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `}function Bue(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t[1]*t[2],a=t[2],{newShape:o,keptDims:l}=pc(t),u=o;if(u.length<t.length){const w=ff(n,u),x=["row","col","depth"];return`
        ${hf(w,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${pf(x,l)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${a}, 1)));
        ${df(n)}
      }
    `;const d=n.shapeInfo.texShape,f=d[0],m=d[1],y=n.shapeInfo.flatOffset;if(m===i&&y==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${a}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${m}.0, ${f}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(m===a&&y==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${m}.0, ${f}.0);
      return sampleTexture(${s}, uv);
    }
  `;const b=ih(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${b};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${a} + depth + ${b};
        vec2 uv = uvFromFlat(${f}, ${m}, index);
        return sampleTexture(${s}, uv);
      }
  `}function zue(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=ur();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${t}, uv);
    }
  `;const i=n.shapeInfo.logicalShape,a=i.length,o=n.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=l[0],d=l[1],f=Math.ceil(i[a-1]/2);let m=f*Math.ceil(i[a-2]/2),y="int b, int row, int col",b=`b * ${m} + (row / 2) * ${f} + (col / 2)`;for(let w=2;w<a-1;w++)y=`int b${w}, `+y,m*=i[a-w-1],b=`b${w} * ${m} + `+b;return`
    vec4 ${s}(${y}) {
      int index = ${b};
      int texR = index / ${d};
      int texC = index - texR * ${d};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}, ${u});
      return ${r.texture2D}(${t}, uv);
    }
  `}function Uue(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t[3],a=t[2]*i,o=t[1]*a,{newShape:l,keptDims:u}=pc(t);if(l.length<t.length){const E=ff(n,l),$=["row","col","depth","depth2"];return`
      ${hf(E,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${pf($,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${a}, ${i}, 1)));
        ${df(n)}
      }
    `;const d=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,m=f[0],y=f[1],b=`int stride2 = ${s}Shape[3];`,w=`int stride1 = ${s}Shape[2] * stride2;`,x=`int stride0 = ${s}Shape[1] * stride1;`;if(y===o&&d==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${b}
        ${w}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${a}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${m}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(y===i&&d==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${m}.0);
        return sampleTexture(${s}, uv);
      }
    `;const T=ih(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${b}
      ${w}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${T});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${m}, ${y}, index + ${T});
      return sampleTexture(${s}, uv);
    }
  `}function jue(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e[4],i=e[3]*r,a=e[2]*i,o=e[1]*a,{newShape:l,keptDims:u}=pc(e);if(l.length<e.length){const w=ff(n,l),x=["row","col","depth","depth2","depth3"];return`
      ${hf(w)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${pf(x,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${a}, ${i}, ${r})) +
          depth3;
        ${df(n)}
      }
    `;const d=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,m=f[0],y=f[1];if(y===o&&d==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${a}, ${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${m}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(y===r&&d==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${m}.0);
        return sampleTexture(${t}, uv);
      }
    `;const b=ih(t);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} + depth * ${i} +
          depth2 * ${r} + depth3 + ${b};
      vec2 uv = uvFromFlat(${m}, ${y}, index);
      return sampleTexture(${t}, uv);
    }
  `}function Wue(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:r,keptDims:i}=pc(e);if(r.length<e.length){const x=ff(n,r),T=["row","col","depth","depth2","depth3","depth4"];return`
      ${hf(x)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${pf(T,i)});
      }
    `}const a=e[5],o=e[4]*a,l=e[3]*o,u=e[2]*l,d=e[1]*u;if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${d}, ${u}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${a}, 1)));
        ${df(n)}
      }
    `;const f=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,y=m[0],b=m[1];if(b===d&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${o}, ${a})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${b}.0, ${y}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(b===a&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${b}.0, ${y}.0);
        return sampleTexture(${t}, uv);
      }
    `;const w=ih(t);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${d} + col * ${u} + depth * ${l} +
          depth2 * ${o} + depth3 * ${a} + depth4 + ${w};
      vec2 uv = uvFromFlat(${y}, ${b}, index);
      return sampleTexture(${t}, uv);
    }
  `}function df(n){const e=n.name,t=Ee(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Gue(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",i=n.shapeInfo.logicalShape.length,a=e.logicalShape.length,o=Cz(n.shapeInfo.logicalShape,e.logicalShape),l=Jt(a),u=a-i;let d;const f=["x","y","z","w","u","v"];i===0?d="":a<2&&o.length>=1?d="coords = 0;":d=o.map(E=>`coords.${f[E+u]} = 0;`).join(`
`);let m="";a<2&&i>0?m="coords":m=n.shapeInfo.logicalShape.map((E,$)=>`coords.${f[$+u]}`).join(", ");let y="return outputValue;";const w=Ee(n.shapeInfo.logicalShape)===1,T=Ee(e.logicalShape)===1;if(i===1&&!w&&!T)y=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(w&&!T)a===1?y=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:y=`
        return vec4(outputValue.x);
      `;else if(o.length){const E=i-2,$=i-1;o.indexOf(E)>-1&&o.indexOf($)>-1?y="return vec4(outputValue.x);":o.indexOf(E)>-1?y="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf($)>-1&&(y="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${d}
      vec4 outputValue = get${s}(${m});
      ${y}
    }
  `}function Hue(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",i=e.texShape,a=n.shapeInfo.texShape,o=n.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!n.shapeInfo.isUniform&&o===l&&n.shapeInfo.flatOffset==null&&Gt(a,i))return`
      float ${r}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const u=Jt(l),d=Cz(n.shapeInfo.logicalShape,e.logicalShape),f=l-o;let m;const y=["x","y","z","w","u","v"];o===0?m="":l<2&&d.length>=1?m="coords = 0;":m=d.map(w=>`coords.${y[w+f]} = 0;`).join(`
`);let b="";return l<2&&o>0?b="coords":b=n.shapeInfo.logicalShape.map((w,x)=>`coords.${y[x+f]}`).join(", "),`
    float ${r}() {
      ${u} coords = getOutputCoords();
      ${m}
      return get${s}(${b});
    }
  `}function Jt(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function oC(n,e,t){const{newShape:s,keptDims:r}=pc(e),i=e.length,a=n&&i===3&&e[0]===1,o=a?e.slice(1):s,l=!n&&i>1&&!Gt(e,t)&&s.length<i||a;return{useSqueezeShape:l,uniformShape:l?o:e,keptDims:r}}function ff(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function pf(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function que(n,e,t,s){const r=t.map((d,f)=>{const m={logicalShape:d.shape,texShape:d.isUniform?null:d.texData.texShape,isUniform:d.isUniform,isPacked:d.isUniform?!1:d.texData.isPacked,flatOffset:null};return d.texData!=null&&d.texData.slice!=null&&d.texData.slice.flatOffset>0&&(m.flatOffset=d.texData.slice.flatOffset),{name:e.variableNames[f],shapeInfo:m}}),i=r.map(d=>d.shapeInfo),a={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},o=hue(r,a,e),l=Bce(n.gl,o),u=n.createProgram(l);return xe().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:i,outShapeInfo:a,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(u),Object.assign({program:e,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:i,outShapeInfo:a},Az(n,e,u)))}function Az(n,e,t){const s=[],r=[];let i,a,o,l=null,u=null;u=n.getUniformLocation(t,"NAN",!1),xe().getNumber("WEBGL_VERSION")===1&&(l=n.getUniformLocation(t,"INFINITY",!1));const d=!1;for(const f of e.variableNames){const m={name:f,uniform:n.getUniformLocation(t,f,d),offset:n.getUniformLocation(t,`offset${f}`,d)};e.enableShapeUniforms&&(m.shape=n.getUniformLocation(t,`${f}Shape`,d),m.texShape=n.getUniformLocation(t,`${f}TexShape`,d)),s.push(m)}if(e.enableShapeUniforms&&(i=n.getUniformLocation(t,"outShape",d),o=n.getUniformLocation(t,"outShapeStrides",d),a=n.getUniformLocation(t,"outTexShape",d)),e.customUniforms)for(const f of e.customUniforms)r.push(n.getUniformLocation(t,f.name,d));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:u,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:a}}function kD(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,s)=>{const r=t.logicalShape,i=e[s],a=i.shape;if(!Gt(r,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${a} must match`);if(t.isUniform&&i.isUniform)return;const o=t.texShape,l=i.isUniform?null:i.texData.texShape;if(!Gt(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function Kue(n,e,t,s,r){e.program.enableShapeUniforms||(kD(e.inShapeInfos,t),kD([e.outShapeInfo],[s]));const i=s.texData.texture,a=s.texData.texShape;s.texData.isPacked?n.setOutputPackedMatrixTexture(i.texture,a[0],a[1]):n.setOutputMatrixTexture(i.texture,a[0],a[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),xe().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<t.length;++l){const u=t[l],{uniform:d,offset:f,shape:m,texShape:y}=e.variablesLocations[l];if(m){const{uniformShape:b}=oC(e.program.packedInputs,u.shape,u.texData.texShape);switch(b.length){case 1:n.gl.uniform1iv(m,new Int32Array(b));break;case 2:n.gl.uniform2iv(m,new Int32Array(b));break;case 3:n.gl.uniform3iv(m,new Int32Array(b));break;case 4:n.gl.uniform4iv(m,new Int32Array(b));break}}if(y&&n.gl.uniform2i(y,u.texData.texShape[0],u.texData.texShape[1]),d!=null){if(u.isUniform){if(Ee(u.shape)<2)n.gl.uniform1f(d,u.uniformValues[0]);else{let b=u.uniformValues;b instanceof Float32Array||(b=new Float32Array(b)),n.gl.uniform1fv(d,b)}continue}u.texData.slice!=null&&f!=null&&n.gl.uniform1i(f,u.texData.slice.flatOffset),n.setInputMatrixTexture(u.texData.texture.texture,d,l)}}const o=e.outShapeLocation;if(o)switch(s.shape.length){case 1:n.gl.uniform1iv(o,new Int32Array(s.shape));break;case 2:n.gl.uniform2iv(o,new Int32Array(s.shape));break;case 3:n.gl.uniform3iv(o,new Int32Array(s.shape));break;case 4:n.gl.uniform4iv(o,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Ye(s.shape);switch(s.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],d=e.customUniformLocations[l],f=r[l];if(u.type==="float")n.gl.uniform1fv(d,f);else if(u.type==="vec2")n.gl.uniform2fv(d,f);else if(u.type==="vec3")n.gl.uniform3fv(d,f);else if(u.type==="vec4")n.gl.uniform4fv(d,f);else if(u.type==="int")n.gl.uniform1iv(d,f);else if(u.type==="ivec2")n.gl.uniform2iv(d,f);else if(u.type==="ivec3")n.gl.uniform3iv(d,f);else if(u.type==="ivec4")n.gl.uniform4iv(d,f);else throw Error(`uniform type ${u.type} is not supported yet.`)}n.executeProgram()}function Xue(n,e,t){let s="";e.concat(t).forEach(a=>{const o=a.texData!=null&&a.texData.slice!=null&&a.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!a.isUniform){const l=a.texData.texShape,{useSqueezeShape:u,uniformShape:d,keptDims:f}=oC(n.packedInputs,a.shape,l);let m="",y="",b="";if(d.length===1&&n.packedInputs){const O=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];m=`${O[0]>1}_${O[1]>1}`}else if(d.length===2&&!n.packedInputs)y=`${d[0]>1}_${d[1]>1}`;else if(d.length>2&&!n.packedInputs){const O=Ye(d);b=`${O[0]===l[1]}_${O[O.length-1]===l[1]}`}const w=a.shape.length,x=d.length===2&&Gt(a.shape,l),T=Ee(a.shape)===1,E=$d(a.shape,t.shape),$=!n.packedInputs&&w===t.shape.length&&Gt(l,t.texData.texShape),C=n.packedInputs||d.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${w}_${$}_${u?f:""}_${d.length}_${T}_${E}_${x}_${m}_${y}_${b}_${C}_${o}`}else{const l=a.isUniform?"uniform":a.texData.texShape;s+=`${a.shape}_${l}_${o}`}});const r=n.userCode;let i=n.constructor.name;return i+="_"+s+"_"+r+`${xe().getNumber("WEBGL_VERSION")}`,i}function Gs(n){return xe().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yue{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=wm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=ur();this.outputShape=e,this.enableShapeUniforms=Gs(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?r1(["r","c","d"],e):rh(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Que{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=wm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=ur();this.outputShape=e,this.enableShapeUniforms=Gs(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?r1(["r","c","d"],e):rh(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zue{constructor(e){this.variableNames=["A"],this.outTexUsage=qr.DOWNLOAD;const t=ur();this.outputShape=e,this.userCode=`
      ${$z}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jue{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=qr.DOWNLOAD;const t=ur();this.outputShape=e,this.userCode=`
      ${$z}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ehe={R:0,G:1,B:2,A:3};class AD{constructor(e,t=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ur();this.outputShape=e,this.enableShapeUniforms=Gs(this.outputShape.length);let i="result";t&&(i="floor(result * 255. + 0.5)");let a="";for(let o=0;o<s.length;o++){const l=s[o];a+=`
          if(offset == ${o}) {
            result = values[${ehe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?aC():iC(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${a}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class the{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ur();this.outputShape=e,this.enableShapeUniforms=Gs(this.outputShape.length);let r="",i="result";t&&(i="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let o=0;o<=1;o++){const l=a*2+o;r+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${a} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${a};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?aC():iC(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(n){const e=ur(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Vce(n,t)}function she(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Wce(n,e)}function rhe(n){const e=new Uint16Array([0,1,2,2,1,3]);return Gce(n,e)}function sy(n,e,t,s,r,i){qce(e,t);const a=Hce(n),o=n.TEXTURE_2D;return ze(n,()=>n.bindTexture(o,a)),ze(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),ze(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),ze(n,()=>n.texParameteri(o,n.TEXTURE_MIN_FILTER,n.NEAREST)),ze(n,()=>n.texParameteri(o,n.TEXTURE_MAG_FILTER,n.NEAREST)),xe().getNumber("WEBGL_VERSION")===1?ze(n,()=>n.texImage2D(o,0,s,e,t,0,r,i,null)):ze(n,()=>n.texStorage2D(o,1,s,e,t)),ze(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:a,texShape:[t,e]}}function Rz(n){return n.internalFormatFloat}function ihe(n,e,t,s){const[r,i]=ty(e,t);return sy(n,r,i,Rz(s),s.textureFormatFloat,n.FLOAT)}function Dz(n){return n.internalFormatHalfFloat}function ahe(n,e,t,s){const[r,i]=ty(e,t);return sy(n,r,i,Dz(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function Oz(n){return n.downloadTextureFormat}function ohe(n,e,t,s){const[r,i]=ty(e,t);return sy(n,r,i,Oz(s),n.RGBA,n.UNSIGNED_BYTE)}function Fz(n){return n.internalFormatPackedFloat}function lhe(n,e,t,s){const[r,i]=uf(e,t);return sy(n,r,i,Fz(s),n.RGBA,n.FLOAT)}function Lz(n){return n.internalFormatPackedHalfFloat}function che(n,e,t,s){const[r,i]=uf(e,t);return sy(n,r,i,Lz(s),n.RGBA,s.textureTypeHalfFloat)}function uhe(n,e,t){return ze(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),$D(n,e,"clipSpacePos",t,3,20,0)&&$D(n,e,"uv",t,2,20,12)}function hhe(n,e,t,s,r,i){ze(n,()=>n.bindTexture(n.TEXTURE_2D,e));let a,o,l;r instanceof Uint8Array?(a=new Uint8Array(t*s*4),o=n.UNSIGNED_BYTE,l=n.RGBA):(a=new Float32Array(t*s*4),o=n.FLOAT,l=i.internalFormatPackedFloat),a.set(r),xe().getNumber("WEBGL_VERSION")===2?ze(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,s,n.RGBA,o,a)):ze(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,t,s,0,n.RGBA,o,a)),ze(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function dhe(n,e,t){ze(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?xe().getNumber("WEBGL_VERSION")===2?ze(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):ze(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):xe().getNumber("WEBGL_VERSION")===2?ze(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):ze(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),ze(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function fhe(n,e,t,s){const r=n.createBuffer();ze(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,r));const o=4*4*e*t;return ze(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,o,n.STREAM_READ)),ze(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),ze(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),r}function phe(n,e,t){const s=n,r=new Float32Array(t);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function mhe(n,e,t,s){const[r,i]=ty(e,t),a=4,o=new Uint8Array(Rce(e*t,a));return ze(n,()=>n.readPixels(0,0,r,i,s.downloadTextureFormat,n.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function ghe(n,e,t,s,r,i,a,o){const l=n,u=new Float32Array(Dce(i,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function yhe(n,e,t){const s=new Float32Array(e*t*4);return ze(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iT{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=xe().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Nce(t,e)):this.gl=Zi(t),e=this.gl,xe().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>ze(i,()=>i.createVertexArray()),this.bindVertexArray=a=>ze(i,()=>i.bindVertexArray(a)),this.deleteVertexArray=a=>ze(i,()=>i.deleteVertexArray(a)),this.getVertexArray=()=>ze(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ze(e,()=>i.createVertexArrayOES()),this.bindVertexArray=a=>ze(e,()=>i.bindVertexArrayOES(a)),this.deleteVertexArray=a=>ze(e,()=>i.deleteVertexArrayOES(a)),this.getVertexArray=()=>ze(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),xe().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",a="OES_texture_half_float";if(this.textureFloatExtension=Ub(this.gl,i),Ti(this.gl,a))this.textureHalfFloatExtension=Ub(this.gl,a);else if(xe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Ti(this.gl,r))this.colorBufferHalfFloatExtension=Ub(this.gl,r);else if(xe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Ti(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Ti(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=she(this.gl),this.indexBuffer=rhe(this.gl),this.framebuffer=Kce(this.gl),this.textureConfig=rC(this.gl,this.textureHalfFloatExtension)}get debug(){return xe().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;ze(e,()=>e.finish()),ze(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),ze(e,()=>e.deleteFramebuffer(this.framebuffer)),ze(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),ze(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),ze(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),ihe(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),ahe(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),ohe(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),dhe(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,s,r){this.throwIfDisposed(),hhe(this.gl,e,t,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),che(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),lhe(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(CD(this.gl,this.framebuffer),this.outputTexture=null),ze(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,s){return this.downloadMatrixDriver(e,()=>mhe(this.gl,t,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,s,r,i,a){return ghe(this.gl,e,t,s,r,i,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return phe(this.gl,e,t)}createBufferFromTexture(e,t,s){this.bindTextureToFrameBuffer(e);const r=fhe(this.gl,t,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,s;if(xe().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const a=r.clientWaitSync(i,0,0);return a===r.ALREADY_SIGNALED||a===r.CONDITION_SATISFIED},t=i}else xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(t,xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:t,isFencePassed:s}}downloadMatrixFromPackedTexture(e,t,s){return this.downloadMatrixDriver(e,()=>yhe(this.gl,t,s))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=nhe(t));const s=Uce(t);ze(t,()=>t.attachShader(s,this.vertexShader)),ze(t,()=>t.attachShader(s,e)),jce(t,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&tT(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;ze(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),uhe(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(ze(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&tT(this.gl,this.program),ze(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,s=!0){return this.throwIfDisposed(),s?Yce(this.gl,e,t):Qce(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),ze(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,s){this.throwIfDisposed(),this.throwIfNoProgram(),Zce(this.gl,e,t,s)}setOutputMatrixTexture(e,t,s){this.setOutputMatrixTextureDriver(e,s,t)}setOutputPackedMatrixTexture(e,t,s){this.throwIfDisposed();const[r,i]=uf(t,s);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,t,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&tT(this.gl,this.program),jb(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ze(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ze(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Ub(this.gl,xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,s=this.getQueryTimerExtensionWebGL2();t.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await dR(()=>this.disposed||this.isQueryAvailable(e,xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=bhe(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:s}=this.itemsToPoll[t];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in xe().platform&&(s=xe().platform.setTimeoutCustom.bind(xe().platform)),dR(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),nT(this.gl,e,this.framebuffer),this.debug&&jb(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(nT(this.gl,this.outputTexture,this.framebuffer),this.debug&&jb(this.gl)):CD(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const s=t();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,t,s){this.throwIfDisposed();const r=this.gl;nT(r,e,this.framebuffer),this.debug&&jb(r),this.outputTexture=e,ze(r,()=>r.viewport(0,0,t,s)),ze(r,()=>r.scissor(0,0,t,s))}setOutputMatrixWriteRegionDriver(e,t,s,r){this.throwIfDisposed(),ze(this.gl,()=>this.gl.scissor(e,t,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function bhe(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:xhe,bincountImpl:Pz,bincountReduceImpl:vhe,bitwiseAndImpl:whe,castImpl:She,ceilImpl:The,concatImpl:Ehe,equalImpl:_he,expImpl:Ihe,expm1Impl:$he,floorImpl:Che,gatherNdImpl:Nhe,gatherV2Impl:khe,greaterImpl:Ahe,greaterEqualImpl:Rhe,lessImpl:Dhe,lessEqualImpl:Ohe,linSpaceImpl:Fhe,logImpl:Lhe,maxImpl:Phe,maximumImpl:Mhe,minimumImpl:Vhe,multiplyImpl:Bhe,negImpl:zhe,notEqualImpl:Uhe,prodImpl:jhe,raggedGatherImpl:Whe,raggedRangeImpl:Ghe,raggedTensorToTensorImpl:Hhe,rangeImpl:qhe,rsqrtImpl:Khe,scatterImpl:Xhe,sigmoidImpl:Yhe,simpleAbsImpl:Mz,sliceImpl:Qhe,sparseFillEmptyRowsImpl:Zhe,sparseReshapeImpl:Jhe,sparseSegmentReductionImpl:Vz,sqrtImpl:ede,staticRegexReplaceImpl:tde,stridedSliceImpl:nde,stringNGramsImpl:sde,stringSplitImpl:rde,stringToHashBucketFastImpl:ide,subImpl:ade,tileImpl:ode,topKImpl:lde,transposeImpl:lC,uniqueImpl:cde}=dre;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bz(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function nr(n,e){return e===1?[n]:Bz(n,e)}function ude(n,e){if(n===1)return"rc";let t="";for(let s=0;s<n;s++)t+=e[s],s<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hde{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Gs(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=nr("rc",this.rank),s=Jt(this.rank),r=this.getOutOfBoundsCondition(t),i=this.getSetup(t),a=this.getOutput(t);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${a}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let i=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let a=2;a<this.rank;a++)i=`${e[e.length-1-a]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let s=this.rank-2;s<this.rank;s++)t+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zz{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Gs(this.outputShape.length);let s="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),s+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${dde(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?aC():iC(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function dde(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?uue(["r","c","d"],"inputShape"):rh(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fde{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,s){const r=DD(t,s),i=OD(e,r,s);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const a=RD(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let o;return r===Es.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Es.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Es.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Es.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Es.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(o),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),o}releaseTexture(e,t,s,r){if(this.freeTextures==null)return;const i=DD(s,r),a=OD(t,i,r);a in this.freeTextures||(this.freeTextures[a]=[]);const o=RD(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=xe().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[a].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const u=this.usedTextures[a],d=u&&u.indexOf(e);if(d==null||d<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[d]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function pde(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function RD(n,e,t,s,r){const i=mde(e,s);let a;if(r){const[l,u]=uf(n[0],n[1]);a=l*u}else{const[l,u]=ty(n[0],n[1]);a=l*u}const o=pde(t,i);return a*o}function mde(n,e){switch(n){case Es.PACKED_2X2_FLOAT32:return Fz(e);case Es.PACKED_2X2_FLOAT16:return Lz(e);case Es.UNPACKED_FLOAT32:return Rz(e);case Es.UNPACKED_FLOAT16:return Dz(e);case Es.PACKED_4X1_UNSIGNED_BYTE:return Oz(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function gde(n){return xe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Es.PACKED_2X2_FLOAT32:Es.UNPACKED_FLOAT32:n?Es.PACKED_2X2_FLOAT16:Es.UNPACKED_FLOAT16}function DD(n,e){if(n===qr.UPLOAD)return Es.PACKED_2X2_FLOAT32;if(n===qr.RENDER||n==null)return gde(e);if(n===qr.DOWNLOAD||n===qr.PIXELS)return Es.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function OD(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $a{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Gs(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ni="if (isnan(x)) return x;",yde="return x;",FD="return abs(x);",bde="return (x >= 0.0) ? x : (exp(x) - 1.0);",xde=Ni+`
  return (x < 0.0) ? 0.0 : x;
`,vde=Ni+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Dl="return x;",wde="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sde="return x;",Tde=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Ede=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_de=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Ide="return 1.0 / (1.0 + exp(-1.0 * x));";class Bl{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Gs(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $de{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Gs(this.outputShape.length);const t=e.length,s=nr("rc",t),r=Jt(t),i=ude(t,s),a=s.slice(-2),o=t<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cde=c3,Nde=1e-7,kde=1e-4,Hb={};function Ade(n){return n in Hb||(Hb[n]={}),Hb[n]}const Rde=xe().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Dde=600;function Ode(){return xe().global.screen==null?1024:xe().global.screen.height*xe().global.screen.width*window.devicePixelRatio*Dde/1024/1024}class i1 extends N_{nextDataId(){return i1.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!xe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof iT)t=e;else{const s=Zi(xe().getNumber("WEBGL_VERSION"),e);t=new iT(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Zi(xe().getNumber("WEBGL_VERSION"));t=new iT(s),this.binaryCache=Ade(xe().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new fde(this.gpgpu),this.numMBBeforeWarning=Ode(),this.texData=new DL(this,va())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,s,r,i,a){const o=this.makeTensorInfo(t,s),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,i]},l.texShape=[r,i];const u=Wb(t),d=new AD(u,!1,a),f=this.runWebGLProgram(d,[o],s,[[r,i]]);return f.shape=t,l.texture=null,this.disposeIntermediateTensorInfo(o),f.dataId}write(e,t,s){if((xe().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||xe().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:s,values:e,usage:qr.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,s,r,i){if(xe().getBool("DEBUG")&&this.checkNumericalProblems(t),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:t,usage:qr.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:i,slice:a,shape:o,isPacked:l}=t;if(a!=null){let m;l?m=new Bl(o,Dl):m=new $a(o,Dl);const y=this.runWebGLProgram(m,[{dataId:e,shape:o,dtype:r}],r),b=this.readSync(y.dataId);return this.disposeIntermediateTensorInfo(y),b}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const u=this.activeTimers!=null;let d;u&&(d=yr());let f;if(r==="complex64"){const m=this.readSync(i.real.dataId),y=this.readSync(i.imag.dataId);f=Mo(m,y)}else f=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=yr()-d),this.convertAndCacheOnCPU(e,f)}async read(e){if(this.pendingRead.has(e)){const b=this.pendingRead.get(e);return new Promise(w=>b.push(w))}const t=this.texData.get(e),{values:s,shape:r,slice:i,dtype:a,complexTensorInfos:o,isPacked:l}=t;if(i!=null){let b;l?b=new Bl(r,Dl):b=new $a(r,Dl);const w=this.runWebGLProgram(b,[{dataId:e,shape:r,dtype:a}],a),x=this.read(w.dataId);return this.disposeIntermediateTensorInfo(w),x}if(s!=null)return this.convertAndCacheOnCPU(e);if(xe().getBool("DEBUG")&&!xe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&xe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,d;if(a!=="complex64"&&xe().get("WEBGL_BUFFER_SUPPORTED")){d=this.decode(e);const b=this.texData.get(d.dataId);u=this.gpgpu.createBufferFromTexture(b.texture.texture,...zb(r))}this.pendingRead.set(e,[]),a!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(a==="complex64"){const b=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),w=b[0],x=b[1];f=Mo(w,x)}else if(u==null)f=this.getValuesFromTexture(e);else{const b=Ee(r);f=this.gpgpu.downloadFloat32MatrixFromBuffer(u,b)}if(d!=null&&this.disposeIntermediateTensorInfo(d),u!=null){const b=this.gpgpu.gl;ze(b,()=>b.deleteBuffer(u))}const m=this.convertAndCacheOnCPU(e,f),y=this.pendingRead.get(e);return this.pendingRead.delete(e),y.forEach(b=>b(m)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&va().removeDataId(e,this),this.pendingDeletes--),m}readToGPU(e,t={}){const s=this.texData.get(e),{values:r,shape:i,slice:a,dtype:o,isPacked:l,texture:u}=s;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let y;l?y=new Bl(i,Dl):y=new $a(i,Dl);const b=this.runWebGLProgram(y,[{dataId:e,shape:i,dtype:o}],o),w=this.readToGPU(b,t);return this.disposeIntermediateTensorInfo(b),w}if(u==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const d=this.decode(e,t.customTexShape),f=va().makeTensorFromTensorInfo(d),m=this.texData.get(d.dataId);return Object.assign({tensorRef:f},m.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>tc(r));return mt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return mt(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const s=e[t];if(!Pce(s))throw xe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:s,isPacked:r}=this.texData.get(e),i=Ee(t);if(xe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const m=this.decode(e),y=this.texData.get(m.dataId),b=this.gpgpu.downloadMatrixFromPackedTexture(y.texture.texture,...zb(t)).subarray(0,i);return this.disposeIntermediateTensorInfo(m),b}const a=xe().getBool("WEBGL_PACK")&&r===!0,o=a?Wb(t):t,l=a?new Jue(o):new Zue(o),u=this.runWebGLProgram(l,[{shape:o,dtype:s,dataId:e}],"float32"),d=this.texData.get(u.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(d.texture.texture,d.texShape[0],d.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),f}timerAvailable(){return xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const i=Nu(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),a=Nu(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=t,r&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);o.kernelMs=b9(l),o.getExtraProfileInfo=()=>l.map((u,d)=>({name:a[d],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:yr(),endMs:null}}endTimer(e){return xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=yr(),e)}async getQueryTime(e){if(xe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,t),this.disposeData(s.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:s,texShape:r,usage:i,isPacked:a,slice:o}=this.texData.get(e),l=o&&o.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),t!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(t,r,i,a)));const d=this.texData.get(e);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=Rde){return xe().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&Ee(s.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){Hr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return Cde(e.shape,t)}packedUnaryOp(e,t,s){const r=new Bl(e.shape,t),i=this.compileAndRun(r,[e],s);return va().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=Mz(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(xe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,FD,e.dtype);const t=new $a(e.shape,FD),s=this.compileAndRun(t,[e]);return va().makeTensorFromTensorInfo(s)}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&jm(s[0])){const i=s.map(a=>Ql(a));r=this.write(i,e,t)}else r=this.write(s,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,s){return va().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,s),this)}unpackTensor(e){const t=new $de(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new hde(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const s=[Od(e.shape),...Fd(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},i=[Od(t),...Fd(t)],a=new zz(i,s),o=!0,l=[s],u=this.runWebGLProgram(a,[r],e.dtype,l,o);return{dataId:u.dataId,shape:t,dtype:u.dtype}}decode(e,t){const s=this.texData.get(e),{isPacked:r,shape:i,dtype:a}=s;if(t!=null){const m=Ee(i),y=t[0]*t[1]*4;H(m<=y,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=Wb(i);let l;r?l=new Que(o):l=new Yue(o);const u=!0,d=[t??zb(o)],f=this.runWebGLProgram(l,[{shape:o,dtype:a,dataId:e}],a,d,u,t);return{dtype:a,shape:i,dataId:f.dataId}}runWebGLProgram(e,t,s,r,i=!1,a){const o=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(o.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===wm.DENSE){const T=a??zb(e.outputShape);l.texShape=T.map(E=>E*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Ee(o.shape)===0)return l.values=Vs(o.dtype,0),o;const u=[],d=t.map(T=>{if(T.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let E=this.texData.get(T.dataId);if(E.texture==null){if(!e.packedInputs&&Ee(T.shape)<=xe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:T.shape,texData:null,isUniform:!0,uniformValues:E.values};e.packedInputs&&(E.isPacked=!0,E.shape=T.shape)}if(this.uploadToGPU(T.dataId),!!E.isPacked!=!!e.packedInputs)T=E.isPacked?this.unpackTensor(T):this.packTensor(T),u.push(T),E=this.texData.get(T.dataId);else if(E.isPacked&&!rx(E.shape,T.shape)){const $=T,C=T.shape;T.shape=E.shape,T=this.packedReshape(T,C),u.push(T),E=this.texData.get(T.dataId),$.shape=C}return{shape:T.shape,texData:E,isUniform:!1}});this.uploadToGPU(o.dataId);const f={shape:o.shape,texData:l,isUniform:!1},m=Xue(e,d,f),y=this.getAndSaveBinary(m,()=>que(this.gpgpu,e,d,f)),b=this.activeTimers!=null;let w;b&&(w=this.startTimer()),xe().get("ENGINE_COMPILE_ONLY")||Kue(this.gpgpu,y,d,f,r),u.forEach(T=>this.disposeIntermediateTensorInfo(T)),b&&(w=this.endTimer(w),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(w)}));const x=xe().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){const T=yr();T-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=T)}if(!xe().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const T=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),T}return o}compileAndRun(e,t,s,r,i=!1){return s=s||t[0].dtype,this.runWebGLProgram(e,t,s,r,i)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(xe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ge(()=>{if(!xe().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=xe().getBool("DEBUG");xe().set("DEBUG",!1);const t=this.abs(Wt(1e-8)).dataSync()[0];if(xe().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Nde:kde}uploadToGPU(e){const t=this.texData.get(e),{shape:s,dtype:r,values:i,texture:a,usage:o,isPacked:l}=t;if(a!=null)return;const u=this.activeTimers!=null;let d;u&&(d=yr());let f=t.texShape;if(f==null&&(f=tue(s,l),t.texShape=f),i!=null){const m=Wb(s);let y,b=f[1],w=f[0];const x=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!x)&&([b,w]=uf(f[0],f[1])),l?y=new the(m,x):y=new AD(m,x);const T=x?[w,b]:f,E=this.makeTensorInfo(T,r),$=this.texData.get(E.dataId);x?$.usage=qr.PIXELS:$.usage=qr.UPLOAD,$.texShape=T,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(E.dataId),b,w,i);const C=[[w,b]],V=this.runWebGLProgram(y,[E],r,C,!0),F=this.texData.get(V.dataId);t.texShape=F.texShape,t.isPacked=F.isPacked,t.usage=F.usage,xe().get("ENGINE_COMPILE_ONLY")?this.disposeData(V.dataId):(t.texture=F.texture,t.values=null,this.texData.delete(V.dataId)),this.disposeIntermediateTensorInfo(E),u&&(this.uploadWaitMs+=yr()-d)}else{const m=this.acquireTexture(f,o,r,l);t.texture=m}}convertAndCacheOnCPU(e,t){const s=this.texData.get(e),{dtype:r}=s;return t!=null&&(s.values=Fde(t,r)),s.values}acquireTexture(e,t,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*O0(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(t),r(!0)}catch(i){throw i}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await I3(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(Iz(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:s,infLoc:r,nanLoc:i,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:l}=Az(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=a,e.outShapeStridesLocation=o,e.outTexShapeLocation=l}}createTensorFromGPUData(e,t,s){e.channels=e.channels||"RGBA";const{texture:r,height:i,width:a,channels:o}=e,l=va().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(r,t,s,i,a,o);return va().makeTensorFromDataId(u,t,s,l)}}i1.nextDataId=0;function Fde(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let s=0;s<t.length;++s)t[s]=Math.round(n[s]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */SP()&&IP("webgl",()=>new i1,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cC=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class zu{constructor(e,t,s){this.variableNames=["A","B"],this.outputShape=ot(t,s),this.enableShapeUniforms=Gs(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ah=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class mf{constructor(e,t,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ot(t,s);const i=this.outputShape.length;this.enableShapeUniforms=Gs(i);let a="";if(r)if(i===0||Ee(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          ${Jt(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=nr("coords",i);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Or(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Lde={kernelName:ug,backendName:"webgl",kernelFunc:Or};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tc(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,i=t.makeTensorInfo(s.shape,"complex64"),a=t.texData.get(i.dataId),o=Or({inputs:{x:s},backend:t}),l=Or({inputs:{x:r},backend:t});return a.complexTensorInfos={real:o,imag:l},i}const Pde={kernelName:U_,backendName:"webgl",kernelFunc:Tc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uz="return (a < 0.) ? b * a : a;",jz=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Mde(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:i}=s,a=t.makeTensorInfo([],"float32",mc(i,"float32")),o=xe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new mf(jz,r.shape,a.shape):new zu(Uz,r.shape,a.shape),l=t.runWebGLProgram(o,[r,a],"float32");return t.disposeIntermediateTensorInfo(a),l}const Vde={kernelName:ev,backendName:"webgl",kernelFunc:Mde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wz="return (a < 0.) ? b * a : a;",Gz=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Bde(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e,i=xe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new mf(Gz,s.shape,r.shape):new zu(Wz,s.shape,r.shape);return t.runWebGLProgram(i,[s,r],"float32")}const zde={kernelName:xv,backendName:"webgl",kernelFunc:Bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gf="if (isnan(x)) return x;";function Ct({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:s}){return({inputs:r,backend:i})=>{const{x:a}=r,o=i,l=s||a.dtype;if(o.shouldExecuteOnCPU([a])&&t!=null){const f=o.texData.get(a.dataId),m=t(f.values,l);return o.makeTensorInfo(a.shape,l,m)}const u=xe().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let d;return u?d=new Bl(a.shape,e):d=new $a(a.shape,n),o.runWebGLProgram(d,[a],l)}}function ks({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}){return({inputs:a,backend:o})=>{const{a:l,b:u}=a,d=o;if(s&&l.dtype==="complex64"){const b=d.texData.get(l.dataId),w=d.texData.get(u.dataId),[x,T]=[[b.complexTensorInfos.real,w.complexTensorInfos.real],[b.complexTensorInfos.imag,w.complexTensorInfos.imag]].map($=>{const[C,O]=$,V={dataId:C.dataId,dtype:C.dtype,shape:l.shape},F={dataId:O.dataId,dtype:O.dtype,shape:u.shape},R=new zu(n,l.shape,u.shape);return d.runWebGLProgram(R,[V,F],Rr(C.dtype,O.dtype))}),E=Tc({inputs:{real:x,imag:T},backend:d});return d.disposeIntermediateTensorInfo(x),d.disposeIntermediateTensorInfo(T),E}const f=i||Rr(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||d.shouldExecuteOnCPU([l,u]))&&r!=null){const b=d.texData.get(l.dataId).values,w=d.texData.get(u.dataId).values,x=l.dtype==="string"?Vo(b):b,T=l.dtype==="string"?Vo(w):w,[E,$]=r(l.shape,u.shape,x,T,f),C=d.makeTensorInfo($,f),O=d.texData.get(C.dataId);return O.values=E,C}const m=xe().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let y;return m?y=new mf(e,l.shape,u.shape,t):y=new zu(n,l.shape,u.shape),d.runWebGLProgram(y,[l,u],f)}}function Sm(n,e=!1){if(n==="linear")return e?Sde:yde;if(n==="relu")return e?Ede:xde;if(n==="elu")return e?Tde:bde;if(n==="relu6")return e?_de:vde;if(n==="prelu")return e?Gz:Wz;if(n==="leakyrelu")return e?jz:Uz;if(n==="sigmoid")return e?Ide:wde;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hz{constructor(e,t,s,r=!1,i=!1,a=!1,o=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Gs(this.outputShape.length);const d=r?e[1]:e[2],f=Math.ceil(d/2),m=r?"i * 2, rc.y":"rc.y, i * 2",y=i?"rc.z, i * 2":"i * 2, rc.z",b=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],w=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let x="",T="";o&&(l?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:u?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:x=`vec4 activation(vec4 x) {
          ${o}
        }`,T="result = activation(result);");const E=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let $="rc.x",C="rc.x";e[0]<t[0]?$=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(C=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${x}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${$};
        int batchB = ${C};
        for (int i = 0; i < ${f}; i++) {
          vec4 a = getMatrixA(batchA, ${m});
          vec4 b = getMatrixB(batchB, ${y});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${b[0]} * ${w[0]});
          result += (${b[1]} * ${w[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${E}

        ${T}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LD={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class PD{constructor(e,t,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ot(t,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MD="return a * b;";function uC(n){const{inputs:e,backend:t}=n,{a:s,b:r}=e,i=Rr(s.dtype,r.dtype);if(s.dtype==="complex64"){const o=t.texData.get(s.dataId),l=t.texData.get(r.dataId),u=new PD(LD.REAL,s.shape,r.shape),d=new PD(LD.IMAG,s.shape,r.shape),f=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:s.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],m=t.runWebGLProgram(u,f,"float32"),y=t.runWebGLProgram(d,f,"float32"),b=Tc({inputs:{real:m,imag:y},backend:t});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),b}if(t.shouldExecuteOnCPU([s,r])){const o=t.texData.get(s.dataId),l=t.texData.get(r.dataId),[u,d]=Bhe(s.shape,r.shape,o.values,l.values,i),f=t.makeTensorInfo(d,i),m=t.texData.get(f.dataId);return m.values=u,f}let a;return xe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?a=new mf(MD,s.shape,r.shape):a=new zu(MD,s.shape,r.shape),t.runWebGLProgram(a,[s,r],i)}const Ude={kernelName:xg,backendName:"webgl",kernelFunc:uC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jde(n,e,t){const s=[Od(n.shape),...Fd(n.shape)],r={dtype:n.dtype,shape:s,dataId:n.dataId},i=[Od(e),...Fd(e)],a=new zz(i,s),o=!0,l=[s],u=t.runWebGLProgram(a,[r],n.dtype,l,o);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Me(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:i}=s,a=t,o=Ee(r.shape),l=FL(i,o),u=Ee(l);H(o===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const d=a.texData.get(r.dataId);return d.isPacked&&!rx(r.shape,l)&&!(d.texture!==null&&rx(d.shape,l))?jde(r,l,a):(a.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const Wde={kernelName:wv,backendName:"webgl",kernelFunc:Me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VD{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:a}=e;this.outputShape=[r,a];const o=Math.floor(s/4)*4,l=s%4;let u="sumValue += dot(values, ones);";if(t!=null){const f=1/t;u=`sumValue += dot(values * ${_d(f)?f.toPrecision(2):f}, ones);`}let d="";i%s>0&&(d=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gde{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:a}=e;this.outputShape=[r,a];let o="0.0",l="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",l="min"):t==="max"&&(o="-1.0 / 1e-20",l="max");let u=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");const d=Math.floor(s/4)*4,f=s%4;let m=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,y="vec4";t==="all"?(o="1.0",m=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,y="bvec4"):t==="any"&&(o="0.0",m=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,y="bvec4");let b="";i%s>0&&(b=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${b}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          ${y} values = ${y}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${m}
        }

        int inIdx = inOffset + ${d};
        if (${f===1}) {
          ${y} values = ${y}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${m}
        } else if (${f===2}) {
          ${y} values = ${y}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${m}
        } else if (${f===3}) {
          ${y} values = ${y}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${m}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hde(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],s=jv(t);e.push({inSize:t,windowSize:s,outSize:Math.ceil(t/s)})}return e}function oh(n,e,t,s){const r=Hde(n.shape);let i=n;for(let a=0;a<r.length;a++){const{inSize:o,windowSize:l,outSize:u}=r[a];let d,f;t==="mean"?d=a===0?new VD({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:u},o):new VD({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:u}):d=new Gde({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:u},t),f=i,i=s.runWebGLProgram(d,[i],e),f.dataId!==n.dataId&&s.disposeIntermediateTensorInfo(f)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qde{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let a=0;a<s.length;a++)s[a]=e[t[a]];this.outputShape=s,this.rank=s.length;const r=Jt(this.rank),i=Kde(t);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function Kde(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<n.length;r++)s[n[r]]=t[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xde{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let d=0;d<s.length;d++)s[d]=e[t[d]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=Jt(this.rank),i=Bz("rc",this.rank),a=new Array(this.rank);for(let d=0;d<t.length;d++)a[t[d]]=i[d];const o=`vec2(${a.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${s[this.rank-1]}`,u=`getChannel(getA(${a.join()}), ${o})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a1(n,e,t){const s=xe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Xde(n.shape,e):new qde(n.shape,e);return t.runWebGLProgram(s,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yde(n,e,t,s){const r=e,i=n.shape.length,a=gt(r,n.shape);let o=a;const l=Sn(o,i),u=l!=null;let d=n;u&&(d=a1(n,l,s),o=Ln(o.length,i)),Ns("sum",o,i);const[f,m]=ps(d.shape,o);let y=f;t&&(y=jn(f,a));const b=Ee(m),x=Ee(n.shape)/b,T=Me({inputs:{x:d},attrs:{shape:[x,b]},backend:s}),E=SI(n.dtype),$=oh(T,E,"sum",s),C=Me({inputs:{x:$},attrs:{shape:y},backend:s});return s.disposeIntermediateTensorInfo(T),s.disposeIntermediateTensorInfo($),u&&s.disposeIntermediateTensorInfo(d),C}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s;return Yde(r,i,a,t)}const Qde={kernelName:$v,backendName:"webgl",kernelFunc:o1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cr(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{perm:i}=s,a=t,o=r.shape.length,l=new Array(o);for(let d=0;d<l.length;d++)l[d]=r.shape[i[d]];let u;if(a.shouldExecuteOnCPU([r])){const f=a.texData.get(r.dataId).values,m=lC(f,r.shape,r.dtype,i,l);u=a.makeTensorInfo(l,r.dtype);const y=a.texData.get(u.dataId);y.values=m}else u=a1(r,i,a);return u}const Zde={kernelName:dd,backendName:"webgl",kernelFunc:cr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qz=1e3;function ix({a:n,b:e,transposeA:t,transposeB:s,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const u=n.shape.length,d=e.shape.length,f=t?n.shape[u-2]:n.shape[u-1],m=s?e.shape[d-1]:e.shape[d-2],y=t?n.shape[u-1]:n.shape[u-2],b=s?e.shape[d-2]:e.shape[d-1],w=n.shape.slice(0,-2),x=e.shape.slice(0,-2),T=Ee(w),E=Ee(x),C=ot(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([y,b]);H(f===m,()=>`Error in matMul: inner shapes (${f}) and (${m}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${s} must match.`);const O=t?[T,f,y]:[T,y,f],V=s?[E,b,m]:[E,m,b],F=Me({inputs:{x:n},backend:r,attrs:{shape:O}}),R=Me({inputs:{x:e},backend:r,attrs:{shape:V}}),N=[F,R],D=Math.max(T,E),k=t?F.shape[1]:F.shape[2],z=i!=null,B=a!=null,ne=l==="leakyrelu",J=l!=null?Sm(l,!0):null,K=z||B||ne||J!=null;let re;if((y===1||b===1)&&k>qz&&K===!1){let he=F,W=R;t&&(he=cr({inputs:{x:F},backend:r,attrs:{perm:[0,2,1]}}),N.push(he)),s&&(W=cr({inputs:{x:R},backend:r,attrs:{perm:[0,2,1]}}),N.push(W));const ee=b!==1,me=b===1;let de=he;ee&&(de=Me({inputs:{x:he},backend:r,attrs:{shape:[D,k,1]}}),N.push(de));const be=b===1?2:1;let _e=W;me&&(_e=Me({inputs:{x:W},backend:r,attrs:{shape:[D,1,k]}}),N.push(_e));const Ne=uC({inputs:{a:de,b:_e},backend:r});re=o1({inputs:{x:Ne},backend:r,attrs:{axis:be,keepDims:!0}}),N.push(Ne)}else{const he=Rr(n.dtype,e.dtype),W=new Hz(O,V,[D,y,b],t,s,z,J,B,ne),ee=[F,R];if(i!=null&&ee.push(i),B&&ee.push(a),ne){const me=r.makeTensorInfo([],"float32",mc(o,"float32"));ee.push(me),N.push(me)}re=r.runWebGLProgram(W,ee,he)}const Z=Me({inputs:{x:re},backend:r,attrs:{shape:C}});N.push(re);for(const he of N)r.disposeIntermediateTensorInfo(he);return Z}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jde(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:i,bias:a,preluActivationWeights:o}=e,{transposeA:l,transposeB:u,activation:d,leakyreluAlpha:f}=s;return ix({a:r,b:i,transposeA:l,transposeB:u,backend:t,bias:a,preluActivationWeights:o,leakyreluAlpha:f,activation:d})}const efe={kernelName:F0,backendName:"webgl",kernelFunc:Jde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BD="return abs(x);";function tfe(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const i=t.texData.get(s.dataId),a=Mz(i.values);return t.makeTensorInfo(s.shape,s.dtype,a)}let r;return xe().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Bl(s.shape,BD):r=new $a(s.shape,BD),t.runWebGLProgram(r,[s],s.dtype)}const nfe={kernelName:Ox,backendName:"webgl",kernelFunc:tfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sfe=Ni+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,rfe=Ct({opSnippet:sfe}),ife={kernelName:Wm,backendName:"webgl",kernelFunc:rfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const afe=Ni+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,ofe=Ct({opSnippet:afe}),lfe={kernelName:Gm,backendName:"webgl",kernelFunc:ofe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zD="return a + b;",cfe=ks({opSnippet:zD,packedOpSnippet:zD,supportsComplex:!0,cpuKernelImpl:xhe}),ufe={kernelName:tf,backendName:"webgl",kernelFunc:cfe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hfe{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((i,a)=>`T${a}`);const s=[];this.variableNames.forEach(i=>{s.push(`float v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dfe{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((i,a)=>`T${a}`);const s=[];this.variableNames.forEach(i=>{s.push(`vec4 v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m0(n){const{inputs:e,backend:t}=n,s=e;if(s.length===1)return Or({inputs:{x:s[0]},backend:t});if(s.length>xe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),u=m0({inputs:s.slice(0,l),backend:t}),d=m0({inputs:s.slice(l),backend:t});return m0({inputs:[u,d],backend:t})}const r=s.map(l=>l.dtype).reduce((l,u)=>Rr(l,u)),i=s.map(l=>l.shape),o=xe().getBool("WEBGL_PACK")?new dfe(s[0].shape,i):new hfe(s[0].shape,i);return t.runWebGLProgram(o,s,r)}const ffe={kernelName:F_,backendName:"webgl",kernelFunc:m0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s,o=r.shape.length,l=gt(i,r.shape);let u=l;const d=Sn(u,o);let f=r;d!=null&&(f=cr({inputs:{x:r},backend:t,attrs:{perm:d}}),u=Ln(u.length,o)),Ns("all",u,o);const[m,y]=ps(f.shape,u),b=Ee(y),w=Me({inputs:{x:f},backend:t,attrs:{shape:[-1,b]}}),x=oh(w,w.dtype,"all",t);let T;if(a){const E=jn(m,l);T=Me({inputs:{x},backend:t,attrs:{shape:E}})}else T=Me({inputs:{x},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),d!=null&&t.disposeIntermediateTensorInfo(f),T}const mfe={kernelName:L_,backendName:"webgl",kernelFunc:pfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s,o=r.shape.length,l=gt(i,r.shape);let u=l;const d=Sn(u,o);let f=r;d!=null&&(f=cr({inputs:{x:r},backend:t,attrs:{perm:d}}),u=Ln(u.length,o)),Ns("any",u,o);const[m,y]=ps(f.shape,u),b=Ee(y),w=Me({inputs:{x:f},backend:t,attrs:{shape:[-1,b]}}),x=oh(w,w.dtype,"any",t);let T;if(a){const E=jn(m,l);T=Me({inputs:{x},backend:t,attrs:{shape:E}})}else T=Me({inputs:{x},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),d!=null&&t.disposeIntermediateTensorInfo(f),T}const yfe={kernelName:P_,backendName:"webgl",kernelFunc:gfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bfe{constructor(e,t,s){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:a}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];const o=t==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xfe{constructor(e,t,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,H(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,u=Jt(l),d=nr("coords",l);let f,m;if(a===1){m=l+1;const R=Jt(m);f=`
        ${R} sourceLocR = ${R}(${d.join()}, 0);
        ++${d[l-1]};
        ${R} sourceLocG = ${R}(${d.join()}, 0);
        ++${d[l-2]};
        ${R} sourceLocA = ${R}(${d.join()}, 0);
        --${d[l-1]};
        ${R} sourceLocB = ${R}(${d.join()}, 0);
        --${d[l-2]};`}else m=l,f=`
        ${u} sourceLocR = coords;
        ++${d[l-1]};
        ${u} sourceLocG = coords;
        ++${d[l-2]};
        ${u} sourceLocA = coords;
        --${d[l-1]};
        ${u} sourceLocB = coords;
        --${d[l-2]};`;const y=["x","y","z","w","u","v"].slice(0,m),b="."+y[m-1],w=y.map(R=>"int "+R),x=nr("sourceLocR",m-1).concat("inIdx.r"),T=nr("sourceLocG",m-1).concat("inIdx.g"),E=nr("sourceLocB",m-1).concat("inIdx.b"),$=nr("sourceLocA",m-1).concat("inIdx.a"),C=s==="max"?"greaterThan":"lessThan",O=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${T.join()}),
                             getBestIndicesAChannel(${E.join()}),
                             getBestIndicesAChannel(${$.join()})));`,V=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${T.join()}) : 0.,
            hasNextRow ? getAChannel(${E.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${$.join()}) : 0.)`,F=r?"":`
      float getBestIndicesAChannel(${w.join()}) {
        return getChannel(getBestIndicesA(${y.join()}),
                                          vec2(${y.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${w.join()}) {
        return getChannel(getA(${y.join()}),
                               vec2(${y.slice(-2).join()}));
      }
      ${F}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${d[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${d[l-2]} < ${o[l-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${b}, sourceLocG${b},
          sourceLocB${b}, sourceLocA${b}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${V};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${O}
          vec4 candidate = ${V};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${C}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kz(n,e,t,s=null){let r=e.shape[0],i=e.shape[1];s!=null&&(r=s.shape[0],i=s.shape[1]);const a=jv(i),o={windowSize:a,inSize:i,batchSize:r,outSize:Math.ceil(i/a)},l=new bfe(o,t,s==null),u=[e];s!=null&&u.push(s);const d=n.runWebGLProgram(l,u,"int32");if(d.shape[1]===1)return d;const f=Kz(n,e,t,d);return n.disposeIntermediateTensorInfo(d),f}function Xz(n,e,t,s=null){const r=s!=null?s.shape:e.shape,i=r[r.length-1],a=jv(i),o=new xfe(r,a,t,s==null),l=s==null?[e]:[e,s],u=n.runWebGLProgram(o,l,"int32");if(u.shape.length===e.shape.length){const d=Xz(n,e,t,u);return n.disposeIntermediateTensorInfo(u),d}return u}function Yz(n,e,t,s){const r=[t];if(Ns("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!xe().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],a=n.texData.get(e.dataId),o=a!==null&&a.isPacked;let l=e;o&&(l=n.unpackTensor(e),i.push(l));const[u,d]=ps(l.shape,r),f=Ee(d),m=Me({inputs:{x:l},backend:n,attrs:{shape:[-1,f]}});i.push(m);const y=Kz(n,m,s);i.push(y);const b=Me({inputs:{x:y},backend:n,attrs:{shape:u}});return i.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}return Xz(n,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i}=s;let a=gt(i,r.shape);const o=Sn(a,r.shape.length);let l=r;const u=[];o!=null&&(l=cr({inputs:{x:r},backend:t,attrs:{perm:o}}),u.push(l),a=Ln(a.length,l.shape.length)),Ns("argMax",[a[0]],l.shape.length);const d=Yz(t,l,a[0],"max");return u.forEach(f=>t.disposeIntermediateTensorInfo(f)),d}const wfe={kernelName:Fx,backendName:"webgl",kernelFunc:vfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i}=s;let a=gt(i,r.shape);const o=Sn(a,r.shape.length);let l=r;const u=[];o!=null&&(l=cr({inputs:{x:r},backend:t,attrs:{perm:o}}),u.push(l),a=Ln(a.length,l.shape.length)),Ns("argMin",[a[0]],l.shape.length);const d=Yz(t,l,a[0],"min");return u.forEach(f=>t.disposeIntermediateTensorInfo(f)),d}const Tfe={kernelName:Lx,backendName:"webgl",kernelFunc:Sfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Efe=Ni+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,_fe=Ct({opSnippet:Efe}),Ife={kernelName:Hm,backendName:"webgl",kernelFunc:_fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $fe=Ni+"return log(x + sqrt(x * x + 1.0));",Cfe=Ct({opSnippet:$fe}),Nfe={kernelName:qm,backendName:"webgl",kernelFunc:Cfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kfe=Ni+`
  return atan(x);
`,Afe=Ct({opSnippet:kfe}),Rfe={kernelName:Km,backendName:"webgl",kernelFunc:Afe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dfe=cC+`
  return atan(a, b);
`,Ofe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ah+`
  return result;
`,Ffe=ks({opSnippet:Dfe,packedOpSnippet:Ofe}),Lfe={kernelName:Ym,backendName:"webgl",kernelFunc:Ffe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pfe=Ni+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Mfe=Ct({opSnippet:Pfe}),Vfe={kernelName:Xm,backendName:"webgl",kernelFunc:Mfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tm{constructor(e,t,s,r=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,o=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterHeight,m=e.effectiveFilterWidth,y=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;const w=t==="avg",x=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,T=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let E="0.0";if(w||(E="-1.0 / 1e-20"),s){const R=">=";this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${y}, ${b});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${m};
                wC += ${d}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${R} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?x:T:`wR * ${m} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let C=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(C="avgValue / max(count, 1.0)");const O=Math.floor(a/4)*4,V=a%4,F=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${y}, ${b});
      const float initializationValue = ${E};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${E});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${O}; wC += 4) {
            int xC = xCCorner + wC * ${d};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              getValue(batch, xR, xC + 3 * ${d}, d)
            );

            ${F}
          }

          int xC = xCCorner + ${O};
          if (${V===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${F}
          } else if (${V===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              initializationValue,
              initializationValue
            );

            ${F}
          } else if (${V===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              initializationValue
            );

            ${F}
          }
        }
        setOutput(${C});
      }
    `}}class hC{constructor(e,t,s,r=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,o=e.strideDepth,l=e.strideHeight,u=e.strideWidth,d=e.dilationDepth,f=e.dilationHeight,m=e.dilationWidth,y=e.effectiveFilterDepth,b=e.effectiveFilterHeight,w=e.effectiveFilterWidth,x=e.padInfo.front,T=e.padInfo.top,E=e.padInfo.left;this.outputShape=e.outShape;const $=t==="avg";let C="0.0";if($||(C="-1.0 / 1e-20"),s){const D=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${u});
        const ivec3 pads = ivec3(${x}, ${T}, ${E});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${y};
              wD += ${d}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${b};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${w};
                  wC += ${m}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${D} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${b} * ${w} +
                      wR * ${w} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const O="max";let V=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(V="avgValue / max(count, 1.0)");const F=Math.floor(a/4)*4,R=a%4,N=`
      if (${$}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${O}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${u});
      const ivec3 pads = ivec3(${x}, ${T}, ${E});
      const float initializationValue = ${C};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${C});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${y};
            wD += ${d}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${b};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${F}; wC += 4) {
              int xC = xCCorner + wC * ${m};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                getValue(batch, xD, xR, xC + 2 * ${m}, ch),
                getValue(batch, xD, xR, xC + 3 * ${m}, ch)
              );

              ${N}
            }

            int xC = xCCorner + ${F};
            if (${R===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${R===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${R===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                getValue(batch, xD, xR, xC + 2 * ${m}, ch),
                initializationValue
              );

              ${N}
            }
          }
        }
        setOutput(${V});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;ny(r,"avgPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=s,u=1;H(js(a,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const d=$i(r.shape,i,a,u,o,l);if(d.filterWidth===1&&d.filterHeight===1&&Gt(d.inShape,d.outShape))return Or({inputs:{x:r},backend:t});const f=new Tm(d,"avg",!1);return t.runWebGLProgram(f,[r],"float32")}const zfe={kernelName:Px,backendName:"webgl",kernelFunc:Bfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ufe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l,dataFormat:u}=s,d=[1,1,1],f=Ho(r.shape,i,a,d,o,l,u),m=new hC(f,"avg",!1);return t.runWebGLProgram(m,[r],"float32")}const jfe={kernelName:Mx,backendName:"webgl",kernelFunc:Ufe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wfe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.top,f=u-1-e.padInfo.left,m=1/(t*s);this.userCode=`
      const ivec2 pads = ivec2(${d}, ${f});
      const float avgMultiplier = float(${m});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Gfe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterDepth,m=e.effectiveFilterHeight,y=e.effectiveFilterWidth,b=f-1-e.padInfo.front,w=m-1-e.padInfo.top,x=y-1-e.padInfo.left,T=1/(t*s*r);this.userCode=`
      const ivec3 pads = ivec3(${b}, ${w}, ${x});
      const float avgMultiplier = float(${T});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${m};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${y};
                wC += ${d}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hfe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,a=i,{filterSize:o,strides:l,pad:u,dimRoundingMode:d}=s,f=[1,1,1],m=Ho(a.shape,o,l,f,u,d),y=new Gfe(m);return t.runWebGLProgram(y,[r],a.dtype)}const qfe={kernelName:V_,backendName:"webgl",kernelFunc:Hfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kfe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,a=i;ny([r,i],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=s,d=$i(a.shape,o,l,1,u),f=new Wfe(d);return t.runWebGLProgram(f,[r],a.dtype)}const Xfe={kernelName:M_,backendName:"webgl",kernelFunc:Kfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yfe(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:i}=e,{transposeA:a,transposeB:o}=s;return ix({a:r,b:i,transposeA:a,transposeB:o,backend:t})}const Qfe={kernelName:Vx,backendName:"webgl",kernelFunc:Yfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zfe{constructor(e,t,s,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],ot(e,t),ot(e,s);let o="0.0";r!=null&&(ot(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";i!=null&&(ot(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jfe{constructor(e,t,s,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ot(e,t),ot(e,s);let o="vec4(0.0)";r!=null&&(ot(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(ot(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const epe=({inputs:n,backend:e,attrs:t})=>{const{x:s,mean:r,variance:i,offset:a,scale:o}=n;H(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),H(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),H(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=t;l==null&&(l=.001);const u=[s,r,i];let d=null;a!=null&&(d=a.shape,u.push(a));let f=null;o!=null&&(f=o.shape,u.push(o));const m=xe().getBool("WEBGL_PACK_NORMALIZATION")?new Jfe(s.shape,r.shape,i.shape,d,f,l):new Zfe(s.shape,r.shape,i.shape,d,f,l);return e.runWebGLProgram(m,u,u[0].dtype)},tpe={kernelName:Qx,backendName:"webgl",kernelFunc:epe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class npe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=Jt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=spe(this.rank);let r;const i=e.map((a,o)=>`sourceLoc.${hE[o]} = start[${o}] + coords.${hE[o]};`);r=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const hE=["x","y","z","w","u","v"];function spe(n){if(n===1)return"sourceLoc";if(n<=6)return hE.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rpe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=Jt(this.rank),s=nr("coords",this.rank),r=nr("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,a=`getChannel(getSource(${r.join()}), ${i})`,o=`
      result.x = ${a};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${a};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${a};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${a};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((d,f)=>`start[${f}]`).join()});`:e.map((d,f)=>`${r[f]} = ${s[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ipe(n,e,t,s){const r=s.texData.get(n.dataId),i=s.makeTensorInfo(t,n.dtype),a=s.texData.get(i.dataId);Object.assign(a,r),a.refCount=1,a.shape=t,a.dtype=n.dtype;let o=r$(e,Ye(n.shape));r.slice&&(o+=r.slice.flatOffset),a.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||n.dataId};const l=s.dataRefCount.get(a.slice.origDataId)||1;return s.dataRefCount.set(a.slice.origDataId,l+1),i}function yf(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:i,size:a}=s,[o,l]=Uv(r,i,a);if(t$(r,o,l),Ee(l)===0)return t.makeTensorInfo(l,r.dtype,[]);if(t.shouldExecuteOnCPU([r])||r.dtype==="string"){const f=t.texData.get(r.dataId),m=Qhe(f.values,o,l,r.shape,r.dtype);return t.makeTensorInfo(l,r.dtype,m)}const{isPacked:u}=t.texData.get(r.dataId),d=s$(r.shape,o,l);if(u||!d){const f=xe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rpe(l):new npe(l),m=[o];return t.runWebGLProgram(f,[r],r.dtype,m)}return t.uploadToGPU(r.dataId),ipe(r,o,l,t)}const ape={kernelName:Iv,backendName:"webgl",kernelFunc:yf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ope=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:i,crops:a}=s;H(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=i.reduce((E,$)=>E*$),l=Gg(r.shape,i,o),u=Hg(l.length,i.length),d=qg(r.shape,i,o),f=c$(a,i.length),m=u$(d,a,i.length),y=[],b=Me({inputs:{x:r},backend:t,attrs:{shape:l}}),w=cr({inputs:{x:b},backend:t,attrs:{perm:u}}),x=Me({inputs:{x:w},backend:t,attrs:{shape:d}}),T=yf({inputs:{x},backend:t,attrs:{begin:f,size:m}});return y.push(b),y.push(w),y.push(x),y.forEach(E=>t.disposeIntermediateTensorInfo(E)),T},lpe={kernelName:Bx,backendName:"webgl",kernelFunc:ope};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cpe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:i}=e,{size:a}=s,o=t.readSync(r.dataId),l=t.readSync(i.dataId),u=Pz(o,l,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,u)}const upe={kernelName:B_,backendName:"webgl",kernelFunc:cpe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hpe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,dpe=`
  return float(int(a.r) & int(b.r));
`;function fpe(n){const{inputs:e,backend:t}=n,{a:s,b:r}=e,i=xe().getBool("WEBGL_PACK_BINARY_OPERATIONS"),a=xe().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([s,r])||a===1){const l=t.texData.get(s.dataId).values,u=t.texData.get(r.dataId).values,[d,f]=whe(s.shape,r.shape,l,u,s.dtype),m=t.makeTensorInfo(f,s.dtype),y=t.texData.get(m.dataId);return y.values=d,m}let o;return i?o=new mf(hpe,s.shape,r.shape,!1):o=new zu(dpe,s.shape,r.shape),t.runWebGLProgram(o,[s,r],s.dtype)}const ppe={kernelName:z_,backendName:"webgl",kernelFunc:fpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mpe(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,i=t.readSync(s.dataId),a=t.readSync(r.dataId),o=ot(Array.from(i),Array.from(a));return t.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const gpe={kernelName:zL,backendName:"webgl",kernelFunc:mpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ype="return float(a != b);",Qz=ks({opSnippet:ype,cpuKernelImpl:Uhe,dtype:"bool"}),bpe={kernelName:pv,backendName:"webgl",kernelFunc:Qz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ry(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return Or({inputs:{x:r.complexTensorInfos.real},backend:t})}const xpe={kernelName:dI,backendName:"webgl",kernelFunc:ry};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vpe="return float(int(x));";function wpe(n,e){const t=new $a(n.shape,vpe),s=e.runWebGLProgram(t,[n],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dE(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return Or({inputs:{x:r},backend:t});const a=cs(r.shape),o=dE({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),l=Tc({inputs:{real:o,imag:a},backend:t});return a.dispose(),t.disposeIntermediateTensorInfo(o),l}if(r.dtype==="complex64"){const a=ry({inputs:{input:r},backend:t}),o=dE({inputs:{x:a},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(a),o}if(!LL(r.dtype,i)){const a=Or({inputs:{x:r},backend:t});return{dataId:a.dataId,shape:a.shape,dtype:i}}if(t.shouldExecuteOnCPU([r])){const a=t.texData.get(r.dataId).values,[o,l,u]=She(a,r.shape,r.dtype,i);return t.makeTensorInfo(o,l,u)}if(i==="int32")return wpe(r,t);if(i==="bool"){const a=t.makeTensorInfo([],"bool",Vs("bool",1)),l=Qz({inputs:{a:r,b:a},backend:t});return t.disposeIntermediateTensorInfo(a),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${i}`)}const Spe={kernelName:Qm,backendName:"webgl",kernelFunc:dE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UD="return ceil(x);",Tpe=Ct({opSnippet:UD,packedOpSnippet:UD,cpuKernelImpl:The}),Epe={kernelName:Zm,backendName:"webgl",kernelFunc:Tpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _pe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ipe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $pe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{clipValueMin:i,clipValueMax:a}=s;let o;xe().getBool("WEBGL_PACK_CLIP")?o=new Ipe(r.shape):o=new _pe(r.shape);const l=[[i],[a]];return t.runWebGLProgram(o,[r],r.dtype,l)}const Cpe={kernelName:Jm,backendName:"webgl",kernelFunc:$pe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Npe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jD(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function kpe(n){const{inputs:e,backend:t}=n,{x:s}=e,r=t.texData.get(s.dataId),i=new Npe(s.shape),a=[jD(s,r.complexTensorInfos.real),jD(s,r.complexTensorInfos.imag)];return t.runWebGLProgram(i,a,a[0].dtype)}const Ape={kernelName:zx,backendName:"webgl",kernelFunc:kpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rpe{constructor(e){this.outputShape=[],this.outputShape=Ra(e,1),this.variableNames=e.map((a,o)=>`T${o}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let a=1;a<t.length;a++)t[a]=t[a-1]+e[a][1];const s=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<t.length;a++){const o=t[a-1];s.push(`else if (yC < ${t[a]}) setOutput(getT${a}(yR, yC-${o}));`)}const r=t.length,i=t[t.length-1];s.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dpe{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ra(e,t);const s=this.outputShape,r=s.length,i=Jt(r),a=nr("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((w,x)=>`T${x}`);const l=new Array(e.length-1);l[0]=e[0][t];for(let w=1;w<l.length;w++)l[w]=l[w-1]+e[w][t];const u=o[t],d=o.slice(-2),f=o.join();let m=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${f}), vec2(${d.join()}));
        }`;for(let w=1;w<l.length;w++){const x=l[w-1];m+=`
        if (${u} < ${l[w]}  && ${u} >= ${l[w-1]}) {
          return getChannel(
            getT${w}(${qb(o,u,x)}),
            vec2(${qb(d,u,x)}));
        }`}const y=l.length,b=l[l.length-1];m+=`
        return getChannel(
          getT${y}(${qb(o,u,b)}),
          vec2(${qb(d,u,b)}));`,this.userCode=`
      float getValue(${o.map(w=>"int "+w)}) {
        ${m}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[r-1]} = ${a[r-1]} + 1;
        if (${a[r-1]} < ${s[r-1]}) {
          result.g = getValue(${a});
        }

        ${a[r-2]} = ${a[r-2]} + 1;
        if (${a[r-2]} < ${s[r-2]}) {
          result.a = getValue(${a});
        }

        ${a[r-1]} = ${a[r-1]} - 1;
        if (${a[r-2]} < ${s[r-2]} &&
            ${a[r-1]} < ${s[r-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}}function qb(n,e,t){const s=n.indexOf(e);return n.map((i,a)=>a===s?`${i} - ${t}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l1(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return Or({inputs:{x:r.complexTensorInfos.imag},backend:t})}const Ope={kernelName:rI,backendName:"webgl",kernelFunc:l1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gp(n,e,t){const s=n[0].dtype;if(s==="complex64"){const y=n.map(E=>ry({inputs:{input:E},backend:t})),b=n.map(E=>l1({inputs:{input:E},backend:t})),w=Gp(y,e,t),x=Gp(b,e,t),T=Tc({inputs:{real:w,imag:x},backend:t});return y.forEach(E=>t.disposeIntermediateTensorInfo(E)),b.forEach(E=>t.disposeIntermediateTensorInfo(E)),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),T}let r=t.shouldExecuteOnCPU(n);if(s==="string"&&(r=!0),r){const y=n.map(C=>{const V=[-1,Ee(C.shape.slice(e))];return Me({inputs:{x:C},backend:t,attrs:{shape:V}})}),b=y.map(C=>({vals:t.readSync(C.dataId),shape:C.shape})),w=Ra(y.map(C=>C.shape),1),x=y[0].shape[0]===1,T=Ehe(b,w,s,x),E=Ra(n.map(C=>C.shape),e),$=t.makeTensorInfo(E,s,T);return y.forEach(C=>t.disposeIntermediateTensorInfo(C)),$}const i=n.filter(y=>Ee(y.shape)>0),a=xe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const y=a?new $a(n[0].shape,Dl):new Bl(n[0].shape,Dl);return t.runWebGLProgram(y,n,s)}const o=xe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>o){const y=[];for(let w=0;w<i.length;w+=o){const x=i.slice(w,w+o);y.push(Gp(x,e,t))}const b=Gp(y,e,t);for(const w of y)t.disposeIntermediateTensorInfo(w);return b}if(a){const y=new Dpe(i.map(b=>b.shape),e);return t.runWebGLProgram(y,i,s)}const{tensors2D:l,outShape:u}=Fpe(i,e,t),d=new Rpe(l.map(y=>y.shape)),f=t.runWebGLProgram(d,l,s);l.forEach(y=>t.disposeIntermediateTensorInfo(y));const m=Me({inputs:{x:f},attrs:{shape:u},backend:t});return t.disposeIntermediateTensorInfo(f),m}function Fpe(n,e,t){const s=Ra(n.map(i=>i.shape),e);return{tensors2D:n.map(i=>Me({inputs:{x:i},attrs:{shape:[-1,Ee(i.shape.slice(e))]},backend:t})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zz(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,i=gt(r,e[0].shape)[0],a=e.map(u=>u.shape);a$(a,i);const o=Ra(e.map(u=>u.shape),i);if(Ee(o)===0)return t.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(u=>Ee(u.shape)>0);return l.length===1?Or({inputs:{x:l[0]},backend:t}):Gp(l,i,t)}const Lpe={kernelName:Ux,backendName:"webgl",kernelFunc:Zz};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jz{constructor(e,t=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const a=e.padInfo.top,o=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,d=e.dilationHeight,f=e.dilationWidth,m=e.filterHeight,y=e.filterWidth,b=Math.floor(e.inChannels/4)*4,w=e.inChannels%4,x=e.dataFormat==="channelsLast",T=x?1:2,E=x?2:3,$=x?3:1;let C="",O="";s&&(r?C=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?C=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:C=`
          float activation(float x) {
            ${s}
          }
        `,O="result = activation(result);");const V=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${C}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${$}];

        ivec2 xRCCorner =
            ivec2(coords[${T}], coords[${E}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${m}; wR++) {
          int xR = xRCorner + wR * ${d};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${y}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${b}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${w===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${b}) *
                    getW(wR, wC, ${b}, d2);
              } else {
                dotProd +=
                    getX(batch, ${b}, xR, xC) *
                    getW(wR, wC, ${b}, d2);
              }

            } else if (${w===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${b}, d2),
                getW(wR, wC, ${b} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${b}),
                  getX(batch, xR, xC, ${b} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${b}, xR, xC),
                  getX(batch, ${b} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${w===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${b}, d2),
                getW(wR, wC, ${b} + 1, d2),
                getW(wR, wC, ${b} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${b}),
                  getX(batch, xR, xC, ${b} + 1),
                  getX(batch, xR, xC, ${b} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${b}, xR, xC),
                  getX(batch, ${b} + 1, xR, xC),
                  getX(batch, ${b} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${V}
        ${O}
        setOutput(result);
      }
    `}}class Ppe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,f=e.filterDepth,m=e.filterHeight,y=e.filterWidth,b=Math.floor(e.inChannels/4)*4,w=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${a}, ${o});
      const ivec3 pads = ivec3(${t}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${y}; wC++) {
              int xC = xCCorner + wC * ${d};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${b}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${w===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${b}) *
                  getW(wF, wR, wC, ${b}, d2);
              } else if (${w===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${b}),
                  getX(batch, xF, xR, xC, ${b} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${b}, d2),
                  getW(wF, wR, wC, ${b} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${w===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${b}),
                  getX(batch, xF, xR, xC, ${b} + 1),
                  getX(batch, xF, xR, xC, ${b} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${b}, d2),
                  getW(wF, wR, wC, ${b} + 1, d2),
                  getW(wF, wR, wC, ${b} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e4{constructor(e,t=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gs(this.outputShape.length);const a=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,f=d;let m=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<d;x++)m+=`
           vec4 xTexelC${x*2};
           int xTexelC${x*2}Ready;
           vec4 xTexelC${x*2+1};
           int xTexelC${x*2+1}Ready;
           vec4 xC${x};`;m+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let x=0;x<d;x++)m+=`
           xTexelC${x*2} = vec4(0.0);
           xTexelC${x*2}Ready = 0;
           xTexelC${x*2+1} = vec4(0.0);
           xTexelC${x*2+1}Ready = 0;
           xC${x} = vec4(0.0);`;m+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let x=0;x<(f+1)/2;x++){const T=x*2;if(m+=`
           xC = xCCorner + ${T*l};
           `,o===1){if(T<d&&(a%2===1?(m+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }
               `,l===1&&T>0?m+=`
                 xC${T} = vec4(xTexelC${T-2}.zw, xTexelC${T}.xy);
                 `:m+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${T} = vec4(previous.zw, xTexelC${T}.xy);
                   } else {
                     xC${T} = vec4(0.0, 0.0, xTexelC${T}.xy);
                   }
                   `):m+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }

                 xC${T} = xTexelC${T};
                 `,T+1<d)){const E=a%2===0?k_(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(m+=`
                   xCOffset = xC + imod(pads[1], 2) + ${E};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                     xTexelC${T+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${T+1}.zw = vec2(0.0);
                     }
                     xTexelC${T+1}Ready = 1;
                   }
                   `,l>1?m+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${T+1} = vec4(previous.zw, xTexelC${T+1}.xy);
                     } else {
                      xC${T+1} = vec4(0.0, 0.0, xTexelC${T+1}.xy);
                     }
                     `:m+=`
                     xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.xy);
                     `):E===1?m+=`
                     xC${T+1} = xTexelC${T};
                     `:m+=`
                     xCOffset = xC + ${E};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                       xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${T+1}.zw = vec2(0.0);
                       }
                       xTexelC${T+1}Ready = 1;
                     }

                     xC${T+1} = xTexelC${T+1};
                     `}}else T<d&&(a%2===1?(m+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${T+1}Ready == 0) {
                   xTexelC${T+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${T+1}.zw = vec2(0.0);
                   }
                   xTexelC${T+1}Ready = 1;
                 }

                 xC${T} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
               `,T+1<d&&(m+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${T+1} = vec4(xTexelC${T+1}.xy, final.xy);
                 `)):(m+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                   xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${T+1}.zw = vec2(0.);
                   }
                   xTexelC${T+1}Ready = 1;
                 }

                 xC${T} = vec4(
                   xTexelC${T}.xy, xTexelC${T+1}.xy);
               `,T+1<d&&(m+=`
                   xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
                 `)));T<d&&(m+=`
             wTexel = getW(r, ${T}, d1, d2);
             dotProd += xC${T}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${T}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,T+1<d&&(m+=`
               wTexel = getW(r, ${T+1}, d1, d2);
               dotProd += xC${T+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${T+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}m+=`
     }
   `,m+=`
     }
   `,m+=`
     }
   `;let y="",b="";s&&(r?y=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:i?y=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:y=`vec4 activation(vec4 x) {
           ${s}
         }`,b="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${y}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${m}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${w}
         ${b}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mpe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Gs(this.outputShape.length);const{dataFormat:s}=t,r=ur(),i=s==="channelsLast",a=i?1:2,o=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let d=0;d<=1;d++)for(let f=0;f<=1;f++)u+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${d};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${d*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${d*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ax(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function t4({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:o=null}){const l=n.shape,u=s.texData.get(n.dataId),d=t.inChannels,f=l[0]*l[1]*l[2],m=t.outChannels,y=t.dataFormat==="channelsLast",b=!1,w=!1;let x;const T=[];if(i!=null){const C=ax(i.shape,y);C!=null&&(i=Me({inputs:{x:i},backend:s,attrs:{shape:C}}),T.push(i))}if(r!=null){const C=ax(r.shape,y);C!=null&&(r=Me({inputs:{x:r},backend:s,attrs:{shape:C}}),T.push(r))}if(!((f===1||m===1)&&d>qz)&&u.isPacked&&y&&u.texture!=null&&l[2]%2!==0&&Gt(u.shape.slice(-3),l.slice(-3))){const C=l[0]*l[1]*(l[2]+1),O={dataId:n.dataId,shape:[1,C,t.inChannels],dtype:n.dtype},V=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,H(rx(u.shape,O.shape),()=>`packed reshape ${u.shape} to ${O.shape} isn't free`);const F=Me({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}});T.push(F);const R=ix({a:O,b:F,backend:s,transposeA:b,transposeB:w,bias:r,activation:o,preluActivationWeights:i,leakyreluAlpha:a}),N=s.texData.get(R.dataId);H(N.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=V,N.shape=t.outShape,x=Or({inputs:{x:R},backend:s}),x.shape=t.outShape,T.push(R)}else{const C=t.outHeight*t.outWidth,O=Me({inputs:{x:n},backend:s,attrs:{shape:y?[t.batchSize,C,t.inChannels]:[t.batchSize,t.inChannels,C]}}),V=Me({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}}),F=ix({a:y?O:V,b:y?V:O,transposeA:!y,transposeB:w,backend:s,bias:r,activation:o,preluActivationWeights:i,leakyreluAlpha:a});x=Me({inputs:{x:F},backend:s,attrs:{shape:t.outShape}}),T.push(O),T.push(V),T.push(F)}for(const C of T)s.disposeIntermediateTensorInfo(C);return x}function n4({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:o=null}){const{filterWidth:l,filterHeight:u,inChannels:d,outWidth:f,outHeight:m,dataFormat:y}=t,b=y==="channelsLast",w=l*u*d,x=m*f,T=[t.batchSize,w,x],E=!0,$=!1,C=[];if(i!=null){const Z=ax(i.shape,b);Z!=null&&(i=Me({inputs:{x:i},backend:s,attrs:{shape:Z}}),C.push(i))}if(r!=null){const Z=ax(r.shape,b);Z!=null&&(r=Me({inputs:{x:r},backend:s,attrs:{shape:Z}}),C.push(r))}const O=Me({inputs:{x:e},backend:s,attrs:{shape:[1,w,Ee(e.shape)/w]}});C.push(O);const V=new Mpe(T,t),F=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],R=s.runWebGLProgram(V,[n],"float32",F),N=Me({inputs:{x:R},backend:s,attrs:{shape:T}});C.push(R),C.push(N);const D=r!=null,k=i!=null,z=o==="leakyrelu",B=o?Sm(o,!0):null,ne=new Hz(b?N.shape:O.shape,b?O.shape:N.shape,b?[t.batchSize,x,t.outChannels]:[t.batchSize,t.outChannels,x],E,$,D,B,k,z),J=b?[N,O]:[O,N];if(r&&J.push(r),k&&J.push(i),z){const Z=s.makeTensorInfo([],"float32",mc(a,"float32"));J.push(Z),C.push(Z)}const K=s.runWebGLProgram(ne,J,"float32"),re=Me({inputs:{x:K},backend:s,attrs:{shape:t.outShape}});C.push(K);for(const Z of C)s.disposeIntermediateTensorInfo(Z);return re}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vpe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dataFormat:l,dilations:u,dimRoundingMode:d}=s,f=qo(l),m=Cs(r.shape,i.shape,a,u,o,d,!1,f);let y;if(m.filterHeight===1&&m.filterWidth===1&&m.dilationHeight===1&&m.dilationWidth===1&&m.strideHeight===1&&m.strideWidth===1&&(m.padInfo.type==="SAME"||m.padInfo.type==="VALID"))y=t4({x:r,filter:i,convInfo:m,backend:t});else if(m.strideWidth<=2&&f==="channelsLast"&&xe().getBool("WEBGL_EXP_CONV")){const w=new e4(m),x=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]];y=t.runWebGLProgram(w,[r,i],"float32",x)}else if(xe().getBool("WEBGL_CONV_IM2COL"))y=n4({x:r,filter:i,convInfo:m,backend:t});else{const w=new Jz(m);y=t.runWebGLProgram(w,[r,i],"float32")}const b=Me({inputs:{x:y},backend:t,attrs:{shape:m.outShape}});return t.disposeIntermediateTensorInfo(y),b}const Bpe={kernelName:jx,backendName:"webgl",kernelFunc:Vpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zpe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${a?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Upe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,l=s-1-e.padInfo.left,u=a?1:2,d=a?2:3,f=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${d}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class jpe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${a};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Wpe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=t-1-e.padInfo.front,u=s-1-e.padInfo.top,d=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gpe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:d}=s,f=qo(l),m=Cs(r.shape,d,a,1,o,u,!1,f),y=new zpe(m);return t.runWebGLProgram(y,[r,i],"float32")}const Hpe={kernelName:j_,backendName:"webgl",kernelFunc:Gpe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qpe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Gs(this.outputShape.length);const t=e.filterHeight,s=e.filterWidth,r=t-1-e.padInfo.top,i=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kpe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{inputShape:a,strides:o,pad:l,dataFormat:u,dimRoundingMode:d}=s,f=qo(u),m=Cs(a,i.shape,o,1,l,d,!1,f);if(xe().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&f==="channelsLast"){const y=[[m.strideHeight,m.strideWidth]],b=new qpe(m);return t.runWebGLProgram(b,[r,i],"float32",y)}else{const y=new Upe(m);return t.runWebGLProgram(y,[r,i],"float32")}}const Xpe={kernelName:Wx,backendName:"webgl",kernelFunc:Kpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ype(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dilations:l}=s,u=gc(r.shape,i.shape,a,l,o),d=new Ppe(u);return t.runWebGLProgram(d,[r,i],"float32")}const Qpe={kernelName:Gx,backendName:"webgl",kernelFunc:Ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zpe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,pad:o,filterShape:l}=s,u=gc(r.shape,l,a,1,o),d=new jpe(u);return t.runWebGLProgram(d,[r,i],"float32")}const Jpe={kernelName:W_,backendName:"webgl",kernelFunc:Zpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eme(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{pad:a,strides:o,inputShape:l}=s,u=gc(l,i.shape,o,1,a),d=new Wpe(u);return t.runWebGLProgram(d,[r,i],"float32")}const tme={kernelName:G_,backendName:"webgl",kernelFunc:eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nme=gf+`
  return cos(x);
`,sme=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${ah}
  return result;
`,rme=Ct({opSnippet:nme,packedOpSnippet:sme}),ime={kernelName:eg,backendName:"webgl",kernelFunc:rme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ame=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,ome=Ct({opSnippet:ame}),lme={kernelName:tg,backendName:"webgl",kernelFunc:ome};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cme{constructor(e,t,s,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,o,l,u]=e,[d]=t,[f,m]=s;this.outputShape=[d,f,m,u];const y=r==="bilinear"?1:0,[b,w]=[`${o-1}.0`,`${l-1}.0`],[x,T,E]=f>1?[`${(o-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${b} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${b}`],[$,C,O]=m>1?[`${(l-1)/(m-1)}`,"(x2-x1) * width_ratio",`x1*${w} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${w}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${$});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${T};
        float width_scale = ${C};

        float in_y = ${E};
        if( in_y < 0.0 || in_y > ${b} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${O};
        if( in_x < 0.0 || in_x > ${w} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${y} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ume=n=>{const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:i,boxInd:a}=e,{cropSize:o,method:l,extrapolationValue:u}=s,d=new cme(r.shape,i.shape,o,l,u);return t.runWebGLProgram(d,[r,i,a],"float32")},hme={kernelName:q_,backendName:"webgl",kernelFunc:ume};var Em;(function(n){n.Prod="*",n.Sum="+"})(Em||(Em={}));class WD{constructor(e,t,s,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,a=this.op===Em.Prod?"1.0":"0.0",o=s?a:`getX(${GD(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",d="";s?(u=r?`end != ${l-1}`:"end != 0",d=r?"end + 1":"end - 1"):(u=r?`end + pow2 < ${l}`:"end >= pow2",d=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Jt(i)} coords = getOutputCoords();
        int end = ${HD(i,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${d};
          ${HD(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${GD(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function GD(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function HD(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s4(n,e,t,s,r,i){const a=e.shape.length,o=Sn([s],a);let l=e;o!=null&&(l=cr({inputs:{x:e},backend:t,attrs:{perm:o}}));const u=Ln(1,a)[0];if(u!==a-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const d=l.shape[u];let f=Or({inputs:{x:l},backend:t});for(let m=0;m<=Math.ceil(Math.log2(d))-1;m++){const y=new WD(n,l.shape,!1,i),b=[[m]],w=f;f=t.runWebGLProgram(y,[f],f.dtype,b),t.disposeIntermediateTensorInfo(w)}if(r){const m=new WD(n,l.shape,r,i),y=f;f=t.runWebGLProgram(m,[f],f.dtype),t.disposeIntermediateTensorInfo(y)}if(o!=null){const m=yc(o),y=cr({inputs:{x:f},backend:t,attrs:{perm:m}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(l),y}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dme(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,exclusive:a,reverse:o}=s;return s4(Em.Prod,r,t,i,a,o)}const fme={kernelName:H_,backendName:"webgl",kernelFunc:dme};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pme(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,exclusive:a,reverse:o}=s;return s4(Em.Sum,r,t,i,a,o)}const mme={kernelName:Hx,backendName:"webgl",kernelFunc:pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gme(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:i}=e,{size:a,binaryOutput:o}=s;if(r.shape.length===1){const l=t.readSync(r.dataId),u=t.readSync(i.dataId),d=Pz(l,u,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,d)}else if(r.shape.length===2){const l=t.bufferSync(r),u=t.bufferSync(i),d=vhe(l,u,a,o);return t.makeTensorInfo(d.shape,i.dtype,d.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const yme={kernelName:K_,backendName:"webgl",kernelFunc:gme};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bme{constructor(e,t,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xme(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:i,dataFormat:a}=s,o=r.shape[0],l=a==="NHWC"?r.shape[1]:r.shape[2],u=a==="NHWC"?r.shape[2]:r.shape[3],d=a==="NHWC"?r.shape[3]:r.shape[1],f=l*i,m=u*i,y=d/(i*i),b=a==="NHWC"?[o,f,m,y]:[o,y,f,m],w=new bme(b,i,a);return t.runWebGLProgram(w,[r],r.dtype)}const vme={kernelName:X_,backendName:"webgl",kernelFunc:xme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r4{constructor(e,t=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gs(this.outputShape.length);const a=e.filterHeight,o=e.filterWidth,l=e.outChannels/e.inChannels;let u="",d="";s&&(r?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:u=`
          float activation(float x) {
            ${s}
          }
        `,d="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${d}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i4{constructor(e,t=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gs(this.outputShape.length);const a=e.outChannels/e.inChannels,o=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,m=f;let y=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let T=0;T<f;T++)y+=`
          vec4 xTexelC${T*2};
          int xTexelC${T*2}Ready;
          vec4 xTexelC${T*2+1};
          int xTexelC${T*2+1}Ready;
          vec4 xC${T};`;y+=`
    for (int r = 0; r < ${d}; r++) {
      `;for(let T=0;T<f;T++)y+=`
          xTexelC${T*2} = vec4(0.0);
          xTexelC${T*2}Ready = 0;
          xTexelC${T*2+1} = vec4(0.0);
          xTexelC${T*2+1}Ready = 0;
          xC${T} = vec4(0.0);`;y+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let T=0;T<(m+1)/2;T++){const E=T*2;if(y+=`
          xC = xCCorner + ${E*u};
          `,l===1){if(E<f&&(o%2===1?(y+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E}Ready == 0) {
                  xTexelC${E} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${E}.zw = vec2(0.0);
                  }
                  xTexelC${E}Ready = 1;
                }
              `,u===1&&E>0?y+=`
                xC${E} = vec4(xTexelC${E-2}.zw, xTexelC${E}.xy);
                `:y+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${E} = vec4(previous.zw, xTexelC${E}.xy);
                  } else {
                    xC${E} = vec4(0.0, 0.0, xTexelC${E}.xy);
                  }
                  `):y+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${E}Ready == 0) {
                  xTexelC${E} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${E}.zw = vec2(0.0);
                  }
                  xTexelC${E}Ready = 1;
                }

                xC${E} = xTexelC${E};
                `,E+1<f)){const $=o%2===0?k_(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(y+=`
                  xCOffset = xC + imod(pads[1], 2) + ${$};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E+1}Ready == 0) {
                    xTexelC${E+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${E+1}.zw = vec2(0.0);
                    }
                    xTexelC${E+1}Ready = 1;
                  }
                  `,u>1?y+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${E+1} = vec4(previous.zw, xTexelC${E+1}.xy);
                    } else {
                     xC${E+1} = vec4(0.0, 0.0, xTexelC${E+1}.xy);
                    }
                    `:y+=`
                    xC${E+1} = vec4(xTexelC${E}.zw, xTexelC${E+1}.xy);
                    `):$===1?y+=`
                    xC${E+1} = xTexelC${E};
                    `:y+=`
                    xCOffset = xC + ${$};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E+1}Ready == 0) {
                      xTexelC${E+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${E+1}.zw = vec2(0.0);
                      }
                      xTexelC${E+1}Ready = 1;
                    }

                    xC${E+1} = xTexelC${E+1};
                    `}}else E<f&&(o%2===1?(y+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E}Ready == 0) {
                  xTexelC${E} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${E}.zw = vec2(0.0);
                  }
                  xTexelC${E}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${E+1}Ready == 0) {
                  xTexelC${E+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${E+1}.zw = vec2(0.0);
                  }
                  xTexelC${E+1}Ready = 1;
                }

                xC${E} = vec4(xTexelC${E}.zw, xTexelC${E+1}.zw);
              `,E+1<f&&(y+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${E+1} = vec4(xTexelC${E+1}.xy, final.xy);
                `)):(y+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${E}Ready == 0) {
                  xTexelC${E} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${E}.zw = vec2(0.0);
                  }
                  xTexelC${E}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${E+1}Ready == 0) {
                  xTexelC${E+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${E+1}.zw = vec2(0.);
                  }
                  xTexelC${E+1}Ready = 1;
                }

                xC${E} = vec4(
                  xTexelC${E}.xy, xTexelC${E+1}.xy);
              `,E+1<f&&(y+=`
                  xC${E+1} = vec4(xTexelC${E}.zw, xTexelC${E+1}.zw);
                `)));E<f&&(y+=`
            wTexel = getW(r, ${E}, d1, q);
            dotProd += xC${E} * vec4(wTexel.xz, wTexel.xz);
          `,E+1<f&&(y+=`
              wTexel = getW(r, ${E+1}, d1, q);
              dotProd += xC${E+1} * vec4(wTexel.xz, wTexel.xz);
            `))}y+=`
    }
  `,y+=`
      }
    `;let b="",w="";s&&(r?b=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?b=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:b=`vec4 activation(vec4 x) {
          ${s}
        }`,w="result = activation(result);");const x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${y}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${x}
        ${w}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wme(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dilations:l,dimRoundingMode:u}=s;let d=l;d==null&&(d=[1,1]),H(js(a,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${d}'`);const f=Cs(r.shape,i.shape,a,d,o,u,!0);let m;xe().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?m=new i4(f):m=new r4(f);const y=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return t.runWebGLProgram(m,[r,i],"float32",y)}const Sme={kernelName:qx,backendName:"webgl",kernelFunc:wme};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tme{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${a} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Eme{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _me(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:u,filterShape:d}=s,f=Cs(r.shape,d,a,o,l,u,!0),m=new Tme(f);return t.runWebGLProgram(m,[r,i],"float32")}const Ime={kernelName:Y_,backendName:"webgl",kernelFunc:_me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $me(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:u,inputShape:d}=s,f=Cs(d,i.shape,a,o,l,u,!0),m=new Eme(f);return t.runWebGLProgram(m,[r,i],"float32")}const Cme={kernelName:Q_,backendName:"webgl",kernelFunc:$me};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nme{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kme(n){const{inputs:e,backend:t}=n,{x:s}=e,r=[...s.shape,...s.shape],i=Ee(s.shape),a=Me({inputs:{x:s},backend:t,attrs:{shape:[i]}}),o=new Nme(i),l=t.runWebGLProgram(o,[a],a.dtype),u=Me({inputs:{x:l},backend:t,attrs:{shape:r}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),u}const Ame={kernelName:UL,backendName:"webgl",kernelFunc:kme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rme{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:s,padInfo:r,strideHeight:i,strideWidth:a,filterHeight:o,filterWidth:l,dilationHeight:u,dilationWidth:d}=e,{top:f,left:m}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${a});
      const ivec2 pads = ivec2(${f}, ${m});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${d};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dme(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i}=e,{strides:a,pad:o,dilations:l}=s,u=Bg(r.shape,i.shape,a,o,"NHWC",l);let d;const f=new Rme(u);d=t.runWebGLProgram(f,[r,i],"float32");const m=Me({inputs:{x:d},backend:t,attrs:{shape:u.outShape}});return t.disposeIntermediateTensorInfo(d),m}const Ome={kernelName:Kx,backendName:"webgl",kernelFunc:Dme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fme(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,i=e,{allDims:a,summedDims:o,idDims:l}=b$(r,i.length);v$(a.length,l,i);const{path:u,steps:d}=w$(o,l),f=d.length;let m=null,y=a.length;const b=[];for(let w=0;w<f;++w){for(const x of d[w]){const{permutationIndices:T,expandDims:E}=x$(y,l[x]);let $;S$(T)?$=i[x]:($=cr({inputs:{x:i[x]},backend:t,attrs:{perm:T}}),b.push($));const C=$.shape.slice();for(let O=0;O<E.length;++O)C.splice(E[O],0,1);Gt($.shape,C)||($=Me({inputs:{x:$},backend:t,attrs:{shape:C}}),b.push($)),m===null?m=$:(m=uC({inputs:{a:$,b:m},backend:t}),b.push(m))}w<f-1&&(u[w]>=0&&(m=o1({inputs:{x:m},backend:t,attrs:{axis:u[w]-(a.length-y),keepDims:!1}}),b.push(m)),y--)}for(const w of b)w!==m&&t.disposeIntermediateTensorInfo(w);return m}const Lme={kernelName:Z_,backendName:"webgl",kernelFunc:Fme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pme="return (x >= 0.0) ? x : (exp(x) - 1.0);",Mme=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Vme=Ct({opSnippet:Pme,packedOpSnippet:Mme}),Bme={kernelName:sg,backendName:"webgl",kernelFunc:Vme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zme="return (b >= 0.0) ? a : a * (b + 1.0);",Ume=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,jme=n=>{const{inputs:e,backend:t}=n,{dy:s,y:r}=e,i=xe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new mf(Ume,s.shape,r.shape):new zu(zme,s.shape,r.shape);return t.runWebGLProgram(i,[s,r],s.dtype)},Wme={kernelName:J_,backendName:"webgl",kernelFunc:jme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gme=`
  return vec4(equal(a, b));
`,Hme="return float(a == b);",qme=ks({opSnippet:Hme,packedOpSnippet:Gme,dtype:"bool",cpuKernelImpl:_he}),Kme={kernelName:Xx,backendName:"webgl",kernelFunc:qme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xme=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${h$};
  float a1 = ${d$};
  float a2 = ${f$};
  float a3 = ${p$};
  float a4 = ${m$};
  float a5 = ${g$};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Yme=Ct({opSnippet:Xme}),Qme={kernelName:rg,backendName:"webgl",kernelFunc:Yme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zme=gf+`
  return exp(x);
`,Jme=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,a4=Ct({opSnippet:Zme,packedOpSnippet:Jme,cpuKernelImpl:Ihe,dtype:"float32"}),ege={kernelName:ig,backendName:"webgl",kernelFunc:a4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fE(n){const{inputs:e,attrs:t,backend:s}=n,{dim:r}=t,{input:i}=e,a=i.shape.length,o=i.shape.slice();let l=r;return r<0&&(H(-(a+1)<=r,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+r+1),o.splice(l,0,1),Me({inputs:{x:i},backend:s,attrs:{shape:o}})}const tge={kernelName:Yx,backendName:"webgl",kernelFunc:fE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qD="return exp(x) - 1.0;",nge=Ct({opSnippet:qD,packedOpSnippet:qD,cpuKernelImpl:$he}),sge={kernelName:ag,backendName:"webgl",kernelFunc:nge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KD{constructor(e,t,s){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const i=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=s?`${r}.0`:"1.0";let o;if(e==="real")o="return real * expR - imag * expI;";else if(e==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${a};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o4(n,e,t){const s=t.texData.get(n.dataId),r=Ee(n.shape),i=n.shape[n.shape.length-1],a=r/i,o=Me({inputs:{x:n},backend:t,attrs:{shape:[a,i]}}),l=o.shape,u=new KD("real",l,e),d=new KD("imag",l,e),f=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],m=t.runWebGLProgram(u,f,"float32"),y=t.runWebGLProgram(d,f,"float32"),b=Tc({inputs:{real:m,imag:y},backend:t});t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y);const w=Me({inputs:{x:b},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(b),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rge(n){const{inputs:e,backend:t}=n,{input:s}=e;return o4(s,!1,t)}const ige={kernelName:eI,backendName:"webgl",kernelFunc:rge};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class age{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iy(n){const{backend:e,attrs:t}=n,{shape:s,value:r}=t;let{dtype:i}=t;if(i=i||Jd(r),i==="string"){const a=Rn(i,Ee(s));return a.fill(r),e.makeTensorInfo(s,i,a)}else{const a=new age(s,r),o=[[r]];return e.runWebGLProgram(a,[],i,o)}}const oge={kernelName:tI,backendName:"webgl",kernelFunc:iy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lge{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cge={kernelName:nI,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,s=e,r=new lge(t.shape);return s.runWebGLProgram(r,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XD="return floor(x);",uge=Ct({opSnippet:XD,packedOpSnippet:XD,cpuKernelImpl:Che}),hge={kernelName:og,backendName:"webgl",kernelFunc:uge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dge=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,fge=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,pge=ks({opSnippet:dge,packedOpSnippet:fge,dtype:"int32"}),mge={kernelName:lg,backendName:"webgl",kernelFunc:pge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gge{constructor(e){this.variableNames=["A"];const t=ur(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yge{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=ur(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bge={kernelName:D9,backendName:"webgl",kernelFunc:xge};let Zh,aT=xe().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function xge(n){const{inputs:e,backend:t,attrs:s}=n;let{pixels:r}=e;const{numChannels:i}=s,a=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,u]=a?[r.videoWidth,r.videoHeight]:[r.width,r.height],d=[u,l],f=[u,l,i];if(o||a){const w=xe().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Zh==null||w!==aT)&&(aT=w,Zh=document.createElement("canvas").getContext("2d",{willReadFrequently:aT})),Zh.canvas.width=l,Zh.canvas.height=u,Zh.drawImage(r,0,0,l,u),r=Zh.canvas}const m=t.makeTensorInfo(d,"int32");t.texData.get(m.dataId).usage=qr.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(m.dataId),r);const y=xe().getBool("WEBGL_PACK")?new yge(f):new gge(f),b=t.runWebGLProgram(y,[m],"int32");return t.disposeData(m.dataId),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vge(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:d,dilations:f,dimRoundingMode:m,activation:y,leakyreluAlpha:b}=s,w=qo(d),x=Cs(r.shape,i.shape,l,f,u,m,!1,w);let T;const E=[],$=a!=null,C=o!=null,O=y==="leakyrelu",V=()=>{const R=[r,i],N=(D,k)=>{if(k==="NCHW"&&D.shape.length===1&&D.shape[0]!==1){const z=Me({inputs:{x:D},backend:t,attrs:{shape:[D.shape[0],1,1]}});return E.push(z),z}return D};if($&&R.push(N(a,d)),C&&R.push(N(o,d)),O){const D=t.makeTensorInfo([],"float32",mc(b,"float32"));R.push(D),E.push(D)}return R};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))T=t4({x:r,filter:i,convInfo:x,backend:t,bias:a,activation:y,preluActivationWeights:o,leakyreluAlpha:b});else if(x.strideWidth<=2&&w==="channelsLast"&&xe().getBool("WEBGL_EXP_CONV")){const R=y?Sm(y,!0):null,N=new e4(x,$,R,C,O),D=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],k=V();T=t.runWebGLProgram(N,k,"float32",D)}else if(xe().getBool("WEBGL_CONV_IM2COL"))T=n4({x:r,filter:i,convInfo:x,backend:t,bias:a,activation:y,preluActivationWeights:o,leakyreluAlpha:b});else{const R=y?Sm(y,!1):null,N=new Jz(x,$,R,C,O),D=V();T=t.runWebGLProgram(N,D,"float32")}const F=Me({inputs:{x:T},backend:t,attrs:{shape:x.outShape}});return E.push(T),E.forEach(R=>t.disposeIntermediateTensorInfo(R)),F}const wge={kernelName:L0,backendName:"webgl",kernelFunc:vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sge(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:u,dilations:d,dimRoundingMode:f,activation:m,leakyreluAlpha:y}=s,b=[];let w=d;w==null&&(w=[1,1]),H(js(l,w),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${w}'`);const x=Cs(r.shape,i.shape,l,w,u,f,!0),T=xe().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,E=m?Sm(m,T):null,$=[r,i],C=a!=null,O=o!=null,V=m==="leakyrelu";if(C&&$.push(a),O&&$.push(o),V){const D=t.makeTensorInfo([],"float32",mc(y,"float32"));$.push(D),b.push(D)}let F;T?F=new i4(x,C,E,O,V):F=new r4(x,C,E,O,V);const R=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],N=t.runWebGLProgram(F,$,"float32",R);return b.forEach(D=>t.disposeIntermediateTensorInfo(D)),N}const Tge={kernelName:oP,backendName:"webgl",kernelFunc:Sge};class Ege{constructor(e,t,s,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const i=Jt(s.length);let a=`
    int index;`;for(let o=0;o<this.sliceDim;o++)a+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ge(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,i=r.shape,a=i[i.length-1],o=Ee(s.shape),[l,u,d,f]=e$(s,r),m=Me({inputs:{x:r},backend:t,attrs:{shape:[u,a]}}),y=Me({inputs:{x:s},backend:t,attrs:{shape:[Ee(s.shape)/d,d]}});if(t.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const T=t.readSync(r.dataId),E=t.bufferSync(s),$=Nhe(T,E,s.dtype,u,a,d,f,s.shape,o);return t.makeTensorInfo(l,s.dtype,$.values)}const b=new Ege(a,f,[u,d],s.shape),w=t.runWebGLProgram(b,[y,m],y.dtype),x=Me({inputs:{x:w},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(w),x}const Ige={kernelName:jL,backendName:"webgl",kernelFunc:_ge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ge{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const s=Jt(this.rank),r=Cge(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function Cge(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<n.length;r++)r===2?s.push("index"):s.push(`${t[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:i}=e,{axis:a,batchDims:o}=s,l=gt(a,r.shape)[0];if(xe().get("DEBUG")){const E=t.readSync(i.dataId),$=r.shape[l];for(let C=0;C<E.length;++C){const O=E[C];H(O<=$-1&&O>=0,()=>`GatherV2: the index value ${O} is not in [0, ${$-1}]`)}}const u=E$(r,i,l,o),d=Ee(i.shape),f=[],m=Me({inputs:{x:r},backend:t,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),y=Me({inputs:{x:i},backend:t,attrs:{shape:[u.batchSize,d/u.batchSize]}});f.push(m),f.push(y);const b=[u.batchSize,u.outerSize,d/u.batchSize,u.sliceSize];if(t.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const E=t.bufferSync(y),$=t.bufferSync(m),C=khe($,E,b);return f.forEach(O=>t.disposeIntermediateTensorInfo(O)),t.makeTensorInfo(u.outputShape,C.dtype,C.values)}const w=new $ge(m.shape,b),x=t.runWebGLProgram(w,[m,y],m.dtype);f.push(x);const T=Me({inputs:{x},backend:t,attrs:{shape:u.outputShape}});return f.forEach(E=>t.disposeIntermediateTensorInfo(E)),T}const Nge={kernelName:Zx,backendName:"webgl",kernelFunc:l4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kge="return float(a > b);",Age=`
  return vec4(greaterThan(a, b));
`,Rge=ks({opSnippet:kge,packedOpSnippet:Age,cpuKernelImpl:Ahe,dtype:"bool"}),Dge={kernelName:Jx,backendName:"webgl",kernelFunc:Rge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oge="return float(a >= b);",Fge=`
  return vec4(greaterThanEqual(a, b));
`,Lge=ks({opSnippet:Oge,packedOpSnippet:Fge,dtype:"bool",cpuKernelImpl:Rhe}),Pge={kernelName:cg,backendName:"webgl",kernelFunc:Lge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mge(n){const{inputs:e,backend:t}=n,{input:s}=e;return o4(s,!0,t)}const Vge={kernelName:sI,backendName:"webgl",kernelFunc:Mge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bge="return float(!isnan(x) && !isinf(x));",zge=Ct({opSnippet:Bge,dtype:"bool"}),Uge={kernelName:hg,backendName:"webgl",kernelFunc:zge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jge="return float(isinf(x));",Wge=Ct({opSnippet:jge,dtype:"bool"}),Gge={kernelName:dg,backendName:"webgl",kernelFunc:Wge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hge="return float(isnan(x));",qge=Ct({opSnippet:Hge,dtype:"bool"}),Kge={kernelName:fg,backendName:"webgl",kernelFunc:qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xge="return float(a < b);",Yge=`
  return vec4(lessThan(a, b));
`,Qge=ks({opSnippet:Xge,packedOpSnippet:Yge,cpuKernelImpl:Dhe,dtype:"bool"}),Zge={kernelName:tv,backendName:"webgl",kernelFunc:Qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jge="return float(a <= b);",eye=`
  return vec4(lessThanEqual(a, b));
`,tye=ks({opSnippet:Jge,packedOpSnippet:eye,cpuKernelImpl:Ohe,dtype:"bool"}),nye={kernelName:nv,backendName:"webgl",kernelFunc:tye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sye(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:i}=t,a=Fhe(s,r,i);return e.makeTensorInfo([a.length],"float32",a)}const rye={kernelName:WL,backendName:"webgl",kernelFunc:sye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iye=gf+`
  return x < 0.0 ? 0./0. : log(x);
`,aye=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,oye=Ct({opSnippet:iye,packedOpSnippet:aye,cpuKernelImpl:Lhe}),lye={kernelName:pg,backendName:"webgl",kernelFunc:oye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cye=gf+`
  return log(1.0 + x);
`,uye=Ct({opSnippet:cye}),hye={kernelName:mg,backendName:"webgl",kernelFunc:uye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dye="return float(a >= 1.0 && b >= 1.0);",fye=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,pye=ks({opSnippet:dye,packedOpSnippet:fye,dtype:"bool"}),mye={kernelName:sv,backendName:"webgl",kernelFunc:pye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gye="return float(!(x >= 1.0));",yye=Ct({opSnippet:gye}),bye={kernelName:rv,backendName:"webgl",kernelFunc:yye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xye="return float(a >= 1.0 || b >= 1.0);",vye=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,wye=ks({opSnippet:xye,packedOpSnippet:vye,dtype:"bool"}),Sye={kernelName:iv,backendName:"webgl",kernelFunc:wye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tye{constructor(e,t,s,r,i){this.variableNames=["x"],this.outputShape=[];const a=t,o=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${a}; j <= ${a}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eye{constructor(e,t,s,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=t,o=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${a};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${a}; j <= ${a}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ye=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:i,bias:a,alpha:o,beta:l}=s,u=xe().getBool("WEBGL_PACK_NORMALIZATION")?new Eye(r.shape,i,a,o,l):new Tye(r.shape,i,a,o,l);return t.runWebGLProgram(u,[r],r.dtype)},Iye={kernelName:av,backendName:"webgl",kernelFunc:_ye};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ye{constructor(e,t,s,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=s,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cye=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r,y:i,dy:a}=e,{depthRadius:o,bias:l,alpha:u,beta:d}=s,f=new $ye(r.shape,o,l,u,d);return t.runWebGLProgram(f,[r,i,a],r.dtype)},Nye={kernelName:iI,backendName:"webgl",kernelFunc:Cye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kye(n,e,t,s){const r=Ee(e),a=Ee(n.shape)/r,o=Me({inputs:{x:n},attrs:{shape:[a,r]},backend:s}),l=oh(o,n.dtype,"max",s),u=Me({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c4(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:i,keepDims:a}=s,o=r.shape.length,l=gt(i,r.shape);let u=l;const d=Sn(u,o),f=d!=null,m=t.shouldExecuteOnCPU([r]);let y=r;if(f){if(m){const $=t.texData.get(y.dataId).values,C=new Array(o);for(let F=0;F<C.length;F++)C[F]=r.shape[d[F]];const O=lC($,r.shape,r.dtype,d,C);y=t.makeTensorInfo(C,r.dtype);const V=t.texData.get(y.dataId);V.values=O}else y=a1(r,d,t);u=Ln(u.length,o)}Ns("max",u,o);const[b,w]=ps(y.shape,u);let x=b;a&&(x=jn(b,l));let T;if(m){const $=t.texData.get(y.dataId).values,C=Phe($,Ee(w),x,r.dtype);T=t.makeTensorInfo(x,r.dtype);const O=t.texData.get(T.dataId);O.values=C}else T=kye(y,w,x,t);return f&&t.disposeIntermediateTensorInfo(y),T}const Aye={kernelName:ov,backendName:"webgl",kernelFunc:c4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rye=cC+`
  return max(a, b);
`,Dye=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ah+`
  return result;
`,Oye=ks({opSnippet:Rye,packedOpSnippet:Dye,cpuKernelImpl:Mhe}),Fye={kernelName:gg,backendName:"webgl",kernelFunc:Oye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lye(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;ny(r,"maxPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:l}=s,u=1;H(js(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const d=$i(r.shape,i,a,u,o,l);if(d.filterWidth===1&&d.filterHeight===1&&Gt(d.inShape,d.outShape))return Or({inputs:{x:r},backend:t});const f=new Tm(d,"max",!1);return t.runWebGLProgram(f,[r],r.dtype)}const Pye={kernelName:lv,backendName:"webgl",kernelFunc:Lye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mye(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:i,strides:a,pad:o,dataFormat:l,dimRoundingMode:u}=s,d=[1,1,1],f=Ho(r.shape,i,a,d,o,u,l),m=new hC(f,"max",!1);return t.runWebGLProgram(m,[r],r.dtype)}const Vye={kernelName:cv,backendName:"webgl",kernelFunc:Mye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bye{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,l=a-1-e.padInfo.left,u=i*a-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class zye{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=l-1-e.padInfo.front,m=u-1-e.padInfo.top,y=d-1-e.padInfo.left,b=l*u*d-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${m}, ${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${b} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${d} +
                  wR * ${d} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uye(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i}=e,a=i,{filterSize:o,strides:l,pad:u,dimRoundingMode:d}=s,f=[1,1,1],m=Ho(a.shape,o,l,f,u,d),y=new hC(m,"max",!0),b=t.runWebGLProgram(y,[a],a.dtype),w=new zye(m),x=t.runWebGLProgram(w,[r,b],a.dtype);return t.disposeIntermediateTensorInfo(b),x}const jye={kernelName:oI,backendName:"webgl",kernelFunc:Uye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wye(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:i,output:a}=e,o=i;ny([i,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:d,dimRoundingMode:f}=s,m=$i(o.shape,l,u,1,d,f),y=!0,b=new Tm(m,"max",y),w=t.runWebGLProgram(b,[o],o.dtype),x=new Bye(m),T=t.runWebGLProgram(x,[r,w],o.dtype);return t.disposeIntermediateTensorInfo(w),T}const Gye={kernelName:aI,backendName:"webgl",kernelFunc:Wye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hye(n,e,t,s){let r=new Tm(t,"max",!1);const i=s.runWebGLProgram(r,[n],"float32");r=new Tm(t,"max",!0,!0,e);const a=s.runWebGLProgram(r,[n],"float32");return[i,a]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qye={kernelName:GL,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:i,pad:a,includeBatchInIndex:o}=e,l=t;H(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const u=[1,1];H(js(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const d=$i(s.shape,r,i,u,a),[f,m]=Hye(s,o,d,l);return[f,m]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kye(n,e,t,s){const r=Ee(e),a=Ee(n.shape)/r,o=Me({inputs:{x:n},attrs:{shape:[a,r]},backend:s}),l=oh(o,"float32","mean",s),u=Me({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xye={kernelName:uv,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{keepDims:r,axis:i}=e,a=t,o=s.shape.length,l=gt(i,s.shape);let u=l;const d=Sn(u,o),f=d!=null,m=a.shouldExecuteOnCPU([s]),y=[];let b=s;if(f){if(m){const C=a.texData.get(b.dataId).values,O=new Array(o);for(let R=0;R<O.length;R++)O[R]=s.shape[d[R]];const V=lC(C,s.shape,s.dtype,d,O);b=a.makeTensorInfo(O,s.dtype);const F=a.texData.get(b.dataId);F.values=V}else b=a1(s,d,a);y.push(b),u=Ln(u.length,o)}Ns("sum",u,o);const[w,x]=ps(b.shape,u);let T=w;r&&(T=jn(w,l));const E=Kye(b,x,T,a);for(const $ of y)a.disposeIntermediateTensorInfo($);return E}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yye(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s,o=r.shape.length,l=gt(i,r.shape);let u=l;const d=Sn(u,o);let f=r;d!=null&&(f=cr({inputs:{x:r},backend:t,attrs:{perm:d}}),u=Ln(u.length,r.shape.length)),Ns("min",u,o);const[m,y]=ps(f.shape,u),b=Ee(y),w=Me({inputs:{x:f},backend:t,attrs:{shape:[-1,b]}}),x=oh(w,w.dtype,"min",t);let T;if(a){const E=jn(m,l);T=Me({inputs:{x},backend:t,attrs:{shape:E}})}else T=Me({inputs:{x},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),d!=null&&t.disposeIntermediateTensorInfo(f),T}const Qye={kernelName:hv,backendName:"webgl",kernelFunc:Yye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zye=cC+`
  return min(a, b);
`,Jye=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ah+`
  return result;
`,ebe=ks({opSnippet:Zye,packedOpSnippet:Jye,cpuKernelImpl:Vhe}),tbe={kernelName:yg,backendName:"webgl",kernelFunc:ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nbe{constructor(e,t,s){this.variableNames=["x"],this.outputShape=t.map((d,f)=>d[0]+e[f]+d[1]);const r=e.length,i=Jt(r),a=t.map(d=>d[0]).join(","),o=t.map((d,f)=>d[0]+e[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sbe{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((b,w)=>b[0]+e[w]+b[1]);const r=e.length,i=Jt(r),a=t.map(b=>b[0]).join(","),o=t.map((b,w)=>b[0]+e[w]).join(","),l=nr("rc",r),u=nr("source",r),d=`${l[r-1]} < ${this.outputShape[r-1]}`,f=r===1?"source":`vec2(${u.slice(-2).join()})`,m=s==="reflect"?0:1;let y="";if(r===1){const b=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${m};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${m};
        }
        source -= start;
      `;y=`
        ${i} rc = outputLoc;
        ${b}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[r-1]} += 1;
        if(${d}) {
          ${b}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
      `}else{const b=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${m}) +
                gte * ((end - 1) * 2 - source + ${m});
        source -= start;
      `;y=`
        ${i} rc = outputLoc;
        ${b}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[r-1]} += 1;
        if(${d}) {
          ${b}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${b}
          result[2] = getChannel(getX(${u.join()}), ${f});
          ${l[r-1]} += 1;
          if(${d}) {
            ${b}
            result[3] = getChannel(getX(${u.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rbe=({inputs:n,backend:e,attrs:t})=>{const{x:s}=n,{paddings:r,mode:i}=t,a=xe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sbe(s.shape,r,i):new nbe(s.shape,r,i);return e.runWebGLProgram(a,[s],s.dtype)},ibe={kernelName:dv,backendName:"webgl",kernelFunc:rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const abe=`if (b == 0.0) return NAN;
  return mod(a, b);`,obe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+ah+`
  return result;
`,lbe=ks({opSnippet:abe,packedOpSnippet:obe}),cbe={kernelName:bg,backendName:"webgl",kernelFunc:lbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ube{constructor(e,t,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hbe=`
if (a == b) {
  return 1.0;
};
return a / b;`,dbe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,u4=ks({opSnippet:hbe,packedOpSnippet:dbe,checkOutOfBounds:!0}),fbe={kernelName:ng,backendName:"webgl",kernelFunc:u4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YD="return a - b;",h4=ks({opSnippet:YD,packedOpSnippet:YD,supportsComplex:!0,cpuKernelImpl:ade}),pbe={kernelName:Og,backendName:"webgl",kernelFunc:h4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d4(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:i}=s,a=gt([i],r.shape),o=c4({inputs:{x:r},backend:t,attrs:{reductionIndices:a,keepDims:!1}}),l=jn(o.shape,a),u=Me({inputs:{x:o},backend:t,attrs:{shape:l}}),d=h4({inputs:{a:r,b:u},backend:t}),f=a4({inputs:{x:d},backend:t}),m=o1({inputs:{x:f},backend:t,attrs:{axis:a,keepDims:!1}}),y=Me({inputs:{x:m},backend:t,attrs:{shape:l}}),b=u4({inputs:{a:f,b:y},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),b}const mbe={kernelName:kv,backendName:"webgl",kernelFunc:d4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gbe(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:i,seed:a,normalized:o}=s,l=o?r:d4({inputs:{logits:r},backend:t,attrs:{dim:r.shape.length-1}}),u=l.shape[0],d=l.shape[1],f=new ube(u,d,i),m=[[a]],y=t.runWebGLProgram(f,[l],"int32",m);return o||t.disposeIntermediateTensorInfo(l),y}const ybe={kernelName:HL,backendName:"webgl",kernelFunc:gbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bbe=Ni+`
  return -x;
`,xbe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function vbe(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])){const i=t.texData.get(s.dataId),[a,o]=zhe(i.values,s.shape,s.dtype);return t.makeTensorInfo(o,s.dtype,a)}let r;return xe().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Bl(s.shape,xbe):r=new $a(s.shape,bbe),t.runWebGLProgram(r,[s],s.dtype)}const wbe={kernelName:fv,backendName:"webgl",kernelFunc:vbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sbe=XI;function Tbe(n){Hr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=s,u=t.readSync(r.dataId),d=t.readSync(i.dataId),{selectedIndices:f}=Sbe(u,d,a,o,l);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const Ebe={kernelName:lI,backendName:"webgl",kernelFunc:Tbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _be=YI;function Ibe(n){Hr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=s,d=t.readSync(r.dataId),f=t.readSync(i.dataId),{selectedIndices:m,validOutputs:y}=_be(d,f,a,o,l,u);return[t.makeTensorInfo([m.length],"int32",new Int32Array(m)),t.makeTensorInfo([],"int32",new Int32Array([y]))]}const $be={kernelName:cI,backendName:"webgl",kernelFunc:Ibe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cbe=QI;function Nbe(n){Hr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=s,d=t.readSync(r.dataId),f=t.readSync(i.dataId),m=a,y=o,b=l,w=u,{selectedIndices:x,selectedScores:T}=Cbe(d,f,m,y,b,w);return[t.makeTensorInfo([x.length],"int32",new Int32Array(x)),t.makeTensorInfo([T.length],"float32",new Float32Array(T))]}const kbe={kernelName:uI,backendName:"webgl",kernelFunc:Nbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Abe{constructor(e,t,s,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rbe=n=>{const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:i,depth:a,onValue:o,offValue:l}=s,u=Ee(r.shape),d=new Abe(u,a,o,l),f=Me({inputs:{x:r},backend:t,attrs:{shape:[u]}}),m=t.runWebGLProgram(d,[f],i);t.disposeIntermediateTensorInfo(f);const y=[...r.shape,a],b=Me({inputs:{x:m},backend:t,attrs:{shape:y}});return t.disposeIntermediateTensorInfo(m),b},Dbe={kernelName:gv,backendName:"webgl",kernelFunc:Rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ox(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="complex64"){const r=ry({inputs:{input:s},backend:t}),i=ox({inputs:{x:r},backend:t}),a=l1({inputs:{input:s},backend:t}),o=ox({inputs:{x:a},backend:t}),l=Tc({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return iy({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:t})}const Obe={kernelName:Dv,backendName:"webgl",kernelFunc:ox};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f4(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=ry({inputs:{input:s},backend:t}),i=f4({inputs:{x:r},backend:t}),a=l1({inputs:{input:s},backend:t}),o=ox({inputs:{x:a},backend:t}),l=Tc({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),l}else return iy({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:t})}const Fbe={kernelName:mv,backendName:"webgl",kernelFunc:f4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lbe(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return fE({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const i=e[0].shape,a=e[0].dtype;e.forEach(d=>{A_(i,d.shape,"All tensors passed to stack must have matching shapes"),H(a===d.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(d=>{const f=fE({inputs:{input:d},backend:t,attrs:{dim:r}});return o.push(f),f}),u=Zz({inputs:l,backend:t,attrs:{axis:r}});return o.forEach(d=>t.disposeIntermediateTensorInfo(d)),u}const Pbe={kernelName:yv,backendName:"webgl",kernelFunc:Lbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mbe{constructor(e,t,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((u,d)=>u[0]+e[d]+u[1]);const r=e.length,i=Jt(r),a=t.map(u=>u[0]).join(","),o=t.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vbe{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((w,x)=>w[0]+e[x]+w[1]);const r=e.length,i=Jt(r),a=t.map(w=>w[0]).join(","),o=t.map((w,x)=>w[0]+e[x]).join(","),l=nr("rc",r),u=nr("source",r),d=`${l[r-1]} < ${this.outputShape[r-1]}`,f=r===1?"source":`vec2(${u.slice(-2).join()})`,m=[`${i} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${d}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${d}) {`],y=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let b="";for(let w=0,x=r===1?2:4;w<x;w++)b+=`
        ${m[w]}
        if (${y}) {
          result[${w}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${w}] = getChannel(getX(${u.join()}), ${f});
        }
      `;b+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${b}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p4=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:i,constantValue:a}=s;if(Ee(r.shape)===0){const u=i.map((d,f)=>d[0]+r.shape[f]+d[1]);return iy({backend:t,attrs:{shape:u,value:a,dtype:r.dtype}})}const o=xe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Vbe(r.shape,i,a):new Mbe(r.shape,i,a),l=[[a]];return t.runWebGLProgram(o,[r],r.dtype,l)},Bbe={kernelName:bv,backendName:"webgl",kernelFunc:p4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zbe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Ube=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+ah+`
  return result;
`,jbe=ks({opSnippet:zbe,packedOpSnippet:Ube}),Wbe={kernelName:vg,backendName:"webgl",kernelFunc:jbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gbe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:i,keepDims:a}=s,o=r.shape.length,l=[],u=gt(i,r.shape);let d=u;const f=Sn(d,o);let m=r;f!=null&&(m=cr({inputs:{x:r},backend:t,attrs:{perm:f}}),d=Ln(d.length,o),l.push(m)),Ns("prod",d,o);let y;if(t.shouldExecuteOnCPU([m])){const b=t.texData.get(m.dataId).values,{outVals:w,outShape:x,outDtype:T}=jhe(m.shape,m.dtype,b,d);y=t.makeTensorInfo(x,T,w)}else{const[b,w]=ps(m.shape,d),x=Ee(w),T=Me({inputs:{x:m},backend:t,attrs:{shape:[-1,x]}}),E=SI(r.dtype),$=oh(T,E,"prod",t);y=Me({inputs:{x:$},backend:t,attrs:{shape:b}}),l.push(T),l.push($)}if(a){l.push(y);const b=jn(y.shape,u);y=Me({inputs:{x:y},backend:t,attrs:{shape:b}})}return l.forEach(b=>t.disposeIntermediateTensorInfo(b)),y}const Hbe={kernelName:vv,backendName:"webgl",kernelFunc:Gbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qbe(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:i,indices:a}=e,{outputRaggedRank:o}=s,l=r.map(T=>t.readSync(T.dataId)),u=r.map(T=>T.shape),d=t.readSync(i.dataId),f=t.readSync(a.dataId),[m,y,b]=Whe(l,u,d,i.shape,i.dtype,f,a.shape,o),w=m.map(T=>t.makeTensorInfo([T.length],"int32",T)),x=t.makeTensorInfo(b,i.dtype,y);return w.concat([x])}const Kbe={kernelName:qL,backendName:"webgl",kernelFunc:qbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xbe(n){const{inputs:e,backend:t}=n,{starts:s,limits:r,deltas:i}=e,a=t.readSync(s.dataId),o=t.readSync(r.dataId),l=t.readSync(i.dataId),[u,d]=Ghe(a,s.shape,s.dtype,o,r.shape,l,i.shape),f=t.makeTensorInfo([u.length],"int32",u),m=t.makeTensorInfo([d.length],s.dtype,d);return[f,m]}const Ybe={kernelName:KL,backendName:"webgl",kernelFunc:Xbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qbe(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:i,defaultValue:a,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,u=t.readSync(r.dataId),d=t.readSync(i.dataId),f=t.readSync(a.dataId),m=o.map(x=>t.readSync(x.dataId)),y=o.map(x=>x.shape),[b,w]=Hhe(u,r.shape,d,i.shape,i.dtype,f,a.shape,m,y,l);return t.makeTensorInfo(b,i.dtype,w)}const Zbe={kernelName:XL,backendName:"webgl",kernelFunc:Qbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m4=n=>{const{backend:e,attrs:t}=n,{start:s,stop:r,step:i,dtype:a}=t,o=qhe(s,r,i,a);return e.makeTensorInfo([o.length],a,o)},Jbe={kernelName:hI,backendName:"webgl",kernelFunc:m4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e0e="return 1.0 / x;",t0e=Ct({opSnippet:e0e}),n0e={kernelName:wg,backendName:"webgl",kernelFunc:t0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s0e=Ni+`
  return (x < 0.0) ? 0.0 : x;
`,r0e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,i0e=Ct({opSnippet:s0e,packedOpSnippet:r0e}),a0e={kernelName:Sg,backendName:"webgl",kernelFunc:i0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o0e=Ni+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,l0e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,c0e=Ct({opSnippet:o0e,packedOpSnippet:l0e}),u0e={kernelName:Tg,backendName:"webgl",kernelFunc:c0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h0e{constructor(e,t,s,r,i){this.variableNames=["A"],this.outputShape=[];const[a,o,l,u]=e;this.outputShape=[a,t,s,u];const d=[r&&t>1?o-1:o,r&&s>1?l-1:l],f=[r&&t>1?t-1:t,r&&s>1?s-1:s];let m;i?m="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":m="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/f[0]},
          ${d[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${m};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d0e{constructor(e,t,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,u]=e;this.outputShape=[a,t,s,u];const d=[r&&t>1?o-1:o,r&&s>1?l-1:l],f=[r&&t>1?t-1:t,r&&s>1?s-1:s];let m;i?m="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":m="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/f[0]},
          ${d[1]/f[1]},
          ${d[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${m};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f0e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:i,halfPixelCenters:a,size:o}=s,[l,u]=o,d=xe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new d0e(r.shape,l,u,i,a):new h0e(r.shape,l,u,i,a);return t.runWebGLProgram(d,[r],"float32")}const p0e={kernelName:Tv,backendName:"webgl",kernelFunc:f0e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m0e{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,i]=t,[,a,o]=e,l=[s&&a>1?r-1:r,s&&o>1?i-1:i],u=[s&&a>1?a-1:a,s&&o>1?o-1:o],d=l[0]/u[0],f=l[1]/u[1],m=1/d,y=1/f,b=Math.ceil(m)*2+2,w=Math.ceil(y)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${f});

        const float invHeightScale = float(${m});
        const float invWidthScale = float(${y});

        const int winHeight = int(${b});
        const int winWidth = int(${w});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:i}=e,{alignCorners:a}=s,o=new m0e(i.shape,r.shape,a);return t.runWebGLProgram(o,[i],i.dtype)}const y0e={kernelName:pI,backendName:"webgl",kernelFunc:g0e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b0e{constructor(e,t,s,r,i){this.variableNames=["A"],this.outputShape=[];const[a,o,l,u]=e;this.outputShape=[a,t,s,u];const d=[r&&t>1?o-1:o,r&&s>1?l-1:l],f=[r&&t>1?t-1:t,r&&s>1?s-1:s],m=r?"0.5":"0.0";let y;i?y="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":y="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/f[0]},
          ${d[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${y};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${m})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x0e{constructor(e,t,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,u]=e;this.outputShape=[a,t,s,u];const d=[r&&t>1?o-1:o,r&&s>1?l-1:l],f=[r&&t>1?t-1:t,r&&s>1?s-1:s],m=r?"0.5":"0.0";let y;i?y="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":y="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/f[0]},
          ${d[1]/f[1]},
          ${d[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${y};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${m})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v0e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:i,halfPixelCenters:a,size:o}=s,[l,u]=o,d=xe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new x0e(r.shape,l,u,i,a):new b0e(r.shape,l,u,i,a);return t.runWebGLProgram(d,[r],r.dtype)}const w0e={kernelName:Sv,backendName:"webgl",kernelFunc:v0e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S0e{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,i]=t,[,a,o]=e,l=[s&&a>1?r-1:r,s&&o>1?i-1:i],u=[s&&a>1?a-1:a,s&&o>1?o-1:o],d=l[0]/u[0],f=l[1]/u[1],m=1/d,y=1/f,b=Math.ceil(m)*2+2,w=Math.ceil(y)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${f});

        const float invHeightScale = float(${m});
        const float invWidthScale = float(${y});

        const int winHeight = int(${b});
        const int winWidth = int(${w});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T0e(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:i}=e,{alignCorners:a}=s,o=new S0e(i.shape,r.shape,a);return t.runWebGLProgram(o,[i],i.dtype)}const E0e={kernelName:fI,backendName:"webgl",kernelFunc:T0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _0e{constructor(e,t){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=o=>t.indexOf(o)!==-1&&e[o]!==1?`${e[o]} - coords[${o}] - 1`:`coords[${o}]`,i=e.map((o,l)=>r(l)).join(","),a=Jt(s);this.userCode=`
      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I0e{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=nr("rc",s),i=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,a=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,o=Jt(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${i}){
            result.g = ${u(r.slice())};
          }
          if(${a}) {
            result.b = ${d(r.slice())};
            if(${i}) {
              result.a = ${f(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(b){return m(b)}function u(b){return b[s-1]="("+b[s-1]+" + 1)",m(b)}function d(b){return b[s-2]="("+b[s-2]+" + 1)",m(b)}function f(b){return b[s-1]="("+b[s-1]+" + 1)",b[s-2]="("+b[s-2]+" + 1)",m(b)}function m(b){const w=e.map((E,$)=>y($,b)),x=w.join(","),T=w.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${T}))`}function y(b,w){return t.indexOf(b)!==-1&&e[b]!==1?`${e[b]} - ${w[b]} - 1`:`${w[b]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $0e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:i}=s,a=r.shape.length,o=gt(i,r.shape);if(a===0)return Or({inputs:{x:r},backend:t});const l=xe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new I0e(r.shape,o):new _0e(r.shape,o);return t.runWebGLProgram(l,[r],r.dtype)}const C0e={kernelName:Ev,backendName:"webgl",kernelFunc:$0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N0e{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let i="";typeof t=="number"?i=`float outputValue = ${t.toFixed(2)};`:i=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k0e={kernelName:wI,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:i,center:a}=e,o=t,l=new N0e(s.shape,i),[u,d]=l$(a,s.shape[1],s.shape[2]),f=[[u,d,Math.sin(r),Math.cos(r)]];return o.runWebGLProgram(l,[s],s.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A0e=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,R0e=Ct({opSnippet:A0e}),D0e={kernelName:Eg,backendName:"webgl",kernelFunc:R0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O0e="return inversesqrt(x);",F0e=Ct({opSnippet:O0e,cpuKernelImpl:Khe}),L0e={kernelName:_g,backendName:"webgl",kernelFunc:F0e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dC{constructor(e,t,s,r,i,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const u=Jt(i.length),d=Jt(a.length);let f="";s===1?f="i":s===2&&(f="i, j");const m=`getIndices(${f})`;let y="";r===1?y="i":r===2&&(y="i, coords[1]");const b=`getUpdates(${y})`;let w="";l&&(w="coords[0], coords[1]");const x=`getDefaultValue(${w})`,T=t>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${d} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${m});
              flattenedIndex += index * ${T};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${b};
              found = true;
            }
          }
          setOutput(mix(${x}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P0e{constructor(e,t,s,r,i,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;const u=Jt(i.length),d=Jt(a.length);let f="";s===1?f="i":s===2&&(f="i, j");const m=`getIndices(${f})`;let y="";r===1?y="i":r===2&&(y="i, coords[1]");const b=`getUpdates(${y})`;let w="";l&&(w="coords[0], coords[1]");const x=`getDefaultValue(${w})`,T=t>1?"strides[j]":"strides",E=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${d} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${m});
              flattenedIndex += index.xz * ${T};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${E};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${b};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${x}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M0e(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:i}=e,{shape:a}=s,{sliceRank:o,numUpdates:l,sliceSize:u,strides:d,outputSize:f}=th(i,r,a),m=[f/u,u];if(f===0)return t.makeTensorInfo(a,r.dtype);const y=Me({inputs:{x:r},backend:t,attrs:{shape:[l,o]}}),b=Me({inputs:{x:i},backend:t,attrs:{shape:[l,u]}}),w=t.makeTensorInfo([],"float32",new Float32Array([0]));let x;xe().getBool("WEBGL_PACK")?x=new P0e(l,o,y.shape.length,b.shape.length,d,m):x=new dC(l,o,y.shape.length,b.shape.length,d,m);const T=t.runWebGLProgram(x,[b,y,w],b.dtype),E=Me({inputs:{x:T},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(T),t.disposeIntermediateTensorInfo(w),E}const V0e={kernelName:YL,backendName:"webgl",kernelFunc:M0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B0e{constructor(e,t,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const i="while (left < right) {",a=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,o=xe().getNumber("WEBGL_VERSION")===2?i:a,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z0e(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:i}=e,{side:a}=s,o=new B0e(r.shape[0],r.shape[1],i.shape[1],a),l=[[r.shape[1]]];return t.runWebGLProgram(o,[r,i],"int32",l)}const U0e={kernelName:ZL,backendName:"webgl",kernelFunc:z0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j0e{constructor(e,t,s){this.variableNames=["c","a","b"],this.outputShape=t;let r,i;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)i="resRC",r="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let d=0;d<t.length;d++)u.push(`${o[d]}`),d<e&&l.push(`${o[d]}`);r=l.join(),i=u.join()}const a=Jt(s);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0e(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:i}=e,a=new j0e(s.shape.length,r.shape,r.shape.length);return t.runWebGLProgram(a,[s,r,i],Rr(r.dtype,i.dtype))}const G0e={kernelName:_v,backendName:"webgl",kernelFunc:W0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H0e=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Wv};
  float scale = ${Gv};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,q0e=Ct({opSnippet:H0e}),K0e={kernelName:Ig,backendName:"webgl",kernelFunc:q0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X0e=gf+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Y0e=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Q0e=Ct({opSnippet:X0e,packedOpSnippet:Y0e,cpuKernelImpl:Yhe}),Z0e={kernelName:kg,backendName:"webgl",kernelFunc:Q0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J0e=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,exe=Ct({opSnippet:J0e}),txe={kernelName:Ng,backendName:"webgl",kernelFunc:exe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nxe=gf+`
  return sin(x);
`,sxe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${ah}
  return result;
`,rxe=Ct({opSnippet:nxe,packedOpSnippet:sxe}),ixe={kernelName:$g,backendName:"webgl",kernelFunc:rxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const axe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,oxe=Ct({opSnippet:axe}),lxe={kernelName:Cg,backendName:"webgl",kernelFunc:oxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cxe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,uxe=Ct({opSnippet:cxe}),hxe={kernelName:Ag,backendName:"webgl",kernelFunc:uxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dxe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:i,paddings:a}=s;H(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=i.reduce((T,E)=>T*E),l=[[0,0]];l.push(...a);for(let T=1+i.length;T<r.shape.length;++T)l.push([0,0]);const u=[],d=p4({inputs:{x:r},backend:t,attrs:{paddings:l,constantValue:0}}),f=Gg(d.shape,i,o,!1),m=Hg(f.length,i.length,!1),y=qg(d.shape,i,o,!1),b=Me({inputs:{x:d},backend:t,attrs:{shape:f}}),w=cr({inputs:{x:b},backend:t,attrs:{perm:m}}),x=Me({inputs:{x:w},backend:t,attrs:{shape:y}});return u.push(d),u.push(b),u.push(w),u.forEach(T=>t.disposeIntermediateTensorInfo(T)),x},fxe={kernelName:Cv,backendName:"webgl",kernelFunc:dxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pxe(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:i,defaultValue:a}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=t.readSync(s.dataId),l=t.readSync(r.dataId),u=t.readSync(i.dataId),d=t.readSync(a.dataId)[0],[f,m,y,b,w]=Zhe(o,s.shape,s.dtype,l,r.dtype,u,d);return[t.makeTensorInfo(m,s.dtype,f),t.makeTensorInfo([m[0]],r.dtype,y),t.makeTensorInfo([b.length],"bool",new Uint8Array(b.map(x=>Number(x)))),t.makeTensorInfo([w.length],s.dtype,new Int32Array(w))]}const mxe={kernelName:JL,backendName:"webgl",kernelFunc:pxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gxe(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const a=Array.from(t.readSync(r.dataId)),o=t.readSync(s.dataId),l=Array.from(t.readSync(i.dataId)),[u,d,f]=Jhe(o,s.shape,s.dtype,a,l);return[t.makeTensorInfo(d,s.dtype,u),t.makeTensorInfo([f.length],i.dtype,new Int32Array(f))]}const yxe={kernelName:eP,backendName:"webgl",kernelFunc:gxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bxe(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const a=t.readSync(s.dataId),o=t.readSync(r.dataId),l=t.readSync(i.dataId),[u,d]=Vz(a,s.shape,s.dtype,o,l,!0);return t.makeTensorInfo(d,s.dtype,u)}const xxe={kernelName:tP,backendName:"webgl",kernelFunc:bxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vxe(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const a=t.readSync(s.dataId),o=t.readSync(r.dataId),l=t.readSync(i.dataId),[u,d]=Vz(a,s.shape,s.dtype,o,l);return t.makeTensorInfo(d,s.dtype,u)}const wxe={kernelName:nP,backendName:"webgl",kernelFunc:vxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sxe(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:i,defaultValue:a}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:u,sliceSize:d,strides:f,outputSize:m}=th(i,r,o),y=!1;if(i.dtype==="string"){const T=t.bufferSync(r),E=t.bufferSync(i),$=tc(t.readSync(a.dataId)[0]),C=Xhe(T,E,o,m,d,u,l,f,$,y);return t.makeTensorInfo(o,C.dtype,C.values)}const b=new dC(u,l,r.shape.length,i.shape.length,f,[m,1],y),w=t.runWebGLProgram(b,[i,r,a],i.dtype),x=Me({inputs:{x:w},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(w),x}const Txe={kernelName:sP,backendName:"webgl",kernelFunc:Sxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Exe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:i,axis:a}=s,o=gt(a,r.shape)[0],l=T$(r,i,o),u=r.shape.length,d=new Array(u).fill(0),f=r.shape.slice();return l.map(m=>{const y=[...f];y[o]=m;const b=yf({inputs:{x:r},backend:t,attrs:{begin:d,size:y}});return d[o]+=m,b})}const _xe={kernelName:Nv,backendName:"webgl",kernelFunc:Exe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QD="return sqrt(x);",Ixe=Ct({opSnippet:QD,packedOpSnippet:QD,cpuKernelImpl:ede}),$xe={kernelName:Rg,backendName:"webgl",kernelFunc:Ixe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cxe="return x * x;",Nxe=Ct({opSnippet:Cxe}),kxe={kernelName:mI,backendName:"webgl",kernelFunc:Nxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZD="return (a - b) * (a - b);",Axe=ks({opSnippet:ZD,packedOpSnippet:ZD}),Rxe={kernelName:Dg,backendName:"webgl",kernelFunc:Axe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dxe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const i=t.readSync(r.dataId),a=Vo(i),o=tde(a,"string",s);return t.makeTensorInfo(r.shape,"string",o)}const Oxe={kernelName:gI,backendName:"webgl",kernelFunc:Dxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fxe({inputs:n,attrs:e,backend:t}){const{x:s}=n,r=Ni+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new $a(s.shape,r);return t.runWebGLProgram(i,[s],s.dtype)}const Lxe={kernelName:Mg,backendName:"webgl",kernelFunc:Fxe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pxe{constructor(e,t,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,i=Jt(s.length),a=Jt(s.length);let o="";if(r===1)o="coords * strides + begin";else{let l=0;o=s.map((u,d)=>(l++,s.length===1?`coords * strides[${d}] + begin[${d}]`:`coords[${l-1}] * strides[${d}] + begin[${d}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${t});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mxe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:i,end:a,strides:o,beginMask:l,endMask:u,ellipsisMask:d,newAxisMask:f,shrinkAxisMask:m}=s,{finalShapeSparse:y,finalShape:b,isIdentity:w,sliceDim0:x,isSimpleSlice:T,begin:E,end:$,strides:C}=i$(r.shape,i,a,o,l,u,d,f,m);let O;if(w)O=Me({inputs:{x:r},backend:t,attrs:{shape:b}});else if(x||T){H(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const F=n$(E,$,C),R=yf({inputs:{x:r},backend:t,attrs:{begin:E,size:F}});O=Me({inputs:{x:R},backend:t,attrs:{shape:b}}),t.disposeIntermediateTensorInfo(R)}else if(t.shouldExecuteOnCPU([r])){const R=t.readSync(r.dataId),N=mt(r.shape,r.dtype,R),D=nde(y,N,C,E);O=t.makeTensorInfo(b,r.dtype,D.values)}else{const R=new Pxe(E,C,y);O=t.runWebGLProgram(R,[r],r.dtype)}const V=Me({inputs:{x:O},backend:t,attrs:{shape:b}});return t.disposeIntermediateTensorInfo(O),V}const Vxe={kernelName:yI,backendName:"webgl",kernelFunc:Mxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bxe(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:i,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:u}=s,{data:d,dataSplits:f}=e,m=t.readSync(d.dataId),y=t.readSync(f.dataId),[b,w]=sde(m,y,r,i,a,o,l,u);return[t.makeTensorInfo([b.length],"string",b),t.makeTensorInfo(f.shape,"int32",w)]}const zxe={kernelName:rP,backendName:"webgl",kernelFunc:Bxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uxe(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:i,delimiter:a}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=t.readSync(i.dataId),l=t.readSync(a.dataId)[0],[u,d,f]=rde(o,l,r),m=d.length;return[t.makeTensorInfo([m,2],"int32",u),t.makeTensorInfo([m],"string",d),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const jxe={kernelName:iP,backendName:"webgl",kernelFunc:Uxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wxe(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const a=t.readSync(i.dataId),o=ide(a,r);return t.makeTensorInfo(i.shape,"int32",o)}const Gxe={kernelName:aP,backendName:"webgl",kernelFunc:Wxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hxe="return tan(x);",qxe=Ct({opSnippet:Hxe}),Kxe={kernelName:Fg,backendName:"webgl",kernelFunc:qxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xxe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Yxe=Ct({opSnippet:Xxe}),Qxe={kernelName:Lg,backendName:"webgl",kernelFunc:Yxe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zxe(n){const{inputs:e,backend:t,attrs:s}=n,{tensor:r,indices:i,updates:a}=e,{sliceRank:o,numUpdates:l,sliceSize:u,strides:d,outputSize:f}=th(a,i,r.shape),m=[f/u,u];if(f===0)return t.makeTensorInfo(r.shape,i.dtype);const y=Me({inputs:{x:i},backend:t,attrs:{shape:[l,o]}}),b=Me({inputs:{x:a},backend:t,attrs:{shape:[l,u]}}),w=Me({inputs:{x:r},backend:t,attrs:{shape:m}}),x=new dC(l,o,y.shape.length,b.shape.length,d,m,!1,!0),T=t.runWebGLProgram(x,[b,y,w],w.dtype),E=Me({inputs:{x:T},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(T),E}const Jxe={kernelName:QL,backendName:"webgl",kernelFunc:Zxe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eve{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let a=0;a<s.length;a++)s[a]=e[a]*t[a];this.outputShape=s,this.rank=s.length;const r=Jt(this.rank),i=tve(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function tve(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<n.length;r++)s.push(`imod(${t[r]}, ${n[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g4(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:i}=s;if(r.dtype==="string"||r.shape.length>5){const l=t.readSync(r.dataId),u=r.dtype==="string"?l.map(m=>tc(m)):l,d=mt(r.shape,r.dtype,u),f=ode(d,i);return t.makeTensorInfo(f.shape,f.dtype,f.values)}const a=new eve(r.shape,i);return t.runWebGLProgram(a,[r],r.dtype)}const nve={kernelName:Pg,backendName:"webgl",kernelFunc:g4};class sve{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class rve{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ou(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function JD(n){let e=1;for(;e<n;)e*=2;return e}function ive(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:i,sorted:a}=s,o=xe().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=xe().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=r.shape,d=u[u.length-1];if(t.shouldExecuteOnCPU([r])||d<o||i>l){const D=t.readSync(r.dataId),[k,z]=lde(D,u,r.dtype,i,a);return[t.makeTensorInfo(k.shape,k.dtype,k.values),t.makeTensorInfo(z.shape,z.dtype,z.values)]}if(i===0)return u[u.length-1]=0,[t.makeTensorInfo(u,r.dtype,[]),t.makeTensorInfo(u,"int32",[])];if(d===1)return[r,iy({attrs:{shape:u,dtype:"int32",value:0},backend:t})];const f=t.texData.get(r.dataId),m=f!==null&&f.isPacked,y=m?t.unpackTensor(r):r,w=Ee(u)/d,x=Me({inputs:{x:y},attrs:{shape:[w,d]},backend:t});m&&ou(t,y);const T=JD(i),E=JD(d);let $=null;const C=()=>$===null?[x,x]:[x,$],O=(D,k,z)=>{const B=C(),ne=new sve(z),K=[[d],[$===null?1:0],[Number.NEGATIVE_INFINITY],[D],[k]],re=$;$=t.runWebGLProgram(ne,B,"int32",K),ou(t,re)};for(let D=1;D<T;D*=2){const k=D*2;for(let z=D;z>=1;z/=2)O(k,z,[w,E])}for(let D=E;D>T;D/=2){const k=C(),z=new rve([w,D/2]),ne=[[d],[$===null?1:0],[T]],J=$;$=t.runWebGLProgram(z,k,"int32",ne),ou(t,J);const K=T/2,re=K*2;for(let Z=K;Z>=1;Z/=2)O(re,Z,$.shape)}let V=$;$=yf({inputs:{x:$},backend:t,attrs:{begin:0,size:[w,i]}}),ou(t,V);let F=l4({inputs:{x,indices:$},backend:t,attrs:{axis:1,batchDims:1}});ou(t,x);const R=u.slice(0,-1);R.push(i),V=$,$=Me({inputs:{x:$},attrs:{shape:R},backend:t}),ou(t,V);const N=F;return F=Me({inputs:{x:F},attrs:{shape:R},backend:t}),ou(t,N),[F,$]}const ave={kernelName:bI,backendName:"webgl",kernelFunc:ive};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ove{constructor(e,t,s,r,i,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const o=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lve(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,transforms:i}=e,{interpolation:a,fillMode:o,fillValue:l,outputShape:u}=s,[d,f,m,y]=r.shape,[b,w]=u??[f,m],x=[d,b,w,y],T=new ove(f,m,a,o,l,x);return t.runWebGLProgram(T,[r,i],"float32")}const cve={kernelName:xI,backendName:"webgl",kernelFunc:lve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uve(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:i}=e;ny(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=s.readSync(i.dataId),{outputValues:o,outputShape:l,indices:u}=cde(a,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,o),s.makeTensorInfo([u.length],"int32",u)]}const hve={kernelName:vI,backendName:"webgl",kernelFunc:uve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dve(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const a=r,o=a.shape.length,l=r.shape[i],u=new Array(o-1);let d=0;for(let w=0;w<o;w++)w!==i&&(u[d++]=a.shape[w]);const f=[],m=new Array(o).fill(0),y=a.shape.slice();y[i]=1;const b=new Array(l);for(let w=0;w<b.length;w++){m[i]=w;const x=yf({inputs:{x:a},backend:t,attrs:{begin:m,size:y}}),T=Me({inputs:{x},backend:t,attrs:{shape:u}});b[w]=T,f.push(x)}return f.forEach(w=>t.disposeIntermediateTensorInfo(w)),b}const fve={kernelName:Av,backendName:"webgl",kernelFunc:dve};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pve{constructor(e,t){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/s);this.outputShape=[r,o];const l="0.0",u="sumValue",d=Math.floor(s/4)*4,f=s%4,m=`
        sumValue += dot(values, segFilter);
    `;let y="";i%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let b="";i%s>0&&(b=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${y}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${b}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${m}
        }

        int inIdx = inOffset + ${d};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${m}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${m}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${m}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mve(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:i}=e,{numSegments:a}=s,o=r.shape.length,l=[];let u=0;const d=Sn([u],o);let f=r;d!=null&&(f=cr({inputs:{x:r},backend:t,attrs:{perm:d}}),l.push(f),u=Ln(1,o)[0]);const m=X3(f.shape,u,a),y=Ee([f.shape[u]]),b=Me({inputs:{x:f},backend:t,attrs:{shape:[-1,y]}});l.push(b);const w=SI(r.dtype),x=(C,O,V,F,R)=>{const N=C.shape[0],D=C.shape[1],k=K3(D,R),z={windowSize:k,inSize:D,batchSize:N,numSegments:R},B=new pve(z,O),ne=t.compileAndRun(B,[C,V],F);if(l.push(ne),ne.shape[1]===R)return ne;const J=m4({backend:t,attrs:{start:0,stop:R,step:1,dtype:"float32"}}),K=g4({inputs:{x:J},backend:t,attrs:{reps:[D/k]}});return l.push(J),l.push(K),x(ne,O,K,F,R)},T=x(b,"unsortedSegmentSum",i,w,a),E=Me({inputs:{x:T},backend:t,attrs:{shape:m}});let $=E;if(d!=null){l.push(E);const C=yc(d);$=cr({inputs:{x:$},backend:t,attrs:{perm:C}})}return l.forEach(C=>t.disposeIntermediateTensorInfo(C)),$}const gve={kernelName:Rv,backendName:"webgl",kernelFunc:mve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yve=[efe,nfe,ife,lfe,ufe,ffe,mfe,yfe,wfe,Tfe,Ife,Nfe,Rfe,Lfe,Vfe,zfe,jfe,qfe,Xfe,Qfe,tpe,lpe,upe,ppe,gpe,Spe,Epe,Cpe,Pde,Ape,Lpe,Bpe,Hpe,Xpe,Qpe,Jpe,tme,ime,lme,hme,fme,mme,yme,vme,Sme,Ime,Cme,Ame,Ome,Lme,Bme,Wme,Kme,Qme,ege,tge,sge,ige,oge,cge,hge,mge,bge,wge,Tge,Ige,Nge,Dge,Pge,Lde,Vge,Ope,Uge,Gge,Kge,Vde,Zge,nye,rye,lye,hye,mye,bye,Sye,Iye,Nye,Aye,Fye,Pye,Vye,jye,Gye,qye,Xye,Qye,tbe,ibe,cbe,ybe,Ude,wbe,Ebe,$be,kbe,bpe,Dbe,Fbe,Pbe,Bbe,Wbe,zde,Hbe,Kbe,Ybe,Zbe,Jbe,xpe,fbe,n0e,a0e,u0e,Wde,p0e,y0e,w0e,E0e,C0e,k0e,D0e,L0e,V0e,U0e,G0e,K0e,Z0e,txe,ixe,lxe,ape,mbe,hxe,fxe,mxe,yxe,xxe,wxe,Txe,_xe,$xe,kxe,Rxe,Oxe,Lxe,Vxe,zxe,jxe,Gxe,pbe,Qde,Kxe,Qxe,Jxe,nve,ave,cve,Zde,hve,fve,gve,Obe];for(const n of yve)lP(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bve=1e-7,xve=1e-4;class vve{refCount(e){return Gr("refCount")}incRef(e){return Gr("incRef")}timerAvailable(){return!0}time(e){return Gr("time")}read(e){return Gr("read")}readSync(e){return Gr("readSync")}readToGPU(e,t){return Gr("readToGPU")}numDataIds(){return Gr("numDataIds")}disposeData(e,t){return Gr("disposeData")}write(e,t,s){return Gr("write")}move(e,t,s,r,i){return Gr("move")}memory(){return Gr("memory")}floatPrecision(){return Gr("floatPrecision")}epsilon(){return this.floatPrecision()===32?bve:xve}dispose(){return Gr("dispose")}}function Gr(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function ki(n,e,t=""){X(oc(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function bf(n){X(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ay(n,e=[],t=!1){if(e==null&&(e=[]),Array.isArray(n)||Ua(n)&&!t)for(let s=0;s<n.length;++s)ay(n[s],e,t);else e.push(n);return e}function Is(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function oc(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function _m(n){return n%1===0}function g0(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function c1(n,e){const t=e.length;return n=n==null?e.map((s,r)=>r):[].concat(n),X(n.every(s=>s>=-t&&s<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),X(n.every(s=>_m(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?t+s:s)}function wve(n,e){const t=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:c1(e,n).sort();let a=0;for(let o=0;o<n.length;++o){if(i!=null){if(i[a]===o&&n[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${n[o]}' is not 1`);(i[a]==null||i[a]>o)&&n[o]===1&&(t.push(n[o]),s.push(o)),i[a]<=o&&a++}n[o]!==1&&(t.push(n[o]),s.push(o))}return{newShape:t,keptDims:s}}function Sve(n,e){let t=null;return t=new Uint8Array(e),t}function Tve(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function Eve(n,e){for(let t=0;t<n.length;t++){const s=n[t];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function _ve(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function Ua(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}function eO(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function Ive(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function fC(n){return typeof n=="string"||n instanceof String}function $ve(n){return typeof n=="boolean"}function Cve(n){return typeof n=="number"}function pC(n){return Array.isArray(n)?pC(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":Cve(n)?"float32":fC(n)?"string":$ve(n)?"bool":"float32"}function tO(n){return!!(n&&n.constructor&&n.call&&n.apply)}function mC(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let s=e-3;s>=0;--s)t[s]=t[s+1]*n[s+1];return t}function y4(n,e,t,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let a=0;a<i;a++)r[a]=t[n+a]}else{const i=e[0],a=e.slice(1),o=a.reduce((l,u)=>l*u)*(s?2:1);for(let l=0;l<i;l++)r[l]=y4(n+l*o,a,t,s)}return r}function pE(n,e,t=!1){if(n.length===0)return e[0];const s=n.reduce((r,i)=>r*i)*(t?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return y4(0,n,e,t)}function b4(n,e){const t=gC(n,e);for(let s=0;s<t.length;s++)t[s]=1;return t}function gC(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function x4(n){n.forEach(e=>{X(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function Ld(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nO="tfjsflags";class Nve{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=kve,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(Dt().getBool("IS_TEST")||Dt().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,s){if(this.flagRegistry[e]={evaluationFn:t,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];Dt().getBool("IS_TEST")||Dt().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Ld(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);nO in e&&e[nO].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=Rve(r,i)})}}function kve(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...s)=>(Ave(e,s[0],s[1]),s.join("="))),e}function Ave(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function Rve(n,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${n}.`)}function Dt(){return v4}let v4=null;function Dve(n){v4=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let oT;function w4(){if(oT==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");oT=n}return oT}function Ove(){const n=w4();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function yC(n,e){const t=Ove();if(t.has(n))return t.get(n);{const s=e();return t.set(n,s),t.get(n)}}const Fve="Abs",Lve="Acos",Pve="Acosh",S4="Add",Mve="AddN",Vve="All",Bve="Any",zve="ArgMax",Uve="ArgMin",jve="Asin",Wve="Asinh",Gve="Atan",Hve="Atanh",qve="Atan2",Kve="AvgPool",Xve="AvgPool3D",Yve="BatchMatMul",Qve="BatchToSpaceND",Zve="Bincount",Jve="BroadcastArgs",T4="Cast",e1e="Ceil",t1e="ClipByValue",n1e="Complex",s1e="ComplexAbs",r1e="Concat",i1e="Conv2D",a1e="Conv2DBackpropFilter",o1e="Conv2DBackpropInput",l1e="Conv3D",c1e="Conv3DBackpropInputV2",u1e="Cos",h1e="Cosh",d1e="Cumprod",f1e="Cumsum",p1e="CropAndResize",m1e="DenseBincount",g1e="DepthToSpace",y1e="DepthwiseConv2dNative",b1e="DepthwiseConv2dNativeBackpropFilter",x1e="DepthwiseConv2dNativeBackpropInput",v1e="Diag",w1e="Dilation2D",S1e="RealDiv",T1e="Einsum",E1e="Elu",_1e="Erf",I1e="Equal",$1e="Exp",C1e="ExpandDims",N1e="Expm1",k1e="FFT",A1e="Fill",R1e="FlipLeftRight",D1e="Floor",O1e="FloorDiv",F1e="FusedBatchNorm",L1e="GatherV2",P1e="GatherNd",M1e="Greater",V1e="GreaterEqual",E4="Identity",B1e="IFFT",z1e="Imag",U1e="IsFinite",j1e="IsInf",W1e="IsNan",G1e="LeakyRelu",H1e="Less",q1e="LessEqual",K1e="LinSpace",X1e="Log",Y1e="Log1p",Q1e="LogicalAnd",Z1e="LogicalNot",J1e="LogicalOr",ewe="LRN",twe="Max",nwe="Maximum",swe="MaxPool",rwe="MaxPool3D",iwe="MaxPoolWithArgmax",awe="Mean",owe="Min",lwe="Minimum",cwe="MirrorPad",uwe="Mod",hwe="Multinomial",dwe="Multiply",fwe="Neg",pwe="NotEqual",mwe="NonMaxSuppressionV3",gwe="NonMaxSuppressionV4",ywe="NonMaxSuppressionV5",bwe="OnesLike",xwe="OneHot",vwe="Pack",wwe="PadV2",Swe="Pow",Twe="Prelu",Ewe="Prod",_we="RaggedGather",Iwe="RaggedTensorToTensor",$we="Range",Cwe="Real",Nwe="Reciprocal",kwe="Relu",Awe="Reshape",Rwe="ResizeNearestNeighbor",Dwe="ResizeBilinear",Owe="Relu6",Fwe="Reverse",Lwe="Round",Pwe="Rsqrt",Mwe="ScatterNd",Vwe="SearchSorted",Bwe="Select",zwe="Selu",Uwe="Slice",jwe="Sin",Wwe="Sinh",Gwe="Sign",Hwe="Sigmoid",qwe="Softplus",Kwe="Sqrt",Xwe="Sum",Ywe="SpaceToBatchND",Qwe="SplitV",Zwe="Softmax",Jwe="SparseFillEmptyRows",eSe="SparseReshape",tSe="SparseSegmentMean",nSe="SparseSegmentSum",sSe="SparseToDense",rSe="SquaredDifference",iSe="StridedSlice",aSe="StringNGrams",oSe="StringSplit",lSe="StringToHashBucketFast",cSe="Sub",uSe="Tan",hSe="Tanh",_4="Tile",dSe="TopK",fSe="Transform",lT="Transpose",pSe="Unique",mSe="Unpack",gSe="UnsortedSegmentSum",ySe="ZerosLike",bSe="Step",xSe="RotateWithOffset",sO="_FusedMatMul",rO="FusedConv2D",iO="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dp(...n){Dt().getBool("IS_TEST")||Dt().getBool("PROD")||console.warn(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I4=yC("kernelRegistry",()=>new Map),vSe=yC("gradRegistry",()=>new Map);function aO(n,e){const t=wSe(n,e);return I4.get(t)}function oO(n){return vSe.get(n)}function lO(n){const e=I4.entries(),t=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,a]=r,[o]=i.split("_");o===n&&t.push(a)}return t}function wSe(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SSe(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function $4(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=ay(n)),Dt().getBool("DEBUG")&&Eve(n,e),SSe(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let s=0;s<t.length;++s)Math.round(n[s])!==0&&(t[s]=1);return t}else throw new Error(`Unknown data type ${e}`)}function lx(){return Dt().platform.now()}function TSe(n,e){return Dt().platform.fetch(n,e)}function ESe(n,e="utf-8"){return e=e||"utf-8",Dt().platform.encode(n,e)}function cO(n,e="utf-8"){return e=e||"utf-8",Dt().platform.decode(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Se{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new $Se)}profileKernel(e,t,s){let r;const i=()=>{r=s()};let a;const o=lx();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();for(const u of r)u.dataSync();a=Promise.resolve({kernelMs:lx()-o})}if(Dt().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<r.length;u++){const d=r[u];d.data().then(f=>{ISe(f,d.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:a.then(u=>u.kernelMs),extraInfo:a.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:s,timeMs:r,inputs:i,extraInfo:a}=e;s.forEach(o=>{Promise.all([o.data(),r,a]).then(l=>{this.logger.logKernelProfile(t,o,l[0],l[1],i,l[2])})})}}function ISe(n,e,t){if(e!=="float32")return!1;for(let s=0;s<n.length;s++){const r=n[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${t}'`),!0}return!1}class $Se{logKernelProfile(e,t,s,r,i,a){const o=typeof r=="number"?g0(`${r}ms`,9):r.error,l=g0(e,25),u=t.rank,d=t.size,f=g0(t.shape.toString(),14);let m="";for(const y in i){const b=i[y];if(b!=null){const w=b.shape||t.shape,x=w.length;m+=`${y}: ${x}D ${x>0?w:""} `}}console.log(`%c${l}	%c${o}	%c${u}D ${f}	%c${d}	%c${m}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CSe(n,e,t){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<n.length;l++){const u=n[l],d=u.inputs;for(const f in d){const m=d[f];let y=!1;for(let b=0;b<e.length;b++)if(s[m.id]){u.outputs.forEach(w=>s[w.id]=!0),y=!0,r[u.id]=!0;break}if(y)break}}const i={};i[t.id]=!0;const a={};for(let l=n.length-1;l>=0;l--){const u=n[l],d=u.inputs;for(let f=0;f<u.outputs.length;f++)if(i[u.outputs[f].id]){for(const m in d)i[d[m].id]=!0,a[u.id]=!0;break}}const o=[];for(let l=0;l<n.length;l++){const u=n[l];if(r[u.id]&&a[u.id]){const d={};for(const m in u.inputs){const y=u.inputs[m];s[y.id]&&(d[m]=y)}const f=Object.assign({},u);f.inputs=d,f.outputs=u.outputs,o.push(f)}}return o}function NSe(n,e,t,s){for(let r=e.length-1;r>=0;r--){const i=e[r],a=[];if(i.outputs.forEach(l=>{const u=n[l.id];u!=null?a.push(u):a.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const o=i.gradient(a);for(const l in i.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const u=t(()=>o[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const d=i.inputs[l];if(!oc(u.shape,d.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${d.shape}'`);if(n[d.id]==null)n[d.id]=u;else{const f=n[d.id];n[d.id]=s(f,u),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uO=20,Op=3,cT=7;function kSe(n,e,t,s){const r=mC(e),i=ASe(n,e,t,r),a=e.length,o=y0(n,e,t,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${a}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(u=>"    "+u).join(`
`)),l.join(`
`)}function ASe(n,e,t,s){const r=Is(e),i=s[s.length-1],a=new Array(i).fill(0),o=e.length,l=t==="complex64"?qp(n):n;if(o>1)for(let u=0;u<r/i;u++){const d=u*i;for(let f=0;f<i;f++)a[f]=Math.max(a[f],Hp(l[d+f],0,t).length)}return a}function Hp(n,e,t){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(cT))} + ${parseFloat(n[1].toFixed(cT))}j`:fC(n)?s=`'${n}'`:t==="bool"?s=C4(n):s=parseFloat(n.toFixed(cT)).toString(),g0(s,e)}function C4(n){return n===0?"false":"true"}function y0(n,e,t,s,r,i=!0){const a=t==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(t==="complex64"){const w=qp(n);return[Hp(w[0],0,t)]}return t==="bool"?[C4(n[0])]:[n[0].toString()]}if(l===1){if(o>uO){const x=Op*a;let T=Array.from(n.slice(0,x)),E=Array.from(n.slice((o-Op)*a,o*a));return t==="complex64"&&(T=qp(T),E=qp(E)),["["+T.map(($,C)=>Hp($,r[C],t)).join(", ")+", ..., "+E.map(($,C)=>Hp($,r[o-Op+C],t)).join(", ")+"]"]}return["["+(t==="complex64"?qp(n):Array.from(n)).map((x,T)=>Hp(x,r[T],t)).join(", ")+"]"]}const u=e.slice(1),d=s.slice(1),f=s[0]*a,m=[];if(o>uO){for(let w=0;w<Op;w++){const x=w*f,T=x+f;m.push(...y0(n.slice(x,T),u,t,d,r,!1))}m.push("...");for(let w=o-Op;w<o;w++){const x=w*f,T=x+f;m.push(...y0(n.slice(x,T),u,t,d,r,w===o-1))}}else for(let w=0;w<o;w++){const x=w*f,T=x+f;m.push(...y0(n.slice(x,T),u,t,d,r,w===o-1))}const y=l===2?",":"";m[0]="["+m[0]+y;for(let w=1;w<m.length-1;w++)m[w]=" "+m[w]+y;let b=`,
`;for(let w=2;w<l;w++)b+=`
`;return m[m.length-1]=" "+m[m.length-1]+"]"+(i?"":b),m}function qp(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mE{constructor(e,t,s){if(this.dtype=t,this.shape=e.slice(),this.size=Is(e),s!=null){const r=s.length;X(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Tve(t,this.size),this.strides=mC(e)}set(e,...t){t.length===0&&(t=[0]),X(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const s=this.locToIndex(t);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const r of e){if(r<0||r>=this.shape[t]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}t++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let s=0;s<e.length-1;++s)t+=this.strides[s]*e[s];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let s=0;s<t.length-1;++s)t[s]=Math.floor(e/this.strides[s]),e-=t[s]*this.strides[s];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Ui().makeTensor(this.values,this.shape,this.dtype)}}let Ui=null,nd=null;function RSe(n){Ui=n}function DSe(n){nd=n}class Ps{constructor(e,t,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Is(e),this.strides=mC(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return nd.buffer(this.shape,this.dtype,e)}bufferSync(){return nd.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return pE(this.shape,e,this.dtype==="complex64")}arraySync(){return pE(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Ui().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(s=>cO(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Ui().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Ui().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>cO(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Ui().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(Ui().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return nd.print(this,e)}clone(){return this.throwIfDisposed(),nd.clone(this)}toString(e=!1){const t=this.dataSync();return kSe(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),nd.cast(this,e)}variable(e=!0,t,s){return this.throwIfDisposed(),Ui().makeVariable(this,e,t,s)}}Object.defineProperty(Ps,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function OSe(){return yC("Tensor",()=>Ps)}OSe();class gE extends Ps{constructor(e,t,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!oc(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Ui().disposeTensor(this),this.dataId=e.dataId,Ui().incRef(this,null)}dispose(){Ui().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(gE,Symbol.hasInstance,{value:n=>n instanceof Ps&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var hO;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(hO||(hO={}));var yE;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(yE||(yE={}));var bE;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(bE||(bE={}));var xE;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(xE||(xE={}));var vE;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(vE||(vE={}));const FSe={float32:xE,int32:yE,bool:bE,complex64:vE};function LSe(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return FSe[n][e]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $n(n,e){if(n.dtype===e.dtype)return[n,e];const t=LSe(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function PSe(n,e){X(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function N4(n){const e=[];return k4(n,e,new Set),e}function k4(n,e,t){if(n==null)return;if(n instanceof Ps){e.push(n);return}if(!MSe(n))return;const s=n;for(const r in s){const i=s[r];t.has(i)||(t.add(i),k4(i,e,t))}}function MSe(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uT(n){return n.kernelName!=null}class dO{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Pd{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new dO}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,s=1){return e in this.registryFactory?(Dp(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:s}=this.initializeBackend(e);if(!(s?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new _Se(this.backendInstance),!0}setupRegisteredKernels(){lO(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){lO(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=t.factory();if(s&&!(s instanceof vve)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(a=>r<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Dp(`Initialization of backend ${e} failed`),Dp(a.stack||a.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Dp(`Initialization of backend ${e} failed`),Dp(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const s=this.state.tensorInfo.get(t),r=s.backend,i=this.readSync(t),a=r.refCount(t);r.disposeData(t,!0),s.backend=e,e.move(t,i,s.shape,s.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let s=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=t(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,t,s){e();try{const r=s();return t(),r}catch(r){throw t(),r}}nextTensorId(){return Pd.nextTensorId++}nextVariableId(){return Pd.nextVariableId++}clone(e){const t=le.runKernel(E4,{x:e}),s={x:e},r=a=>({x:()=>{const o="float32",l={x:a},u={dtype:o};return le.runKernel(T4,l,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[t],r,i,{}),t}runKernel(e,t,s){if(this.backendName==null&&this.backend,!(aO(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-i-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,s=[];const r=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const u=uT(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(uT(e)){const{kernelName:b,inputs:w,attrs:x}=e;this.backendName==null&&this.backend;const T=aO(b,this.backendName);X(T!=null,()=>`Cannot find registered kernel '${b}' for backend '${this.backendName}'`),o=()=>{const E=this.backend.numDataIds();l=T.kernelFunc({inputs:w,attrs:x,backend:this.backend});const $=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(b,E,$);const C=$.map(O=>O.rank!=null?O:this.makeTensorFromTensorInfo(O));if(r){const O=this.getTensorsForGradient(b,w,C);s=this.saveTensorsForBackwardMode(O)}return C}}else{const{forwardFunc:b}=e,w=x=>{r&&(s=x.map(T=>this.keep(this.clone(T))))};o=()=>{const x=this.backend.numDataIds();l=this.tidy(()=>b(this.backend,w));const T=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,x,T),T}}const{inputs:d,attrs:f}=e,m=uT(e)?null:e.backwardsFunc;let y;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=o():(y=this.profiler.profileKernel(u,d,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(y),t=y.outputs)}),r&&this.addTapeNode(u,d,t,m,s,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(d).map(b=>d[b]!=null?d[b].shape:null),outputShapes:t.map(b=>b.shape),kernelTimeMs:y.timeMs,extraInfo:y.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,t,s){const r=oO(e);if(r!=null){const i=r.inputsToSave||[],a=r.outputsToSave||[];let o;r.saveAllInputs?(X(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(t).map(u=>t[u])):o=i.map(u=>t[u]);const l=s.filter((u,d)=>a[d]);return o.concat(l)}return[]}makeTensor(e,t,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&fC(e[0])&&(i=e.map(l=>ESe(l)));const a=r.write(i,t,s),o=new Ps(t,s,a,this.nextTensorId());if(this.trackTensor(o,r),s==="string"){const l=this.state.tensorInfo.get(a),u=Ive(i);this.state.numBytes+=u-l.bytes,l.bytes=u}return o}makeTensorFromDataId(e,t,s,r){s=s||"float32";const i={dataId:e,shape:t,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,t){const{dataId:s,shape:r,dtype:i}=e,a=new Ps(r,i,s,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e,t=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new gE(e,t,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*eO(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof gE||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*eO(e.dtype);this.state.numBytes-=s}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,s,r,i,a){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:s,saved:i},l=oO(e);l!=null&&(r=l.gradFunc),r!=null&&(o.gradient=u=>(u=u.map((d,f)=>{if(d==null){const m=s[f],y=gC(m.size,m.dtype);return this.makeTensor(y,m.shape,m.dtype)}return d}),r(u.length>1?u:u[0],i,a))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=N4(e),s=new Set(t.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const a=this.state.activeScope.track[i];!a.kept&&!s.has(a.id)&&a.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,t,s,r=!1){if(X(t.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));X(i instanceof Ps,()=>"The result y returned by f() must be a tensor.");const a=CSe(this.state.activeTape,t,i);if(!r&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[i.id]=s??VSe(i.shape),NSe(o,a,u=>this.tidy(u),BSe);const l=t.map(u=>o[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const d of u.saved)d.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return X(tO(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{X(t.every(o=>o instanceof Ps),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};t.forEach((o,l)=>{r[l]=o});const i=(o,l)=>(s=e(...t,l),X(s.value instanceof Ps,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),X(tO(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),a=(o,l)=>{const u=s.gradFunc(o,l),d=Array.isArray(u)?u:[u];X(d.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),X(d.every(m=>m instanceof Ps),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return d.forEach((m,y)=>{f[y]=()=>m}),f};return this.runKernelFunc({forwardFunc:i,backwardsFunc:a,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=lx(),s=await this.backend.time(e);return s.wallMs=lx()-t,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new dO;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Pd.nextTensorId=0;Pd.nextVariableId=0;function VSe(n){const e=b4(Is(n),"float32");return le.makeTensor(e,n,"float32")}function A4(){const n=w4();if(n._tfengine==null){const e=new Nve(n);n._tfengine=new Pd(e)}return Dve(n._tfengine.ENV),RSe(()=>n._tfengine),n._tfengine}const le=A4();function BSe(n,e){const t={a:n,b:e};return le.runKernel(S4,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zSe(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fr=Dt();Fr.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Fr.registerFlag("IS_BROWSER",()=>zSe());Fr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Fr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Fr.registerFlag("PROD",()=>!1);Fr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Fr.getBool("DEBUG"));Fr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Fr.registerFlag("IS_TEST",()=>!1);Fr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);Fr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Fr.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);Fr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Fr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ec(n,e){let t=n;if(Ua(n))return e==="string"?[]:[n.length];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(t)||Ua(t)&&e!=="string";)s.push(t.length),t=t[0];return Array.isArray(n)&&Dt().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&R4(n,s,[]),s}function R4(n,e,t){if(t=t||[],!Array.isArray(n)&&!Ua(n)){X(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}X(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),X(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const s=e.slice(1);for(let r=0;r<n.length;++r)R4(n[r],s,t.concat(r))}function fO(n,e,t,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${s}' must be ${n} tensor, but got ${e} tensor`)}}function j(n,e,t,s="numeric"){if(n instanceof Ps)return fO(s,n.dtype,e,t),n;let r=pC(n);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),fO(s,r,e,t),n==null||!Ua(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const i=Ec(n,r);!Ua(n)&&!Array.isArray(n)&&(n=[n]);const o=r!=="string"?$4(n,r):ay(n,[],!0);return le.makeTensor(o,i,r)}function cx(n,e,t,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((i,a)=>j(i,`${e}[${a}]`,t,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D4="__op";function Q(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const s=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+D4;const r=(...i)=>{le.startScope(t);try{const a=s(...i);return Ld(a)&&console.error("Cannot return a Promise inside of tidy."),le.endScope(a),a}catch(a){throw le.endScope(null),a}};return Object.defineProperty(r,"name",{value:t,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function USe(n,e){const t=j(n,"real","complex"),s=j(e,"imag","complex");ki(t.shape,s.shape,`real and imag shapes, ${t.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:t,imag:s};return le.runKernel(n1e,r)}const lc=Q({complex_:USe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _c(n,e,t,s){if(s==null&&(s=pC(n)),s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Ua(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){x4(e);const r=Is(e),i=Is(t);X(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let a=0;a<t.length;++a){const o=t[a],l=a===t.length-1?o!==Is(e.slice(a)):!0;X(t[a]===e[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!Ua(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=s!=="string"?$4(n,s):ay(n,[],!0),le.makeTensor(n,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fa(n,e,t){const s=Ec(n,t);return _c(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wE={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ux=4;async function jSe(n,e){const t=[],s=[],r=Array.isArray(n)?n.map(a=>a.name):Object.keys(n);for(let a=0;a<r.length;++a){const o=r[a],l=Array.isArray(n)?n[a].tensor:n[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const u={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const d=new Promise(async f=>{const m=await l.bytes(),y=m.reduce((x,T)=>x+T.length,0)+ux*m.length,b=new Uint8Array(y);let w=0;for(let x=0;x<m.length;x++){const T=m[x],E=new Uint8Array(new Uint32Array([T.length]).buffer);b.set(E,w),w+=ux,b.set(T,w),w+=T.length}f(b)});s.push(d)}else s.push(l.data());e!=null&&(u.group=e),t.push(u)}const i=await Promise.all(s);return{data:WSe(i),specs:t}}function O4(n,e){const t={};let s,r=0;for(const i of e){const a=i.name,o=i.dtype,l=i.shape,u=Is(l);let d;if("quantization"in i){const f=i.quantization;if(f.dtype==="uint8"||f.dtype==="uint16"){if(!("min"in f&&"scale"in f))throw new Error(`Weight ${i.name} with quantization ${f.dtype} doesn't have corresponding metadata min and scale.`)}else if(f.dtype==="float16"){if(o!=="float32")throw new Error(`Weight ${i.name} is quantized with ${f.dtype} which only supports weights of type float32 not ${o}.`)}else throw new Error(`Weight ${i.name} has unknown quantization dtype ${f.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const m=wE[f.dtype],y=n.slice(r,r+u*m),b=f.dtype==="uint8"?new Uint8Array(y):new Uint16Array(y);if(o==="float32")if(f.dtype==="uint8"||f.dtype==="uint16"){d=new Float32Array(b.length);for(let w=0;w<b.length;w++){const x=b[w];d[w]=x*f.scale+f.min}}else if(f.dtype==="float16")s===void 0&&(s=YSe()),d=s(b);else throw new Error(`Unsupported quantization type ${f.dtype} for weight type float32.`);else if(o==="int32"){if(f.dtype!=="uint8"&&f.dtype!=="uint16")throw new Error(`Unsupported quantization type ${f.dtype} for weight type int32.`);d=new Int32Array(b.length);for(let w=0;w<b.length;w++){const x=b[w];d[w]=Math.round(x*f.scale+f.min)}}else throw new Error(`Unsupported dtype in weight '${a}': ${o}`);r+=u*m}else if(o==="string"){const f=Is(i.shape);d=[];for(let m=0;m<f;m++){const y=new Uint32Array(n.slice(r,r+ux))[0];r+=ux;const b=new Uint8Array(n.slice(r,r+y));d.push(b),r+=y}}else{const f=wE[o],m=n.slice(r,r+u*f);if(o==="float32")d=new Float32Array(m);else if(o==="int32")d=new Int32Array(m);else if(o==="bool")d=new Uint8Array(m);else if(o==="complex64"){d=new Float32Array(m);const y=new Float32Array(d.length/2),b=new Float32Array(d.length/2);for(let T=0;T<y.length;T++)y[T]=d[T*2],b[T]=d[T*2+1];const w=Fa(y,l,"float32"),x=Fa(b,l,"float32");t[a]=lc(w,x),w.dispose(),x.dispose()}else throw new Error(`Unsupported dtype in weight '${a}': ${o}`);r+=u*f}o!=="complex64"&&(t[a]=Fa(d,l,o))}return t}function WSe(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(i=>{if(e+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return t.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const bC=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function pO(n){return bC?Buffer.byteLength(n):new Blob([n]).size}function GSe(n){if(bC)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let s=0,r=e.length;s<r;s++)t+=String.fromCharCode(e[s]);return btoa(t)}function HSe(n){if(bC){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t.set([e.charCodeAt(s)],s);return t.buffer}function xC(n){if(n.length===1)return n[0];let e=0;n.forEach(r=>{e+=r.byteLength});const t=new Uint8Array(e);let s=0;return n.forEach(r=>{t.set(new Uint8Array(r),s),s+=r.byteLength}),t.buffer}function mO(n){const e="/";for(n=n.trim();n.endsWith(e);)n=n.slice(0,n.length-1);const t=n.split(e);return t[t.length-1]}function F4(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function L4(n,e,t){const s={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(s.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=t}return n.signature!=null&&(s.signature=n.signature),n.userDefinedMetadata!=null&&(s.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(s.modelInitializer=n.modelInitializer),s}async function vC(n,e){let t,s;return n.weightsManifest!=null&&([t,s]=await e(n.weightsManifest)),L4(n,t,s)}function oy(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:pO(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:pO(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}function P4(n){const e=[];for(const t of n)e.push(...t.weights);return e}function qSe(){const n=t=>{let s=t<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function KSe(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function XSe(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function YSe(){const n=qSe(),e=KSe(),t=XSe();return s=>{const r=new ArrayBuffer(4*s.length),i=new Uint32Array(r);for(let a=0;a<s.length;a++){const o=s[a],l=n[t[o>>10]+(o&1023)]+e[o>>10];i[a]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return xn.instance==null&&(xn.instance=new xn),xn.instance}static registerSaveRouter(e){xn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){xn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return xn.getHandlers(e,"save")}static getLoadHandlers(e,t){return xn.getHandlers(e,"load",t)}static getHandlers(e,t,s){const r=[];return(t==="load"?xn.getInstance().loadRouters:xn.getInstance().saveRouters).forEach(a=>{const o=a(e,s);o!==null&&r.push(o)}),r}}const QSe=n=>xn.registerSaveRouter(n),ZSe=n=>xn.registerLoadRouter(n),JSe=n=>xn.getSaveHandlers(n),eTe=(n,e)=>xn.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SE="tensorflowjs",TE=1,gu="models_store",zl="model_info_store";function M4(){if(!Dt().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function EE(n){const e=n.result;e.createObjectStore(gu,{keyPath:"modelPath"}),e.createObjectStore(zl,{keyPath:"modelPath"})}class Uu{constructor(e){if(this.indexedDB=M4(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((s,r)=>{const i=this.indexedDB.open(SE,TE);i.onupgradeneeded=()=>EE(i),i.onsuccess=()=>{const a=i.result;if(t==null){const o=a.transaction(gu,"readonly"),u=o.objectStore(gu).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return a.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=d=>(a.close(),r(u.error)),o.oncomplete=()=>a.close()}else{const o=oy(t),l=a.transaction(zl,"readwrite");let u=l.objectStore(zl);const d=u.put({modelPath:this.modelPath,modelArtifactsInfo:o});let f;d.onsuccess=()=>{f=a.transaction(gu,"readwrite");const y=f.objectStore(gu).put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o});y.onsuccess=()=>s({modelArtifactsInfo:o}),y.onerror=b=>{u=l.objectStore(zl);const w=u.delete(this.modelPath);w.onsuccess=()=>(a.close(),r(y.error)),w.onerror=x=>(a.close(),r(y.error))}},d.onerror=m=>(a.close(),r(d.error)),l.oncomplete=()=>{f==null?a.close():f.oncomplete=()=>a.close()}}},i.onerror=a=>r(i.error)})}}Uu.URL_SCHEME="indexeddb://";const V4=n=>Dt().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Uu.URL_SCHEME)?tTe(n.slice(Uu.URL_SCHEME.length)):null;xn.registerSaveRouter(V4);xn.registerLoadRouter(V4);function tTe(n){return new Uu(n)}function nTe(n){return n.startsWith(Uu.URL_SCHEME)?n.slice(Uu.URL_SCHEME.length):n}class sTe{constructor(){this.indexedDB=M4()}async listModels(){return new Promise((e,t)=>{const s=this.indexedDB.open(SE,TE);s.onupgradeneeded=()=>EE(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(zl,"readonly"),o=i.objectStore(zl).getAll();o.onsuccess=()=>{const l={};for(const u of o.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},o.onerror=l=>(r.close(),t(o.error)),i.oncomplete=()=>r.close()},s.onerror=r=>t(s.error)})}async removeModel(e){return e=nTe(e),new Promise((t,s)=>{const r=this.indexedDB.open(SE,TE);r.onupgradeneeded=()=>EE(r),r.onsuccess=()=>{const i=r.result,a=i.transaction(zl,"readwrite"),o=a.objectStore(zl),l=o.get(e);let u;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const d=o.delete(e),f=()=>{u=i.transaction(gu,"readwrite");const y=u.objectStore(gu).delete(e);y.onsuccess=()=>t(l.result.modelArtifactsInfo),y.onerror=b=>s(l.error)};d.onsuccess=f,d.onerror=m=>(f(),i.close(),s(l.error))}},l.onerror=d=>(i.close(),s(l.error)),a.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eo="/",sd="tensorflowjs_models",B4="info",rTe="model_topology",iTe="weight_specs",aTe="weight_data",oTe="model_metadata";function z4(n){return{info:[sd,n,B4].join(Eo),topology:[sd,n,rTe].join(Eo),weightSpecs:[sd,n,iTe].join(Eo),weightData:[sd,n,aTe].join(Eo),modelMetadata:[sd,n,oTe].join(Eo)}}function U4(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function lTe(n){const e=n.split(Eo);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(Eo)}function cTe(n){return n.startsWith(ju.URL_SCHEME)?n.slice(ju.URL_SCHEME.length):n}class ju{constructor(e){if(!Dt().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=z4(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=oy(e);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,GSe(e.weightData));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw U4(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const o=JSON.parse(i);t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy,o.signature!=null&&(t.signature=o.signature),o.userDefinedMetadata!=null&&(t.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(t.modelInitializer=o.modelInitializer),o.trainingConfig!=null&&(t.trainingConfig=o.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=HSe(a),t}}ju.URL_SCHEME="localstorage://";const j4=n=>Dt().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(ju.URL_SCHEME)?uTe(n.slice(ju.URL_SCHEME.length)):null;xn.registerSaveRouter(j4);xn.registerLoadRouter(j4);function uTe(n){return new ju(n)}class hTe{constructor(){X(Dt().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),X(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=sd+Eo,s=Eo+B4;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(t)&&i.endsWith(s)){const a=lTe(i);e[a]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=cTe(e);const t=z4(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(t.info));return U4(t),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gd="://";class Js{constructor(){this.managers={}}static getInstance(){return Js.instance==null&&(Js.instance=new Js),Js.instance}static registerManager(e,t){X(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(gd)&&(e=e.slice(0,e.indexOf(gd))),X(e.length>0,()=>"scheme must not be an empty string.");const s=Js.getInstance();X(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=t}static getManager(e){const t=Js.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(Js.getInstance().managers)}}function b0(n){if(n.indexOf(gd)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Js.getSchemes().join(",")}`);return{scheme:n.split(gd)[0],path:n.split(gd)[1]}}async function W4(n,e,t=!1){X(n!==e,()=>`Old path and new path are the same: '${n}'`);const s=xn.getLoadHandlers(n);X(s.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),X(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${n}.`);const r=s[0],i=xn.getSaveHandlers(e);X(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),X(i.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const a=i[0],o=b0(n).scheme,l=b0(n).path,u=o===b0(n).scheme,d=await r.load();t&&u&&await Js.getManager(o).removeModel(l);const f=await a.save(d);return t&&!u&&await Js.getManager(o).removeModel(l),f.modelArtifactsInfo}async function dTe(){const n=Js.getSchemes(),e={};for(const t of n){const s=await Js.getManager(t).listModels();for(const r in s){const i=t+gd+r;e[i]=s[r]}}return e}async function fTe(n){const e=b0(n);return Js.getManager(e.scheme).removeModel(e.path)}async function pTe(n,e){return W4(n,e,!1)}async function mTe(n,e){return W4(n,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gTe{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(!window||!Dt().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}}if(Dt().get("IS_BROWSER")){Dt().setPlatform("browser",new gTe);try{Js.registerManager(ju.URL_SCHEME,new hTe)}catch{}try{Js.registerManager(Uu.URL_SCHEME,new sTe)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yTe={importFetch:()=>require("node-fetch")};let hT;class bTe{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return Dt().global.fetch!=null?Dt().global.fetch(e,t):(hT==null&&(hT=yTe.importFetch()),hT(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}}Dt().get("IS_NODE")&&!Dt().get("IS_BROWSER")&&Dt().setPlatform("node",new bTe);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bo(n,e="float32",t){return e=e||"float32",x4(n),new mE(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xTe(n,e){const t=j(n,"x","cast");if(!_ve(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:t},r={dtype:e};return le.runKernel(T4,s,r)}const hs=Q({cast_:xTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vTe(n){const t={x:j(n,"x","clone","string_or_numeric")};return le.runKernel(E4,t)}const ec=Q({clone_:vTe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G4(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */A4();const wTe={buffer:Bo,cast:hs,clone:ec,print:G4};DSe(wTe);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const STe="model",TTe=".json",ETe=".weights.bin";function gO(n){return new Promise(e=>setTimeout(e)).then(n)}class Wu{constructor(e){if(!Dt().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Wu.URL_SCHEME)&&(e=e.slice(Wu.URL_SCHEME.length)),(e==null||e.length===0)&&(e=STe),this.modelJsonFileName=e+TTe,this.weightDataFileName=e+ETe}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r=F4(e,s),i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=i,await gO(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const o=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;o.download=this.weightDataFileName,o.href=t,await gO(()=>o.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:oy(e)}}}}Wu.URL_SCHEME="downloads://";class _Te{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const s=new FileReader;s.onload=r=>{const i=JSON.parse(r.target.result),a=i.modelTopology;if(a==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:a});return}const l=vC(i,u=>this.loadWeights(u));e(l)},s.onerror=r=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const t=[],s=[];for(const a of e)t.push(...a.weights),s.push(...a.paths);const r=this.checkManifestAndWeightFiles(e),i=s.map(a=>this.loadWeightsFile(a,r[a]));return Promise.all(i).then(a=>[t,xC(a)])}loadWeightsFile(e,t){return new Promise((s,r)=>{const i=new FileReader;i.onload=a=>{const o=a.target.result;s(o)},i.onerror=a=>r(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],s=this.weightsFiles.map(i=>mO(i.name)),r={};for(const i of e)i.paths.forEach(a=>{const o=mO(a);if(t.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(t.push(o),s.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);r[a]=this.weightsFiles[s.indexOf(o)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const ITe=n=>Dt().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Wu.URL_SCHEME)?$Te(n.slice(Wu.URL_SCHEME.length)):null;xn.registerSaveRouter(ITe);function $Te(n="model"){return new Wu(n)}function CTe(n){return new _Te(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yO(n,e,t,s){a(n),t=t??0,s=s??1,o(t,s);let r=0;const i=l=>(l.then(u=>{const d=t+ ++r/n.length*(s-t);return e(d),u}),l);function a(l){X(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,u){X(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),X(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),X(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(n.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function H4(n,e){e==null&&(e={});const t=e.fetchFunc==null?Dt().platform.fetch:e.fetchFunc,s=n.map(f=>t(f,e.requestInit,{isBinary:!0})),o=(e.onProgress==null?await Promise.all(s):await yO(s,e.onProgress,0,.5)).map(f=>f.arrayBuffer());return e.onProgress==null?await Promise.all(o):await yO(o,e.onProgress,.5,1)}async function NTe(n,e="",t,s){return q4(a=>H4(a,{requestInit:s}))(n,e,t)}function q4(n){return async(e,t="",s)=>{const r=e.map(()=>!1),i={},a=s!=null?s.map(()=>!1):[],o=[];if(e.forEach((y,b)=>{let w=0;y.weights.forEach(x=>{const T="quantization"in x?x.quantization.dtype:x.dtype,E=wE[T]*Is(x.shape),$=()=>{r[b]=!0,i[b]==null&&(i[b]=[]),i[b].push({manifestEntry:x,groupOffset:w,sizeBytes:E})};s!=null?s.forEach((C,O)=>{C===x.name&&($(),a[O]=!0)}):$(),o.push(x.name),w+=E})}),!a.every(y=>y)){const y=s.filter((b,w)=>!a[w]);throw new Error(`Could not find weights in manifest with names: ${y.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=r.reduce((y,b,w)=>(b&&y.push(w),y),[]),u=[];l.forEach(y=>{e[y].paths.forEach(b=>{const w=t+(t.endsWith("/")?"":"/")+b;u.push(w)})});const d=await n(u),f={};let m=0;return l.forEach(y=>{const b=e[y].paths.length;let w=0;for(let C=0;C<b;C++)w+=d[m+C].byteLength;const x=new ArrayBuffer(w),T=new Uint8Array(x);let E=0;for(let C=0;C<b;C++){const O=new Uint8Array(d[m+C]);T.set(O,E),E+=O.byteLength}i[y].forEach(C=>{const O=x.slice(C.groupOffset,C.groupOffset+C.sizeBytes),V=O4(O,[C.manifestEntry]);for(const F in V)f[F]=V[F]}),m+=b}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kTe="application/octet-stream",ATe="application/json";class wC{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(X(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=Dt().platform.fetch,X(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&X(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=F4(e,s);t.body.append("model.json",new Blob([JSON.stringify(r)],{type:ATe}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:kTe}),"model.weights.bin");const i=await this.fetch(this.path,t);if(i.ok)return{modelArtifactsInfo:oy(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}const s=t.modelTopology,r=t.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return vC(t,i=>this.loadWeights(i))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=RTe(t),i=this.weightPathPrefix||s,a=P4(e),o=[],l=[];for(const d of e)for(const f of d.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(f)):o.push(i+f+r);this.weightUrlConverter&&o.push(...await Promise.all(l));const u=await H4(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[a,xC(u)]}}wC.URL_SCHEME_REGEX=/^https?:\/\//;function RTe(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),s=n.substring(0,e),r=t>e?n.substring(t):"";return[s+"/",r]}function _E(n){return n.match(wC.URL_SCHEME_REGEX)!=null}const K4=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(s=>_E(s)):t=_E(n),t)return SC(n,e)}return null};xn.registerSaveRouter(K4);xn.registerLoadRouter(K4);function SC(n,e){return new wC(n,e)}function DTe(n,e){return SC(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dT{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class X4{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class OTe{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function FTe(n,e,t,s){const r=arguments;return new OTe(Y4(...r))}function Y4(n,e,t,s){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new dT(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new dT({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new dT({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:s}))}function LTe(n){return new X4(n)}function PTe(n){return new X4(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q4=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:CTe,browserHTTPRequest:DTe,concatenateArrayBuffers:xC,copyModel:pTe,decodeWeights:O4,encodeWeights:jSe,fromMemory:FTe,fromMemorySync:Y4,getLoadHandlers:eTe,getModelArtifactsForJSON:vC,getModelArtifactsForJSONSync:L4,getModelArtifactsInfoForJSON:oy,getSaveHandlers:JSe,getWeightSpecs:P4,http:SC,isHTTPScheme:_E,listModels:dTe,loadWeights:NTe,moveModel:mTe,registerLoadRouter:ZSe,registerSaveRouter:QSe,removeModel:fTe,weightsLoaderFactory:q4,withSaveHandler:LTe,withSaveHandlerSync:PTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MTe(n,e,t=!1,s=!1){let r=j(n,"a","matMul"),i=j(e,"b","matMul");[r,i]=$n(r,i);const a={a:r,b:i},o={transposeA:t,transposeB:s};return le.runKernel(Yve,a,o)}const Zt=Q({matMul_:MTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VTe(n,e,t=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const a={indices:j(n,"indices","oneHot","int32")},o={dtype:r,depth:e,onValue:t,offValue:s};return le.runKernel(xwe,a,o)}const BTe=Q({oneHot_:VTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qi(n,e){return le.tidy(n,e)}function zTe(n){N4(n).forEach(t=>t.dispose())}function Ul(n){return le.keep(n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UTe(n){const t={input:j(n,"input","imag")};return le.runKernel(z1e,t)}const u1=Q({imag_:UTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jTe(n){const t={x:j(n,"x","neg")};return le.runKernel(fwe,t)}const Ro=Q({neg_:jTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WTe(n){const t={input:j(n,"input","real")};return le.runKernel(Cwe,t)}const Im=Q({real_:WTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GTe(n,e,t){const s=j(n,"x","transpose");if(e==null&&(e=s.shape.map((a,o)=>o).reverse()),X(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(a=>{X(a>=0&&a<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?qi(()=>{let a=Im(s),o=u1(s);return a=le.runKernel(lT,{x:a},i),o=le.runKernel(lT,{x:o},i),t&&(o=Ro(o)),lc(a,o)}):le.runKernel(lT,r,i)}const IE=Q({transpose_:GTe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HTe(n,e){const t=[];for(let s=0;s<e.length;s++){const r=n[n.length-s-1],i=e.length-s-1,a=e[i];(r==null||r===1&&a>1)&&t.unshift(i)}return t}function fs(n,e){const t=[],s=Math.max(n.length,e.length);for(let r=0;r<s;r++){let i=n[n.length-r-1];i==null&&(i=1);let a=e[e.length-r-1];if(a==null&&(a=1),i===1)t.unshift(a);else if(a===1)t.unshift(i);else if(i!==a){const o=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(o)}else t.unshift(i)}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qTe(n,e,t){if(bf(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Ec(n,t);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return _c(n,e,s,t)}function KTe(n,e,t){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${r}.`;if(t.rank<r)throw new Error(i+` update.rank < ${r}. `);if(n.length<s+(t.rank-r))throw new Error(i+` Output shape length < ${s+(t.rank-r)}`);if(t.rank!==r+n.length-s)throw new Error(i+` update.rank != ${r+n.length-s}`);for(let a=0;a<r;++a)if(t.shape[a]!==e.shape[a])throw new Error(i+` updates.shape[${a}] (${t.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<t.rank-r;++a)if(t.shape[a+r]!==n[a+s])throw new Error(i+` updates.shape[${a+r}] (${t.shape[a+r]}) != shape[${a+r}] (${n[a+r]})`)}function XTe(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}KTe(t,e,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YTe(n,e){let t=j(n,"a","add"),s=j(e,"b","add");[t,s]=$n(t,s);const r={a:t,b:s};return le.runKernel(S4,r)}const ds=Q({add_:YTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QTe(n,e){let t=j(n,"a","floorDiv"),s=j(e,"b","floorDiv");[t,s]=$n(t,s);const r={a:t,b:s};return le.runKernel(O1e,r)}const Z4=Q({floorDiv_:QTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZTe(n,e){let t=j(n,"a","div"),s=j(e,"b","div");if([t,s]=$n(t,s),t.dtype==="int32"&&s.dtype==="int32")return Z4(t,s);const r={a:t,b:s},i={};return le.runKernel(S1e,r,i)}const ir=Q({div_:ZTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JTe(n,e){let t=j(n,"a","mul"),s=j(e,"b","mul");[t,s]=$n(t,s);const r={a:t,b:s};return le.runKernel(dwe,r)}const dt=Q({mul_:JTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eEe(n){const e=j(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return le.runKernel(s1e,t)}else{const t={x:e};return le.runKernel(Fve,t)}}const xi=Q({abs_:eEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tEe(n){const t={x:j(n,"x","acos")};return le.runKernel(Lve,t)}const nEe=Q({acos_:tEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sEe(n){const t={x:j(n,"x","acosh")};return le.runKernel(Pve,t)}const rEe=Q({acosh_:sEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iEe(n){X(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),X(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((r,i)=>j(r,`tensors${i}`,"addN")),t=e[0];e.forEach(r=>{if(r.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!oc(r.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return le.runKernel(Mve,s)}const aEe=Q({addN_:iEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oEe(n,e=null,t=!1){const r={x:j(n,"x","all","bool")},i={axis:e,keepDims:t};return le.runKernel(Vve,r,i)}const lEe=Q({all_:oEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cEe(n,e=null,t=!1){const r={x:j(n,"x","any","bool")},i={axis:e,keepDims:t};return le.runKernel(Bve,r,i)}const uEe=Q({any_:cEe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hEe(n,e=0){const s={x:j(n,"x","argMax")},r={axis:e};return le.runKernel(zve,s,r)}const dEe=Q({argMax_:hEe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fEe(n,e=0){const s={x:j(n,"x","argMin")},r={axis:e};return le.runKernel(Uve,s,r)}const pEe=Q({argMin_:fEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mEe(n){const t={x:j(n,"x","asin")};return le.runKernel(jve,t)}const gEe=Q({asin_:mEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yEe(n){const t={x:j(n,"x","asinh")};return le.runKernel(Wve,t)}const bEe=Q({asinh_:yEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xEe(n){const t={x:j(n,"x","atan")};return le.runKernel(Gve,t)}const vEe=Q({atan_:xEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wEe(n,e){let t=j(n,"a","atan2"),s=j(e,"b","atan2");[t,s]=$n(t,s);const r={a:t,b:s};return le.runKernel(qve,r)}const SEe=Q({atan2_:wEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TEe(n){const t={x:j(n,"x","atanh")};return le.runKernel(Hve,t)}const EEe=Q({atanh_:TEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ee(n,e,t,s,r,i,a="channelsLast"){const[o,l]=hx(e);let u;if(a==="channelsLast")u=[o,l,n[3],n[3]];else if(a==="channelsFirst")u=[o,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return TC(n,u,t,s,r,i,!1,a)}function TC(n,e,t,s,r,i,a=!1,o="channelsLast"){let[l,u,d,f]=[-1,-1,-1,-1];if(o==="channelsLast")[l,u,d,f]=n;else if(o==="channelsFirst")[l,f,u,d]=n;else throw new Error(`Unknown dataFormat ${o}`);const[m,y,,b]=e,[w,x]=hx(t),[T,E]=hx(s),$=$E(m,T),C=$E(y,E),{padInfo:O,outHeight:V,outWidth:F}=CEe(r,u,d,w,x,$,C,i,o),R=a?b*f:b;let N;return o==="channelsFirst"?N=[l,R,V,F]:o==="channelsLast"&&(N=[l,V,F,R]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:d,inChannels:f,outHeight:V,outWidth:F,outChannels:R,padInfo:O,strideHeight:w,strideWidth:x,filterHeight:m,filterWidth:y,effectiveFilterHeight:$,effectiveFilterWidth:C,dilationHeight:T,dilationWidth:E,inShape:n,outShape:N,filterShape:e}}function IEe(n,e,t,s,r){s==null&&(s=$Ee(n,e,t));const i=n[0],a=n[1],o=dx((i-e+2*s)/t+1,r),l=dx((a-e+2*s)/t+1,r);return[o,l]}function $Ee(n,e,t,s=1){const r=$E(e,s);return Math.floor((n[0]*(t-1)-t+r)/2)}function hx(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function $E(n,e){return e<=1?n:n+(n-1)*(e-1)}function CEe(n,e,t,s,r,i,a,o,l){let u,d,f;if(typeof n=="number"){u={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const y=IEe([e,t],i,s,n,o);d=y[0],f=y[1]}else if(n==="same"){d=Math.ceil(e/s),f=Math.ceil(t/r);const m=Math.max(0,(d-1)*s+i-e),y=Math.max(0,(f-1)*r+a-t),b=Math.floor(m/2),w=m-b,x=Math.floor(y/2),T=y-x;u={top:b,bottom:w,left:x,right:T,type:"SAME"}}else if(n==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((e-i+1)/s),f=Math.ceil((t-a+1)/r);else if(typeof n=="object"){const m=l==="channelsLast"?n[1][0]:n[2][0],y=l==="channelsLast"?n[1][1]:n[2][1],b=l==="channelsLast"?n[2][0]:n[3][0],w=l==="channelsLast"?n[2][1]:n[3][1];u={top:m,bottom:y,left:b,right:w,type:m===0&&y===0&&b===0&&w===0?"VALID":"EXPLICIT"},d=dx((e-i+m+y)/s+1,o),f=dx((t-a+b+w)/r+1,o)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:u,outHeight:d,outWidth:f}}function dx(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function fx(n){const[e,t,s]=hx(n);return e===1&&t===1&&s===1}function Ic(n,e){return fx(n)||fx(e)}function na(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")X(_m(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{X(_m(r),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${r}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NEe(n,e){const s={x:j(n,"x","reshape","string_or_numeric")},r={shape:e};return le.runKernel(Awe,s,r)}const Ce=Q({reshape_:NEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kEe(n,e,t,s,r){const i=j(n,"x","avgPool","float32"),a=1;X(Ic(t,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);let o=i,l=!1;i.rank===3&&(l=!0,o=Ce(i,[1,i.shape[0],i.shape[1],i.shape[2]])),X(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),na("avgPool",s,r);const u={x:o},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r};let f=le.runKernel(Kve,u,d);return f=hs(f,i.dtype),l?Ce(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const J4=Q({avgPool_:kEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AEe(n,e,t,s,r,i="NDHWC"){const a=j(n,"x","avgPool3d","float32");let o=a,l=!1;a.rank===4&&(l=!0,o=Ce(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),X(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),X(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),na("avgPool3d",s,r);const u={x:o},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:i};let f=le.runKernel(Xve,u,d);return f=hs(f,o.dtype),l?Ce(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const REe=Q({avgPool3d_:AEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DEe(n,e=0){X(n.length>=1,()=>"Pass at least one tensor to concat");const t=cx(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),t.length===1)return ec(t[0]);const s=t,r={axis:e};return le.runKernel(r1e,s,r)}const or=Q({concat_:DEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OEe(n){const t={x:j(n,"x","sigmoid","float32")};return le.runKernel(Hwe,t)}const yd=Q({sigmoid_:OEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FEe(n,e,t){const s=j(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:t};return le.runKernel(Uwe,r,i)}const cn=Q({slice_:FEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LEe(n){const t={x:j(n,"x","tanh","float32")};return le.runKernel(hSe,t)}const CE=Q({tanh_:LEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PEe(n,e,t,s,r,i){const a=j(n,"forgetBias","basicLSTMCell"),o=j(e,"lstmKernel","basicLSTMCell"),l=j(t,"lstmBias","basicLSTMCell"),u=j(s,"data","basicLSTMCell"),d=j(r,"c","basicLSTMCell"),f=j(i,"h","basicLSTMCell"),m=or([u,f],1),y=Zt(m,o),b=ds(y,l),w=b.shape[0],x=b.shape[1]/4,T=[w,x],E=cn(b,[0,0],T),$=cn(b,[0,x],T),C=cn(b,[0,x*2],T),O=cn(b,[0,x*3],T),V=ds(dt(yd(E),CE($)),dt(d,yd(ds(a,C)))),F=dt(CE(V),yd(O));return[V,F]}const MEe=Q({basicLSTMCell_:PEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VEe(n,e,t){const s=j(n,"x","batchToSpaceND"),r=e.reduce((o,l)=>o*l);X(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),X(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),X(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},a={blockShape:e,crops:t};return le.runKernel(Qve,i,a)}const eU=Q({batchToSpaceND_:VEe});function BEe(n){let e;return n.rank===0||n.rank===1?e=Ce(n,[1,1,1,n.size]):n.rank===2?e=Ce(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=Ce(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zEe(n,e,t,s,r,i){i==null&&(i=.001);const a=j(n,"x","batchNorm"),o=j(e,"mean","batchNorm"),l=j(t,"variance","batchNorm");let u;r!=null&&(u=j(r,"scale","batchNorm"));let d;s!=null&&(d=j(s,"offset","batchNorm")),X(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),X(d==null||o.rank===d.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),X(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const m={x:BEe(a),scale:u,offset:d,mean:o,variance:l},y={varianceEpsilon:i},b=le.runKernel(F1e,m,y);return Ce(b,a.shape)}const h1=Q({batchNorm_:zEe});function UEe(n,e,t,s,r,i){const a=j(n,"x","batchNorm"),o=j(e,"mean","batchNorm"),l=j(t,"variance","batchNorm");let u;r!=null&&(u=j(r,"scale","batchNorm"));let d;return s!=null&&(d=j(s,"offset","batchNorm")),X(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),X(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),X(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&X(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),d!=null&&X(d.rank===2||d.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${d.rank}.`),h1(a,o,l,d,u,i)}const jEe=Q({batchNorm2d_:UEe});function WEe(n,e,t,s,r,i){const a=j(n,"x","batchNorm"),o=j(e,"mean","batchNorm"),l=j(t,"variance","batchNorm");let u;r!=null&&(u=j(r,"scale","batchNorm"));let d;return s!=null&&(d=j(s,"offset","batchNorm")),X(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),X(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),X(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&X(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),d!=null&&X(d.rank===3||d.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${d.rank}.`),h1(a,o,l,d,u,i)}const GEe=Q({batchNorm3d_:WEe});function HEe(n,e,t,s,r,i){const a=j(n,"x","batchNorm"),o=j(e,"mean","batchNorm"),l=j(t,"variance","batchNorm");let u;r!=null&&(u=j(r,"scale","batchNorm"));let d;return s!=null&&(d=j(s,"offset","batchNorm")),X(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),X(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),X(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&X(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),d!=null&&X(d.rank===4||d.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${d.rank}.`),h1(a,o,l,d,u,i)}const qEe=Q({batchNorm4d_:HEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KEe(n,e,t){const s=j(n,"x","bincount"),r=j(e,"weights","bincount");X(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),X(t>=0,()=>`size must be non-negative, but got ${t}.`),X(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},a={size:t};return le.runKernel(Zve,i,a)}const tU=Q({bincount_:KEe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XEe(n,e){const t=j(n,"s0","broadcastArgs","int32"),s=j(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:t,s1:s};return le.runKernel(Jve,r)}const YEe=Q({broadcastArgs_:XEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QEe(n,e){let t=j(n,"broadcastTo","x");const s=t.shape;if(e.some(u=>!(u>0)||u%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const u=t.shape.slice();for(;u.length<e.length;)u.unshift(1);t=Ce(t,u)}const r=t.shape,i=Array.from(e);for(let u=e.length-1;u>=0;u--)if(r[u]===e[u])i[u]=1;else if(t.shape[u]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((u,d)=>u>1?d:-1).filter(u=>u>=0).length===0)return ec(t);const o={x:t},l={reps:i};return le.runKernel(_4,o,l)}const x0=Q({broadcastTo_:QEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZEe(n){const t={x:j(n,"x","ceil","float32")};return le.runKernel(e1e,t)}const JEe=Q({ceil_:ZEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d1(n,e,t){const s={shape:n,value:e,dtype:t};return le.runKernel(A1e,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e_e(n,e,t){const s=j(n,"x","clipByValue");if(X(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return d1(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:t};return le.runKernel(t1e,r,i)}const t_e=Q({clipByValue_:e_e});function n_e(n){return or(n,0)}const s_e=Q({concat1d_:n_e});function r_e(n,e){return or(n,e)}const i_e=Q({concat2d_:r_e});function a_e(n,e){return or(n,e)}const o_e=Q({concat3d_:a_e});function l_e(n,e){return or(n,e)}const c_e=Q({concat4d_:l_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_e(n,e,t,s,r="NHWC",i=[1,1],a){const o=j(n,"x","conv2d","float32"),l=j(e,"filter","conv2d","float32");let u=o,d=!1;o.rank===3&&(d=!0,u=Ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),X(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),X(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),na("conv2d",s,a);const f=r==="NHWC"?u.shape[3]:u.shape[1];X(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),X(Ic(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const m={x:u,filter:l},y={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a},b=le.runKernel(i1e,m,y);return d?Ce(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const f1=Q({conv2d_:u_e});function h_e(n,e,t,s,r="NWC",i=1,a){const o=j(n,"x","conv1d"),l=j(e,"filter","conv1d");let u=o,d=!1;o.rank===2&&(d=!0,u=Ce(o,[1,o.shape[0],o.shape[1]])),X(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),X(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),na("conv1d",s,a),X(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),X(Ic(t,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${i}'`),X(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const f=Ce(l,[1,l.shape[0],l.shape[1],l.shape[2]]),m=Ce(u,[u.shape[0],1,u.shape[1],u.shape[2]]),x=f1(m,f,[1,t],s,"NHWC",[1,i],a);return d?Ce(x,[x.shape[2],x.shape[3]]):Ce(x,[x.shape[0],x.shape[2],x.shape[3]])}const d_e=Q({conv1d_:h_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_e(n,e,t,s,r,i="NHWC",a){X(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,l=e,u=!1;e.rank===3&&(u=!0,l=Ce(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,n[0],n[1],n[2]]),X(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),X(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),X(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const d=i==="NHWC"?o[3]:o[1],f=i==="NHWC"?l.shape[3]:l.shape[1];X(d===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${d}) must match input depth for filter ${t.shape[2]}.`),X(f===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${t.shape[3]}.`),na("conv2dDerInput",r,a);const m={dy:l,filter:t},y={strides:s,pad:r,dataFormat:i,dimRoundingMode:a,inputShape:o},b=le.runKernel(o1e,m,y);return u?Ce(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const nU=Q({conv2DBackpropInput_:f_e});function p_e(n,e,t,s,r,i){const a=j(n,"x","conv2dTranspose"),o=j(e,"filter","conv2dTranspose");return nU(t,a,o,s,r,"NHWC",i)}const m_e=Q({conv2dTranspose_:p_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g_e(n,e,t,s,r="NDHWC",i=[1,1,1]){const a=j(n,"x","conv3d"),o=j(e,"filter","conv3d");let l=a,u=!1;a.rank===4&&(u=!0,l=Ce(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),X(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),X(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),X(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),X(Ic(t,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),X(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`);const d={x:l,filter:o},f={strides:t,pad:s,dataFormat:r,dilations:i},m=le.runKernel(l1e,d,f);return u?Ce(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const y_e=Q({conv3d_:g_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b_e(n,e,t,s,r){X(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let i=n,a=e,o=!1;e.rank===4&&(o=!0,a=Ce(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,n[0],n[1],n[2],n[3]]);const l=i[4],u=a.shape[4];X(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),X(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),X(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),X(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),X(u===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${t.shape[4]}.`);const d={dy:a,filter:t},f={pad:r,strides:s,inputShape:i},m=le.runKernel(c1e,d,f);return o?Ce(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const x_e=Q({conv3DBackpropInput_:b_e});function v_e(n,e,t,s,r){const i=j(n,"x","conv3dTranspose"),a=j(e,"filter","conv3dTranspose");return x_e(t,i,a,s,r)}const w_e=Q({conv3dTranspose_:v_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S_e(n){const t={x:j(n,"x","cos","float32")};return le.runKernel(u1e,t)}const T_e=Q({cos_:S_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E_e(n){const t={x:j(n,"x","cosh","float32")};return le.runKernel(h1e,t)}const __e=Q({cosh_:E_e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I_e(n,e=0,t=!1,s=!1){const i={x:j(n,"x","cumprod")},a={axis:e,exclusive:t,reverse:s};return le.runKernel(d1e,i,a)}const $_e=Q({cumprod_:I_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C_e(n,e=0,t=!1,s=!1){const i={x:j(n,"x","cumsum")},a={axis:e,exclusive:t,reverse:s};return le.runKernel(f1e,i,a)}const N_e=Q({cumsum_:C_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k_e(n,e,t,s=!1){const r=j(n,"x","denseBincount"),i=j(e,"weights","denseBincount");X(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),X(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),X(t>=0,()=>`size must be non-negative, but got ${t}.`),X(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const a={x:r,weights:i},o={size:t,binaryOutput:s};return le.runKernel(m1e,a,o)}const A_e=Q({denseBincount_:k_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_e(n,e,t="NHWC"){const s=j(n,"x","depthToSpace","float32"),r=t==="NHWC"?s.shape[1]:s.shape[2],i=t==="NHWC"?s.shape[2]:s.shape[3],a=t==="NHWC"?s.shape[3]:s.shape[1];X(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),X(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),X(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),X(a%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${s.shape}`);const o={x:s},l={blockSize:e,dataFormat:t};return le.runKernel(g1e,o,l)}const D_e=Q({depthToSpace_:R_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O_e(n,e,t,s,r="NHWC",i=[1,1],a){const o=j(n,"x","depthwiseConv2d","float32"),l=j(e,"filter","depthwiseConv2d","float32");let u=o,d=!1;o.rank===3&&(d=!0,u=Ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),X(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),X(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const f=r==="NHWC"?u.shape[3]:u.shape[1];X(f===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${l.shape[2]}.`),na("depthwiseConv2d",s,a);const m={x:u,filter:l},y={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a},b=le.runKernel(y1e,m,y);return d?Ce(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const EC=Q({depthwiseConv2d_:O_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F_e(n){const t={x:j(n,"x","diag")};return le.runKernel(v1e,t)}const L_e=Q({diag_:F_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_e(n,e,t,s,r=[1,1],i="NHWC"){const a=j(n,"x","dilation2d"),o=j(e,"filter","dilation2d");X(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),X(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),X(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=a,u=!1;a.rank===3&&(l=Ce(a,[1,a.shape[0],a.shape[1],a.shape[2]]),u=!0);const d={x:l,filter:o},f={strides:t,pad:s,dilations:r},m=le.runKernel(w1e,d,f);return u?Ce(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const M_e=Q({dilation2d_:P_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V_e(n,e){let t=j(n,"a","equal","string_or_numeric"),s=j(e,"b","equal","string_or_numeric");[t,s]=$n(t,s),fs(t.shape,s.shape);const r={a:t,b:s};return le.runKernel(I1e,r)}const sU=Q({equal_:V_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B_e(n,e,t){const s=j(e,"a","where"),r=j(t,"b","where"),i=j(n,"condition","where","bool"),a=fs(fs(i.shape,s.shape),r.shape),o=x0(i,a),l=x0(s,a),u=x0(r,a),d={condition:o,t:l,e:u};return le.runKernel(Bwe,d)}const Md=Q({where_:B_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z_e(n){const t={x:j(n,"x","zerosLike")};return le.runKernel(ySe,t)}const _C=Q({zerosLike_:z_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U_e(n,e){let t=j(n,"a","div"),s=j(e,"b","div");[t,s]=$n(t,s);const r=ir(t,s),i=_C(r),a=sU(s,i);return Md(a,i,r)}const j_e=Q({divNoNan_:U_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W_e(n,e){const t=j(n,"t1","dot"),s=j(e,"t2","dot");X((t.rank===1||t.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${s.rank}.`);const r=t.rank===1?t.size:t.shape[1],i=s.rank===1?s.size:s.shape[0];if(X(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),t.rank===1&&s.rank===1){const a=Ce(t,[1,-1]),o=Ce(s,[-1,1]),l=Zt(a,o);return Ce(l,[])}else if(t.rank===1&&s.rank===2){const a=Ce(t,[1,-1]),o=Ce(s,[s.shape[0],s.shape[1]]),l=Zt(a,o);return Ce(l,[l.size])}else if(t.rank===2&&s.rank===1){const a=Ce(s,[-1,1]),o=Zt(t,a);return Ce(o,[o.size])}else{const a=Ce(s,[s.shape[0],s.shape[1]]);return Zt(t,a)}}const G_e=Q({dot_:W_e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_e(n,...e){const t=e.map((r,i)=>j(r,`tensors${i}`,"einsum")),s={equation:n};return le.runKernel(T1e,t,s)}const q_e=Q({einsum_:H_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K_e(n){const t={x:j(n,"x","elu","float32")};return le.runKernel(E1e,t)}const rU=Q({elu_:K_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X_e(n){let e=j(n,"x","erf");X(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=hs(e,"float32"));const t={x:e};return le.runKernel(_1e,t)}const Y_e=Q({erf_:X_e});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q_e(n,e,t){const s=n.length+e.length,r=[];let i=0,a=0;for(let o=0;o<s;o++)t.indexOf(o)===-1?r.push(n[i++]):r.push(e[a++]);return r}function p1(n,e){const t=e.map(s=>1);return Q_e(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z_e(n,e=null,t=!1){const r={x:j(n,"x","max")},i={reductionIndices:e,keepDims:t};return le.runKernel(twe,r,i)}const bd=Q({max_:Z_e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_e(n,e=null,t=!1){const r={x:j(n,"x","min")},i={axis:e,keepDims:t};return le.runKernel(owe,r,i)}const NE=Q({min_:J_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eIe(n,e){let t=j(n,"base","pow"),s=j(e,"exp","pow");[t,s]=$n(t,s);const r={a:t,b:s};return le.runKernel(Swe,r)}const IC=Q({pow_:eIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yt(n,e){if((Ua(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Ua(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return _c(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tIe(n){const t={x:j(n,"x","sqrt","float32")};return le.runKernel(Kwe,t)}const kE=Q({sqrt_:tIe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nIe(n){const e=j(n,"x","square"),t={};return le.runKernel("Square",{x:e},t)}const m1=Q({square_:nIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sIe(n,e=null,t=!1){let s=j(n,"x","sum");s.dtype==="bool"&&(s=hs(s,"int32"));const r={x:s},i={axis:e,keepDims:t};return le.runKernel(Xwe,r,i)}const mn=Q({sum_:sIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rIe(n,e="euclidean",t=null,s=!1){n=j(n,"x","norm");const r=iU(n,e,t);let i=r.shape;if(s){const a=c1(t,n.shape);i=p1(r.shape,a)}return Ce(r,i)}function iU(n,e,t=null){if(n.rank===0)return xi(n);if(n.rank!==1&&t===null)return iU(Ce(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return mn(xi(n),t);if(e===1/0)return bd(xi(n),t);if(e===-1/0)return NE(xi(n),t);if(e==="euclidean"||e===2)return kE(mn(IC(xi(n),Yt(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return bd(mn(xi(n),t[0]),t[1]-1);if(e===1/0)return bd(mn(xi(n),t[1]),t[0]);if(e===-1/0)return NE(mn(xi(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return kE(mn(m1(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const g1=Q({norm_:rIe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iIe(n,e=null,t=!1){return g1(n,"euclidean",e,t)}const aIe=Q({euclideanNorm_:iIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oIe(n){const t={x:j(n,"x","exp")};return le.runKernel($1e,t)}const Gu=Q({exp_:oIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lIe(n,e=0){const t=j(n,"x","expandDims","string_or_numeric");X(e<=t.rank,()=>"Axis must be <= rank of the tensor");const s={input:t},r={dim:e};return le.runKernel(C1e,s,r)}const uu=Q({expandDims_:lIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cIe(n){const t={x:j(n,"x","expm1")};return le.runKernel(N1e,t)}const uIe=Q({expm1_:cIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hIe(n,e){const t=j(n,"x","tile","string_or_numeric");X(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const s={x:t},r={reps:e};return le.runKernel(_4,s,r)}const tm=Q({tile_:hIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dIe(n,e,t,s="float32"){e==null&&(e=n);const r=Bo([n,e],s),i=n<=e?n:e;for(let o=0;o<i;++o)r.set(1,o,o);const a=Ce(r.toTensor(),[n,e]);if(t==null)return a;if(t.length===1)return tm(uu(a,0),[t[0],1,1]);if(t.length===2)return tm(uu(uu(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return tm(uu(uu(uu(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const aU=Q({eye_:dIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fIe(n){const t={x:j(n,"x","floor","float32")};return le.runKernel(D1e,t)}const oU=Q({floor_:fIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pIe(n,e,t=0,s=0){const r=j(n,"x","gather"),i=j(e,"indices","gather","int32"),a={x:r,indices:i},o={axis:t,batchDims:s};return le.runKernel(L1e,a,o)}const lU=Q({gather_:pIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mIe(n,e){let t=j(n,"a","greater","string_or_numeric"),s=j(e,"b","greater","string_or_numeric");[t,s]=$n(t,s),fs(t.shape,s.shape);const r={a:t,b:s};return le.runKernel(M1e,r)}const y1=Q({greater_:mIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gIe(n,e){let t=j(n,"a","greaterEqual","string_or_numeric"),s=j(e,"b","greaterEqual","string_or_numeric");[t,s]=$n(t,s),fs(t.shape,s.shape);const r={a:t,b:s};return le.runKernel(V1e,r)}const cU=Q({greaterEqual_:gIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yIe(n){const t={x:j(n,"x","isFinite")};return le.runKernel(U1e,t)}const bIe=Q({isFinite_:yIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xIe(n){const t={x:j(n,"x","isInf")};return le.runKernel(j1e,t)}const vIe=Q({isInf_:xIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wIe(n){const t={x:j(n,"x","isNaN")};return le.runKernel(W1e,t)}const SIe=Q({isNaN_:wIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TIe(n,e=.2){const s={x:j(n,"x","leakyRelu")},r={alpha:e};return le.runKernel(G1e,s,r)}const uU=Q({leakyRelu_:TIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EIe(n,e){let t=j(n,"a","less","string_or_numeric"),s=j(e,"b","less","string_or_numeric");[t,s]=$n(t,s),fs(t.shape,s.shape);const r={a:t,b:s};return le.runKernel(H1e,r)}const _Ie=Q({less_:EIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IIe(n,e){let t=j(n,"a","lessEqual","string_or_numeric"),s=j(e,"b","lessEqual","string_or_numeric");[t,s]=$n(t,s),fs(t.shape,s.shape);const r={a:t,b:s};return le.runKernel(q1e,r)}const $C=Q({lessEqual_:IIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ie(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const s={start:n,stop:e,num:t};return le.runKernel(K1e,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CIe(n,e=5,t=1,s=1,r=.5){const i=j(n,"x","localResponseNormalization");X(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),X(_m(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=i,o=!1;i.rank===3&&(o=!0,a=Ce(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:a},u={depthRadius:e,bias:t,alpha:s,beta:r},d=le.runKernel(ewe,l,u);return o?Ce(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const NIe=Q({localResponseNormalization_:CIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kIe(n){const t={x:j(n,"x","log","float32")};return le.runKernel(X1e,t)}const $m=Q({log_:kIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AIe(n){const t={x:j(n,"x","log1p")};return le.runKernel(Y1e,t)}const hU=Q({log1p_:AIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zo(n){return le.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RIe(n){const t={x:j(n,"x","softplus")};return le.runKernel(qwe,t)}const dU=Q({softplus_:RIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DIe(n){const e=j(n,"x","logSigmoid");return zo(s=>({value:Ro(dU(Ro(s))),gradFunc:a=>dt(a,yd(Ro(s)))}))(e)}const OIe=Q({logSigmoid_:DIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FIe(n,e){let t=j(n,"a","sub"),s=j(e,"b","sub");[t,s]=$n(t,s);const r={a:t,b:s};return le.runKernel(cSe,r)}const Pt=Q({sub_:FIe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LIe(n,e=-1){const t=j(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return zo((r,i)=>{const o=bd(r,e,!0),l=Pt(r,o),u=Pt(hs(l,"float32"),$m(mn(Gu(l),e,!0)));return i([u]),{value:u,gradFunc:(f,m)=>{const[y]=m,b=!0,w=Gu(y);return Pt(f,dt(mn(f,e,b),w))}}})(t)}const PIe=Q({logSoftmax_:LIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MIe(n,e=null,t=!1){const s=j(n,"x","logSumExp"),r=c1(e,s.shape),i=bd(s,r,!0),a=Pt(s,i),o=Gu(a),l=mn(o,r),u=$m(l),d=ds(Ce(i,u.shape),u);if(t){const f=p1(d.shape,r);return Ce(d,f)}return d}const fU=Q({logSumExp_:MIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VIe(n,e){const t=j(n,"a","logicalAnd","bool"),s=j(e,"b","logicalAnd","bool");fs(t.shape,s.shape);const r={a:t,b:s};return le.runKernel(Q1e,r)}const px=Q({logicalAnd_:VIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BIe(n){const t={x:j(n,"x","logicalNot","bool")};return le.runKernel(Z1e,t)}const pU=Q({logicalNot_:BIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zIe(n,e){const t=j(n,"a","logicalOr","bool"),s=j(e,"b","logicalOr","bool");fs(t.shape,s.shape);const r={a:t,b:s};return le.runKernel(J1e,r)}const mU=Q({logicalOr_:zIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UIe(n,e){const t=j(n,"a","logicalXor","bool"),s=j(e,"b","logicalXor","bool");return fs(t.shape,s.shape),px(mU(n,e),pU(px(n,e)))}const jIe=Q({logicalXor_:UIe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kb=2147483648;function WIe(n,e,t="left"){const s=j(n,"sortedSequence","searchSorted"),r=j(e,"values","searchSorted"),i=s.shape[s.shape.length-1],a=r.shape[r.shape.length-1],o=Ce(s,[-1,i]),l=Ce(r,[-1,a]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Is(l.shape)>=Kb)throw new Error(`values tensor size must less than ${Kb}`);if(o.shape[1]>=Kb)throw new Error(`trailing dim_size must less than ${Kb} for int32 output type, was ${o.shape[1]}`);const u={sortedSequence:o,values:l},d={side:t};return le.runKernel(Vwe,u,d)}const CC=Q({searchSorted_:WIe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GIe(n,e){return CC(n,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HIe(n,e,t,s,r){const i=j(n,"x","maxPool"),a=1;let o=i,l=!1;i.rank===3&&(l=!0,o=Ce(i,[1,i.shape[0],i.shape[1],i.shape[2]])),X(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),X(Ic(t,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),na("maxPool",s,r);const u={x:o},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r},f=le.runKernel(swe,u,d);return l?Ce(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const gU=Q({maxPool_:HIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qIe(n,e=[1,1,1],t,s,r,i="NDHWC"){const a=j(n,"x","maxPool3d");let o=a,l=!1;a.rank===4&&(l=!0,o=Ce(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),X(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),X(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),na("maxPool3d",s,r);const u={x:o},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:i},f=le.runKernel(rwe,u,d);return l?Ce(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const KIe=Q({maxPool3d_:qIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XIe(n,e,t,s,r=!1){const a={x:j(n,"x","maxPoolWithArgmax")},o={filterSize:e,strides:t,pad:s,includeBatchInIndex:r},l=le.runKernel(iwe,a,o);return{result:l[0],indexes:l[1]}}const YIe=Q({maxPoolWithArgmax_:XIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QIe(n,e){let t=j(n,"a","maximum"),s=j(e,"b","maximum");[t,s]=$n(t,s),t.dtype==="bool"&&(t=hs(t,"int32"),s=hs(s,"int32")),fs(t.shape,s.shape);const r={a:t,b:s};return le.runKernel(nwe,r)}const ZIe=Q({maximum_:QIe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JIe(n,e=null,t=!1){const r={x:j(n,"x","mean")},i={axis:e,keepDims:t};return le.runKernel(awe,r,i)}const mx=Q({mean_:JIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vd(n,e="float32"){if(e==="complex64"){const s=Vd(n,"float32"),r=Vd(n,"float32");return lc(s,r)}const t=gC(Is(n),e);return le.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yu(n,e="float32"){if(e==="complex64"){const s=yu(n,"float32"),r=Vd(n,"float32");return lc(s,r)}const t=b4(Is(n),e);return le.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e$e(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let s=j(n,"x","meshgrid",n instanceof Ps?n.dtype:"float32");if(e===void 0)return[s];let r=j(e,"y","meshgrid",e instanceof Ps?e.dtype:"float32");const i=Is(s.shape),a=Is(r.shape);return t==="xy"?(s=Ce(s,[1,-1]),r=Ce(r,[-1,1]),[Zt(yu([a,1],s.dtype),s),Zt(r,yu([1,i],r.dtype))]):(s=Ce(s,[-1,1]),r=Ce(r,[1,-1]),[Zt(s,yu([1,a],s.dtype)),Zt(yu([i,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t$e(n,e){let t=j(n,"a","minimum"),s=j(e,"b","minimum");[t,s]=$n(t,s),t.dtype==="bool"&&(t=hs(t,"int32"),s=hs(s,"int32")),fs(t.shape,s.shape);const r={a:t,b:s};return le.runKernel(lwe,r)}const yU=Q({minimum_:t$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n$e(n,e,t){X(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const s=j(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");X(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=t==="reflect"?1:0;for(let o=0;o<s.rank;o++)X(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),X(e[o][0]>=0&&e[o][0]<=s.shape[o]-r&&e[o][1]>=0&&e[o][1]<=s.shape[o]-r,()=>`Padding in dimension ${o} cannot be greater than or equal to ${s.shape[o]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:t},a={x:s};return le.runKernel(cwe,a,i)}const s$e=Q({mirrorPad_:n$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r$e(n,e){let t=j(n,"a","mod"),s=j(e,"b","mod");[t,s]=$n(t,s);const r={a:t,b:s};return le.runKernel(uwe,r)}const i$e=Q({mod_:r$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a$e(n,e=null,t=!1){n=j(n,"x","moments");const s=c1(e,n.shape),r=mx(n,s,t);let i=r.shape;t||(i=p1(r.shape,s));const a=m1(Pt(hs(n,"float32"),Ce(r,i))),o=mx(a,s,t);return{mean:r,variance:o}}const o$e=Q({moments_:a$e});function l$e(n,e,t,s){const r=j(e,"data","multiRNNCell"),i=cx(t,"c","multiRNNCell"),a=cx(s,"h","multiRNNCell");let o=r;const l=[];for(let f=0;f<n.length;f++){const m=n[f](o,i[f],a[f]);l.push(m[0]),l.push(m[1]),o=m[1]}const u=[],d=[];for(let f=0;f<l.length;f+=2)u.push(l[f]),d.push(l[f+1]);return[u,d]}const c$e=Q({multiRNNCell_:l$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u$e(n,e,t,s=!1){const r=j(n,"logits","multinomial"),i=r.size,a=r.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(a>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${a}`);t=t||Math.random();const l={logits:a===1?Ce(r,[1,-1]):r},u={numSamples:e,seed:t,normalized:s},d=le.runKernel(hwe,l,u);return a===1?Ce(d,[d.size]):d}const h$e=Q({multinomial_:u$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d$e(n,e){let t=j(n,"a","notEqual","string_or_numeric"),s=j(e,"b","notEqual","string_or_numeric");[t,s]=$n(t,s),fs(t.shape,s.shape);const r={a:t,b:s};return le.runKernel(pwe,r)}const bU=Q({notEqual_:d$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f$e(n){const t={x:j(n,"x","onesLike")};return le.runKernel(bwe,t)}const p$e=Q({onesLike_:f$e});function m$e(n,e){const t=j(n,"v1","outerProduct"),s=j(e,"v2","outerProduct");X(t.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${s.rank}.`);const r=Ce(t,[-1,1]),i=Ce(s,[1,-1]);return Zt(r,i)}const g$e=Q({outerProduct_:m$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y$e(n,e,t=0){const s=j(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:t},i={x:s};return le.runKernel(wwe,i,r)}const ly=Q({pad_:y$e});function b$e(n,e,t=0){return X(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),ly(n,[e],t)}const x$e=Q({pad1d_:b$e});function v$e(n,e,t=0){return X(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ly(n,e,t)}const w$e=Q({pad2d_:v$e});function S$e(n,e,t=0){return X(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ly(n,e,t)}const T$e=Q({pad3d_:S$e});function E$e(n,e,t=0){return X(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ly(n,e,t)}const _$e=Q({pad4d_:E$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I$e(n,e,t){const s=j(n,"x","spaceToBatchND");X(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),X(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),X(s.shape.reduce((a,o,l)=>l>0&&l<=e.length?a&&(o+t[l-1][0]+t[l-1][1])%e[l-1]===0:a,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:t};return le.runKernel(Ywe,r,i)}const xU=Q({spaceToBatchND_:I$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $$e(n,e,t,s,r,i,a){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const o=j(n,"x","maxPool");let l=o,u=!1;o.rank===3&&(u=!0,l=Ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),X(Ic(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const d=_Ee(l.shape,e,i,r,s),f=[d.dilationHeight,d.dilationWidth];let m;s==="same"?m=N$e([d.filterHeight,d.filterWidth],f):m=[[0,0],[0,0]];const y=f[0]===1&&f[1]===1,[b,w]=C$e([d.inHeight,d.inWidth],f,m),x=y?s:"valid",T=y?l:xU(l,f,b),$=(t==="avg"?()=>J4(T,e,i,x,a):()=>gU(T,e,i,x,a))(),C=y?$:eU($,f,w);return u?Ce(C,[C.shape[1],C.shape[2],C.shape[3]]):C}function C$e(n,e,t){const s=t.map(d=>d[0]),r=t.map(d=>d[1]),i=n.concat(s,r),a=e.map((d,f)=>(d-i[f]%d)%d),o=r.map((d,f)=>d+a[f]),l=e.map((d,f)=>[s[f],o[f]]),u=e.map((d,f)=>[0,a[f]]);return[l,u]}function N$e(n,e){const s=n.map((a,o)=>a+(a-1)*(e[o]-1)).map(a=>a-1),r=s.map(a=>Math.floor(a/2)),i=s.map((a,o)=>a-r[o]);return s.map((a,o)=>[r[o],i[o]])}const k$e=Q({pool_:$$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A$e(n,e){const t=j(n,"x","prelu"),s=j(e,"alpha","prelu"),r={x:t,alpha:s};return le.runKernel(Twe,r)}const vU=Q({prelu_:A$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R$e(n,e=null,t=!1){let s=j(n,"x","prod");s.dtype==="bool"&&(s=hs(s,"int32"));const r={x:s},i={axis:e,keepDims:t};return le.runKernel(Ewe,r,i)}const D$e=Q({prod_:R$e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O$e(n,e,t,s){const r=n.map((d,f)=>j(d,`tensors${f}`,"raggedGather","int32")),i=j(e,"paramsDenseValues","raggedGather"),a=j(t,"indices","raggedGather","int32"),o={paramsNestedSplits:r,paramsDenseValues:i,indices:a},l={outputRaggedRank:s},u=le.runKernel(_we,o,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const F$e=Q({raggedGather_:O$e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L$e(n,e,t,s,r){const i=j(n,"shape","raggedTensorToTensor","int32"),a=j(e,"values","raggedTensorToTensor"),o=j(t,"defaultValue","raggedTensorToTensor",a.dtype),l=s.map((f,m)=>j(f,`tensors${m}`,"raggedTensorToTensor","int32")),u={shape:i,values:a,defaultValue:o,rowPartitionTensors:l},d={rowPartitionTypes:r};return le.runKernel(Iwe,u,d)}const P$e=Q({raggedTensorToTensor_:L$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M$e(n,e,t){const s=Is(n);let r=null;if(t==null||t==="float32")r=new Float32Array(s);else if(t==="int32")r=new Int32Array(s);else if(t==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${t}`);for(let i=0;i<s;i++)r[i]=e();return le.makeTensor(r,n,t)}const V$e=Q({rand_:M$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NC{constructor(e,t,s,r,i){this.mean=e,this.stdDev=t,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=i||Math.random();this.random=af.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,t,s=!1;for(;!s;){let r,i,a;do r=2*this.random()-1,i=2*this.random()-1,a=r*r+i*i;while(a>=1||a===0);const o=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*r*o,t=this.mean+this.stdDev*i*o,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class B$e{constructor(e,t,s,r){this.alpha=e,this.beta=1/t,this.dtype=s;const i=r||Math.random();this.randu=af.alea(i.toString()),this.randn=new NC(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,s,r,i,a;for(;;){do r=this.randn.nextValue(),a=1+this.c*r;while(a<=0);if(a*=a*a,e=r*r,t=1-.331*e*e,s=.5*e+this.d*(1-a+Math.log(a)),i=this.randu(),i<t||Math.log(i)<s)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class z$e{constructor(e=0,t=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=af.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U$e(n,e,t=1,s="float32",r){if(t==null&&(t=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const i=new B$e(e,t,s,r),a=Bo(n,s);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const j$e=Q({randomGamma_:U$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W$e(n,e=0,t=1,s,r){if(s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new NC(e,t,s,!1,r),a=Bo(n,s);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const wU=Q({randomNormal_:W$e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G$e(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return wU(n,0,1,e,t)}const H$e=Q({randomStandardNormal_:G$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q$e(n,e=0,t=1,s="float32",r){const i=Bo(n,s),a=new z$e(e,t,null,r);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const SU=Q({randomUniform_:q$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cm(n,e,t=1,s="float32"){if(t===0)throw new Error("Cannot have a step of zero");const r={start:n,stop:e,step:t,dtype:s};return le.runKernel($we,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K$e(n){const t={x:j(n,"x","reciprocal")};return le.runKernel(Nwe,t)}const X$e=Q({reciprocal_:K$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$e(n){const t={x:j(n,"x","relu")};return le.runKernel(kwe,t)}const b1=Q({relu_:Y$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q$e(n){const t={x:j(n,"x","relu6")};return le.runKernel(Owe,t)}const TU=Q({relu6_:Q$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z$e(n,e){const s={x:j(n,"x","reverse")},r={dims:e};return le.runKernel(Fwe,s,r)}const Hu=Q({reverse_:Z$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$e(n){const e=j(n,"x","reverse");return X(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Hu(e,0)}const eCe=Q({reverse1d_:J$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tCe(n,e){const t=j(n,"x","reverse");return X(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),Hu(t,e)}const nCe=Q({reverse2d_:tCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sCe(n,e){const t=j(n,"x","reverse");return X(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),Hu(t,e)}const rCe=Q({reverse3d_:sCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iCe(n,e){const t=j(n,"x","reverse");return X(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),Hu(t,e)}const aCe=Q({reverse4d_:iCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oCe(n){const t={x:j(n,"x","round")};return le.runKernel(Lwe,t)}const EU=Q({round_:oCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lCe(n){const t={x:j(n,"x","rsqrt","float32")};return le.runKernel(Pwe,t)}const cCe=Q({rsqrt_:lCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uCe(n){const t={x:j(n,"x","selu")};return le.runKernel(zwe,t)}const hCe=Q({selu_:uCe});function dCe(n,e,t,s,r,i=[1,1],a="NHWC"){const o=j(n,"x","separableConv2d"),l=j(e,"depthwiseFilter","separableConv2d"),u=j(t,"pointwiseFilter","separableConv2d");let d=o,f=!1;if(o.rank===3&&(f=!0,d=Ce(o,[1,o.shape[0],o.shape[1],o.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");X(d.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${d.rank}.`),X(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),X(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),X(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),X(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const m=l.shape[2],y=l.shape[3];X(u.shape[2]===m*y,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${m*y}, but got ${u.shape[2]}.`);const b=EC(d,l,s,r,a,i),x=f1(b,u,1,"valid",a);return f?Ce(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const fCe=Q({separableConv2d_:dCe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function pCe(n,e){const t=j(n,"x","setdiff1d"),s=j(e,"y","setdiff1d");X(t.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${s.dtype}).`),X(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),X(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await t.data(),i=await s.data(),a=new Set(i);let o=0;for(let d=0;d<r.length;d++)a.has(r[d])||o++;const l=new mE([o],t.dtype),u=new mE([o],"int32");for(let d=0,f=0;d<r.length;d++)a.has(r[d])||(l.values[f]=r[d],u.values[f]=d,f++);return[l.toTensor(),u.toTensor()]}const mCe=pCe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gCe(n){const t={x:j(n,"x","sign")};return le.runKernel(Gwe,t)}const yCe=Q({sign_:gCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bCe(n){const t={x:j(n,"x","sin","float32")};return le.runKernel(jwe,t)}const xCe=Q({sin_:bCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vCe(n){const t={x:j(n,"x","sinh")};return le.runKernel(Wwe,t)}const wCe=Q({sinh_:vCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SCe(n,e,t){const s=j(n,"x","slice1d");return X(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),cn(s,[e],[t])}const TCe=Q({slice1d_:SCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ECe(n,e,t){const s=j(n,"x","slice2d");return X(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),cn(s,e,t)}const _Ce=Q({slice2d_:ECe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ICe(n,e,t){const s=j(n,"x","slice3d");return X(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),cn(s,e,t)}const $Ce=Q({slice3d_:ICe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CCe(n,e,t){const s=j(n,"x","slice4d");return X(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),cn(s,e,t)}const NCe=Q({slice4d_:CCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kCe(n,e=-1){const t=j(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const s={logits:t},r={dim:e};return le.runKernel(Zwe,s,r)}const ACe=Q({softmax_:kCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RCe(n){X(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return le.runKernel(k1e,e)}const kC=Q({fft_:RCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DCe(n){X(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return le.runKernel(B1e,e)}const gx=Q({ifft_:DCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OCe(n){const e=n.shape[n.shape.length-1],t=n.size/e;let s;if(e<=2){const r=Ce(n,[t,e]);s=gx(r)}else{const r=[t,2*(e-1)],i=Ce(Im(n),[t,e]),a=Ce(u1(n),[t,e]),o=Hu(cn(i,[0,1],[t,e-2]),1),l=dt(Hu(cn(a,[0,1],[t,e-2]),1),Yt(-1)),u=or([i,o],1),d=or([a,l],1),f=Ce(lc(u,d),[r[0],r[1]]);s=gx(f)}if(s=Im(s),n.rank===3&&n.shape[0]!==0){const r=s,i=n.shape[0];s=Ce(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const _U=Q({irfft_:OCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FCe(n,e,t=0){const r={x:j(n,"x","split")},i={numOrSizeSplits:e,axis:t};return le.runKernel(Qwe,r,i)}const Nm=Q({split_:FCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LCe(n,e){X(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const s=n.size/t;let r;if(e!=null&&e<t){const b=n.shape.map(x=>0),w=n.shape.map(x=>x);w[n.shape.length-1]=e,r=cn(n,b,w),t=e}else if(e!=null&&e>t){const b=n.shape.map(w=>w);b[n.shape.length-1]=e-t,r=or([n,Vd(b)],n.shape.length-1),t=e}else r=n;const i=_C(r),a=Ce(lc(r,i),[s,t]),o=kC(a),l=Math.floor(t/2)+1,u=Im(o),d=u1(o),f=Nm(u,[l,t-l],u.shape.length-1),m=Nm(d,[l,t-l],d.shape.length-1),y=r.shape.slice();return y[r.shape.length-1]=l,Ce(lc(f[0],m[0]),y)}const AC=Q({rfft_:LCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PCe(n,e){let t=j(n,"a","squaredDifference"),s=j(e,"b","squaredDifference");[t,s]=$n(t,s),fs(t.shape,s.shape);const r={a:t,b:s},i={};return le.runKernel(rSe,r,i)}const IU=Q({squaredDifference_:PCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MCe(n,e){const t=j(n,"x","squeeze","string_or_numeric");return Ce(t,wve(t.shape,e).newShape)}const RC=Q({squeeze_:MCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VCe(n,e=0){const t=cx(n,"tensors","stack","string_or_numeric");X(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&X(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const s=t,r={axis:e};return le.runKernel(vwe,s,r)}const Uo=Q({stack_:VCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BCe(n,e=0){const s={x:j(n,"x","step")},r={alpha:e};return le.runKernel(bSe,s,r)}const $U=Q({step_:BCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zCe(n,e,t,s,r=0,i=0,a=0,o=0,l=0){const d={x:j(n,"x","stridedSlice","string_or_numeric")},f={begin:e,end:t,strides:s,beginMask:r,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};return le.runKernel(iSe,d,f)}const UCe=Q({stridedSlice_:zCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jCe(n){const t={x:j(n,"x","tan","float32")};return le.runKernel(uSe,t)}const WCe=Q({tan_:jCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ei(n,e){bf(n);const t=Ec(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return _c(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xd(n,e,t){if(bf(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Ec(n,t);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return _c(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GCe(n,e,t){if(bf(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Ec(n,t);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return _c(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HCe(n,e,t){if(bf(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Ec(n,t);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return _c(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qCe(n,e,t){if(bf(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Ec(n,t);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,_c(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KCe(n,e=1,t=!0){const s=j(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},a={k:e,sorted:t},[o,l]=le.runKernel(dSe,i,a);return{values:o,indices:l}}const XCe=Q({topk_:KCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YCe(n,e=0,t=1,s,r){if(s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new NC(e,t,s,!0,r),a=Bo(n,s);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const QCe=Q({truncatedNormal_:YCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZCe(n,e=0){const t=j(n,"x","unique","string_or_numeric");X(t.rank>0,()=>"The input tensor must be at least 1D");const s={x:t},r={axis:e},[i,a]=le.runKernel(pSe,s,r);return{values:i,indices:a}}const JCe=Q({unique_:ZCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eNe(n,e,t){const s=j(n,"x","unsortedSegmentSum"),r=j(e,"segmentIds","unsortedSegmentSum","int32");X(_m(t),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},a={numSegments:t};return le.runKernel(gSe,i,a)}const tNe=Q({unsortedSegmentSum_:eNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nNe(n,e=0){const t=j(n,"x","unstack","string_or_numeric");X(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const s={value:t},r={axis:e};return le.runKernel(mSe,s,r)}const lh=Q({unstack_:nNe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sNe(n,e){return CC(n,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rNe(n,e=!0,t,s){return le.makeVariable(n,e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iNe(n,e){const t=[];for(let i=0;i<e.length;i++)e[i]&&t.push(i);const s=Bo(n,"int32"),r=Bo([t.length,n.length],"int32");for(let i=0;i<t.length;i++){const a=s.indexToLoc(t[i]),o=i*n.length;r.values.set(a,o)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function aNe(n){const e=j(n,"condition","whereAsync","bool"),t=await e.data(),s=iNe(e.shape,t);return n!==e&&e.dispose(),s}const CU=aNe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function oNe(n,e,t){const s=j(n,"tensor","boolMask"),r=j(e,"mask","boolMask","bool"),i=t??0,a=r.rank,o=s.shape;X(a>0,()=>"mask cannot be scalar"),ki(o.slice(i,i+a),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let w=i;w<i+a;w++)l*=o[w];const u=o.slice(0,i).concat([l],o.slice(i+a)),d=Ce(s,u),f=Ce(r,[-1]),m=await CU(f),y=RC(m,[1]),b=lU(d,y,i);return n!==s&&s.dispose(),e!==r&&r.dispose(),y.dispose(),d.dispose(),f.dispose(),m.dispose(),b}const lNe=oNe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cNe(n,e,t,s,r=!0){const i=j(n,"v","movingAverage"),a=j(e,"x","movingAverage"),o=j(t,"decay","movingAverage");PSe(i,a),X(oc(i.shape,a.shape),()=>"Shape mismatch in v and x");const l=Yt(1),u=Pt(l,o);let d=dt(Pt(a,i),u);if(r){X(s!=null,()=>"When using zeroDebias: true, step is required.");const f=j(s,"step","movingAverage");d=ir(d,Pt(l,IC(o,f)))}return ds(i,d)}const uNe=Q({movingAverage_:cNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hNe(n,e,t){const s=j(n,"indices","scatterND","int32"),r=j(e,"updates","scatterND");XTe(r,s,t);const i={indices:s,updates:r},a={shape:t};return le.runKernel(Mwe,i,a)}const dNe=Q({scatterND_:hNe});function fNe(n,e,t,s){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const r=n.rank>0?n.shape[0]:1,i=n.rank>1?n.shape[1]:1;if(t.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${i}.`);const a=e.size;if(!(e.rank===0||e.rank===1&&a===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pNe(n,e,t,s=0){const r=j(n,"sparseIndices","sparseToDense","int32"),i=j(e,"sparseValues","sparseToDense","string_or_numeric"),a=j(s,"defaultValue","sparseToDense",i.dtype);fNe(r,i,t,a);const o={sparseIndices:r,sparseValues:i,defaultValue:a},l={outputShape:t};return le.runKernel(sSe,o,l)}const mNe=Q({sparseToDense_:pNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gNe(n,e){const t=j(e,"indices","gatherND","int32"),r={params:j(n,"x","gatherND","string_or_numeric"),indices:t};return le.runKernel(P1e,r)}const yNe=Q({gatherND_:gNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bNe(n,e){if(e==null)return n.shape.slice();if(oc(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let s=0;s<n.shape.length;s++)e[s]==null&&n.shape[s]!=null?t.push(n.shape[s]):t.push(e[s]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xNe(n,e,t,s){const r=j(n,"x","dropout");if(X(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),X(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof Ps?r.clone():r;const i=bNe(r,t),a=1-e,o=ir(oU(ds(SU(i,0,1,"float32",s),a)),a);return dt(r,o)}const vNe=Q({dropout_:xNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function DC(n,e,t){const s=1-n%2,r=new Float32Array(n);for(let i=0;i<n;++i){const a=2*Math.PI*i/(n+s-1);r[i]=e-t*Math.cos(a)}return Ei(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function wNe(n,e,t=1){const s=j(n,"predictions","inTopK"),r=j(e,"targets","inTopK");X(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),X(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),ki(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=s.shape[s.shape.length-1];X(t>0&&t<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${t}`);const a=await s.data(),o=await r.data(),[l,u]=[a.length/i,i],d=Sve("bool",l);for(let f=0;f<l;f++){const m=f*u,y=a.subarray(m,m+u),b=[];for(let w=0;w<y.length;w++)b.push({value:y[w],index:w});b.sort((w,x)=>x.value-w.value),d[f]=0;for(let w=0;w<t;w++)if(b[w].index===o[f]){d[f]=1;break}}return n!==s&&s.dispose(),e!==r&&r.dispose(),Fa(d,r.shape,"bool")}const SNe=wNe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TNe(n,e,t,s,r,i="NHWC",a){let o=n;n.rank===3&&(o=Ce(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=Ce(e,[1,e.shape[0],e.shape[1],e.shape[2]])),X(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),X(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),X(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const u=i==="NHWC"?o.shape[3]:o.shape[1],d=i==="NHWC"?l.shape[3]:l.shape[1];X(u===t[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${t[2]}.`),X(d===t[3],()=>`Error in conv2dDerFilter: depth of dy (${d}) must match output depth for filter (${t[3]}).`),na("conv2dDerFilter",r,a);const f={x:o,dy:l},m={strides:s,pad:r,dataFormat:i,dimRoundingMode:a,filterShape:t};return le.runKernel(a1e,f,m)}const ENe=Q({conv2DBackpropFilter_:TNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OC(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return dt(n,$U(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function FC(n,e){let t=e;const s=HTe(n.shape,e.shape);return s.length>0&&(t=mn(t,s)),Ce(t,n.shape)}function LC(n,e,t,s){if(e==="linear")return n;if(e==="relu")return b1(n);if(e==="elu")return rU(n);if(e==="relu6")return TU(n);if(e==="prelu")return vU(n,t);if(e==="leakyrelu")return uU(n,s);if(e==="sigmoid")return yd(n);throw new Error(`Unknown fused activation ${e}.`)}const PC=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ne({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:d}){if(l=l||"linear",PC(le.state.gradientDepth,l)===!1){X(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let V=f1(n,e,t,s,r,i,a);return o!=null&&(V=ds(V,o)),LC(V,l,u,d)}const f=j(n,"x","conv2d","float32"),m=j(e,"filter","conv2d","float32");let y=f,b=!1;f.rank===3&&(b=!0,y=Ce(f,[1,f.shape[0],f.shape[1],f.shape[2]])),X(y.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${y.rank}.`),X(m.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${m.rank}.`),na("fused conv2d",s,a);const w=r==="NHWC"?y.shape[3]:y.shape[1];X(m.shape[2]===w,()=>`Error in conv2d: depth of input (${w}) must match input depth for filter ${m.shape[2]}.`),X(Ic(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const x=TC(y.shape,m.shape,t,i,s,a);let T;o!=null&&(T=j(o,"bias","fused conv2d"),[T]=$n(T,f),r==="NHWC"?fs(x.outShape,T.shape):(X(T.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${T.shape.length}.`),X(T.shape.length===0||T.shape[0]===x.outChannels||T.shape[0]===1,()=>`Error in fused conv2d: bias shape (${T.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let E;if(u!=null){const V=u.shape;if(X(V.length<=1||V.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${V.length}.`),V.length===1)X(V[0]===1||V[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${V}) is not compatible with the number of output channels (${x.outChannels}).`);else if(V.length===3)try{fs(V,x.outShape)}catch{const R=`Error in fused conv2d: PReLU activation weights (${V}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(R)}E=j(u,"prelu weights","fused conv2d")}const $=(V,F)=>{X(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[R,N,D,k]=F,z=OC(V,D,l);X(fx(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const B=nU(N.shape,z,R,t,s),ne=ENe(N,z,R.shape,t,s),J=[B,ne];if(k!=null){const K=FC(k,z);J.push(K)}return J},C={x:y,filter:m,bias:T,preluActivationWeights:E},O={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a,activation:l,leakyreluAlpha:d};return o==null?zo((F,R,N)=>{let D=le.runKernel(rO,C,O);return N([R,F,D]),b&&(D=Ce(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:$}})(y,m):zo((F,R,N,D)=>{let k=le.runKernel(rO,C,O);return D([R,F,k,N]),b&&(k=Ce(k,[k.shape[1],k.shape[2],k.shape[3]])),{value:k,gradFunc:$}})(y,m,T)}const INe=Q({fusedConv2d_:_Ne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ne(n,e,t,s,r,i=[1,1],a){let o=n;n.rank===3&&(o=Ce(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=Ce(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:o,dy:l},d={strides:s,pad:r,dimRoundingMode:a,dilations:i,filterShape:t};return le.runKernel(b1e,u,d)}const CNe=Q({depthwiseConv2dNativeBackpropFilter_:$Ne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NNe(n,e,t,s,r,i=[1,1],a){let o=e,l=!1;e.rank===3&&(l=!0,o=Ce(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:o,filter:t},d={strides:s,pad:r,dimRoundingMode:a,dilations:i,inputShape:n},f=le.runKernel(x1e,u,d);return l?Ce(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const kNe=Q({depthwiseConv2dNativeBackpropInput_:NNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ANe({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:d}){if(PC(le.state.gradientDepth,l)===!1){let O=EC(n,e,t,s,r,i,a);return o!=null&&(O=ds(O,o)),LC(O,l,u,d)}const f=j(n,"x","depthwiseConv2d","float32"),m=j(e,"filter","depthwiseConv2d","float32");let y=f,b=!1;f.rank===3&&(b=!0,y=Ce(f,[1,f.shape[0],f.shape[1],f.shape[2]])),X(y.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${y.rank}.`),X(m.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${m.rank}.`),X(y.shape[3]===m.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${y.shape[3]}) must match the inChannels dimension in filter ${m.shape[2]}.`),i==null&&(i=[1,1]),X(Ic(t,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),na("fused depthwiseConv2d",s,a);const w=TC(y.shape,m.shape,t,i,s,a,!0);let x;o!=null&&(x=j(o,"bias","fused conv2d"),[x]=$n(x,f),fs(w.outShape,x.shape));let T;u!=null&&(T=j(u,"prelu weights","fused depthwiseConv2d"));const E=(O,V)=>{X(fx(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[F,R,N,D]=V,k=OC(O,N,l),z=kNe(R.shape,k,F,t,s,i,a),B=CNe(R,k,F.shape,t,s,i,a);if(D!=null){const ne=FC(x,k);return[z,B,ne]}return[z,B]},$={x:y,filter:m,bias:x,preluActivationWeights:T},C={strides:t,pad:s,dataFormat:r,dilations:i,dimRoundingMode:a,activation:l,leakyreluAlpha:d};return o==null?zo((V,F,R)=>{let N=le.runKernel(iO,$,C);return R([F,V,N]),b&&(N=Ce(N,[N.shape[1],N.shape[2],N.shape[3]])),{value:N,gradFunc:E}})(y,m):zo((V,F,R,N)=>{let D=le.runKernel(iO,$,C);return N([F,V,D,R]),b&&(D=Ce(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:E}})(y,m,x)}const RNe=Q({fusedDepthwiseConv2d_:ANe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DNe({a:n,b:e,transposeA:t=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:a,leakyreluAlpha:o=.2}){if(PC(le.state.gradientDepth,i)===!1){let k=Zt(n,e,t,s);return r!=null&&(k=ds(k,r)),LC(k,i,a,o)}let l=j(n,"a","fused matMul"),u=j(e,"b","fused matMul");[l,u]=$n(l,u);const d=t?l.shape[l.rank-2]:l.shape[l.rank-1],f=s?u.shape[u.rank-1]:u.shape[u.rank-2],m=t?l.shape[l.rank-1]:l.shape[l.rank-2],y=s?u.shape[u.rank-2]:u.shape[u.rank-1],b=l.shape.slice(0,-2),w=u.shape.slice(0,-2),x=Is(b),T=Is(w);X(d===f,()=>`Error in fused matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${t} and transposeB=${s} must match.`);const $=fs(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([m,y]),C=t?Ce(l,[x,d,m]):Ce(l,[x,m,d]),O=s?Ce(u,[T,y,f]):Ce(u,[T,f,y]);let V;r!=null&&(V=j(r,"bias","fused matMul"),[V]=$n(V,l),fs($,V.shape));let F;a!=null&&(F=j(a,"prelu weights","fused matMul"));const R=(k,z)=>{const[B,ne,J,K]=z,re=OC(Ce(k,J.shape),J,i);let Z,he;if(!t&&!s?(Z=Zt(re,ne,!1,!0),he=Zt(B,re,!0,!1)):!t&&s?(Z=Zt(re,ne,!1,!1),he=Zt(re,B,!0,!1)):t&&!s?(Z=Zt(ne,re,!1,!0),he=Zt(B,re,!1,!1)):(Z=Zt(ne,re,!0,!0),he=Zt(re,B,!0,!0)),r!=null){const W=FC(K,re);return[Z,he,W]}else return[Z,he]},N={a:C,b:O,bias:V,preluActivationWeights:F},D={transposeA:t,transposeB:s,activation:i,leakyreluAlpha:o};return r==null?zo((z,B,ne)=>{const J=le.runKernel(sO,N,D);return ne([z,B,J]),{value:Ce(J,$),gradFunc:R}})(C,O):zo((z,B,ne,J)=>{const K=le.runKernel(sO,N,D);return J([z,B,K,ne]),{value:Ce(K,$),gradFunc:R}})(C,O,V)}const ONe=Q({fusedMatMul_:DNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FNe=Object.freeze(Object.defineProperty({__proto__:null,conv2d:INe,depthwiseConv2d:RNe,matMul:ONe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LNe(n){return DC(n,.54,.46)}const PNe=Q({hammingWindow_:LNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MNe(n){return DC(n,.5,.5)}const kU=Q({hannWindow_:MNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VNe(n,e,t,s=!1,r=0){let i=0;const a=[];for(;i+e<=n.size;)a.push(cn(n,i,e)),i+=t;if(s)for(;i<n.size;){const o=i+e-n.size,l=or([cn(n,i,e-o),d1([o],r)]);a.push(l),i+=t}return a.length===0?xd([],[0,e]):Ce(or(a),[a.length,e])}const AU=Q({frame_:VNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BNe(n,e,t,s,r=kU){s==null&&(s=NU(e));const i=AU(n,e,t),a=dt(i,r(e));return AC(a,s)}const zNe=Q({stft_:BNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UNe(n,e,t,s,r="bilinear",i=0){const a=j(n,"image","cropAndResize"),o=j(e,"boxes","cropAndResize","float32"),l=j(t,"boxInd","cropAndResize","int32"),u=o.shape[0];X(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),X(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`),X(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`),X(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),X(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),X(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const d={image:a,boxes:o,boxInd:l},f={method:r,extrapolationValue:i,cropSize:s};return le.runKernel(p1e,d,f)}const jNe=Q({cropAndResize_:UNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WNe(n){const e=j(n,"image","flipLeftRight","float32");X(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return le.runKernel(R1e,t,{})}const GNe=Q({flipLeftRight_:WNe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HNe(n){const e=j(n,"image","grayscaleToRGB"),t=e.rank-1,s=e.shape[t];X(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),X(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,t),r[t]=3,tm(e,r)}const qNe=Q({grayscaleToRGB_:HNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KNe(n,e,t=0,s=.5){const r=j(n,"image","rotateWithOffset","float32");X(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},a={radians:e,fillValue:t,center:s};return le.runKernel(xSe,i,a)}const XNe=Q({rotateWithOffset_:KNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xf(n,e,t,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const a=n.shape[0];return t=Math.min(t,a),X(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),X(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),X(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),X(e.rank===1,()=>"scores must be a 1D tensor"),X(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${e.shape[0]}`),X(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YNe(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const i=j(n,"boxes","nonMaxSuppression","float32"),a=j(e,"scores","nonMaxSuppression","float32"),o=xf(i,a,t,s,r);t=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l={maxOutputSize:t,iouThreshold:s,scoreThreshold:r};return le.runKernel(mwe,{boxes:i,scores:a},l)}const QNe=Q({nonMaxSuppression_:YNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZNe(n,e,t){const s=JNe(n,e,t),r=s<0?-(s+1):s;n.splice(r,0,e)}function JNe(n,e,t){return tke(n,e,t||eke)}function eke(n,e){return n>e?1:n<e?-1:0}function tke(n,e,t){let s=0,r=n.length,i=0,a=!1;for(;s<r;){i=s+(r-s>>>1);const o=t(e,n[i]);o>0?s=i+1:(r=i,a=!o)}return a?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nke(n,e,t,s,r){return MC(n,e,t,s,r,0)}function ske(n,e,t,s,r,i){return MC(n,e,t,s,r,0,!1,i,!0)}function rke(n,e,t,s,r,i){return MC(n,e,t,s,r,i,!0)}function MC(n,e,t,s,r,i,a=!1,o=!1,l=!1){const u=[];for(let x=0;x<e.length;x++)e[x]>r&&u.push({score:e[x],boxIndex:x,suppressBeginIndex:0});u.sort(bO);const d=i>0?-.5/i:0,f=[],m=[];for(;f.length<t&&u.length>0;){const x=u.pop(),{score:T,boxIndex:E,suppressBeginIndex:$}=x;if(T<r)break;let C=!1;for(let O=f.length-1;O>=$;--O){const V=ike(n,E,f[O]);if(V>=s){C=!0;break}if(x.score=x.score*ake(s,d,V),x.score<=r)break}x.suppressBeginIndex=f.length,C||(x.score===T?(f.push(E),m.push(x.score)):x.score>r&&ZNe(u,x,bO))}const y=f.length,b=t-y;o&&b>0&&(f.push(...new Array(b).fill(0)),m.push(...new Array(b).fill(0)));const w={selectedIndices:f};return a&&(w.selectedScores=m),l&&(w.validOutputs=y),w}function ike(n,e,t){const s=n.subarray(e*4,e*4+4),r=n.subarray(t*4,t*4+4),i=Math.min(s[0],s[2]),a=Math.min(s[1],s[3]),o=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),u=Math.min(r[0],r[2]),d=Math.min(r[1],r[3]),f=Math.max(r[0],r[2]),m=Math.max(r[1],r[3]),y=(o-i)*(l-a),b=(f-u)*(m-d);if(y<=0||b<=0)return 0;const w=Math.max(i,u),x=Math.max(a,d),T=Math.min(o,f),E=Math.min(l,m),$=Math.max(T-w,0)*Math.max(E-x,0);return $/(y+b-$)}function ake(n,e,t){const s=Math.exp(e*t*t);return t<=n?s:0}function bO(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function oke(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const i=j(n,"boxes","nonMaxSuppressionAsync"),a=j(e,"scores","nonMaxSuppressionAsync"),o=xf(i,a,t,s,r);t=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l=await Promise.all([i.data(),a.data()]),u=l[0],d=l[1],{selectedIndices:f}=nke(u,d,t,s,r);return i!==n&&i.dispose(),a!==e&&a.dispose(),Ei(f,"int32")}const lke=oke;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cke(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const a=j(n,"boxes","nonMaxSuppression"),o=j(e,"scores","nonMaxSuppression"),l=xf(a,o,t,s,r,i);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const u={boxes:a,scores:o},d={maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},f=le.runKernel(ywe,u,d);return{selectedIndices:f[0],selectedScores:f[1]}}const uke=Q({nonMaxSuppressionWithScore_:cke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hke(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const a=j(n,"boxes","nonMaxSuppressionAsync"),o=j(e,"scores","nonMaxSuppressionAsync"),l=xf(a,o,t,s,r,i);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const u=await Promise.all([a.data(),o.data()]),d=u[0],f=u[1],{selectedIndices:m,selectedScores:y}=rke(d,f,t,s,r,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:Ei(m,"int32"),selectedScores:Ei(y)}}const dke=hke;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fke(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const a=j(n,"boxes","nonMaxSuppression"),o=j(e,"scores","nonMaxSuppression"),l=xf(a,o,t,s,r,null),u=l.maxOutputSize,d=l.iouThreshold,f=l.scoreThreshold,m={boxes:a,scores:o},y={maxOutputSize:u,iouThreshold:d,scoreThreshold:f,padToMaxOutputSize:i},b=le.runKernel(gwe,m,y);return{selectedIndices:b[0],validOutputs:b[1]}}const pke=Q({nonMaxSuppressionPadded_:fke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function mke(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const a=j(n,"boxes","nonMaxSuppressionAsync"),o=j(e,"scores","nonMaxSuppressionAsync"),l=xf(a,o,t,s,r,null),u=l.maxOutputSize,d=l.iouThreshold,f=l.scoreThreshold,[m,y]=await Promise.all([a.data(),o.data()]),{selectedIndices:b,validOutputs:w}=ske(m,y,u,d,f,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:Ei(b,"int32"),validOutputs:Yt(w,"int32")}}const gke=mke;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yke(n,e,t=!1,s=!1){const r=j(n,"images","resizeBilinear");X(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),X(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),X(s===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,a=!1;r.rank===3&&(a=!0,i=Ce(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:s,size:e},u=le.runKernel(Dwe,o,l);return a?Ce(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const bke=Q({resizeBilinear_:yke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xke(n,e,t=!1,s=!1){const r=j(n,"images","resizeNearestNeighbor");X(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),X(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),X(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),X(s===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,a=!1;r.rank===3&&(a=!0,i=Ce(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:i},l={alignCorners:t,halfPixelCenters:s,size:e},u=le.runKernel(Rwe,o,l);return a?Ce(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const vke=Q({resizeNearestNeighbor_:xke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wke(n,e="binary",t=!1,s=.5){const r=j(n,"image","threshold"),i=.2989,a=.587,o=.114,l=r.shape[0]*r.shape[1];let u=dt(Ei([s]),255),d,f,m,y;if(X(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),X(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),X(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),X(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[d,f,m]=Nm(r,[1,1,1],-1);const x=dt(d,i),T=dt(f,a),E=dt(m,o);y=ds(ds(x,T),E)}else y=n;if(e==="otsu"){const x=tU(hs(EU(y),"int32"),Fa([]),256);u=Ske(x,l)}const b=t?$C(y,u):y1(y,u);return hs(dt(b,255),"int32")}function Ske(n,e){let t=Ei([-1]),s=Ei([0]),r=Ei([0]),i,a,o,l,u,d;for(let f=0;f<n.size-1;f++){i=cn(n,0,f+1),a=cn(n,f+1),u=ir(mn(i),e),d=ir(mn(a),e);const m=mn(dt(i,Cm(0,i.size)));o=ir(m,mn(i));const y=d1(a.shape,i.size),b=ds(Cm(0,a.size),y),w=dt(a,b);l=ir(mn(w),mn(a));const x=Pt(o,l),T=Pt(o,l),E=dt(u,d);r=dt(dt(E,x),T);const $=y1(r,s);s=Md($,r,s),t=Md($,Ei([f]),t)}return t}const Tke=Q({threshold_:wke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eke(n,e,t="nearest",s="constant",r=0,i){const a=j(n,"image","transform","float32"),o=j(e,"transforms","transform","float32");X(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),X(o.rank===2&&(o.shape[0]===a.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),X(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:a,transforms:o},u={interpolation:t,fillMode:s,fillValue:r,outputShape:i};return le.runKernel(fSe,l,u)}const _ke=Q({transform_:Eke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ike(n,e,t){X(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),X(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`);const s=j(n,"a","bandPart");X(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,a]=s.shape.slice(-2);if(!(e<=i))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`);if(!(t<=a))throw new Error(`bandPart(): numUpper (${t}) must not be greater than the number of columns (${a}).`);e<0&&(e=i),t<0&&(t=a);const o=Ce(Cm(0,i,1,"int32"),[-1,1]),l=Cm(0,a,1,"int32"),u=Pt(o,l),d=px($C(u,Yt(+e,"int32")),cU(u,Yt(-t,"int32"))),f=Vd([i,a],s.dtype);return Ce(Uo(lh(Ce(s,[-1,i,a])).map(m=>Md(d,m,f))),r)}const $ke=Q({bandPart_:Ike});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cke(n){let e;if(Array.isArray(n)){e=!1,X(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=n[0].shape[0];for(let i=1;i<n.length;++i)X(n[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[i].shape[0]} vs. ${r})`)}else e=!0,n=Nm(n,n.shape[0],0).map(r=>RC(r,[0]));X(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],s=n;for(let r=0;r<n.length;++r)t.push(le.tidy(()=>{let i=s[r];if(r>0)for(let a=0;a<r;++a){const o=dt(mn(dt(t[a],i)),t[a]);i=Pt(i,o)}return ir(i,g1(i,"euclidean"))}));return e?Uo(t,0):t}const Nke=Q({gramSchmidt_:Cke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kke(n,e=!1){if(X(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return xO(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,u)=>l*u),s=lh(Ce(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[u,d]=xO(l,e);r.push(u),i.push(d)});const a=Ce(Uo(r,0),n.shape),o=Ce(Uo(i,0),n.shape);return[a,o]}}function xO(n,e=!1){return le.tidy(()=>{X(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],s=n.shape[1];let r=aU(t),i=ec(n);const a=xd([[1]],[1,1]);let o=ec(a);const l=t>=s?s:t;for(let u=0;u<l;++u){const d=i,f=o,m=r;[o,i,r]=le.tidy(()=>{const y=cn(i,[u,u],[t-u,1]),b=g1(y),w=cn(i,[u,u],[1,1]),x=Md(y1(w,0),xd([[-1]]),xd([[1]])),T=Pt(w,dt(x,b)),E=ir(y,T);E.shape[0]===1?o=ec(a):o=or([a,cn(E,[1,0],[E.shape[0]-1,E.shape[1]])],0);const $=Ro(ir(Zt(x,T),b)),C=cn(i,[u,0],[t-u,s]),O=dt($,o),V=IE(o);if(u===0)i=Pt(C,Zt(O,Zt(V,C)));else{const N=Pt(C,Zt(O,Zt(V,C)));i=or([cn(i,[0,0],[u,s]),N],0)}const F=IE(O),R=cn(r,[0,u],[t,r.shape[1]-u]);if(u===0)r=Pt(R,Zt(Zt(R,o),F));else{const N=Pt(R,Zt(Zt(R,o),F));r=or([cn(r,[0,0],[t,u]),N],1)}return[o,i,r]}),zTe([d,f,m])}return!e&&t>s&&(r=cn(r,[0,0],[t,s]),i=cn(i,[0,0],[s,s])),[r,i]})}const Ake=Q({qr_:kke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var vr;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(vr||(vr={}));function Rke(n,e,t=vr.SUM_BY_NONZERO_WEIGHTS){const s=j(n,"losses","computeWeightedLoss");let r=null;e!=null&&(r=j(e,"weights","computeWeightedLoss"));const i=r==null?s:dt(s,r);if(t===vr.NONE)return i;if(t===vr.SUM)return mn(i);if(t===vr.MEAN){if(r==null)return mx(i);{const a=s.size/r.size,o=ir(mn(i),mn(r));return a>1?ir(o,Yt(a)):o}}if(t===vr.SUM_BY_NONZERO_WEIGHTS){if(r==null)return ir(mn(i),Yt(s.size));{const a=dt(r,yu(s.shape)),o=hs(mn(bU(a,Yt(0))),"float32");return ir(mn(i),o)}}throw Error(`Unknown reduction: ${t}`)}const Xo=Q({computeWeightedLoss_:Rke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dke(n,e,t,s=vr.SUM_BY_NONZERO_WEIGHTS){const r=j(n,"labels","absoluteDifference"),i=j(e,"predictions","absoluteDifference");let a=null;t!=null&&(a=j(t,"weights","absoluteDifference")),ki(r.shape,i.shape,"Error in absoluteDifference: ");const o=xi(Pt(r,i));return Xo(o,a,s)}const Oke=Q({absoluteDifference_:Dke});function Fke(n,e,t,s,r=vr.SUM_BY_NONZERO_WEIGHTS){const i=j(n,"labels","cosineDistance"),a=j(e,"predictions","cosineDistance");let o=null;s!=null&&(o=j(s,"weights","cosineDistance")),ki(i.shape,a.shape,"Error in cosineDistance: ");const l=Yt(1),u=Pt(l,mn(dt(i,a),t,!0));return Xo(u,o,r)}const Lke=Q({cosineDistance_:Fke});function Pke(n,e,t,s=vr.SUM_BY_NONZERO_WEIGHTS){let r=j(n,"labels","hingeLoss");const i=j(e,"predictions","hingeLoss");let a=null;t!=null&&(a=j(t,"weights","hingeLoss")),ki(r.shape,i.shape,"Error in hingeLoss: ");const o=Yt(1);r=Pt(dt(Yt(2),r),o);const l=b1(Pt(o,dt(r,i)));return Xo(l,a,s)}const Mke=Q({hingeLoss_:Pke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vke(n,e,t,s=1,r=vr.SUM_BY_NONZERO_WEIGHTS){const i=j(n,"labels","huberLoss"),a=j(e,"predictions","huberLoss");let o=null;t!=null&&(o=j(t,"weights","huberLoss")),ki(i.shape,a.shape,"Error in huberLoss: ");const l=Yt(s),u=xi(Pt(a,i)),d=yU(u,l),f=Pt(u,d),m=ds(dt(Yt(.5),m1(d)),dt(l,f));return Xo(m,o,r)}const Bke=Q({huberLoss_:Vke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zke(n,e,t,s=1e-7,r=vr.SUM_BY_NONZERO_WEIGHTS){const i=j(n,"labels","logLoss"),a=j(e,"predictions","logLoss");let o=null;t!=null&&(o=j(t,"weights","logLoss")),ki(i.shape,a.shape,"Error in logLoss: ");const l=Yt(1),u=Yt(s),d=Ro(dt(i,$m(ds(a,u)))),f=dt(Pt(l,i),$m(ds(Pt(l,a),u))),m=Pt(d,f);return Xo(m,o,r)}const Uke=Q({logLoss_:zke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jke(n,e,t,s=vr.SUM_BY_NONZERO_WEIGHTS){const r=j(n,"labels","meanSquaredError"),i=j(e,"predictions","meanSquaredError");let a=null;t!=null&&(a=j(t,"weights","meanSquaredError")),ki(r.shape,i.shape,"Error in meanSquaredError: ");const o=IU(r,i);return Xo(o,a,s)}const Wke=Q({meanSquaredError_:jke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gke(n,e){const t=j(n,"labels","sigmoidCrossEntropyWithLogits"),s=j(e,"logits","sigmoidCrossEntropyWithLogits");ki(t.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=b1(s),i=dt(s,t),a=hU(Gu(Ro(xi(s))));return ds(Pt(r,i),a)}function Hke(n,e,t,s=0,r=vr.SUM_BY_NONZERO_WEIGHTS){let i=j(n,"multiClassLabels","sigmoidCrossEntropy");const a=j(e,"logits","sigmoidCrossEntropy");let o=null;if(t!=null&&(o=j(t,"weights","sigmoidCrossEntropy")),ki(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),s>0){const u=Yt(s),d=Yt(1),f=Yt(.5);i=ds(dt(i,Pt(d,u)),dt(f,u))}const l=Gke(i,a);return Xo(l,o,r)}const qke=Q({sigmoidCrossEntropy_:Hke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kke(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return zo((r,i,a)=>{const l=fU(i,[t],!0),u=Pt(hs(i,"float32"),l);a([r,u]);const d=Ro(dt(u,r));return{value:mn(d,[t]),gradFunc:(y,b)=>{const[w,x]=b,T=p1(y.shape,[t]);return[dt(Ce(y,T),Pt(hs(w,"float32"),Gu(x))),dt(Ce(y,T),Pt(Gu(x),hs(w,"float32")))]}}})(n,e)}function Xke(n,e,t,s=0,r=vr.SUM_BY_NONZERO_WEIGHTS){let i=j(n,"onehotLabels","softmaxCrossEntropy");const a=j(e,"logits","softmaxCrossEntropy");let o=null;if(t!=null&&(o=j(t,"weights","softmaxCrossEntropy")),ki(i.shape,a.shape,"Error in softmaxCrossEntropy: "),s>0){const u=Yt(s),d=Yt(1),f=Yt(i.shape[1]);i=ds(dt(i,Pt(d,u)),ir(u,f))}const l=Kke(i,a);return Xo(l,o,r)}const Yke=Q({softmaxCrossEntropy_:Xke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qke(n,e,t,s){const r=j(n,"indices","sparseFillEmptyRows","int32"),i=j(e,"values","sparseFillEmptyRows"),a=j(t,"denseShape","sparseFillEmptyRows","int32"),o=j(s,"defaultValue","sparseFillEmptyRows",i.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(a.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:r,values:i,denseShape:a,defaultValue:o},u=le.runKernel(Jwe,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const Zke=Q({sparseFillEmptyRows_:Qke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jke(n,e,t){const s=j(n,"inputIndices","sparseReshape","int32"),r=j(e,"inputShape","sparseReshape","int32"),i=j(t,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const a={inputIndices:s,inputShape:r,newShape:i},o=le.runKernel(eSe,a);return{outputIndices:o[0],outputShape:o[1]}}const e2e=Q({sparseReshape_:Jke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t2e(n,e,t){const s=j(n,"data","sparseSegmentMean"),r=j(e,"indices","sparseSegmentMean","int32"),i=j(t,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const a={data:s,indices:r,segmentIds:i};return le.runKernel(tSe,a)}const n2e=Q({sparseSegmentMean_:t2e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s2e(n,e,t){const s=j(n,"data","sparseSegmentSum"),r=j(e,"indices","sparseSegmentSum","int32"),i=j(t,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const a={data:s,indices:r,segmentIds:i};return le.runKernel(nSe,a)}const r2e=Q({sparseSegmentSum_:s2e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i2e(n,e,t,s,r,i,a,o){const l=j(n,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=j(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const d={separator:t,nGramWidths:s,leftPad:r,rightPad:i,padWidth:a,preserveShortSequences:o},f={data:l,dataSplits:u},m=le.runKernel(aSe,f,d);return{nGrams:m[0],nGramsSplits:m[1]}}const a2e=Q({stringNGrams_:i2e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o2e(n,e,t=!0){const s=j(n,"input","stringSplit","string"),r=j(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const i={skipEmpty:t},a={input:s,delimiter:r},o=le.runKernel(oSe,a,i);return{indices:o[0],values:o[1],shape:o[2]}}const l2e=Q({stringSplit_:o2e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c2e(n,e){const t=j(n,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:t};return le.runKernel(lSe,r,s)}const u2e=Q({stringToHashBucketFast_:c2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h2e={fft:kC,ifft:gx,rfft:AC,irfft:_U},d2e={hammingWindow:PNe,hannWindow:kU,frame:AU,stft:zNe},f2e={flipLeftRight:GNe,grayscaleToRGB:qNe,resizeNearestNeighbor:vke,resizeBilinear:bke,rotateWithOffset:XNe,cropAndResize:jNe,nonMaxSuppression:QNe,nonMaxSuppressionAsync:lke,nonMaxSuppressionWithScore:uke,nonMaxSuppressionWithScoreAsync:dke,nonMaxSuppressionPadded:pke,nonMaxSuppressionPaddedAsync:gke,threshold:Tke,transform:_ke},p2e={bandPart:$ke,gramSchmidt:Nke,qr:Ake},m2e={absoluteDifference:Oke,computeWeightedLoss:Xo,cosineDistance:Lke,hingeLoss:Mke,huberLoss:Bke,logLoss:Uke,meanSquaredError:Wke,sigmoidCrossEntropy:qke,softmaxCrossEntropy:Yke},g2e={sparseFillEmptyRows:Zke,sparseReshape:e2e,sparseSegmentMean:n2e,sparseSegmentSum:r2e},y2e={stringNGrams:a2e,stringSplit:l2e,stringToHashBucketFast:u2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b2e=Dt();b2e.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var yi;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(yi||(yi={}));var vO;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(vO||(vO={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x2e={};function RU(n){return x2e[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L(n,e,t,s,r){const i=e.inputParams[n];if(i&&i.inputIndexStart!==void 0){const o=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?o+1:i.inputIndexEnd;if(i.type==="tensor")return sr(e.inputNames[i.inputIndexStart],t,s,r);if(i.type==="tensors")return e.inputNames.slice(o,l).map(m=>sr(m,t,s,r));const u=sr(e.inputNames.slice(o)[0],t,s,r),d=u.dataSync();return i.type==="number"?d[0]:pE(u.shape,d)}const a=e.attrParams[n];return a&&a.value}function sr(n,e,t,s){const[r,i]=Nr(n);if(s!=null){const o=s.getHashTableHandleByName(r);if(o!=null)return o}const a=t.currentContextIds.find(o=>!!e[yx(r,o)]);return a!==void 0?e[yx(r,a)][i]:void 0}function v2e(n,e,t){return e[yx(n,t.currentContextId)]}function Ea(n,e){const[t,s,r]=Nr(n);return[yx(t,e&&e.currentContextId),s,r]}function yx(n,e){return e?`${n}-${e}`:n}function Nr(n){const e=n.split(":");if(e.length===1)return[n,0,void 0];const t=e[0],s=e.length===3?e[1]:void 0,r=Number(e[e.length-1]);return[t,r,s]}function v0(n,e,t){let s=L("pad",n,e,t);if(s==="explicit"){s=L("explicitPaddings",n,e,t);const r=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)r[i][0]=s[i*2],r[i][1]=s[i*2+1];return r}return s}function So(n){return n.kept?n:ec(n)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w2e=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],S2e=Object.freeze(Object.defineProperty({__proto__:null,json:w2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T2e=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],E2e=Object.freeze(Object.defineProperty({__proto__:null,json:T2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _2e=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],I2e=Object.freeze(Object.defineProperty({__proto__:null,json:_2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $2e=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],C2e=Object.freeze(Object.defineProperty({__proto__:null,json:$2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N2e=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],k2e=Object.freeze(Object.defineProperty({__proto__:null,json:N2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A2e=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],R2e=Object.freeze(Object.defineProperty({__proto__:null,json:A2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D2e=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],O2e=Object.freeze(Object.defineProperty({__proto__:null,json:D2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F2e=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],L2e=Object.freeze(Object.defineProperty({__proto__:null,json:F2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P2e=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],M2e=Object.freeze(Object.defineProperty({__proto__:null,json:P2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V2e=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],B2e=Object.freeze(Object.defineProperty({__proto__:null,json:V2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z2e=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],U2e=Object.freeze(Object.defineProperty({__proto__:null,json:z2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j2e=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],W2e=Object.freeze(Object.defineProperty({__proto__:null,json:j2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G2e=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],H2e=Object.freeze(Object.defineProperty({__proto__:null,json:G2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q2e=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],K2e=Object.freeze(Object.defineProperty({__proto__:null,json:q2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X2e=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],Y2e=Object.freeze(Object.defineProperty({__proto__:null,json:X2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q2e=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Z2e=Object.freeze(Object.defineProperty({__proto__:null,json:Q2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J2e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],eAe=Object.freeze(Object.defineProperty({__proto__:null,json:J2e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tAe=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],nAe=Object.freeze(Object.defineProperty({__proto__:null,json:tAe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sAe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],rAe=Object.freeze(Object.defineProperty({__proto__:null,json:sAe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wO{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[S2e,E2e,I2e,C2e,k2e,R2e,O2e,L2e,M2e,B2e,U2e,W2e,H2e,K2e,Y2e,Z2e,eAe,nAe,rAe],t=[].concat(...e.map(s=>s.json));this.opMappers=t.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,t={}){const s=e.node,r=[],i=[],a=[],o=s.reduce((w,x)=>(w[x.name]=this.mapNode(x),x.op.startsWith("Placeholder")?r.push(w[x.name]):x.op==="Const"?i.push(w[x.name]):(x.input==null||x.input.length===0)&&a.push(w[x.name]),w),{});let l=[];const u=[];let d={},f={};t!=null&&(d=this.mapSignatureEntries(t.inputs),f=this.mapSignatureEntries(t.outputs));const m=Object.keys(o);m.forEach(w=>{const x=o[w];x.inputNames.forEach((T,E)=>{const[$,,C]=Ea(T),O=o[$];if(O.outputs!=null){const V=O.outputs.indexOf(C);if(V!==-1){const F=`${$}:${V}`;x.inputNames[E]=F}}x.inputs.push(O),O.children.push(x)})}),Object.keys(f).length===0?m.forEach(w=>{const x=o[w];x.children.length===0&&u.push(x)}):Object.keys(f).forEach(w=>{const[x]=Ea(w),T=o[x];T!=null&&(T.signatureKey=f[w],u.push(T))}),Object.keys(d).length>0?Object.keys(d).forEach(w=>{const[x]=Ea(w),T=o[x];T&&(T.signatureKey=d[w],l.push(T))}):l=r;let y={};e.library!=null&&e.library.function!=null&&(y=e.library.function.reduce((w,x)=>(w[x.signature.name]=this.mapFunction(x),w),{}));const b={nodes:o,inputs:l,outputs:u,weights:i,placeholders:r,signature:t,functions:y};return a.length>0&&(b.initNodes=a),b}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,s)=>(t[e[s].name]=s,t),{})}mapNode(e){const t=RU(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(s.inputParams=t.inputs.reduce((r,i)=>(r[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},r),{})),t.attrs!=null&&(s.attrParams=t.attrs.reduce((r,i)=>{const a=i.type;let o;switch(i.type){case"string":o=AE(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=AE(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":o=ME(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=ME(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":o=DE(e.attr,i.tfName,i.defaultValue||0),o===void 0&&i.tfDeprecatedName&&(o=DE(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":o=PE(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=PE(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":o=RE(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=RE(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":o=BE(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=BE(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":o=LE(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=LE(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":o=VE(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=VE(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":o=OE(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=OE(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":o=FE(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=FE(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":o=SO(e.attr,i.tfName,i.defaultValue),o===void 0&&i.tfDeprecatedName&&(o=SO(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return r[i.name]={value:o,type:a},r},{})),s}mapFunction(e){const t=e.nodeDef,s=[],r=[];let i={};t!=null&&(i=t.reduce((f,m)=>(f[m.name]=this.mapNode(m),m.op==="Const"&&r.push(f[m.name]),f),{}));const a=[],o=[];e.signature.inputArg.forEach(f=>{const[m]=Ea(f.name),y={name:m,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:VC(f.type),type:"dtype"}},children:[]};y.signatureKey=f.name,a.push(y),i[m]=y}),Object.keys(i).forEach(f=>{const m=i[f];m.inputNames.forEach((y,b)=>{const[w,,x]=Ea(y),T=i[w];if(T.outputs!=null){const E=T.outputs.indexOf(x);if(E!==-1){const $=`${w}:${E}`;m.inputNames[b]=$}}m.inputs.push(T),T.children.push(m)})});const u=e.ret;e.signature.outputArg.forEach(f=>{const[m,y]=Ea(u[f.name]),b=i[m];b!=null&&(b.defaultOutput=y,o.push(b))});const d=this.mapArgsToSignature(e);return{nodes:i,inputs:a,outputs:o,weights:r,placeholders:s,signature:d}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s),t),{}),outputs:e.signature.outputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s,e.ret),t),{})}}mapArgToTensorInfo(e,t){let s=e.name;return t!=null&&(s=t[s]),{name:s,dtype:e.type}}}function iAe(n){const e=Dt().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function DU(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):iAe(n);return e?t:t.toLowerCase()}function AE(n,e,t,s=!1){const r=n[e];return r!=null?DU(r.s,s):t}function RE(n,e,t){const s=n[e];return s?s.b:t}function DE(n,e,t){const s=n[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:t;return typeof r=="number"?r:parseInt(r,10)}function VC(n){switch(typeof n=="string"&&(n=yi[n]),n){case yi.DT_FLOAT:case yi.DT_HALF:return"float32";case yi.DT_INT32:case yi.DT_INT64:case yi.DT_INT8:case yi.DT_UINT8:return"int32";case yi.DT_BOOL:return"bool";case yi.DT_DOUBLE:return"float32";case yi.DT_STRING:return"string";default:return null}}function SO(n,e,t){const s=n[e];return s&&s.func?s.func.name:t}function OE(n,e,t){const s=n[e];return s&&s.type?VC(s.type):t}function FE(n,e,t){const s=n[e];return s&&s.list&&s.list.type?s.list.type.map(r=>VC(r)):t}function OU(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function LE(n,e,t){const s=n[e];return s&&s.shape?OU(s.shape):t}function PE(n,e,t){const s=n[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):t}function ME(n,e,t,s=!1){const r=n[e];return r&&r.list&&r.list.s?r.list.s.map(i=>DU(i,s)):t}function VE(n,e,t){const s=n[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>OU(r)):t}function BE(n,e,t){const s=n[e];return s&&s.list&&s.list.b?s.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aAe{constructor(e,t,s){this.node=e,this.tensorMap=t,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,i)=>(r[i]=this.getAttr(i),r),{}))}getInput(e){return sr(e,this.tensorMap,this.context)}getAttr(e,t){const s=this.node.rawAttrs[e];if(s.tensor!=null)return sr(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return DE(this.node.rawAttrs,e,t);if(s.s!=null)return AE(this.node.rawAttrs,e,t);if(s.b!=null)return RE(this.node.rawAttrs,e,t);if(s.shape!=null)return LE(this.node.rawAttrs,e,t);if(s.type!=null)return OE(this.node.rawAttrs,e,t);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return PE(this.node.rawAttrs,e,t);if(s.list.s!=null)return ME(this.node.rawAttrs,e,t);if(s.list.shape!=null)return VE(this.node.rawAttrs,e,t);if(s.list.b!=null)return BE(this.node.rawAttrs,e,t);if(s.list.type!=null)return FE(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hs=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:D4,abs:xi,acos:nEe,acosh:rEe,add:ds,addN:aEe,all:lEe,any:uEe,argMax:dEe,argMin:pEe,asin:gEe,asinh:bEe,atan:vEe,atan2:SEe,atanh:EEe,avgPool:J4,avgPool3d:REe,basicLSTMCell:MEe,batchNorm:h1,batchNorm2d:jEe,batchNorm3d:GEe,batchNorm4d:qEe,batchToSpaceND:eU,bincount:tU,booleanMaskAsync:lNe,broadcastArgs:YEe,broadcastTo:x0,buffer:Bo,cast:hs,ceil:JEe,clipByValue:t_e,clone:ec,complex:lc,concat:or,concat1d:s_e,concat2d:i_e,concat3d:o_e,concat4d:c_e,conv1d:d_e,conv2d:f1,conv2dTranspose:m_e,conv3d:y_e,conv3dTranspose:w_e,cos:T_e,cosh:__e,cosineWindow:DC,cumprod:$_e,cumsum:N_e,denseBincount:A_e,depthToSpace:D_e,depthwiseConv2d:EC,diag:L_e,dilation2d:M_e,div:ir,divNoNan:j_e,dot:G_e,dropout:vNe,einsum:q_e,elu:rU,enclosingPowerOfTwo:NU,equal:sU,erf:Y_e,euclideanNorm:aIe,exp:Gu,expandDims:uu,expm1:uIe,eye:aU,fft:kC,fill:d1,floor:oU,floorDiv:Z4,fused:FNe,gather:lU,gatherND:yNe,greater:y1,greaterEqual:cU,ifft:gx,imag:u1,image:f2e,inTopKAsync:SNe,irfft:_U,isFinite:bIe,isInf:vIe,isNaN:SIe,leakyRelu:uU,less:_Ie,lessEqual:$C,linalg:p2e,linspace:$Ie,localResponseNormalization:NIe,log:$m,log1p:hU,logSigmoid:OIe,logSoftmax:PIe,logSumExp:fU,logicalAnd:px,logicalNot:pU,logicalOr:mU,logicalXor:jIe,losses:m2e,lowerBound:GIe,matMul:Zt,max:bd,maxPool:gU,maxPool3d:KIe,maxPoolWithArgmax:YIe,maximum:ZIe,mean:mx,meshgrid:e$e,min:NE,minimum:yU,mirrorPad:s$e,mod:i$e,moments:o$e,movingAverage:uNe,mul:dt,multiRNNCell:c$e,multinomial:h$e,neg:Ro,norm:g1,notEqual:bU,oneHot:BTe,ones:yu,onesLike:p$e,op:Q,outerProduct:g$e,pad:ly,pad1d:x$e,pad2d:w$e,pad3d:T$e,pad4d:_$e,pool:k$e,pow:IC,prelu:vU,print:G4,prod:D$e,raggedGather:F$e,raggedTensorToTensor:P$e,rand:V$e,randomGamma:j$e,randomNormal:wU,randomStandardNormal:H$e,randomUniform:SU,range:Cm,real:Im,reciprocal:X$e,relu:b1,relu6:TU,reshape:Ce,reverse:Hu,reverse1d:eCe,reverse2d:nCe,reverse3d:rCe,reverse4d:aCe,rfft:AC,round:EU,rsqrt:cCe,scalar:Yt,scatterND:dNe,searchSorted:CC,selu:hCe,separableConv2d:fCe,setdiff1dAsync:mCe,sigmoid:yd,sign:yCe,signal:d2e,sin:xCe,sinh:wCe,slice:cn,slice1d:TCe,slice2d:_Ce,slice3d:$Ce,slice4d:NCe,softmax:ACe,softplus:dU,spaceToBatchND:xU,sparse:g2e,sparseToDense:mNe,spectral:h2e,split:Nm,sqrt:kE,square:m1,squaredDifference:IU,squeeze:RC,stack:Uo,step:$U,stridedSlice:UCe,string:y2e,sub:Pt,sum:mn,tan:WCe,tanh:CE,tensor:Fa,tensor1d:Ei,tensor2d:xd,tensor3d:qTe,tensor4d:GCe,tensor5d:HCe,tensor6d:qCe,tile:tm,topk:XCe,transpose:IE,truncatedNormal:QCe,unique:JCe,unsortedSegmentSum:tNe,unstack:lh,upperBound:sNe,variable:rNe,where:Md,whereAsync:CU,zeros:Vd,zerosLike:_C},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oAe=(n,e,t,s=Hs)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(L("a",n,e,t),L("b",n,e,t))];case"AddN":return[s.addN(L("tensors",n,e,t))];case"FloorMod":case"Mod":return[s.mod(L("a",n,e,t),L("b",n,e,t))];case"Mul":return[s.mul(L("a",n,e,t),L("b",n,e,t))];case"RealDiv":case"Div":return[s.div(L("a",n,e,t),L("b",n,e,t))];case"DivNoNan":return[s.divNoNan(L("a",n,e,t),L("b",n,e,t))];case"FloorDiv":return[s.floorDiv(L("a",n,e,t),L("b",n,e,t))];case"Sub":return[s.sub(L("a",n,e,t),L("b",n,e,t))];case"Minimum":return[s.minimum(L("a",n,e,t),L("b",n,e,t))];case"Maximum":return[s.maximum(L("a",n,e,t),L("b",n,e,t))];case"Pow":return[s.pow(L("a",n,e,t),L("b",n,e,t))];case"SquaredDifference":return[s.squaredDifference(L("a",n,e,t),L("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lAe=(n,e,t,s=Hs)=>{switch(n.op){case"Abs":case"ComplexAbs":return[s.abs(L("x",n,e,t))];case"Acos":return[s.acos(L("x",n,e,t))];case"Acosh":return[s.acosh(L("x",n,e,t))];case"Asin":return[s.asin(L("x",n,e,t))];case"Asinh":return[s.asinh(L("x",n,e,t))];case"Atan":return[s.atan(L("x",n,e,t))];case"Atan2":return[s.atan2(L("x",n,e,t),L("y",n,e,t))];case"Atanh":return[s.atanh(L("x",n,e,t))];case"Ceil":return[s.ceil(L("x",n,e,t))];case"Complex":return[s.complex(L("real",n,e,t),L("imag",n,e,t))];case"Cos":return[s.cos(L("x",n,e,t))];case"Cosh":return[s.cosh(L("x",n,e,t))];case"Elu":return[s.elu(L("x",n,e,t))];case"Erf":return[s.erf(L("x",n,e,t))];case"Exp":return[s.exp(L("x",n,e,t))];case"Expm1":return[s.expm1(L("x",n,e,t))];case"Floor":return[s.floor(L("x",n,e,t))];case"Log":return[s.log(L("x",n,e,t))];case"Log1p":return[s.log1p(L("x",n,e,t))];case"Imag":return[s.imag(L("x",n,e,t))];case"Neg":return[s.neg(L("x",n,e,t))];case"Reciprocal":return[s.reciprocal(L("x",n,e,t))];case"Real":return[s.real(L("x",n,e,t))];case"Relu":return[s.relu(L("x",n,e,t))];case"Round":return[s.round(L("x",n,e,t))];case"Selu":return[s.selu(L("x",n,e,t))];case"Sigmoid":return[s.sigmoid(L("x",n,e,t))];case"Sin":return[s.sin(L("x",n,e,t))];case"Sign":return[s.sign(L("x",n,e,t))];case"Sinh":return[s.sinh(L("x",n,e,t))];case"Softplus":return[s.softplus(L("x",n,e,t))];case"Sqrt":return[s.sqrt(L("x",n,e,t))];case"Square":return[s.square(L("x",n,e,t))];case"Tanh":return[s.tanh(L("x",n,e,t))];case"Tan":return[s.tan(L("x",n,e,t))];case"ClipByValue":return[s.clipByValue(L("x",n,e,t),L("clipValueMin",n,e,t),L("clipValueMax",n,e,t))];case"Relu6":return[s.relu6(L("x",n,e,t))];case"Rsqrt":return[s.rsqrt(sr(n.inputNames[0],e,t))];case"Prod":return[s.prod(L("x",n,e,t),L("axes",n,e,t))];case"LeakyRelu":return[s.leakyRelu(L("x",n,e,t),L("alpha",n,e,t))];case"Prelu":return[s.prelu(L("x",n,e,t),L("alpha",n,e,t))];case"IsNan":return[s.isNaN(sr(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vi(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){X(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let s=0;s<n.length;s++){const r=n[s],i=e[s];X(r<0||i<0||r===i,()=>t+` Shapes ${n} and ${e} must match`)}}}function TO(n){return!(typeof n=="number"||n.some(e=>e<0))}function Fp(n,e,t){let s=zE(n,t);const r=!TO(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(i=>{s=zE(i.shape,s)}),!TO(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function zE(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let s=0;s<n.length;++s){const r=n[s],i=e[s];if(r>=0&&i>=0&&r!==i)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[s]=r>=0?r:i}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cAe{constructor(e,t,s,r,i,a,o){this.name=e,this.dtype=t,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=a,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=Yt(0),Ul(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),vi(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=t,Ul(t),s.written=!0,this.tensors[e]=s}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((s,r)=>this.write(s,t[r]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return Fa([],[0].concat(this.elementShape));const s=this.readMany(e);return vi(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),Uo(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Fa([],[0].concat(this.elementShape));const t=[];for(let r=0;r<this.size();r++)t.push(r);const s=this.readMany(t);return vi(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),or(s,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,lh(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let s=0;const r=e.map(l=>(s+=l,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=s===0?0:t.size/s,a=[];qi(()=>{t=Ce(t,[1,s,i]);for(let l=0;l<e.length;++l){const d=[0,l===0?0:r[l-1],0],f=[1,e[l],i];a[l]=Ce(cn(t,d,f),this.elementShape)}return a});const o=[];for(let l=0;l<e.length;l++)o[l]=l;this.writeMany(o,a)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qu{constructor(e,t,s,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=s,e!=null&&e.forEach(i=>{if(s!==i.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${i.dtype}`);vi(t,i.shape,"TensorList shape mismatch: "),Ul(i)}),this.idTensor=Yt(0),this.maxNumElements=r,Ul(this.idTensor)}get id(){return this.idTensor.id}copy(){return new qu([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,s=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);vi(e,this.elementShape,"TensorList shape mismatch: ");const r=Fp(this.elementShape,this.tensors,e);return qi(()=>{const i=this.tensors.map(a=>Ce(a,r));return Uo(i,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=Fp(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,vi(r.shape,e,"TensorList shape mismatch: "),Ce(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(vi(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Ul(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new qu([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)t.tensors[s]=this.tensors[s];return t}getItem(e,t,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);vi(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=Fp(this.elementShape,this.tensors,t);return Ce(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);vi(this.elementShape,t.shape,"TensorList shape mismatch: "),Ul(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,s){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);vi(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=Fp(this.elementShape,this.tensors,s);return e.length===0?Fa([],[0].concat(r)):qi(()=>{const i=e.map(a=>Ce(this.tensors[a],r));return Uo(i,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);vi(this.elementShape,t,"TensorList shape mismatch: ");const s=Fp(this.elementShape,this.tensors,t);return this.size()===0?Fa([],[0].concat(s)):qi(()=>{const r=this.tensors.map(i=>Ce(i,s));return or(r,0)})}}function uAe(n,e,t){const s=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const r=n.shape.slice(1);vi(r,e,"TensorList shape mismatch: ");const i=lh(n);return new qu(i,e,s)}function hAe(n,e,t,s){return new qu([],n,e,s)}function dAe(n,e,t,s){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const i=new qu([],t,n.dtype,s),a=lh(n,0);return e.forEach((o,l)=>{i.setItem(o,a[l])}),i}function fAe(n,e,t){let s=0;const r=e.map(d=>(s+=d,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);const i=n.shape.slice(1),a=zE(i,t),o=s===0?0:n.size/s,l=qi(()=>{const d=[];n=Ce(n,[1,s,o]);for(let f=0;f<e.length;++f){const y=[0,f===0?0:r[f-1],0],b=[1,e[f],o];d[f]=Ce(cn(n,y,b),a)}return n.dispose(),d}),u=new qu([],t,n.dtype,e.length);for(let d=0;d<l.length;d++)u.setItem(d,l[d]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pAe=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const s=L("thenBranch",n,e,t),r=L("elseBranch",n,e,t),i=L("cond",n,e,t),a=L("args",n,e,t);return(await i.data())[0]?t.functionMap[s].executeFunctionAsync(a,t.tensorArrayMap,t.tensorListMap):t.functionMap[r].executeFunctionAsync(a,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const s=L("body",n,e,t),r=L("cond",n,e,t),i=L("args",n,e,t),a=await t.functionMap[r].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap),o=i.map(d=>d.id);let l=await a[0].data();a.forEach(d=>{!d.kept&&o.indexOf(d.id)===-1&&d.dispose()});let u=i;for(;l[0];){const d=u;u=await t.functionMap[s].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);const f=u.map(y=>y.id);d.forEach(y=>{!y.kept&&o.indexOf(y.id)===-1&&f.indexOf(y.id)===-1&&y.dispose()});const m=await t.functionMap[r].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);l=await m[0].data(),m.forEach(y=>{!y.kept&&o.indexOf(y.id)===-1&&f.indexOf(y.id)===-1&&y.dispose()})}return u}case"LoopCond":{const s=L("pred",n,e,t);return[So(s)]}case"Switch":{const s=L("pred",n,e,t);let r=L("data",n,e,t);return r.kept||(r=So(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=n.inputNames.find(r=>sr(r,e,t)!==void 0);if(s){const r=sr(s,e,t);return[So(r)]}return}case"Enter":{const s=L("frameName",n,e,t),r=L("tensor",n,e,t);return t.enterFrame(s),[So(r)]}case"Exit":{const s=L("tensor",n,e,t);return t.exitFrame(),[So(s)]}case"NextIteration":{const s=L("tensor",n,e,t);return t.nextIteration(),[So(s)]}case"TensorArrayV3":{const s=L("size",n,e,t),r=L("dtype",n,e,t),i=L("elementShape",n,e,t),a=L("dynamicSize",n,e,t),o=L("clearAfterRead",n,e,t),l=L("identicalElementShapes",n,e,t),u=L("name",n,e,t),d=new cAe(u,r,s,i,l,a,o);return t.addTensorArray(d),[d.idTensor,Yt(1)]}case"TensorArrayWriteV3":{const s=L("tensorArrayId",n,e,t),r=L("index",n,e,t),i=L("tensor",n,e,t),a=t.getTensorArray(s.id);return a.write(r,i),[a.idTensor]}case"TensorArrayReadV3":{const s=L("tensorArrayId",n,e,t),r=L("index",n,e,t);return[t.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=L("tensorArrayId",n,e,t),r=L("indices",n,e,t),i=L("dtype",n,e,t);return[t.getTensorArray(s.id).gather(r,i)]}case"TensorArrayScatterV3":{const s=L("tensorArrayId",n,e,t),r=L("indices",n,e,t),i=L("tensor",n,e,t),a=t.getTensorArray(s.id);return a.scatter(r,i),[a.idTensor]}case"TensorArrayConcatV3":{const s=L("tensorArrayId",n,e,t),r=t.getTensorArray(s.id),i=L("dtype",n,e,t);return[r.concat(i)]}case"TensorArraySplitV3":{const s=L("tensorArrayId",n,e,t),r=L("tensor",n,e,t),i=L("lengths",n,e,t),a=t.getTensorArray(s.id);return a.split(i,r),[a.idTensor]}case"TensorArraySizeV3":{const s=L("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return[Yt(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=L("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=L("tensorListId",n,e,t),r=L("index",n,e,t),i=L("tensor",n,e,t),a=t.getTensorList(s.id);return a.setItem(r,i),[a.idTensor]}case"TensorListGetItem":{const s=L("tensorListId",n,e,t),r=L("index",n,e,t),i=L("elementShape",n,e,t),a=L("elementDType",n,e,t);return[t.getTensorList(s.id).getItem(r,i,a)]}case"TensorListScatterV2":case"TensorListScatter":{const s=L("indices",n,e,t),r=L("tensor",n,e,t),i=L("elementShape",n,e,t),a=L("numElements",n,e,t),o=dAe(r,s,i,a);return t.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=L("elementShape",n,e,t),r=L("elementDType",n,e,t);let i;n.op==="TensorListReserve"?i="numElements":i="maxNumElements";const a=L(i,n,e,t),o=n.op==="TensorListReserve"?-1:a,l=hAe(s,r,a,o);return t.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=L("tensorListId",n,e,t),r=L("indices",n,e,t),i=L("elementShape",n,e,t),a=L("elementDType",n,e,t);return[t.getTensorList(s.id).gather(r,a,i)]}case"TensorListStack":{const s=L("tensorListId",n,e,t),r=L("elementShape",n,e,t),i=L("elementDType",n,e,t),a=L("numElements",n,e,t);return[t.getTensorList(s.id).stack(r,i,a)]}case"TensorListFromTensor":{const s=L("tensor",n,e,t),r=L("elementShape",n,e,t),i=L("elementDType",n,e,t),a=uAe(s,r,i);return t.addTensorList(a),[a.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=L("tensorListId",n,e,t),r=t.getTensorList(s.id),i=L("dtype",n,e,t),a=L("elementShape",n,e,t);return[r.concat(i,a)]}case"TensorListPushBack":{const s=L("tensorListId",n,e,t),r=L("tensor",n,e,t),i=t.getTensorList(s.id);return i.pushBack(r),[i.idTensor]}case"TensorListPopBack":{const s=L("tensorListId",n,e,t),r=L("elementShape",n,e,t),i=L("elementDType",n,e,t);return[t.getTensorList(s.id).popBack(r,i)]}case"TensorListSplit":{const s=L("tensor",n,e,t),r=L("elementShape",n,e,t),i=L("lengths",n,e,t),a=fAe(s,i,r);return t.addTensorList(a),[a.idTensor]}case"TensorListLength":{const s=L("tensorListId",n,e,t),r=t.getTensorList(s.id);return[Yt(r.size(),"int32")]}case"TensorListResize":{const s=L("tensorListId",n,e,t),r=L("size",n,e,t),a=t.getTensorList(s.id).resize(r);return t.addTensorList(a),[a.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EO(n,e,t){const[s,r]=L("fusedOps",n,e,t),i=s==="biasadd",a=!i,o=r==="prelu",l=s==="fusedbatchnorm",u=L("numArgs",n,e,t);if(i){if(o&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&i&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const d=L("strides",n,e,t),f=v0(n,e,t),m=L("dataFormat",n,e,t).toUpperCase(),y=L("dilations",n,e,t);let[b,w]=L("args",n,e,t);a&&(w=b,b=void 0);const x=L("leakyreluAlpha",n,e,t);return{stride:d,pad:f,dataFormat:m,dilations:y,biasArg:b,preluArg:w,activationFunc:r,leakyreluAlpha:x}}const mAe=(n,e,t,s=Hs)=>{switch(n.op){case"Conv1D":{const r=L("stride",n,e,t),i=L("pad",n,e,t),a=L("dataFormat",n,e,t).toUpperCase(),o=L("dilation",n,e,t);return[s.conv1d(L("x",n,e,t),L("filter",n,e,t),r,i,a,o)]}case"Conv2D":{const r=L("strides",n,e,t),i=v0(n,e,t),a=L("dataFormat",n,e,t).toUpperCase(),o=L("dilations",n,e,t);return[s.conv2d(L("x",n,e,t),L("filter",n,e,t),[r[1],r[2]],i,a,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:r,pad:i,dataFormat:a,dilations:o,biasArg:l,preluArg:u,activationFunc:d,leakyreluAlpha:f}=EO(n,e,t);return[s.fused.conv2d({x:L("x",n,e,t),filter:L("filter",n,e,t),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[o[1],o[2]],bias:l,activation:d,preluActivationWeights:u,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:i,dataFormat:a,dilations:o,biasArg:l,preluArg:u,activationFunc:d,leakyreluAlpha:f}=EO(n,e,t);return[s.fused.depthwiseConv2d({x:L("x",n,e,t),filter:L("filter",n,e,t),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[o[1],o[2]],bias:l,activation:d,preluActivationWeights:u,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=L("outputShape",n,e,t),i=L("strides",n,e,t),a=v0(n,e,t);return[s.conv2dTranspose(L("x",n,e,t),L("filter",n,e,t),r,[i[1],i[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=L("strides",n,e,t),i=v0(n,e,t),a=L("dilations",n,e,t),o=L("dataFormat",n,e,t).toUpperCase();return[s.depthwiseConv2d(L("input",n,e,t),L("filter",n,e,t),[r[1],r[2]],i,o,[a[1],a[2]])]}case"Conv3D":{const r=L("strides",n,e,t),i=L("pad",n,e,t),a=L("dataFormat",n,e,t).toUpperCase(),o=L("dilations",n,e,t);return[s.conv3d(L("x",n,e,t),L("filter",n,e,t),[r[1],r[2],r[3]],i,a,[o[1],o[2],o[3]])]}case"AvgPool":{const r=L("strides",n,e,t),i=L("pad",n,e,t),a=L("kernelSize",n,e,t);return[s.avgPool(L("x",n,e,t),[a[1],a[2]],[r[1],r[2]],i)]}case"MaxPool":{const r=L("strides",n,e,t),i=L("pad",n,e,t),a=L("kernelSize",n,e,t);return[s.maxPool(L("x",n,e,t),[a[1],a[2]],[r[1],r[2]],i)]}case"MaxPoolWithArgmax":{const r=L("strides",n,e,t),i=L("pad",n,e,t),a=L("kernelSize",n,e,t),o=L("includeBatchInIndex",n,e,t),{result:l,indexes:u}=s.maxPoolWithArgmax(L("x",n,e,t),[a[1],a[2]],[r[1],r[2]],i,o);return[l,u]}case"AvgPool3D":{const r=L("strides",n,e,t),i=L("pad",n,e,t),a=L("kernelSize",n,e,t);return[s.avgPool3d(L("x",n,e,t),[a[1],a[2],a[3]],[r[1],r[2],r[3]],i)]}case"MaxPool3D":{const r=L("strides",n,e,t),i=L("pad",n,e,t),a=L("kernelSize",n,e,t);return[s.maxPool3d(L("x",n,e,t),[a[1],a[2],a[3]],[r[1],r[2],r[3]],i)]}case"Dilation2D":{const r=L("strides",n,e,t),i=L("pad",n,e,t),a=L("dilations",n,e,t),o=r[1],l=r[2],u=a[1],d=a[2];return[s.dilation2d(L("x",n,e,t),L("filter",n,e,t),[o,l],i,[u,d],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gAe=(n,e,t,s=Hs)=>{switch(n.op){case"Fill":{const r=L("shape",n,e,t),i=L("dtype",n,e,t),a=L("value",n,e,t);return[s.fill(r,a,i)]}case"LinSpace":{const r=L("start",n,e,t),i=L("stop",n,e,t),a=L("num",n,e,t);return[s.linspace(r,i,a)]}case"Multinomial":{const r=L("logits",n,e,t),i=L("numSamples",n,e,t),a=L("seed",n,e,t);return[s.multinomial(r,i,a)]}case"OneHot":{const r=L("indices",n,e,t),i=L("depth",n,e,t),a=L("onValue",n,e,t),o=L("offValue",n,e,t),l=L("dtype",n,e,t);return[s.oneHot(r,i,a,o,l)]}case"Ones":return[s.ones(L("shape",n,e,t),L("dtype",n,e,t))];case"OnesLike":return[s.onesLike(L("x",n,e,t))];case"RandomStandardNormal":return[s.randomStandardNormal(L("shape",n,e,t),L("dtype",n,e,t),L("seed",n,e,t))];case"RandomUniform":return[s.randomUniform(L("shape",n,e,t),L("minval",n,e,t),L("maxval",n,e,t),L("dtype",n,e,t))];case"Range":{const r=L("start",n,e,t),i=L("stop",n,e,t),a=L("step",n,e,t);return[s.range(r,i,a,L("dtype",n,e,t))]}case"TruncatedNormal":{const r=L("shape",n,e,t),i=L("mean",n,e,t),a=L("stdDev",n,e,t),o=L("seed",n,e,t);return[s.truncatedNormal(r,i,a,L("dtype",n,e,t),o)]}case"Zeros":return[s.zeros(L("shape",n,e,t),L("dtype",n,e,t))];case"ZerosLike":return[s.zerosLike(L("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fT(n,e,t){const s=L("boxes",n,e,t),r=L("scores",n,e,t),i=L("maxOutputSize",n,e,t),a=L("iouThreshold",n,e,t),o=L("scoreThreshold",n,e,t),l=L("softNmsSigma",n,e,t);return{boxes:s,scores:r,maxOutputSize:i,iouThreshold:a,scoreThreshold:o,softNmsSigma:l}}const yAe=async(n,e,t,s,r=Hs)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:u,softNmsSigma:d}=fT(n,e,t),f=await r.image.nonMaxSuppressionWithScoreAsync(i,a,o,l,u,d);return[f.selectedIndices,f.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:u}=fT(n,e,t),d=L("padToMaxOutputSize",n,e,t),f=await r.image.nonMaxSuppressionPaddedAsync(i,a,o,l,u,d);return[f.selectedIndices,f.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:u}=fT(n,e,t);return[await r.image.nonMaxSuppressionAsync(i,a,o,l,u)]}case"Where":{const i=r.cast(L("condition",n,e,t),"bool"),a=[await r.whereAsync(i)];return i.dispose(),a}case"ListDiff":return r.setdiff1dAsync(L("x",n,e,t),L("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bAe=(n,e,t,s=Hs)=>{switch(n.op){case"LowerBound":{const r=L("sortedSequence",n,e,t),i=L("values",n,e,t);return[s.lowerBound(r,i)]}case"TopKV2":{const r=L("x",n,e,t),i=L("k",n,e,t),a=L("sorted",n,e,t),o=s.topk(r,i,a);return[o.values,o.indices]}case"UpperBound":{const r=L("sortedSequence",n,e,t),i=L("values",n,e,t);return[s.upperBound(r,i)]}case"Unique":{const r=L("x",n,e,t),i=s.unique(r);return[i.values,i.indices]}case"UniqueV2":{const r=L("x",n,e,t),i=L("axis",n,e,t),a=s.unique(r,i);return[a.values,a.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xAe=(n,e,t,s=Hs)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const r=L("default",n,e,t);return[sr(n.name,e,t)||r];case"Placeholder":return[sr(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const d=L("x",n,e,t);return[So(d)]}case"IdentityN":return L("x",n,e,t).map(d=>So(d));case"Snapshot":const i=L("x",n,e,t);return[So(i)];case"Shape":return[s.tensor1d(L("x",n,e,t).shape,"int32")];case"ShapeN":return L("x",n,e,t).map(d=>s.tensor1d(d.shape));case"Size":return[s.scalar(L("x",n,e,t).size,"int32")];case"Rank":return[s.scalar(L("x",n,e,t).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const a=L("x",n,e,t),o=L("data",n,e,t),l=L("message",n,e,t),u=L("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let d=0;d<o.length;d++)console.log(Array.prototype.slice.call(o[d].dataSync()).slice(0,u));return[a];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vAe{constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=Yt(0),this.tensorMap=new Map,Ul(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Yt(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),qi(()=>{const r=lh(t),i=s.length,a=r.length;X(i===a,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${a} elements.`);for(let o=0;o<i;o++){const l=s[o],u=r[o];Ul(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return qi(()=>{const r=[];for(let i=0;i<s.length;i++){const a=s[i],o=this.findWithDefault(a,t);r.push(o)}return Uo(r)})}findWithDefault(e,t){const s=this.tensorMap.get(e);return s??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wAe=async(n,e,t,s)=>{switch(n.op){case"HashTable":case"HashTableV2":{const r=L("keyDType",n,e,t),i=L("valueDType",n,e,t),a=new vAe(r,i);return s.addHashTable(n.name,a),[a.handle]}case"LookupTableImport":case"LookupTableImportV2":{const r=L("tableHandle",n,e,t,s),i=L("keys",n,e,t),a=L("values",n,e,t);return[await s.getHashTableById(r.id).import(i,a)]}case"LookupTableFind":case"LookupTableFindV2":{const r=L("tableHandle",n,e,t,s),i=L("keys",n,e,t),a=L("defaultValue",n,e,t);return[await s.getHashTableById(r.id).find(i,a)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=L("tableHandle",n,e,t,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SAe=(n,e,t,s=Hs)=>{switch(n.op){case"ResizeBilinear":{const r=L("images",n,e,t),i=L("size",n,e,t),a=L("alignCorners",n,e,t),o=L("halfPixelCenters",n,e,t);return[s.image.resizeBilinear(r,[i[0],i[1]],a,o)]}case"ResizeNearestNeighbor":{const r=L("images",n,e,t),i=L("size",n,e,t),a=L("alignCorners",n,e,t),o=L("halfPixelCenters",n,e,t);return[s.image.resizeNearestNeighbor(r,[i[0],i[1]],a,o)]}case"CropAndResize":{const r=L("image",n,e,t),i=L("boxes",n,e,t),a=L("boxInd",n,e,t),o=L("cropSize",n,e,t),l=L("method",n,e,t),u=L("extrapolationValue",n,e,t);return[s.image.cropAndResize(r,i,a,o,l,u)]}case"ImageProjectiveTransformV3":{const r=L("images",n,e,t),i=L("transforms",n,e,t),a=L("outputShape",n,e,t),o=L("fillValue",n,e,t),l=L("interpolation",n,e,t),u=L("fillMode",n,e,t);return[s.image.transform(r,i,l.toLowerCase(),u.toLowerCase(),o,a)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TAe=(n,e,t,s=Hs)=>{switch(n.op){case"Equal":return[s.equal(L("a",n,e,t),L("b",n,e,t))];case"NotEqual":return[s.notEqual(L("a",n,e,t),L("b",n,e,t))];case"Greater":return[s.greater(L("a",n,e,t),L("b",n,e,t))];case"GreaterEqual":return[s.greaterEqual(L("a",n,e,t),L("b",n,e,t))];case"Less":return[s.less(L("a",n,e,t),L("b",n,e,t))];case"LessEqual":return[s.lessEqual(L("a",n,e,t),L("b",n,e,t))];case"LogicalAnd":return[s.logicalAnd(L("a",n,e,t),L("b",n,e,t))];case"LogicalNot":return[s.logicalNot(L("a",n,e,t))];case"LogicalOr":return[s.logicalOr(L("a",n,e,t),L("b",n,e,t))];case"Select":case"SelectV2":return[s.where(L("condition",n,e,t),L("a",n,e,t),L("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EAe=(n,e,t,s=Hs)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(L("a",n,e,t),L("b",n,e,t),L("transposeA",n,e,t),L("transposeB",n,e,t))];case"Einsum":return[s.einsum(L("equation",n,e,t),...L("tensors",n,e,t))];case"Transpose":return[s.transpose(L("x",n,e,t),L("perm",n,e,t))];case"_FusedMatMul":const[r,i]=L("fusedOps",n,e,t),a=r==="biasadd",o=i==="prelu",l=L("numArgs",n,e,t),u=L("leakyreluAlpha",n,e,t);if(a){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[d,f]=L("args",n,e,t);return[s.fused.matMul({a:L("a",n,e,t),b:L("b",n,e,t),transposeA:L("transposeA",n,e,t),transposeB:L("transposeB",n,e,t),bias:d,activation:i,preluActivationWeights:f,leakyreluAlpha:u})];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ae=(n,e,t,s=Hs)=>{switch(n.op){case"EuclideanNorm":return[s.euclideanNorm(L("x",n,e,t),L("axis",n,e,t),L("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(L("x",n,e,t),L("mean",n,e,t),L("variance",n,e,t),L("offset",n,e,t),L("scale",n,e,t),L("epsilon",n,e,t))];case"FusedBatchNormV3":return[s.batchNorm(L("x",n,e,t),L("mean",n,e,t),L("variance",n,e,t),L("offset",n,e,t),L("scale",n,e,t),L("epsilon",n,e,t))];case"LRN":return[s.localResponseNormalization(L("x",n,e,t),L("radius",n,e,t),L("bias",n,e,t),L("alpha",n,e,t),L("beta",n,e,t))];case"Softmax":return[s.softmax(L("x",n,e,t))];case"LogSoftmax":return[s.logSoftmax(L("x",n,e,t))];case"SparseToDense":return[s.sparseToDense(L("sparseIndices",n,e,t),L("outputShape",n,e,t),L("sparseValues",n,e,t),L("defaultValue",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IAe=(n,e,t,s=Hs)=>{switch(n.op){case"Max":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.max(L("x",n,e,t),o,l)]}case"Mean":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.mean(L("x",n,e,t),o,l)]}case"Min":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.min(L("x",n,e,t),o,l)]}case"Sum":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.sum(L("x",n,e,t),o,l)]}case"All":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.all(L("x",n,e,t),o,l)]}case"Any":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.any(L("x",n,e,t),o,l)]}case"ArgMax":{const o=L("axis",n,e,t);return[s.argMax(L("x",n,e,t),o)]}case"ArgMin":{const o=L("axis",n,e,t);return[s.argMin(L("x",n,e,t),o)]}case"Prod":{const o=L("axis",n,e,t),l=L("keepDims",n,e,t);return[s.prod(L("x",n,e,t),o,l)]}case"Cumprod":{const o=L("axis",n,e,t),l=L("exclusive",n,e,t),u=L("reverse",n,e,t);return[s.cumprod(L("x",n,e,t),o,l,u)]}case"Cumsum":{const o=L("axis",n,e,t),l=L("exclusive",n,e,t),u=L("reverse",n,e,t);return[s.cumsum(L("x",n,e,t),o,l,u)]}case"Bincount":const r=L("x",n,e,t),i=L("weights",n,e,t),a=L("size",n,e,t);return[s.bincount(r,i,a)];case"DenseBincount":{const o=L("x",n,e,t),l=L("weights",n,e,t),u=L("size",n,e,t),d=L("binaryOutput",n,e,t);return[s.denseBincount(o,l,u,d)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ae=(n,e,t,s=Hs)=>{switch(n.op){case"ConcatV2":case"Concat":{const r=L("n",n,e,t),i=L("axis",n,e,t);let a=L("tensors",n,e,t);return a=a.slice(0,r),[s.concat(a,i)]}case"Gather":{const r=L("x",n,e,t),i=L("indices",n,e,t);return[s.gather(r,s.cast(i,"int32"),0)]}case"GatherV2":{const r=L("axis",n,e,t),i=L("batchDims",n,e,t),a=L("x",n,e,t),o=L("indices",n,e,t);return[s.gather(a,s.cast(o,"int32"),r,i)]}case"Reverse":{const r=L("dims",n,e,t),i=[];for(let o=0;o<r.length;o++)r[o]&&i.push(o);const a=L("x",n,e,t);return[s.reverse(a,i)]}case"ReverseV2":{const r=L("axis",n,e,t),i=L("x",n,e,t);return[s.reverse(i,r)]}case"Slice":{const r=L("begin",n,e,t),i=L("size",n,e,t);return[s.slice(L("x",n,e,t),r,i)]}case"StridedSlice":{const r=L("begin",n,e,t),i=L("end",n,e,t),a=L("strides",n,e,t),o=L("beginMask",n,e,t),l=L("endMask",n,e,t),u=L("ellipsisMask",n,e,t),d=L("newAxisMask",n,e,t),f=L("shrinkAxisMask",n,e,t),m=L("x",n,e,t);return[s.stridedSlice(m,r,i,a,o,l,u,d,f)]}case"Pack":return qi(()=>{const r=L("axis",n,e,t),i=L("tensors",n,e,t),a=i[0].shape,o=s.squeeze(i[0]).shape,l=i.map(u=>{const d=oc(u.shape,a);if(!d&&!oc(s.squeeze(u).shape,o))throw new Error("the input tensors shape does not match");return d?u:s.reshape(u,a)});return[s.stack(l,r)]});case"Unpack":{const r=L("axis",n,e,t),i=L("tensor",n,e,t);return s.unstack(i,r)}case"Tile":{const r=L("reps",n,e,t);return[s.tile(L("x",n,e,t),r)]}case"Split":case"SplitV":{const r=L("axis",n,e,t),i=L("numOrSizeSplits",n,e,t),a=L("x",n,e,t);return s.split(a,i,r)}case"ScatterNd":{const r=L("indices",n,e,t),i=L("values",n,e,t),a=L("shape",n,e,t);return[s.scatterND(r,i,a)]}case"GatherNd":{const r=L("x",n,e,t),i=L("indices",n,e,t);return[s.gatherND(r,i)]}case"SparseToDense":{const r=L("sparseIndices",n,e,t),i=L("outputShape",n,e,t),a=L("sparseValues",n,e,t),o=L("defaultValue",n,e,t);return[s.sparseToDense(r,a,i,a.dtype===o.dtype?o:s.cast(o,a.dtype))]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CAe=(n,e,t,s=Hs)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:i,emptyRowIndicator:a,reverseIndexMap:o}=s.sparse.sparseFillEmptyRows(L("indices",n,e,t),L("values",n,e,t),L("denseShape",n,e,t),L("defaultValue",n,e,t));return[r,i,a,o]}case"SparseReshape":{const{outputIndices:r,outputShape:i}=s.sparse.sparseReshape(L("inputIndices",n,e,t),L("inputShape",n,e,t),L("newShape",n,e,t));return[r,i]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(L("data",n,e,t),L("indices",n,e,t),L("segmentIds",n,e,t))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(L("data",n,e,t),L("indices",n,e,t),L("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NAe=(n,e,t,s=Hs)=>{switch(n.op){case"FFT":return[s.fft(L("x",n,e,t))];case"IFFT":return[s.ifft(L("x",n,e,t))];case"RFFT":return[s.rfft(L("x",n,e,t))];case"IRFFT":return[s.irfft(L("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kAe=(n,e,t,s=Hs)=>{switch(n.op){case"StringNGrams":{const{nGrams:r,nGramsSplits:i}=s.string.stringNGrams(L("data",n,e,t),L("dataSplits",n,e,t),L("separator",n,e,t),L("nGramWidths",n,e,t),L("leftPad",n,e,t),L("rightPad",n,e,t),L("padWidth",n,e,t),L("preserveShortSequences",n,e,t));return[r,i]}case"StringSplit":{const{indices:r,values:i,shape:a}=s.string.stringSplit(L("input",n,e,t),L("delimiter",n,e,t),L("skipEmpty",n,e,t));return[r,i,a]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(L("input",n,e,t),L("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AAe=(n,e,t,s=Hs)=>{switch(n.op){case"Cast":return[s.cast(L("x",n,e,t),L("dtype",n,e,t))];case"ExpandDims":{const r=L("axis",n,e,t);return[s.expandDims(L("x",n,e,t),r)]}case"Squeeze":{const r=L("axis",n,e,t);return[s.squeeze(L("x",n,e,t),r)]}case"Reshape":return[s.reshape(L("x",n,e,t),L("shape",n,e,t))];case"MirrorPad":return[s.mirrorPad(L("x",n,e,t),L("padding",n,e,t),L("mode",n,e,t))];case"PadV2":case"Pad":return[s.pad(L("x",n,e,t),L("padding",n,e,t),L("constantValue",n,e,t))];case"SpaceToBatchND":{const r=L("blockShape",n,e,t),i=L("paddings",n,e,t);return[s.spaceToBatchND(L("x",n,e,t),r,i)]}case"BatchToSpaceND":{const r=L("blockShape",n,e,t),i=L("crops",n,e,t);return[s.batchToSpaceND(L("x",n,e,t),r,i)]}case"DepthToSpace":{const r=L("blockSize",n,e,t),i=L("dataFormat",n,e,t).toUpperCase();return[s.depthToSpace(L("x",n,e,t),r,i)]}case"BroadcastTo":return[s.broadcastTo(L("x",n,e,t),L("shape",n,e,t))];case"BroadcastArgs":return[s.broadcastArgs(L("s0",n,e,t),L("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _O(n,e,t,s,r=qi){const i=((a,o,l)=>{switch(a.category){case"arithmetic":return r(()=>oAe(a,o,l));case"basic_math":return r(()=>lAe(a,o,l));case"control":return pAe(a,o,l);case"convolution":return r(()=>mAe(a,o,l));case"creation":return r(()=>gAe(a,o,l));case"dynamic":return yAe(a,o,l);case"evaluation":return r(()=>bAe(a,o,l));case"image":return r(()=>SAe(a,o,l));case"graph":return r(()=>xAe(a,o,l));case"logical":return r(()=>TAe(a,o,l));case"matrices":return r(()=>EAe(a,o,l));case"normalization":return r(()=>_Ae(a,o,l));case"reduction":return r(()=>IAe(a,o,l));case"slice_join":return r(()=>$Ae(a,o,l));case"sparse":return r(()=>CAe(a,o,l));case"spectral":return r(()=>NAe(a,o,l));case"string":return r(()=>kAe(a,o,l));case"transformation":return r(()=>AAe(a,o,l));case"hash_table":return wAe(a,o,l,s);case"custom":const u=RU(a.op);if(u&&u.customExecutor)return u.customExecutor(new aAe(a,o,l));throw TypeError(`Custom op ${a.op} is not registered.`);default:throw TypeError(`Unknown op '${a.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return Ld(i)?i.then(a=>[].concat(a)):[].concat(i)}class IO{constructor(e={},t={},s={},r={}){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=s,this.functionMap=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const s=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $O(n,e,t,s){const r=new Set,i=[];let a=null,o=null;const l=new Set,u=Object.keys(n).map(m=>Nr(m)[0]);let d=[];s!=null&&(d=s.map(m=>Nr(m.name)[0]));const f=[...e];for(;f.length>0;){const m=f.pop();if((FU(m)||LAe(m)||PAe(m))&&a==null&&(a=m,o=a.children.map(y=>y.name).filter(y=>r.has(y))),r.add(m.name),t[m.name]==null&&u.indexOf(m.name)===-1&&d.indexOf(m.name)===-1){if(m.inputs.length===0){i.push(m.name);continue}m.inputs.forEach(y=>{l.has(y.name)||(l.add(y.name),f.push(y))})}}return{inputs:n,outputs:e,usedNodes:r,missingInputs:i,dynamicNode:a,syncInputs:o}}function RAe(n,e,t){const{usedNodes:s,inputs:r}=t,i=[],a=Object.keys(r).map(d=>Nr(d)[0]).map(d=>n.nodes[d]),o=n.initNodes;a.forEach(d=>{s.has(d.name)&&i.push(d)}),n.weights.forEach(d=>{s.has(d.name)&&i.push(d)}),o!=null&&o.forEach(d=>{s.has(d.name)&&i.push(d)});const l=new Set,u=[];for(;i.length>0;){const d=i.pop();l.add(d.name),e[d.name]||u.push(d),d.children.forEach(f=>{!l.has(f.name)&&s.has(f.name)&&f.inputs.every(m=>l.has(m.name))&&i.push(f)})}return u}const DAe=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],OAe=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],FAe=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function FU(n){return DAe.indexOf(n.op)>=0}function LAe(n){return OAe.indexOf(n.op)>=0}function PAe(n){return FAe.indexOf(n.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bx{constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new bx(e.functions[s],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}getCompilationKey(e,t){const s=e.map(i=>i.name).sort(),r=t.map(i=>i.name).sort();return s.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}compile(e,t){const s=$O(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:i,syncInputs:a}=s;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${a}]`);if(r.length>0){const o=t.map(u=>u.name),l=Object.keys(e);throw new Error(`Cannot compute the outputs [${o}] from the provided inputs [${l}]. Missing the following inputs: [${r}]`)}return RAe(this.graph,this.weightMap,s)}execute(e,t){e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=s.map(f=>this.graph.nodes[Nr(f)[0]]),i=t.map(f=>Nr(f)[0]);let a=i.map(f=>this.graph.nodes[f]);this.resetIntermediateTensors(),a.length===0&&(a=this._outputs);const o=this.getCompilationKey(r,a);let l=this.compiledMap.get(o);l==null&&(l=this.compile(e,a),this.compiledMap.set(o,l));const u={},d={};return qi(()=>{const f=new IO(this.weightMap,u,d,this.functionExecutorMap),m=Object.assign({},this.weightMap);Object.keys(e).forEach(w=>{const[x,T]=Nr(w),E=[];E[T]=e[w],m[x]=E});const y=this.getFrozenTensorIds(m),b={};for(let w=0;w<l.length;w++){const x=l[w];if(!m[x.name]){const T=_O(x,m,f,this._resourceManager);if(Ld(T))throw new Error(`The execution of the op '${x.op}' returned a promise. Please use model.executeAsync() instead.`);m[x.name]=T,this.checkTensorForDisposal(x.name,x,m,f,y,i,b)}}return this.parent==null&&f.dispose(y),t.map(w=>sr(w,m,f))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(t)}checkTensorForDisposal(e,t,s,r,i,a,o){t.category==="control"||a.indexOf(e)!==-1||(s[e].forEach(l=>{l!=null&&(o[l.id]=(o[l.id]||0)+t.children.length)}),t.inputs.forEach(l=>{if(l.category!=="control"){const u=v2e(l.name,s,r);u!=null&&u.forEach(d=>{if(d&&!d.kept&&!i.has(d.id)){const f=o[d.id];if(f===1){if(!this.keepTensorForDebug)d.dispose();else{const[m,y]=Ea(t.name,r);this.intermediateTensors[m]?this.intermediateTensors[m][y]=d:(this.intermediateTensors[m]=[],this.intermediateTensors[m][y]=d)}delete o[d.id]}else f!=null&&o[d.id]--}})}}))}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach(e=>this.intermediateTensors[e].forEach(t=>t.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach(e=>{this.tensorsMap[e].forEach(s=>{s&&!s.kept&&!s.isDisposed&&!this.keepIds.has(s.id)&&s.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach(t=>t.dispose()),delete this.intermediateTensors[e]}async _executeAsync(e,t,s=!1,r={},i={}){s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepTensorForDebug=Dt().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){console.warn(d.message)}this.resetIntermediateTensors();const a=new IO(this.weightMap,r,i,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,a,t,s);const o=t.map(d=>sr(d,this.tensorsMap,a)),l=o.map(d=>d.id),u=Object.keys(e).map(d=>e[d].id);return this.keepIds=new Set([...l,...u,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),this.parent==null&&a.dispose(this.keepIds),o}async executeFunctionAsync(e,t,s){const r=e.reduce((i,a,o)=>(i[this.inputs[o].name]=a,i),{});return this._executeAsync(r,this.outputNodes,!0,t,s)}async executeWithControlFlow(e,t,s,r){const i=Object.keys(e),a=i.map($=>this.graph.nodes[Nr($)[0]]),o=s.map($=>Nr($)[0]);let l=o.map($=>this.graph.nodes[$]);l.length===0&&(l=this._outputs);const{usedNodes:u,missingInputs:d,dynamicNode:f,syncInputs:m}=$O(e,l,this.weightMap,this._initNodes),y=[...a,...this.graph.weights,...this._initNodes||[]].map($=>({node:$,contexts:t.currentContext})),b=Object.assign({},this.weightMap);Object.keys(e).forEach($=>{const[C,O]=Nr($),V=[];V[O]=e[$],b[C]=V});const w={},x=this.getFrozenTensorIds(b),T={};for(;y.length>0;){const $=this.processStack(a,y,t,b,T,x,o,w,u);await Promise.all($)}f==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const E=l.filter($=>!FU($)&&!sr($.name,b,t)).map($=>$.name);if(E.length>0){let $="";throw f!=null&&($=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${m}]`),new Error(`Cannot compute the outputs [${E}] from the provided inputs [${i}]. Consider providing the following inputs: [${d}]. ${$}`)}return b}processStack(e,t,s,r,i,a,o,l,u){const d=[];for(;t.length>0;){const f=t.pop();s.currentContext=f.contexts;let m="";if(f.node.op==="Enter"&&L("isConstant",f.node,r,s)&&([m]=Ea(f.node.name,s)),r[f.node.name]==null){const y=_O(f.node,r,s,this._resourceManager);m||([m]=Ea(f.node.name,s));const b=s.currentContext;Ld(y)?d.push(y.then(w=>(r[m]=w,s.currentContext=b,this.checkTensorForDisposal(m,f.node,r,s,a,o,l),this.processChildNodes(f.node,t,s,r,i,u),w))):(r[m]=y,this.checkTensorForDisposal(m,f.node,r,s,a,o,l),this.processChildNodes(f.node,t,s,r,i,u))}else this.processChildNodes(f.node,t,s,r,i,u)}return d}processChildNodes(e,t,s,r,i,a){e.children.forEach(o=>{const[l]=Ea(o.name,s);i[l]||!a.has(o.name)||(o.op==="Merge"?o.inputNames.some(u=>!!sr(u,r,s))&&(i[l]=!0,t.push({contexts:s.currentContext,node:o})):o.inputNames.every(u=>!!sr(u,r,s))&&(i[l]=!0,t.push({contexts:s.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const s=e[t],[r]=Nr(t),i=this.graph.nodes[r];if(i.attrParams.shape&&i.attrParams.shape.value){const a=i.attrParams.shape.value,o=a.length===s.shape.length&&s.shape.every((l,u)=>a[u]===-1||a[u]===l);X(o,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${a}], but was [${s.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&X(s.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){const t={};for(const s in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[s]!=null){const r=this._signature.inputs[s];t[r.name]=e[s]}else t[s]=e[s];return t}checkInputs(e){const t=Object.keys(e).filter(s=>{const[r]=Nr(s);return this.graph.nodes[r]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[t]!=null?this._signature.outputs[t].name:t,{})}checkOutputs(e){e.forEach(t=>{const[s]=Nr(t);if(!this.graph.nodes[s])throw new Error(`The output '${t}' is not found in the graph`)})}}class MAe{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VAe="?tfjs-format=file",BAe="model.json";class zAe{constructor(e,t={},s=Q4){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=s,t==null&&(this.loadOptions={}),this.resourceManager=new MAe}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Ld(e)?e.then(t=>this.loadSync(t)):this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(s=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}this.signature=s,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const r=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new bx(wO.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=wO.Instance.transformGraph(e.modelInitializer);this.initializer=new bx(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,t){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,t){const s=this.execute(e,this.outputNodes);if(this.structuredOutputKeys){const r=s instanceof Ps?[s]:s,i={};return r.forEach((a,o)=>i[this.structuredOutputKeys[o]]=a),i}return s}normalizeInputs(e){if(!(e instanceof Ps)&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce((t,s,r)=>(t[s]=e[r],t),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=this.executor.execute(e,t);return s.length>1?s:s[0]}async executeAsync(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=await this.executor.executeAsync(e,t);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,s)=>(t[s]=[e[s]],t),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function CO(n,e={},t=Q4){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=UAe(n));const s=new zAe(n,e,t);return await s.load(),s}function UAe(n){return n.endsWith("/")||(n=n+"/"),`${n}${BAe}${VAe}`}/**
    * @license
    * Copyright 2021 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */function nm(n,e,t,s){return new(t||(t=Promise))(function(r,i){function a(u){try{l(s.next(u))}catch(d){i(d)}}function o(u){try{l(s.throw(u))}catch(d){i(d)}}function l(u){var d;u.done?r(u.value):(d=u.value,d instanceof t?d:new t(function(f){f(d)})).then(a,o)}l((s=s.apply(n,[])).next())})}function sm(n,e){var t,s,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(l){return function(u){return function(d){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,s&&(r=2&d[0]?s.return:d[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,d[1])).done)return r;switch(s=0,r&&(d=[2&d[0],r.value]),d[0]){case 0:case 1:r=d;break;case 4:return a.label++,{value:d[1],done:!1};case 5:a.label++,s=d[1],d=[0];continue;case 7:d=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(d[0]===6||d[0]===2)){a=0;continue}if(d[0]===3&&(!r||d[1]>r[0]&&d[1]<r[3])){a.label=d[1];break}if(d[0]===6&&a.label<r[1]){a.label=r[1],r=d;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(d);break}r[2]&&a.ops.pop(),a.trys.pop();continue}d=e.call(n,a)}catch(f){d=[6,f],s=0}finally{t=r=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([l,u])}}}var LU=function(n){for(var e=[],t=0,s=n;t<s.length;t++){var r=s[t];e.push(r)}return e},NO=function(){return function(){this.parent=null,this.children={},this.end=!1,this.word=[[],0,0]}}(),jAe=function(){function n(){this.root=new NO}return n.prototype.insert=function(e,t,s){for(var r=this.root,i=LU(e),a=0;a<i.length;a++)r.children[i[a]]||(r.children[i[a]]=new NO,r.children[i[a]].parent=r,r.children[i[a]].word[0]=r.word[0].concat(i[a])),r=r.children[i[a]],a===i.length-1&&(r.end=!0,r.word[1]=t,r.word[2]=s)},n.prototype.commonPrefixSearch=function(e){for(var t=[],s=this.root.children[e[0]],r=0;r<e.length&&s;r++)s.end&&t.push(s.word),s=s.children[e[r+1]];return t.length||t.push([[e[0]],0,0]),t},n}(),kO="▁";function WAe(n){var e=n.normalize("NFKC");return e.length>0?kO+e.replace(/ /g,kO):e}var GAe=6,HAe=function(){function n(e,t){t===void 0&&(t=GAe),this.vocabulary=e,this.reservedSymbolsCount=t,this.trie=new jAe;for(var s=this.reservedSymbolsCount;s<this.vocabulary.length;s++)this.trie.insert(this.vocabulary[s][0],this.vocabulary[s][1],s)}return n.prototype.encode=function(e){var t=[],s=[],r=[];e=WAe(e);for(var i=LU(e),a=0;a<=i.length;a++)t.push({}),s.push(0),r.push(0);for(a=0;a<i.length;a++)for(var o=this.trie.commonPrefixSearch(i.slice(a)),l=0;l<o.length;l++){var u=o[l],d={key:u[0],score:u[1],index:u[2]};t[a+(f=u[0].length)][a]==null&&(t[a+f][a]=[]),t[a+f][a].push(d)}for(var f=0;f<=i.length;f++)for(var m in t[f]){var y=t[f][m];for(l=0;l<y.length;l++){var b=y[l],w=b.score+r[f-b.key.length];(r[f]===0||w>=r[f])&&(r[f]=w,s[f]=y[l].index)}}for(var x=[],T=s.length-1;T>0;)x.push(s[T]),T-=this.vocabulary[s[T]][0].length;var E=[],$=!1;for(a=0;a<x.length;a++){var C=x[a];$&&C===0||E.push(C),$=C===0}return E.reverse()},n}();function qAe(n){return nm(this,void 0,void 0,function(){return sm(this,function(e){switch(e.label){case 0:return[4,TSe(n)];case 1:return[2,e.sent().json()]}})})}var KAe="https://storage.googleapis.com/tfjs-models/savedmodel/universal_sentence_encoder";function XAe(n){return nm(this,void 0,void 0,function(){var e;return sm(this,function(t){switch(t.label){case 0:return[4,(e=new YAe).load(n)];case 1:return t.sent(),[2,e]}})})}var YAe=function(){function n(){}return n.prototype.loadModel=function(e){return nm(this,void 0,void 0,function(){return sm(this,function(t){return[2,e?CO(e):CO("https://tfhub.dev/tensorflow/tfjs-model/universal-sentence-encoder-lite/1/default/1",{fromTFHub:!0})]})})},n.prototype.load=function(e){return e===void 0&&(e={}),nm(this,void 0,void 0,function(){var t,s,r;return sm(this,function(i){switch(i.label){case 0:return[4,Promise.all([this.loadModel(e.modelUrl),qAe(e.vocabUrl||KAe+"/vocab.json")])];case 1:return t=i.sent(),s=t[0],r=t[1],this.model=s,this.tokenizer=new HAe(r),[2]}})})},n.prototype.embed=function(e){return nm(this,void 0,void 0,function(){var t,s,r,i,a,o,l,u,d=this;return sm(this,function(f){switch(f.label){case 0:for(typeof e=="string"&&(e=[e]),t=e.map(function(m){return d.tokenizer.encode(m)}),s=t.map(function(m,y){return m.map(function(b,w){return[y,w]})}),r=[],i=0;i<s.length;i++)r=r.concat(s[i]);return a=xd(r,[r.length,2],"int32"),o=Ei(ay(t),"int32"),l={indices:a,values:o},[4,this.model.executeAsync(l)];case 1:return u=f.sent(),a.dispose(),o.dispose(),[2,u]}})})},n}();let AO=!1;const BC={orthopedics:["leg pain","broken bone","broken leg","back pain","joint pain","shoulder dislocation","ankle dislocation","wrist dislocation","finger dislocation","ankle sprains","wrist sprain","knee sprain","hip pain","osteoporosis","arthritis","fracture","neck pain","spinal stenosis","carpal tunnel syndrome","rotator cuff injury","scoliosis"],emergency:["broken bone","shoulder dislocation","ankle dislocation","wrist dislocation","finger dislocation","severe headache","high fever","vomiting","allergic reaction","cuts","lacerations","burns","concussion","chest pain","shortness of breath","seizures","stroke symptoms","heart attack symptoms","uncontrolled bleeding","poisoning","drug overdose","acute asthma attack","loss of consciousness","acute abdominal pain"],"physical therapy":["back pain","neck pain","joint stiffness","mobility issues","sports injury rehabilitation","post-operative recovery","balance disorders","muscle weakness","chronic pain"],rheumatology:["joint pain","arthritis","rheumatoid arthritis","lupus","fibromyalgia","gout","autoimmune disease","systemic sclerosis","sjogren's syndrome","ankylosing spondylitis"],"sports medicine":["ankle sprains","wrist sprain","knee sprain","ACL injury","meniscus tear","sports-related concussion","tennis elbow","golfer's elbow","hamstring strain","shin splints","stress fractures"],"general practice":["minor illness","minor headache","headache","fever","cough","cold","sore throat","sinus infection","flu","mono","stomach ache","stomach pain","stomach bug","diarrhea","nausea","allergies","covid-19","strep throat","bruises","minor burns","skin rashes","rash","infections","hypertension","diabetes management","cholesterol management","fatigue","ear infections","urinary tract infections (UTI)","eye infections"],"urgent care":["minor illness","minor headache","fever","high fever","cold","sore throat","sinus infection","flu","mono","vomiting","strep throat","cuts","lacerations","bruises","minor burns","sprains","strains","ear pain","eye irritation","UTI symptoms","minor allergic reaction"],neurology:["severe headache","headache","concussion","migraine","epilepsy","Parkinson's disease","multiple sclerosis","neuropathy","memory loss","tremors","stroke","Alzheimer's disease"],pulmonology:["cough","asthma","COPD","bronchitis","pneumonia","shortness of breath","lung infections","sleep apnea","tuberculosis","emphysema"],gastroenterology:["stomach ache","stomach pain","stomach bug","vomiting","diarrhea","nausea","IBS","Crohn's disease","ulcerative colitis","gastritis","acid reflux","ulcers","celiac disease","gastroenteritis","hepatitis","pancreatitis"],allergy:["allergies","allergic reaction","seasonal allergies","food allergies","insect bite reaction","anaphylaxis","hay fever","eczema","hives"],"infectious disease":["covid-19","infections","HIV/AIDS","hepatitis B","hepatitis C","MRSA","Lyme disease","malaria","measles","mumps","rubella","chickenpox","meningitis","influenza","mononucleosis"],dermatology:["skin rashes","rash","acne","eczema","psoriasis","skin infections","dermatitis","skin cancer","melanoma","fungal infections","warts","rosacea"],psychiatry:["mental health","depression","anxiety","bipolar disorder","schizophrenia","PTSD","OCD","ADHD","panic disorder","eating disorders","substance abuse"],psychology:["mental health","depression","anxiety","stress management","behavioral therapy","family counseling","grief counseling","psychological assessments","PTSD"],obstetrics:["pregnancy","prenatal care","labor and delivery","postpartum care","gestational diabetes","pre-eclampsia","ectopic pregnancy","miscarriage management"],gynecology:["pregnancy","menstrual disorders","menopause","uterine fibroids","PCOS","endometriosis","ovarian cysts","pelvic pain","cervical cancer screening","sexually transmitted infections (STI)"],pediatrics:["children","childhood immunizations","growth and developmental issues","ear infections","common colds","fevers in children","asthma in children","allergies in children","child behavioral issues","nutrition guidance","childhood diabetes"],xray:["broken","fracture","dislocation","sprains","chest pain","cough","pneumonia","lung infections","arthritis","joint pain","osteoporosis","scoliosis","tumors","foreign body","sinus infections","digestive tract obstructions","abdominal pain","swallowed objects","kidney stones","spinal injuries"]},jl={};for(const[n,e]of Object.entries(BC))e.forEach(t=>{jl[t]||(jl[t]=[]),jl[t].push(n)});const vd={symptoms:null,symptomKeys:null};let Kp=null;const QAe=async()=>{if(!Kp)try{AO||(await o8(),AO=!0,console.log("TensorFlow.js is ready, attempting to load model...")),Kp=await XAe(),console.log("Model loaded successfully")}catch(n){console.error("Error loading model:",n),Kp=null}return Kp},PU=async n=>{const e=await QAe();return e?e.embed(n):null},ZAe=async()=>{if(vd.symptoms)return;const e=[...Object.keys(jl),...Object.keys(BC)];try{const t=await PU(e);vd.symptoms=t,vd.symptomKeys=e}catch(t){console.error("Error initializing embeddings:",t)}},JAe=(n,e)=>ge(()=>{const t=Je(n,Cd(n)),s=Je(e,Cd(e));return Ze(se(t,s))}),eRe=async(n,e=.6)=>{try{if(await ZAe(),!Kp||!vd.symptoms)return console.warn("Model unavailable - skipping semantic matching"),[];const t=await PU([n]);if(!t)return[];const s=vd.symptomKeys.map((r,i)=>{const a=sn(vd.symptoms,[i,0],[1,-1]),o=JAe(t,a).dataSync()[0];return{symptom:r,similarity:o}});return t.dispose(),s.filter(r=>r.similarity>e).sort((r,i)=>i.similarity-r.similarity).map(r=>r.symptom)}catch(t){return console.error("Error in semantic matching process:",t),[]}},tRe=async n=>{const e=n.toLowerCase();let t=[];console.log("Analyzing input:",e);let s=[];for(const[r,i]of Object.entries(jl))e.includes(r)&&(console.log(`Exact match found: "${r}"`),s.push(r),t=[...t,...i]);if(console.log("Exact matches:",s),console.log("Specialties from exact matches:",t),t.length===0){console.log("No exact matches, trying semantic matching...");try{const r=await eRe(e);if(console.log("Semantic matches:",r),r.length>0){for(const i of r)jl[i]?(console.log(`Matched symptom semantically: "${i}" -> specialties:`,jl[i]),t=[...t,...jl[i]]):BC[i]&&(console.log(`Matched specialty name directly: "${i}"`),t.push(i));console.log("Specialties from semantic matches:",t)}else console.log("No semantic matches found")}catch(r){console.error("Error in semantic matching:",r)}}return t.length===0&&(console.log("No matches found, using default categories"),t=["general practice","urgent care"]),t=[...new Set(t)],console.log("Final matched specialties:",t),t};var RO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Su,MU;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(F,R){function N(){}N.prototype=R.prototype,F.D=R.prototype,F.prototype=new N,F.prototype.constructor=F,F.C=function(D,k,z){for(var B=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)B[ne-2]=arguments[ne];return R.prototype[k].apply(D,B)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(F,R,N){N||(N=0);var D=Array(16);if(typeof R=="string")for(var k=0;16>k;++k)D[k]=R.charCodeAt(N++)|R.charCodeAt(N++)<<8|R.charCodeAt(N++)<<16|R.charCodeAt(N++)<<24;else for(k=0;16>k;++k)D[k]=R[N++]|R[N++]<<8|R[N++]<<16|R[N++]<<24;R=F.g[0],N=F.g[1],k=F.g[2];var z=F.g[3],B=R+(z^N&(k^z))+D[0]+3614090360&4294967295;R=N+(B<<7&4294967295|B>>>25),B=z+(k^R&(N^k))+D[1]+3905402710&4294967295,z=R+(B<<12&4294967295|B>>>20),B=k+(N^z&(R^N))+D[2]+606105819&4294967295,k=z+(B<<17&4294967295|B>>>15),B=N+(R^k&(z^R))+D[3]+3250441966&4294967295,N=k+(B<<22&4294967295|B>>>10),B=R+(z^N&(k^z))+D[4]+4118548399&4294967295,R=N+(B<<7&4294967295|B>>>25),B=z+(k^R&(N^k))+D[5]+1200080426&4294967295,z=R+(B<<12&4294967295|B>>>20),B=k+(N^z&(R^N))+D[6]+2821735955&4294967295,k=z+(B<<17&4294967295|B>>>15),B=N+(R^k&(z^R))+D[7]+4249261313&4294967295,N=k+(B<<22&4294967295|B>>>10),B=R+(z^N&(k^z))+D[8]+1770035416&4294967295,R=N+(B<<7&4294967295|B>>>25),B=z+(k^R&(N^k))+D[9]+2336552879&4294967295,z=R+(B<<12&4294967295|B>>>20),B=k+(N^z&(R^N))+D[10]+4294925233&4294967295,k=z+(B<<17&4294967295|B>>>15),B=N+(R^k&(z^R))+D[11]+2304563134&4294967295,N=k+(B<<22&4294967295|B>>>10),B=R+(z^N&(k^z))+D[12]+1804603682&4294967295,R=N+(B<<7&4294967295|B>>>25),B=z+(k^R&(N^k))+D[13]+4254626195&4294967295,z=R+(B<<12&4294967295|B>>>20),B=k+(N^z&(R^N))+D[14]+2792965006&4294967295,k=z+(B<<17&4294967295|B>>>15),B=N+(R^k&(z^R))+D[15]+1236535329&4294967295,N=k+(B<<22&4294967295|B>>>10),B=R+(k^z&(N^k))+D[1]+4129170786&4294967295,R=N+(B<<5&4294967295|B>>>27),B=z+(N^k&(R^N))+D[6]+3225465664&4294967295,z=R+(B<<9&4294967295|B>>>23),B=k+(R^N&(z^R))+D[11]+643717713&4294967295,k=z+(B<<14&4294967295|B>>>18),B=N+(z^R&(k^z))+D[0]+3921069994&4294967295,N=k+(B<<20&4294967295|B>>>12),B=R+(k^z&(N^k))+D[5]+3593408605&4294967295,R=N+(B<<5&4294967295|B>>>27),B=z+(N^k&(R^N))+D[10]+38016083&4294967295,z=R+(B<<9&4294967295|B>>>23),B=k+(R^N&(z^R))+D[15]+3634488961&4294967295,k=z+(B<<14&4294967295|B>>>18),B=N+(z^R&(k^z))+D[4]+3889429448&4294967295,N=k+(B<<20&4294967295|B>>>12),B=R+(k^z&(N^k))+D[9]+568446438&4294967295,R=N+(B<<5&4294967295|B>>>27),B=z+(N^k&(R^N))+D[14]+3275163606&4294967295,z=R+(B<<9&4294967295|B>>>23),B=k+(R^N&(z^R))+D[3]+4107603335&4294967295,k=z+(B<<14&4294967295|B>>>18),B=N+(z^R&(k^z))+D[8]+1163531501&4294967295,N=k+(B<<20&4294967295|B>>>12),B=R+(k^z&(N^k))+D[13]+2850285829&4294967295,R=N+(B<<5&4294967295|B>>>27),B=z+(N^k&(R^N))+D[2]+4243563512&4294967295,z=R+(B<<9&4294967295|B>>>23),B=k+(R^N&(z^R))+D[7]+1735328473&4294967295,k=z+(B<<14&4294967295|B>>>18),B=N+(z^R&(k^z))+D[12]+2368359562&4294967295,N=k+(B<<20&4294967295|B>>>12),B=R+(N^k^z)+D[5]+4294588738&4294967295,R=N+(B<<4&4294967295|B>>>28),B=z+(R^N^k)+D[8]+2272392833&4294967295,z=R+(B<<11&4294967295|B>>>21),B=k+(z^R^N)+D[11]+1839030562&4294967295,k=z+(B<<16&4294967295|B>>>16),B=N+(k^z^R)+D[14]+4259657740&4294967295,N=k+(B<<23&4294967295|B>>>9),B=R+(N^k^z)+D[1]+2763975236&4294967295,R=N+(B<<4&4294967295|B>>>28),B=z+(R^N^k)+D[4]+1272893353&4294967295,z=R+(B<<11&4294967295|B>>>21),B=k+(z^R^N)+D[7]+4139469664&4294967295,k=z+(B<<16&4294967295|B>>>16),B=N+(k^z^R)+D[10]+3200236656&4294967295,N=k+(B<<23&4294967295|B>>>9),B=R+(N^k^z)+D[13]+681279174&4294967295,R=N+(B<<4&4294967295|B>>>28),B=z+(R^N^k)+D[0]+3936430074&4294967295,z=R+(B<<11&4294967295|B>>>21),B=k+(z^R^N)+D[3]+3572445317&4294967295,k=z+(B<<16&4294967295|B>>>16),B=N+(k^z^R)+D[6]+76029189&4294967295,N=k+(B<<23&4294967295|B>>>9),B=R+(N^k^z)+D[9]+3654602809&4294967295,R=N+(B<<4&4294967295|B>>>28),B=z+(R^N^k)+D[12]+3873151461&4294967295,z=R+(B<<11&4294967295|B>>>21),B=k+(z^R^N)+D[15]+530742520&4294967295,k=z+(B<<16&4294967295|B>>>16),B=N+(k^z^R)+D[2]+3299628645&4294967295,N=k+(B<<23&4294967295|B>>>9),B=R+(k^(N|~z))+D[0]+4096336452&4294967295,R=N+(B<<6&4294967295|B>>>26),B=z+(N^(R|~k))+D[7]+1126891415&4294967295,z=R+(B<<10&4294967295|B>>>22),B=k+(R^(z|~N))+D[14]+2878612391&4294967295,k=z+(B<<15&4294967295|B>>>17),B=N+(z^(k|~R))+D[5]+4237533241&4294967295,N=k+(B<<21&4294967295|B>>>11),B=R+(k^(N|~z))+D[12]+1700485571&4294967295,R=N+(B<<6&4294967295|B>>>26),B=z+(N^(R|~k))+D[3]+2399980690&4294967295,z=R+(B<<10&4294967295|B>>>22),B=k+(R^(z|~N))+D[10]+4293915773&4294967295,k=z+(B<<15&4294967295|B>>>17),B=N+(z^(k|~R))+D[1]+2240044497&4294967295,N=k+(B<<21&4294967295|B>>>11),B=R+(k^(N|~z))+D[8]+1873313359&4294967295,R=N+(B<<6&4294967295|B>>>26),B=z+(N^(R|~k))+D[15]+4264355552&4294967295,z=R+(B<<10&4294967295|B>>>22),B=k+(R^(z|~N))+D[6]+2734768916&4294967295,k=z+(B<<15&4294967295|B>>>17),B=N+(z^(k|~R))+D[13]+1309151649&4294967295,N=k+(B<<21&4294967295|B>>>11),B=R+(k^(N|~z))+D[4]+4149444226&4294967295,R=N+(B<<6&4294967295|B>>>26),B=z+(N^(R|~k))+D[11]+3174756917&4294967295,z=R+(B<<10&4294967295|B>>>22),B=k+(R^(z|~N))+D[2]+718787259&4294967295,k=z+(B<<15&4294967295|B>>>17),B=N+(z^(k|~R))+D[9]+3951481745&4294967295,F.g[0]=F.g[0]+R&4294967295,F.g[1]=F.g[1]+(k+(B<<21&4294967295|B>>>11))&4294967295,F.g[2]=F.g[2]+k&4294967295,F.g[3]=F.g[3]+z&4294967295}s.prototype.u=function(F,R){R===void 0&&(R=F.length);for(var N=R-this.blockSize,D=this.B,k=this.h,z=0;z<R;){if(k==0)for(;z<=N;)r(this,F,z),z+=this.blockSize;if(typeof F=="string"){for(;z<R;)if(D[k++]=F.charCodeAt(z++),k==this.blockSize){r(this,D),k=0;break}}else for(;z<R;)if(D[k++]=F[z++],k==this.blockSize){r(this,D),k=0;break}}this.h=k,this.o+=R},s.prototype.v=function(){var F=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);F[0]=128;for(var R=1;R<F.length-8;++R)F[R]=0;var N=8*this.o;for(R=F.length-8;R<F.length;++R)F[R]=N&255,N/=256;for(this.u(F),F=Array(16),R=N=0;4>R;++R)for(var D=0;32>D;D+=8)F[N++]=this.g[R]>>>D&255;return F};function i(F,R){var N=o;return Object.prototype.hasOwnProperty.call(N,F)?N[F]:N[F]=R(F)}function a(F,R){this.h=R;for(var N=[],D=!0,k=F.length-1;0<=k;k--){var z=F[k]|0;D&&z==R||(N[k]=z,D=!1)}this.g=N}var o={};function l(F){return-128<=F&&128>F?i(F,function(R){return new a([R|0],0>R?-1:0)}):new a([F|0],0>F?-1:0)}function u(F){if(isNaN(F)||!isFinite(F))return f;if(0>F)return x(u(-F));for(var R=[],N=1,D=0;F>=N;D++)R[D]=F/N|0,N*=4294967296;return new a(R,0)}function d(F,R){if(F.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(F.charAt(0)=="-")return x(d(F.substring(1),R));if(0<=F.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=u(Math.pow(R,8)),D=f,k=0;k<F.length;k+=8){var z=Math.min(8,F.length-k),B=parseInt(F.substring(k,k+z),R);8>z?(z=u(Math.pow(R,z)),D=D.j(z).add(u(B))):(D=D.j(N),D=D.add(u(B)))}return D}var f=l(0),m=l(1),y=l(16777216);n=a.prototype,n.m=function(){if(w(this))return-x(this).m();for(var F=0,R=1,N=0;N<this.g.length;N++){var D=this.i(N);F+=(0<=D?D:4294967296+D)*R,R*=4294967296}return F},n.toString=function(F){if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(b(this))return"0";if(w(this))return"-"+x(this).toString(F);for(var R=u(Math.pow(F,6)),N=this,D="";;){var k=C(N,R).g;N=T(N,k.j(R));var z=((0<N.g.length?N.g[0]:N.h)>>>0).toString(F);if(N=k,b(N))return z+D;for(;6>z.length;)z="0"+z;D=z+D}},n.i=function(F){return 0>F?0:F<this.g.length?this.g[F]:this.h};function b(F){if(F.h!=0)return!1;for(var R=0;R<F.g.length;R++)if(F.g[R]!=0)return!1;return!0}function w(F){return F.h==-1}n.l=function(F){return F=T(this,F),w(F)?-1:b(F)?0:1};function x(F){for(var R=F.g.length,N=[],D=0;D<R;D++)N[D]=~F.g[D];return new a(N,~F.h).add(m)}n.abs=function(){return w(this)?x(this):this},n.add=function(F){for(var R=Math.max(this.g.length,F.g.length),N=[],D=0,k=0;k<=R;k++){var z=D+(this.i(k)&65535)+(F.i(k)&65535),B=(z>>>16)+(this.i(k)>>>16)+(F.i(k)>>>16);D=B>>>16,z&=65535,B&=65535,N[k]=B<<16|z}return new a(N,N[N.length-1]&-2147483648?-1:0)};function T(F,R){return F.add(x(R))}n.j=function(F){if(b(this)||b(F))return f;if(w(this))return w(F)?x(this).j(x(F)):x(x(this).j(F));if(w(F))return x(this.j(x(F)));if(0>this.l(y)&&0>F.l(y))return u(this.m()*F.m());for(var R=this.g.length+F.g.length,N=[],D=0;D<2*R;D++)N[D]=0;for(D=0;D<this.g.length;D++)for(var k=0;k<F.g.length;k++){var z=this.i(D)>>>16,B=this.i(D)&65535,ne=F.i(k)>>>16,J=F.i(k)&65535;N[2*D+2*k]+=B*J,E(N,2*D+2*k),N[2*D+2*k+1]+=z*J,E(N,2*D+2*k+1),N[2*D+2*k+1]+=B*ne,E(N,2*D+2*k+1),N[2*D+2*k+2]+=z*ne,E(N,2*D+2*k+2)}for(D=0;D<R;D++)N[D]=N[2*D+1]<<16|N[2*D];for(D=R;D<2*R;D++)N[D]=0;return new a(N,0)};function E(F,R){for(;(F[R]&65535)!=F[R];)F[R+1]+=F[R]>>>16,F[R]&=65535,R++}function $(F,R){this.g=F,this.h=R}function C(F,R){if(b(R))throw Error("division by zero");if(b(F))return new $(f,f);if(w(F))return R=C(x(F),R),new $(x(R.g),x(R.h));if(w(R))return R=C(F,x(R)),new $(x(R.g),R.h);if(30<F.g.length){if(w(F)||w(R))throw Error("slowDivide_ only works with positive integers.");for(var N=m,D=R;0>=D.l(F);)N=O(N),D=O(D);var k=V(N,1),z=V(D,1);for(D=V(D,2),N=V(N,2);!b(D);){var B=z.add(D);0>=B.l(F)&&(k=k.add(N),z=B),D=V(D,1),N=V(N,1)}return R=T(F,k.j(R)),new $(k,R)}for(k=f;0<=F.l(R);){for(N=Math.max(1,Math.floor(F.m()/R.m())),D=Math.ceil(Math.log(N)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),z=u(N),B=z.j(R);w(B)||0<B.l(F);)N-=D,z=u(N),B=z.j(R);b(z)&&(z=m),k=k.add(z),F=T(F,B)}return new $(k,F)}n.A=function(F){return C(this,F).h},n.and=function(F){for(var R=Math.max(this.g.length,F.g.length),N=[],D=0;D<R;D++)N[D]=this.i(D)&F.i(D);return new a(N,this.h&F.h)},n.or=function(F){for(var R=Math.max(this.g.length,F.g.length),N=[],D=0;D<R;D++)N[D]=this.i(D)|F.i(D);return new a(N,this.h|F.h)},n.xor=function(F){for(var R=Math.max(this.g.length,F.g.length),N=[],D=0;D<R;D++)N[D]=this.i(D)^F.i(D);return new a(N,this.h^F.h)};function O(F){for(var R=F.g.length+1,N=[],D=0;D<R;D++)N[D]=F.i(D)<<1|F.i(D-1)>>>31;return new a(N,F.h)}function V(F,R){var N=R>>5;R%=32;for(var D=F.g.length-N,k=[],z=0;z<D;z++)k[z]=0<R?F.i(z+N)>>>R|F.i(z+N+1)<<32-R:F.i(z+N);return new a(k,F.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,MU=s,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=d,Su=a}).apply(typeof RO<"u"?RO:typeof self<"u"?self:typeof window<"u"?window:{});var Xb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var VU,Xp,BU,w0,UE,zU,UU,jU;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(v,A,P){return v==Array.prototype||v==Object.prototype||(v[A]=P.value),v};function t(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xb=="object"&&Xb];for(var A=0;A<v.length;++A){var P=v[A];if(P&&P.Math==Math)return P}throw Error("Cannot find global object")}var s=t(this);function r(v,A){if(A)e:{var P=s;v=v.split(".");for(var G=0;G<v.length-1;G++){var pe=v[G];if(!(pe in P))break e;P=P[pe]}v=v[v.length-1],G=P[v],A=A(G),A!=G&&A!=null&&e(P,v,{configurable:!0,writable:!0,value:A})}}function i(v,A){v instanceof String&&(v+="");var P=0,G=!1,pe={next:function(){if(!G&&P<v.length){var Te=P++;return{value:A(Te,v[Te]),done:!1}}return G=!0,{done:!0,value:void 0}}};return pe[Symbol.iterator]=function(){return pe},pe}r("Array.prototype.values",function(v){return v||function(){return i(this,function(A,P){return P})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(v){var A=typeof v;return A=A!="object"?A:v?Array.isArray(v)?"array":A:"null",A=="array"||A=="object"&&typeof v.length=="number"}function u(v){var A=typeof v;return A=="object"&&v!=null||A=="function"}function d(v,A,P){return v.call.apply(v.bind,arguments)}function f(v,A,P){if(!v)throw Error();if(2<arguments.length){var G=Array.prototype.slice.call(arguments,2);return function(){var pe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(pe,G),v.apply(A,pe)}}return function(){return v.apply(A,arguments)}}function m(v,A,P){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,m.apply(null,arguments)}function y(v,A){var P=Array.prototype.slice.call(arguments,1);return function(){var G=P.slice();return G.push.apply(G,arguments),v.apply(this,G)}}function b(v,A){function P(){}P.prototype=A.prototype,v.aa=A.prototype,v.prototype=new P,v.prototype.constructor=v,v.Qb=function(G,pe,Te){for(var Pe=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)Pe[Nt-2]=arguments[Nt];return A.prototype[pe].apply(G,Pe)}}function w(v){const A=v.length;if(0<A){const P=Array(A);for(let G=0;G<A;G++)P[G]=v[G];return P}return[]}function x(v,A){for(let P=1;P<arguments.length;P++){const G=arguments[P];if(l(G)){const pe=v.length||0,Te=G.length||0;v.length=pe+Te;for(let Pe=0;Pe<Te;Pe++)v[pe+Pe]=G[Pe]}else v.push(G)}}class T{constructor(A,P){this.i=A,this.j=P,this.h=0,this.g=null}get(){let A;return 0<this.h?(this.h--,A=this.g,this.g=A.next,A.next=null):A=this.i(),A}}function E(v){return/^[\s\xa0]*$/.test(v)}function $(){var v=o.navigator;return v&&(v=v.userAgent)?v:""}function C(v){return C[" "](v),v}C[" "]=function(){};var O=$().indexOf("Gecko")!=-1&&!($().toLowerCase().indexOf("webkit")!=-1&&$().indexOf("Edge")==-1)&&!($().indexOf("Trident")!=-1||$().indexOf("MSIE")!=-1)&&$().indexOf("Edge")==-1;function V(v,A,P){for(const G in v)A.call(P,v[G],G,v)}function F(v,A){for(const P in v)A.call(void 0,v[P],P,v)}function R(v){const A={};for(const P in v)A[P]=v[P];return A}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(v,A){let P,G;for(let pe=1;pe<arguments.length;pe++){G=arguments[pe];for(P in G)v[P]=G[P];for(let Te=0;Te<N.length;Te++)P=N[Te],Object.prototype.hasOwnProperty.call(G,P)&&(v[P]=G[P])}}function k(v){var A=1;v=v.split(":");const P=[];for(;0<A&&v.length;)P.push(v.shift()),A--;return v.length&&P.push(v.join(":")),P}function z(v){o.setTimeout(()=>{throw v},0)}function B(){var v=he;let A=null;return v.g&&(A=v.g,v.g=v.g.next,v.g||(v.h=null),A.next=null),A}class ne{constructor(){this.h=this.g=null}add(A,P){const G=J.get();G.set(A,P),this.h?this.h.next=G:this.g=G,this.h=G}}var J=new T(()=>new K,v=>v.reset());class K{constructor(){this.next=this.g=this.h=null}set(A,P){this.h=A,this.g=P,this.next=null}reset(){this.next=this.g=this.h=null}}let re,Z=!1,he=new ne,W=()=>{const v=o.Promise.resolve(void 0);re=()=>{v.then(ee)}};var ee=()=>{for(var v;v=B();){try{v.h.call(v.g)}catch(P){z(P)}var A=J;A.j(v),100>A.h&&(A.h++,v.next=A.g,A.g=v)}Z=!1};function me(){this.s=this.s,this.C=this.C}me.prototype.s=!1,me.prototype.ma=function(){this.s||(this.s=!0,this.N())},me.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function de(v,A){this.type=v,this.g=this.target=A,this.defaultPrevented=!1}de.prototype.h=function(){this.defaultPrevented=!0};var be=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var v=!1,A=Object.defineProperty({},"passive",{get:function(){v=!0}});try{const P=()=>{};o.addEventListener("test",P,A),o.removeEventListener("test",P,A)}catch{}return v}();function _e(v,A){if(de.call(this,v?v.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,v){var P=this.type=v.type,G=v.changedTouches&&v.changedTouches.length?v.changedTouches[0]:null;if(this.target=v.target||v.srcElement,this.g=A,A=v.relatedTarget){if(O){e:{try{C(A.nodeName);var pe=!0;break e}catch{}pe=!1}pe||(A=null)}}else P=="mouseover"?A=v.fromElement:P=="mouseout"&&(A=v.toElement);this.relatedTarget=A,G?(this.clientX=G.clientX!==void 0?G.clientX:G.pageX,this.clientY=G.clientY!==void 0?G.clientY:G.pageY,this.screenX=G.screenX||0,this.screenY=G.screenY||0):(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0),this.button=v.button,this.key=v.key||"",this.ctrlKey=v.ctrlKey,this.altKey=v.altKey,this.shiftKey=v.shiftKey,this.metaKey=v.metaKey,this.pointerId=v.pointerId||0,this.pointerType=typeof v.pointerType=="string"?v.pointerType:Ne[v.pointerType]||"",this.state=v.state,this.i=v,v.defaultPrevented&&_e.aa.h.call(this)}}b(_e,de);var Ne={2:"touch",3:"pen",4:"mouse"};_e.prototype.h=function(){_e.aa.h.call(this);var v=this.i;v.preventDefault?v.preventDefault():v.returnValue=!1};var Ve="closure_listenable_"+(1e6*Math.random()|0),Le=0;function Be(v,A,P,G,pe){this.listener=v,this.proxy=null,this.src=A,this.type=P,this.capture=!!G,this.ha=pe,this.key=++Le,this.da=this.fa=!1}function je(v){v.da=!0,v.listener=null,v.proxy=null,v.src=null,v.ha=null}function Qe(v){this.src=v,this.g={},this.h=0}Qe.prototype.add=function(v,A,P,G,pe){var Te=v.toString();v=this.g[Te],v||(v=this.g[Te]=[],this.h++);var Pe=pt(v,A,G,pe);return-1<Pe?(A=v[Pe],P||(A.fa=!1)):(A=new Be(A,this.src,Te,!!G,pe),A.fa=P,v.push(A)),A};function ft(v,A){var P=A.type;if(P in v.g){var G=v.g[P],pe=Array.prototype.indexOf.call(G,A,void 0),Te;(Te=0<=pe)&&Array.prototype.splice.call(G,pe,1),Te&&(je(A),v.g[P].length==0&&(delete v.g[P],v.h--))}}function pt(v,A,P,G){for(var pe=0;pe<v.length;++pe){var Te=v[pe];if(!Te.da&&Te.listener==A&&Te.capture==!!P&&Te.ha==G)return pe}return-1}var Mt="closure_lm_"+(1e6*Math.random()|0),Tt={};function bt(v,A,P,G,pe){if(Array.isArray(A)){for(var Te=0;Te<A.length;Te++)bt(v,A[Te],P,G,pe);return null}return P=_r(P),v&&v[Ve]?v.K(A,P,u(G)?!!G.capture:!1,pe):qt(v,A,P,!1,G,pe)}function qt(v,A,P,G,pe,Te){if(!A)throw Error("Invalid event type");var Pe=u(pe)?!!pe.capture:!!pe,Nt=Lr(v);if(Nt||(v[Mt]=Nt=new Qe(v)),P=Nt.add(A,P,G,Pe,Te),P.proxy)return P;if(G=Vt(),P.proxy=G,G.src=v,G.listener=P,v.addEventListener)be||(pe=Pe),pe===void 0&&(pe=!1),v.addEventListener(A.toString(),G,pe);else if(v.attachEvent)v.attachEvent(hr(A.toString()),G);else if(v.addListener&&v.removeListener)v.addListener(G);else throw Error("addEventListener and attachEvent are unavailable.");return P}function Vt(){function v(P){return A.call(v.src,v.listener,P)}const A=As;return v}function qs(v,A,P,G,pe){if(Array.isArray(A))for(var Te=0;Te<A.length;Te++)qs(v,A[Te],P,G,pe);else G=u(G)?!!G.capture:!!G,P=_r(P),v&&v[Ve]?(v=v.i,A=String(A).toString(),A in v.g&&(Te=v.g[A],P=pt(Te,P,G,pe),-1<P&&(je(Te[P]),Array.prototype.splice.call(Te,P,1),Te.length==0&&(delete v.g[A],v.h--)))):v&&(v=Lr(v))&&(A=v.g[A.toString()],v=-1,A&&(v=pt(A,P,G,pe)),(P=-1<v?A[v]:null)&&hn(P))}function hn(v){if(typeof v!="number"&&v&&!v.da){var A=v.src;if(A&&A[Ve])ft(A.i,v);else{var P=v.type,G=v.proxy;A.removeEventListener?A.removeEventListener(P,G,v.capture):A.detachEvent?A.detachEvent(hr(P),G):A.addListener&&A.removeListener&&A.removeListener(G),(P=Lr(A))?(ft(P,v),P.h==0&&(P.src=null,A[Mt]=null)):je(v)}}}function hr(v){return v in Tt?Tt[v]:Tt[v]="on"+v}function As(v,A){if(v.da)v=!0;else{A=new _e(A,this);var P=v.listener,G=v.ha||v.src;v.fa&&hn(v),v=P.call(G,A)}return v}function Lr(v){return v=v[Mt],v instanceof Qe?v:null}var dn="__closure_events_fn_"+(1e9*Math.random()>>>0);function _r(v){return typeof v=="function"?v:(v[dn]||(v[dn]=function(A){return v.handleEvent(A)}),v[dn])}function en(){me.call(this),this.i=new Qe(this),this.M=this,this.F=null}b(en,me),en.prototype[Ve]=!0,en.prototype.removeEventListener=function(v,A,P,G){qs(this,v,A,P,G)};function an(v,A){var P,G=v.F;if(G)for(P=[];G;G=G.F)P.push(G);if(v=v.M,G=A.type||A,typeof A=="string")A=new de(A,v);else if(A instanceof de)A.target=A.target||v;else{var pe=A;A=new de(G,v),D(A,pe)}if(pe=!0,P)for(var Te=P.length-1;0<=Te;Te--){var Pe=A.g=P[Te];pe=ms(Pe,G,!0,A)&&pe}if(Pe=A.g=v,pe=ms(Pe,G,!0,A)&&pe,pe=ms(Pe,G,!1,A)&&pe,P)for(Te=0;Te<P.length;Te++)Pe=A.g=P[Te],pe=ms(Pe,G,!1,A)&&pe}en.prototype.N=function(){if(en.aa.N.call(this),this.i){var v=this.i,A;for(A in v.g){for(var P=v.g[A],G=0;G<P.length;G++)je(P[G]);delete v.g[A],v.h--}}this.F=null},en.prototype.K=function(v,A,P,G){return this.i.add(String(v),A,!1,P,G)},en.prototype.L=function(v,A,P,G){return this.i.add(String(v),A,!0,P,G)};function ms(v,A,P,G){if(A=v.i.g[String(A)],!A)return!0;A=A.concat();for(var pe=!0,Te=0;Te<A.length;++Te){var Pe=A[Te];if(Pe&&!Pe.da&&Pe.capture==P){var Nt=Pe.listener,rs=Pe.ha||Pe.src;Pe.fa&&ft(v.i,Pe),pe=Nt.call(rs,G)!==!1&&pe}}return pe&&!G.defaultPrevented}function sa(v,A,P){if(typeof v=="function")P&&(v=m(v,P));else if(v&&typeof v.handleEvent=="function")v=m(v.handleEvent,v);else throw Error("Invalid listener argument");return 2147483647<Number(A)?-1:o.setTimeout(v,A||0)}function qa(v){v.g=sa(()=>{v.g=null,v.i&&(v.i=!1,qa(v))},v.l);const A=v.h;v.h=null,v.m.apply(null,A)}class Cc extends me{constructor(A,P){super(),this.m=A,this.l=P,this.h=null,this.i=!1,this.g=null}j(A){this.h=arguments,this.g?this.i=!0:qa(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ka(v){me.call(this),this.h=v,this.g={}}b(Ka,me);var Pr=[];function gs(v){V(v.g,function(A,P){this.g.hasOwnProperty(P)&&hn(A)},v),v.g={}}Ka.prototype.N=function(){Ka.aa.N.call(this),gs(this)},Ka.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Nc=o.JSON.stringify,ra=o.JSON.parse,dr=class{stringify(v){return o.JSON.stringify(v,void 0)}parse(v){return o.JSON.parse(v,void 0)}};function Ef(){}Ef.prototype.h=null;function py(v){return v.h||(v.h=v.i())}function my(){}var ia={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Qo(){de.call(this,"d")}b(Qo,de);function Ai(){de.call(this,"c")}b(Ai,de);var Jr={},Zo=null;function ch(){return Zo=Zo||new en}Jr.La="serverreachability";function _f(v){de.call(this,Jr.La,v)}b(_f,de);function Jo(v){const A=ch();an(A,new _f(A))}Jr.STAT_EVENT="statevent";function uh(v,A){de.call(this,Jr.STAT_EVENT,v),this.stat=A}b(uh,de);function Vn(v){const A=ch();an(A,new uh(A,v))}Jr.Ma="timingevent";function gy(v,A){de.call(this,Jr.Ma,v),this.size=A}b(gy,de);function el(v,A){if(typeof v!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){v()},A)}function tl(){this.g=!0}tl.prototype.xa=function(){this.g=!1};function yy(v,A,P,G,pe,Te){v.info(function(){if(v.g)if(Te)for(var Pe="",Nt=Te.split("&"),rs=0;rs<Nt.length;rs++){var kt=Nt[rs].split("=");if(1<kt.length){var xs=kt[0];kt=kt[1];var is=xs.split("_");Pe=2<=is.length&&is[1]=="type"?Pe+(xs+"="+kt+"&"):Pe+(xs+"=redacted&")}}else Pe=null;else Pe=Te;return"XMLHTTP REQ ("+G+") [attempt "+pe+"]: "+A+`
`+P+`
`+Pe})}function by(v,A,P,G,pe,Te,Pe){v.info(function(){return"XMLHTTP RESP ("+G+") [ attempt "+pe+"]: "+A+`
`+P+`
`+Te+" "+Pe})}function nl(v,A,P,G){v.info(function(){return"XMLHTTP TEXT ("+A+"): "+ys(v,P)+(G?" "+G:"")})}function aa(v,A){v.info(function(){return"TIMEOUT: "+A})}tl.prototype.info=function(){};function ys(v,A){if(!v.g)return A;if(!A)return null;try{var P=JSON.parse(A);if(P){for(v=0;v<P.length;v++)if(Array.isArray(P[v])){var G=P[v];if(!(2>G.length)){var pe=G[1];if(Array.isArray(pe)&&!(1>pe.length)){var Te=pe[0];if(Te!="noop"&&Te!="stop"&&Te!="close")for(var Pe=1;Pe<pe.length;Pe++)pe[Pe]=""}}}}return Nc(P)}catch{return A}}var ss={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Xa={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},kc;function hh(){}b(hh,Ef),hh.prototype.g=function(){return new XMLHttpRequest},hh.prototype.i=function(){return{}},kc=new hh;function oa(v,A,P,G){this.j=v,this.i=A,this.l=P,this.R=G||1,this.U=new Ka(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new If}function If(){this.i=null,this.g="",this.h=!1}var sl={},Ac={};function Ri(v,A,P){v.L=1,v.v=Oc(Cn(A)),v.m=P,v.P=!0,Ya(v,null)}function Ya(v,A){v.F=Date.now(),Tn(v),v.A=Cn(v.v);var P=v.A,G=v.R;Array.isArray(G)||(G=[String(G)]),Ja(P.i,"t",G),v.C=0,P=v.j.J,v.h=new If,v.g=Ry(v.j,P?A:null,!v.m),0<v.O&&(v.M=new Cc(m(v.Y,v,v.g),v.O)),A=v.U,P=v.g,G=v.ca;var pe="readystatechange";Array.isArray(pe)||(pe&&(Pr[0]=pe.toString()),pe=Pr);for(var Te=0;Te<pe.length;Te++){var Pe=bt(P,pe[Te],G||A.handleEvent,!1,A.h||A);if(!Pe)break;A.g[Pe.key]=Pe}A=v.H?R(v.H):{},v.m?(v.u||(v.u="POST"),A["Content-Type"]="application/x-www-form-urlencoded",v.g.ea(v.A,v.u,v.m,A)):(v.u="GET",v.g.ea(v.A,v.u,null,A)),Jo(),yy(v.i,v.u,v.A,v.l,v.R,v.m)}oa.prototype.ca=function(v){v=v.target;const A=this.M;A&&ri(v)==3?A.j():this.Y(v)},oa.prototype.Y=function(v){try{if(v==this.g)e:{const is=ri(this.g);var A=this.g.Ba();const so=this.g.Z();if(!(3>is)&&(is!=3||this.g&&(this.h.h||this.g.oa()||Ey(this.g)))){this.J||is!=4||A==7||(A==8||0>=so?Jo(3):Jo(2)),dh(this);var P=this.g.Z();this.X=P;t:if(rl(this)){var G=Ey(this.g);v="";var pe=G.length,Te=ri(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ir(this),Mr(this);var Pe="";break t}this.h.i=new o.TextDecoder}for(A=0;A<pe;A++)this.h.h=!0,v+=this.h.i.decode(G[A],{stream:!(Te&&A==pe-1)});G.length=0,this.h.g+=v,this.C=0,Pe=this.h.g}else Pe=this.g.oa();if(this.o=P==200,by(this.i,this.u,this.A,this.l,this.R,is,P),this.o){if(this.T&&!this.K){t:{if(this.g){var Nt,rs=this.g;if((Nt=rs.g?rs.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(Nt)){var kt=Nt;break t}}kt=null}if(P=kt)nl(this.i,this.l,P,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Vr(this,P);else{this.o=!1,this.s=3,Vn(12),Ir(this),Mr(this);break e}}if(this.P){P=!0;let Rs;for(;!this.J&&this.C<Pe.length;)if(Rs=il(this,Pe),Rs==Ac){is==4&&(this.s=4,Vn(14),P=!1),nl(this.i,this.l,null,"[Incomplete Response]");break}else if(Rs==sl){this.s=4,Vn(15),nl(this.i,this.l,Pe,"[Invalid Chunk]"),P=!1;break}else nl(this.i,this.l,Rs,null),Vr(this,Rs);if(rl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),is!=4||Pe.length!=0||this.h.h||(this.s=1,Vn(16),P=!1),this.o=this.o&&P,!P)nl(this.i,this.l,Pe,"[Invalid Chunked Response]"),Ir(this),Mr(this);else if(0<Pe.length&&!this.W){this.W=!0;var xs=this.j;xs.g==this&&xs.ba&&!xs.M&&(xs.j.info("Great, no buffering proxy detected. Bytes received: "+Pe.length),zc(xs),xs.M=!0,Vn(11))}}else nl(this.i,this.l,Pe,null),Vr(this,Pe);is==4&&Ir(this),this.o&&!this.J&&(is==4?Ny(this.j,this):(this.o=!1,Tn(this)))}else F1(this.g),P==400&&0<Pe.indexOf("Unknown SID")?(this.s=3,Vn(12)):(this.s=0,Vn(13)),Ir(this),Mr(this)}}}catch{}finally{}};function rl(v){return v.g?v.u=="GET"&&v.L!=2&&v.j.Ca:!1}function il(v,A){var P=v.C,G=A.indexOf(`
`,P);return G==-1?Ac:(P=Number(A.substring(P,G)),isNaN(P)?sl:(G+=1,G+P>A.length?Ac:(A=A.slice(G,G+P),v.C=G+P,A)))}oa.prototype.cancel=function(){this.J=!0,Ir(this)};function Tn(v){v.S=Date.now()+v.I,$f(v,v.I)}function $f(v,A){if(v.B!=null)throw Error("WatchDog timer not null");v.B=el(m(v.ba,v),A)}function dh(v){v.B&&(o.clearTimeout(v.B),v.B=null)}oa.prototype.ba=function(){this.B=null;const v=Date.now();0<=v-this.S?(aa(this.i,this.A),this.L!=2&&(Jo(),Vn(17)),Ir(this),this.s=2,Mr(this)):$f(this,this.S-v)};function Mr(v){v.j.G==0||v.J||Ny(v.j,v)}function Ir(v){dh(v);var A=v.M;A&&typeof A.ma=="function"&&A.ma(),v.M=null,gs(v.U),v.g&&(A=v.g,v.g=null,A.abort(),A.ma())}function Vr(v,A){try{var P=v.j;if(P.G!=0&&(P.g==v||al(P.h,v))){if(!v.K&&al(P.h,v)&&P.G==3){try{var G=P.Da.g.parse(A)}catch{G=null}if(Array.isArray(G)&&G.length==3){var pe=G;if(pe[0]==0){e:if(!P.u){if(P.g)if(P.g.F+3e3<v.F)Sh(P),vh(P);else break e;Mf(P),Vn(18)}}else P.za=pe[1],0<P.za-P.T&&37500>pe[2]&&P.F&&P.v==0&&!P.C&&(P.C=el(m(P.Za,P),6e3));if(1>=xy(P.h)&&P.ca){try{P.ca()}catch{}P.ca=void 0}}else no(P,11)}else if((v.K||P.g==v)&&Sh(P),!E(A))for(pe=P.Da.g.parse(A),A=0;A<pe.length;A++){let kt=pe[A];if(P.T=kt[0],kt=kt[1],P.G==2)if(kt[0]=="c"){P.K=kt[1],P.ia=kt[2];const xs=kt[3];xs!=null&&(P.la=xs,P.j.info("VER="+P.la));const is=kt[4];is!=null&&(P.Aa=is,P.j.info("SVER="+P.Aa));const so=kt[5];so!=null&&typeof so=="number"&&0<so&&(G=1.5*so,P.L=G,P.j.info("backChannelRequestTimeoutMs_="+G)),G=P;const Rs=v.g;if(Rs){const pa=Rs.g?Rs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pa){var Te=G.h;Te.g||pa.indexOf("spdy")==-1&&pa.indexOf("quic")==-1&&pa.indexOf("h2")==-1||(Te.j=Te.l,Te.g=new Set,Te.h&&(ol(Te,Te.h),Te.h=null))}if(G.D){const Bf=Rs.g?Rs.g.getResponseHeader("X-HTTP-Session-Id"):null;Bf&&(G.ya=Bf,Bt(G.I,G.D,Bf))}}P.G=3,P.l&&P.l.ua(),P.ba&&(P.R=Date.now()-v.F,P.j.info("Handshake RTT: "+P.R+"ms")),G=P;var Pe=v;if(G.qa=Ay(G,G.J?G.ia:null,G.W),Pe.K){ei(G.h,Pe);var Nt=Pe,rs=G.L;rs&&(Nt.I=rs),Nt.B&&(dh(Nt),Tn(Nt)),G.g=Pe}else $y(G);0<P.i.length&&wh(P)}else kt[0]!="stop"&&kt[0]!="close"||no(P,7);else P.G==3&&(kt[0]=="stop"||kt[0]=="close"?kt[0]=="stop"?no(P,7):Lf(P):kt[0]!="noop"&&P.l&&P.l.ta(kt),P.v=0)}}Jo(4)}catch{}}var k1=class{constructor(v,A){this.g=v,this.map=A}};function Cf(v){this.l=v||10,o.PerformanceNavigationTiming?(v=o.performance.getEntriesByType("navigation"),v=0<v.length&&(v[0].nextHopProtocol=="hq"||v[0].nextHopProtocol=="h2")):v=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=v?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Nf(v){return v.h?!0:v.g?v.g.size>=v.j:!1}function xy(v){return v.h?1:v.g?v.g.size:0}function al(v,A){return v.h?v.h==A:v.g?v.g.has(A):!1}function ol(v,A){v.g?v.g.add(A):v.h=A}function ei(v,A){v.h&&v.h==A?v.h=null:v.g&&v.g.has(A)&&v.g.delete(A)}Cf.prototype.cancel=function(){if(this.i=fr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const v of this.g.values())v.cancel();this.g.clear()}};function fr(v){if(v.h!=null)return v.i.concat(v.h.D);if(v.g!=null&&v.g.size!==0){let A=v.i;for(const P of v.g.values())A=A.concat(P.D);return A}return w(v.i)}function vy(v){if(v.V&&typeof v.V=="function")return v.V();if(typeof Map<"u"&&v instanceof Map||typeof Set<"u"&&v instanceof Set)return Array.from(v.values());if(typeof v=="string")return v.split("");if(l(v)){for(var A=[],P=v.length,G=0;G<P;G++)A.push(v[G]);return A}A=[],P=0;for(G in v)A[P++]=v[G];return A}function A1(v){if(v.na&&typeof v.na=="function")return v.na();if(!v.V||typeof v.V!="function"){if(typeof Map<"u"&&v instanceof Map)return Array.from(v.keys());if(!(typeof Set<"u"&&v instanceof Set)){if(l(v)||typeof v=="string"){var A=[];v=v.length;for(var P=0;P<v;P++)A.push(P);return A}A=[],P=0;for(const G in v)A[P++]=G;return A}}}function Rc(v,A){if(v.forEach&&typeof v.forEach=="function")v.forEach(A,void 0);else if(l(v)||typeof v=="string")Array.prototype.forEach.call(v,A,void 0);else for(var P=A1(v),G=vy(v),pe=G.length,Te=0;Te<pe;Te++)A.call(void 0,G[Te],P&&P[Te],v)}var kf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fh(v,A){if(v){v=v.split("&");for(var P=0;P<v.length;P++){var G=v[P].indexOf("="),pe=null;if(0<=G){var Te=v[P].substring(0,G);pe=v[P].substring(G+1)}else Te=v[P];A(Te,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function Qa(v){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,v instanceof Qa){this.h=v.h,ll(this,v.j),this.o=v.o,this.g=v.g,Dc(this,v.s),this.l=v.l;var A=v.i,P=new la;P.i=A.i,A.g&&(P.g=new Map(A.g),P.h=A.h),ph(this,P),this.m=v.m}else v&&(A=String(v).match(kf))?(this.h=!1,ll(this,A[1]||"",!0),this.o=cl(A[2]||""),this.g=cl(A[3]||"",!0),Dc(this,A[4]),this.l=cl(A[5]||"",!0),ph(this,A[6]||"",!0),this.m=cl(A[7]||"")):(this.h=!1,this.i=new la(null,this.h))}Qa.prototype.toString=function(){var v=[],A=this.j;A&&v.push(ti(A,Af,!0),":");var P=this.g;return(P||A=="file")&&(v.push("//"),(A=this.o)&&v.push(ti(A,Af,!0),"@"),v.push(encodeURIComponent(String(P)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),P=this.s,P!=null&&v.push(":",String(P))),(P=this.l)&&(this.g&&P.charAt(0)!="/"&&v.push("/"),v.push(ti(P,P.charAt(0)=="/"?Rf:wy,!0))),(P=this.i.toString())&&v.push("?",P),(P=this.m)&&v.push("#",ti(P,O1)),v.join("")};function Cn(v){return new Qa(v)}function ll(v,A,P){v.j=P?cl(A,!0):A,v.j&&(v.j=v.j.replace(/:$/,""))}function Dc(v,A){if(A){if(A=Number(A),isNaN(A)||0>A)throw Error("Bad port number "+A);v.s=A}else v.s=null}function ph(v,A,P){A instanceof la?(v.i=A,Df(v.i,v.h)):(P||(A=ti(A,D1)),v.i=new la(A,v.h))}function Bt(v,A,P){v.i.set(A,P)}function Oc(v){return Bt(v,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),v}function cl(v,A){return v?A?decodeURI(v.replace(/%25/g,"%2525")):decodeURIComponent(v):""}function ti(v,A,P){return typeof v=="string"?(v=encodeURI(v).replace(A,R1),P&&(v=v.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v):null}function R1(v){return v=v.charCodeAt(0),"%"+(v>>4&15).toString(16)+(v&15).toString(16)}var Af=/[#\/\?@]/g,wy=/[#\?:]/g,Rf=/[#\?]/g,D1=/[#\?@]/g,O1=/#/g;function la(v,A){this.h=this.g=null,this.i=v||null,this.j=!!A}function ni(v){v.g||(v.g=new Map,v.h=0,v.i&&fh(v.i,function(A,P){v.add(decodeURIComponent(A.replace(/\+/g," ")),P)}))}n=la.prototype,n.add=function(v,A){ni(this),this.i=null,v=eo(this,v);var P=this.g.get(v);return P||this.g.set(v,P=[]),P.push(A),this.h+=1,this};function mh(v,A){ni(v),A=eo(v,A),v.g.has(A)&&(v.i=null,v.h-=v.g.get(A).length,v.g.delete(A))}function Za(v,A){return ni(v),A=eo(v,A),v.g.has(A)}n.forEach=function(v,A){ni(this),this.g.forEach(function(P,G){P.forEach(function(pe){v.call(A,pe,G,this)},this)},this)},n.na=function(){ni(this);const v=Array.from(this.g.values()),A=Array.from(this.g.keys()),P=[];for(let G=0;G<A.length;G++){const pe=v[G];for(let Te=0;Te<pe.length;Te++)P.push(A[G])}return P},n.V=function(v){ni(this);let A=[];if(typeof v=="string")Za(this,v)&&(A=A.concat(this.g.get(eo(this,v))));else{v=Array.from(this.g.values());for(let P=0;P<v.length;P++)A=A.concat(v[P])}return A},n.set=function(v,A){return ni(this),this.i=null,v=eo(this,v),Za(this,v)&&(this.h-=this.g.get(v).length),this.g.set(v,[A]),this.h+=1,this},n.get=function(v,A){return v?(v=this.V(v),0<v.length?String(v[0]):A):A};function Ja(v,A,P){mh(v,A),0<P.length&&(v.i=null,v.g.set(eo(v,A),w(P)),v.h+=P.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const v=[],A=Array.from(this.g.keys());for(var P=0;P<A.length;P++){var G=A[P];const Te=encodeURIComponent(String(G)),Pe=this.V(G);for(G=0;G<Pe.length;G++){var pe=Te;Pe[G]!==""&&(pe+="="+encodeURIComponent(String(Pe[G]))),v.push(pe)}}return this.i=v.join("&")};function eo(v,A){return A=String(A),v.j&&(A=A.toLowerCase()),A}function Df(v,A){A&&!v.j&&(ni(v),v.i=null,v.g.forEach(function(P,G){var pe=G.toLowerCase();G!=pe&&(mh(this,G),Ja(this,pe,P))},v)),v.j=A}function Sy(v,A){const P=new tl;if(o.Image){const G=new Image;G.onload=y(si,P,"TestLoadImage: loaded",!0,A,G),G.onerror=y(si,P,"TestLoadImage: error",!1,A,G),G.onabort=y(si,P,"TestLoadImage: abort",!1,A,G),G.ontimeout=y(si,P,"TestLoadImage: timeout",!1,A,G),o.setTimeout(function(){G.ontimeout&&G.ontimeout()},1e4),G.src=v}else A(!1)}function Fc(v,A){const P=new tl,G=new AbortController,pe=setTimeout(()=>{G.abort(),si(P,"TestPingServer: timeout",!1,A)},1e4);fetch(v,{signal:G.signal}).then(Te=>{clearTimeout(pe),Te.ok?si(P,"TestPingServer: ok",!0,A):si(P,"TestPingServer: server error",!1,A)}).catch(()=>{clearTimeout(pe),si(P,"TestPingServer: error",!1,A)})}function si(v,A,P,G,pe){try{pe&&(pe.onload=null,pe.onerror=null,pe.onabort=null,pe.ontimeout=null),G(P)}catch{}}function Lc(){this.g=new dr}function ca(v,A,P){const G=P||"";try{Rc(v,function(pe,Te){let Pe=pe;u(pe)&&(Pe=Nc(pe)),A.push(G+Te+"="+encodeURIComponent(Pe))})}catch(pe){throw A.push(G+"type="+encodeURIComponent("_badmap")),pe}}function ul(v){this.l=v.Ub||null,this.j=v.eb||!1}b(ul,Ef),ul.prototype.g=function(){return new to(this.l,this.j)},ul.prototype.i=function(v){return function(){return v}}({});function to(v,A){en.call(this),this.D=v,this.o=A,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(to,en),n=to.prototype,n.open=function(v,A){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=v,this.A=A,this.readyState=1,ha(this)},n.send=function(v){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const A={headers:this.u,method:this.B,credentials:this.m,cache:void 0};v&&(A.body=v),(this.D||o).fetch(new Request(this.A,A)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ua(this)),this.readyState=0},n.Sa=function(v){if(this.g&&(this.l=v,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=v.headers,this.readyState=2,ha(this)),this.g&&(this.readyState=3,ha(this),this.g)))if(this.responseType==="arraybuffer")v.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in v){if(this.j=v.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Of(this)}else v.text().then(this.Ra.bind(this),this.ga.bind(this))};function Of(v){v.j.read().then(v.Pa.bind(v)).catch(v.ga.bind(v))}n.Pa=function(v){if(this.g){if(this.o&&v.value)this.response.push(v.value);else if(!this.o){var A=v.value?v.value:new Uint8Array(0);(A=this.v.decode(A,{stream:!v.done}))&&(this.response=this.responseText+=A)}v.done?ua(this):ha(this),this.readyState==3&&Of(this)}},n.Ra=function(v){this.g&&(this.response=this.responseText=v,ua(this))},n.Qa=function(v){this.g&&(this.response=v,ua(this))},n.ga=function(){this.g&&ua(this)};function ua(v){v.readyState=4,v.l=null,v.j=null,v.v=null,ha(v)}n.setRequestHeader=function(v,A){this.u.append(v,A)},n.getResponseHeader=function(v){return this.h&&this.h.get(v.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const v=[],A=this.h.entries();for(var P=A.next();!P.done;)P=P.value,v.push(P[0]+": "+P[1]),P=A.next();return v.join(`\r
`)};function ha(v){v.onreadystatechange&&v.onreadystatechange.call(v)}Object.defineProperty(to.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(v){this.m=v?"include":"same-origin"}});function Ff(v){let A="";return V(v,function(P,G){A+=G,A+=":",A+=P,A+=`\r
`}),A}function bs(v,A,P){e:{for(G in P){var G=!1;break e}G=!0}G||(P=Ff(P),typeof v=="string"?P!=null&&encodeURIComponent(String(P)):Bt(v,A,P))}function Kt(v){en.call(this),this.headers=new Map,this.o=v||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(Kt,en);var gh=/^https?$/i,Pc=["POST","PUT"];n=Kt.prototype,n.Ha=function(v){this.J=v},n.ea=function(v,A,P,G){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+v);A=A?A.toUpperCase():"GET",this.D=v,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():kc.g(),this.v=this.o?py(this.o):py(kc),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(A,String(v),!0),this.B=!1}catch(Te){Ty(this,Te);return}if(v=P||"",P=new Map(this.headers),G)if(Object.getPrototypeOf(G)===Object.prototype)for(var pe in G)P.set(pe,G[pe]);else if(typeof G.keys=="function"&&typeof G.get=="function")for(const Te of G.keys())P.set(Te,G.get(Te));else throw Error("Unknown input type for opt_headers: "+String(G));G=Array.from(P.keys()).find(Te=>Te.toLowerCase()=="content-type"),pe=o.FormData&&v instanceof o.FormData,!(0<=Array.prototype.indexOf.call(Pc,A,void 0))||G||pe||P.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Te,Pe]of P)this.g.setRequestHeader(Te,Pe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Mc(this),this.u=!0,this.g.send(v),this.u=!1}catch(Te){Ty(this,Te)}};function Ty(v,A){v.h=!1,v.g&&(v.j=!0,v.g.abort(),v.j=!1),v.l=A,v.m=5,yh(v),da(v)}function yh(v){v.A||(v.A=!0,an(v,"complete"),an(v,"error"))}n.abort=function(v){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=v||7,an(this,"complete"),an(this,"abort"),da(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),da(this,!0)),Kt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?bh(this):this.bb())},n.bb=function(){bh(this)};function bh(v){if(v.h&&typeof a<"u"&&(!v.v[1]||ri(v)!=4||v.Z()!=2)){if(v.u&&ri(v)==4)sa(v.Ea,0,v);else if(an(v,"readystatechange"),ri(v)==4){v.h=!1;try{const Pe=v.Z();e:switch(Pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var A=!0;break e;default:A=!1}var P;if(!(P=A)){var G;if(G=Pe===0){var pe=String(v.D).match(kf)[1]||null;!pe&&o.self&&o.self.location&&(pe=o.self.location.protocol.slice(0,-1)),G=!gh.test(pe?pe.toLowerCase():"")}P=G}if(P)an(v,"complete"),an(v,"success");else{v.m=6;try{var Te=2<ri(v)?v.g.statusText:""}catch{Te=""}v.l=Te+" ["+v.Z()+"]",yh(v)}}finally{da(v)}}}}function da(v,A){if(v.g){Mc(v);const P=v.g,G=v.v[0]?()=>{}:null;v.g=null,v.v=null,A||an(v,"ready");try{P.onreadystatechange=G}catch{}}}function Mc(v){v.I&&(o.clearTimeout(v.I),v.I=null)}n.isActive=function(){return!!this.g};function ri(v){return v.g?v.g.readyState:0}n.Z=function(){try{return 2<ri(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(v){if(this.g){var A=this.g.responseText;return v&&A.indexOf(v)==0&&(A=A.substring(v.length)),ra(A)}};function Ey(v){try{if(!v.g)return null;if("response"in v.g)return v.g.response;switch(v.H){case"":case"text":return v.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in v.g)return v.g.mozResponseArrayBuffer}return null}catch{return null}}function F1(v){const A={};v=(v.g&&2<=ri(v)&&v.g.getAllResponseHeaders()||"").split(`\r
`);for(let G=0;G<v.length;G++){if(E(v[G]))continue;var P=k(v[G]);const pe=P[0];if(P=P[1],typeof P!="string")continue;P=P.trim();const Te=A[pe]||[];A[pe]=Te,Te.push(P)}F(A,function(G){return G.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vc(v,A,P){return P&&P.internalChannelParams&&P.internalChannelParams[v]||A}function xh(v){this.Aa=0,this.i=[],this.j=new tl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Vc("failFast",!1,v),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Vc("baseRetryDelayMs",5e3,v),this.cb=Vc("retryDelaySeedMs",1e4,v),this.Wa=Vc("forwardChannelMaxRetries",2,v),this.wa=Vc("forwardChannelRequestTimeoutMs",2e4,v),this.pa=v&&v.xmlHttpFactory||void 0,this.Xa=v&&v.Tb||void 0,this.Ca=v&&v.useFetchStreams||!1,this.L=void 0,this.J=v&&v.supportsCrossDomainXhr||!1,this.K="",this.h=new Cf(v&&v.concurrentRequestLimit),this.Da=new Lc,this.P=v&&v.fastHandshake||!1,this.O=v&&v.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=v&&v.Rb||!1,v&&v.xa&&this.j.xa(),v&&v.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&v&&v.detectBufferingProxy||!1,this.ja=void 0,v&&v.longPollingTimeout&&0<v.longPollingTimeout&&(this.ja=v.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=xh.prototype,n.la=8,n.G=1,n.connect=function(v,A,P,G){Vn(0),this.W=v,this.H=A||{},P&&G!==void 0&&(this.H.OSID=P,this.H.OAID=G),this.F=this.X,this.I=Ay(this,null,this.W),wh(this)};function Lf(v){if(_y(v),v.G==3){var A=v.U++,P=Cn(v.I);if(Bt(P,"SID",v.K),Bt(P,"RID",A),Bt(P,"TYPE","terminate"),Bc(v,P),A=new oa(v,v.j,A),A.L=2,A.v=Oc(Cn(P)),P=!1,o.navigator&&o.navigator.sendBeacon)try{P=o.navigator.sendBeacon(A.v.toString(),"")}catch{}!P&&o.Image&&(new Image().src=A.v,P=!0),P||(A.g=Ry(A.j,null),A.g.ea(A.v)),A.F=Date.now(),Tn(A)}ky(v)}function vh(v){v.g&&(zc(v),v.g.cancel(),v.g=null)}function _y(v){vh(v),v.u&&(o.clearTimeout(v.u),v.u=null),Sh(v),v.h.cancel(),v.s&&(typeof v.s=="number"&&o.clearTimeout(v.s),v.s=null)}function wh(v){if(!Nf(v.h)&&!v.s){v.s=!0;var A=v.Ga;re||W(),Z||(re(),Z=!0),he.add(A,v),v.B=0}}function L1(v,A){return xy(v.h)>=v.h.j-(v.s?1:0)?!1:v.s?(v.i=A.D.concat(v.i),!0):v.G==1||v.G==2||v.B>=(v.Va?0:v.Wa)?!1:(v.s=el(m(v.Ga,v,A),Vf(v,v.B)),v.B++,!0)}n.Ga=function(v){if(this.s)if(this.s=null,this.G==1){if(!v){this.U=Math.floor(1e5*Math.random()),v=this.U++;const pe=new oa(this,this.j,v);let Te=this.o;if(this.S&&(Te?(Te=R(Te),D(Te,this.S)):Te=this.S),this.m!==null||this.O||(pe.H=Te,Te=null),this.P)e:{for(var A=0,P=0;P<this.i.length;P++){t:{var G=this.i[P];if("__data__"in G.map&&(G=G.map.__data__,typeof G=="string")){G=G.length;break t}G=void 0}if(G===void 0)break;if(A+=G,4096<A){A=P;break e}if(A===4096||P===this.i.length-1){A=P+1;break e}}A=1e3}else A=1e3;A=Iy(this,pe,A),P=Cn(this.I),Bt(P,"RID",v),Bt(P,"CVER",22),this.D&&Bt(P,"X-HTTP-Session-Id",this.D),Bc(this,P),Te&&(this.O?A="headers="+encodeURIComponent(String(Ff(Te)))+"&"+A:this.m&&bs(P,this.m,Te)),ol(this.h,pe),this.Ua&&Bt(P,"TYPE","init"),this.P?(Bt(P,"$req",A),Bt(P,"SID","null"),pe.T=!0,Ri(pe,P,null)):Ri(pe,P,A),this.G=2}}else this.G==3&&(v?Pf(this,v):this.i.length==0||Nf(this.h)||Pf(this))};function Pf(v,A){var P;A?P=A.l:P=v.U++;const G=Cn(v.I);Bt(G,"SID",v.K),Bt(G,"RID",P),Bt(G,"AID",v.T),Bc(v,G),v.m&&v.o&&bs(G,v.m,v.o),P=new oa(v,v.j,P,v.B+1),v.m===null&&(P.H=v.o),A&&(v.i=A.D.concat(v.i)),A=Iy(v,P,1e3),P.I=Math.round(.5*v.wa)+Math.round(.5*v.wa*Math.random()),ol(v.h,P),Ri(P,G,A)}function Bc(v,A){v.H&&V(v.H,function(P,G){Bt(A,G,P)}),v.l&&Rc({},function(P,G){Bt(A,G,P)})}function Iy(v,A,P){P=Math.min(v.i.length,P);var G=v.l?m(v.l.Na,v.l,v):null;e:{var pe=v.i;let Te=-1;for(;;){const Pe=["count="+P];Te==-1?0<P?(Te=pe[0].g,Pe.push("ofs="+Te)):Te=0:Pe.push("ofs="+Te);let Nt=!0;for(let rs=0;rs<P;rs++){let kt=pe[rs].g;const xs=pe[rs].map;if(kt-=Te,0>kt)Te=Math.max(0,pe[rs].g-100),Nt=!1;else try{ca(xs,Pe,"req"+kt+"_")}catch{G&&G(xs)}}if(Nt){G=Pe.join("&");break e}}}return v=v.i.splice(0,P),A.D=v,G}function $y(v){if(!v.g&&!v.u){v.Y=1;var A=v.Fa;re||W(),Z||(re(),Z=!0),he.add(A,v),v.v=0}}function Mf(v){return v.g||v.u||3<=v.v?!1:(v.Y++,v.u=el(m(v.Fa,v),Vf(v,v.v)),v.v++,!0)}n.Fa=function(){if(this.u=null,Cy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var v=2*this.R;this.j.info("BP detection timer enabled: "+v),this.A=el(m(this.ab,this),v)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Vn(10),vh(this),Cy(this))};function zc(v){v.A!=null&&(o.clearTimeout(v.A),v.A=null)}function Cy(v){v.g=new oa(v,v.j,"rpc",v.Y),v.m===null&&(v.g.H=v.o),v.g.O=0;var A=Cn(v.qa);Bt(A,"RID","rpc"),Bt(A,"SID",v.K),Bt(A,"AID",v.T),Bt(A,"CI",v.F?"0":"1"),!v.F&&v.ja&&Bt(A,"TO",v.ja),Bt(A,"TYPE","xmlhttp"),Bc(v,A),v.m&&v.o&&bs(A,v.m,v.o),v.L&&(v.g.I=v.L);var P=v.g;v=v.ia,P.L=1,P.v=Oc(Cn(A)),P.m=null,P.P=!0,Ya(P,v)}n.Za=function(){this.C!=null&&(this.C=null,vh(this),Mf(this),Vn(19))};function Sh(v){v.C!=null&&(o.clearTimeout(v.C),v.C=null)}function Ny(v,A){var P=null;if(v.g==A){Sh(v),zc(v),v.g=null;var G=2}else if(al(v.h,A))P=A.D,ei(v.h,A),G=1;else return;if(v.G!=0){if(A.o)if(G==1){P=A.m?A.m.length:0,A=Date.now()-A.F;var pe=v.B;G=ch(),an(G,new gy(G,P)),wh(v)}else $y(v);else if(pe=A.s,pe==3||pe==0&&0<A.X||!(G==1&&L1(v,A)||G==2&&Mf(v)))switch(P&&0<P.length&&(A=v.h,A.i=A.i.concat(P)),pe){case 1:no(v,5);break;case 4:no(v,10);break;case 3:no(v,6);break;default:no(v,2)}}}function Vf(v,A){let P=v.Ta+Math.floor(Math.random()*v.cb);return v.isActive()||(P*=2),P*A}function no(v,A){if(v.j.info("Error code "+A),A==2){var P=m(v.fb,v),G=v.Xa;const pe=!G;G=new Qa(G||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ll(G,"https"),Oc(G),pe?Sy(G.toString(),P):Fc(G.toString(),P)}else Vn(2);v.G=0,v.l&&v.l.sa(A),ky(v),_y(v)}n.fb=function(v){v?(this.j.info("Successfully pinged google.com"),Vn(2)):(this.j.info("Failed to ping google.com"),Vn(1))};function ky(v){if(v.G=0,v.ka=[],v.l){const A=fr(v.h);(A.length!=0||v.i.length!=0)&&(x(v.ka,A),x(v.ka,v.i),v.h.i.length=0,w(v.i),v.i.length=0),v.l.ra()}}function Ay(v,A,P){var G=P instanceof Qa?Cn(P):new Qa(P);if(G.g!="")A&&(G.g=A+"."+G.g),Dc(G,G.s);else{var pe=o.location;G=pe.protocol,A=A?A+"."+pe.hostname:pe.hostname,pe=+pe.port;var Te=new Qa(null);G&&ll(Te,G),A&&(Te.g=A),pe&&Dc(Te,pe),P&&(Te.l=P),G=Te}return P=v.D,A=v.ya,P&&A&&Bt(G,P,A),Bt(G,"VER",v.la),Bc(v,G),G}function Ry(v,A,P){if(A&&!v.J)throw Error("Can't create secondary domain capable XhrIo object.");return A=v.Ca&&!v.pa?new Kt(new ul({eb:P})):new Kt(v.pa),A.Ha(v.J),A}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Dy(){}n=Dy.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Th(){}Th.prototype.g=function(v,A){return new pr(v,A)};function pr(v,A){en.call(this),this.g=new xh(A),this.l=v,this.h=A&&A.messageUrlParams||null,v=A&&A.messageHeaders||null,A&&A.clientProtocolHeaderRequired&&(v?v["X-Client-Protocol"]="webchannel":v={"X-Client-Protocol":"webchannel"}),this.g.o=v,v=A&&A.initMessageHeaders||null,A&&A.messageContentType&&(v?v["X-WebChannel-Content-Type"]=A.messageContentType:v={"X-WebChannel-Content-Type":A.messageContentType}),A&&A.va&&(v?v["X-WebChannel-Client-Profile"]=A.va:v={"X-WebChannel-Client-Profile":A.va}),this.g.S=v,(v=A&&A.Sb)&&!E(v)&&(this.g.m=v),this.v=A&&A.supportsCrossDomainXhr||!1,this.u=A&&A.sendRawJson||!1,(A=A&&A.httpSessionIdParam)&&!E(A)&&(this.g.D=A,v=this.h,v!==null&&A in v&&(v=this.h,A in v&&delete v[A])),this.j=new fa(this)}b(pr,en),pr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},pr.prototype.close=function(){Lf(this.g)},pr.prototype.o=function(v){var A=this.g;if(typeof v=="string"){var P={};P.__data__=v,v=P}else this.u&&(P={},P.__data__=Nc(v),v=P);A.i.push(new k1(A.Ya++,v)),A.G==3&&wh(A)},pr.prototype.N=function(){this.g.l=null,delete this.j,Lf(this.g),delete this.g,pr.aa.N.call(this)};function Oy(v){Qo.call(this),v.__headers__&&(this.headers=v.__headers__,this.statusCode=v.__status__,delete v.__headers__,delete v.__status__);var A=v.__sm__;if(A){e:{for(const P in A){v=P;break e}v=void 0}(this.i=v)&&(v=this.i,A=A!==null&&v in A?A[v]:void 0),this.data=A}else this.data=v}b(Oy,Qo);function Fy(){Ai.call(this),this.status=1}b(Fy,Ai);function fa(v){this.g=v}b(fa,Dy),fa.prototype.ua=function(){an(this.g,"a")},fa.prototype.ta=function(v){an(this.g,new Oy(v))},fa.prototype.sa=function(v){an(this.g,new Fy)},fa.prototype.ra=function(){an(this.g,"b")},Th.prototype.createWebChannel=Th.prototype.g,pr.prototype.send=pr.prototype.o,pr.prototype.open=pr.prototype.m,pr.prototype.close=pr.prototype.close,jU=function(){return new Th},UU=function(){return ch()},zU=Jr,UE={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ss.NO_ERROR=0,ss.TIMEOUT=8,ss.HTTP_ERROR=6,w0=ss,Xa.COMPLETE="complete",BU=Xa,my.EventType=ia,ia.OPEN="a",ia.CLOSE="b",ia.ERROR="c",ia.MESSAGE="d",en.prototype.listen=en.prototype.K,Xp=my,Kt.prototype.listenOnce=Kt.prototype.L,Kt.prototype.getLastError=Kt.prototype.Ka,Kt.prototype.getLastErrorCode=Kt.prototype.Ba,Kt.prototype.getStatus=Kt.prototype.Z,Kt.prototype.getResponseJson=Kt.prototype.Oa,Kt.prototype.getResponseText=Kt.prototype.oa,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Ha,VU=Kt}).apply(typeof Xb<"u"?Xb:typeof self<"u"?self:typeof window<"u"?window:{});const DO="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zs.UNAUTHENTICATED=new Zs(null),Zs.GOOGLE_CREDENTIALS=new Zs("google-credentials-uid"),Zs.FIRST_PARTY=new Zs("first-party-uid"),Zs.MOCK_USER=new Zs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vf="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ku=new m_("@firebase/firestore");function Lp(){return Ku.logLevel}function qe(n,...e){if(Ku.logLevel<=_t.DEBUG){const t=e.map(zC);Ku.debug(`Firestore (${vf}): ${n}`,...t)}}function jo(n,...e){if(Ku.logLevel<=_t.ERROR){const t=e.map(zC);Ku.error(`Firestore (${vf}): ${n}`,...t)}}function Bd(n,...e){if(Ku.logLevel<=_t.WARN){const t=e.map(zC);Ku.warn(`Firestore (${vf}): ${n}`,...t)}}function zC(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(n="Unexpected state"){const e=`FIRESTORE (${vf}) INTERNAL ASSERTION FAILED: `+n;throw jo(e),new Error(e)}function On(n,e){n||ut()}function Ft(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ke extends Wo{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class nRe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Zs.UNAUTHENTICATED))}shutdown(){}}class sRe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class rRe{constructor(e){this.t=e,this.currentUser=Zs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){On(this.o===void 0);let s=this.i;const r=l=>this.i!==s?(s=this.i,t(l)):Promise.resolve();let i=new Tu;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Tu,e.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},o=l=>{qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Tu)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(On(typeof s.accessToken=="string"),new WU(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return On(e===null||typeof e=="string"),new Zs(e)}}class iRe{constructor(e,t,s){this.l=e,this.h=t,this.P=s,this.type="FirstParty",this.user=Zs.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class aRe{constructor(e,t,s){this.l=e,this.h=t,this.P=s}getToken(){return Promise.resolve(new iRe(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Zs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class oRe{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lRe{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){On(this.o===void 0);const s=i=>{i.error!=null&&qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,qe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?r(i):qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(On(typeof t.token=="string"),this.R=t.token,new oRe(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cRe(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uRe{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=cRe(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%e.length))}return s}}function Ht(n,e){return n<e?-1:n>e?1:0}function zd(n,e,t){return n.length===e.length&&n.every((s,r)=>t(s,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ke(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ke(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ke(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ke(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return $s.fromMillis(Date.now())}static fromDate(e){return $s.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*t));return new $s(t,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ht(this.nanoseconds,e.nanoseconds):Ht(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new lt(e)}static min(){return new lt(new $s(0,0))}static max(){return new lt(new $s(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,t,s){t===void 0?t=0:t>e.length&&ut(),s===void 0?s=e.length-t:s>e.length-t&&ut(),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return km.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof km?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class In extends km{construct(e,t,s){return new In(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ke(Fe.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(r=>r.length>0))}return new In(t)}static emptyPath(){return new In([])}}const hRe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rr extends km{construct(e,t,s){return new rr(e,t,s)}static isValidIdentifier(e){return hRe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new rr(["__name__"])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(s.length===0)throw new Ke(Fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let a=!1;for(;r<e.length;){const o=e[r];if(o==="\\"){if(r+1===e.length)throw new Ke(Fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ke(Fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=l,r+=2}else o==="`"?(a=!a,r++):o!=="."||a?(s+=o,r++):(i(),r++)}if(i(),a)throw new Ke(Fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rr(t)}static emptyPath(){return new rr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.path=e}static fromPath(e){return new st(In.fromString(e))}static fromName(e){return new st(In.fromString(e).popFirst(5))}static empty(){return new st(In.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&In.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return In.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new st(new In(e.slice()))}}function dRe(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=lt.fromTimestamp(s===1e9?new $s(t+1,0):new $s(t,s));return new cc(r,st.empty(),e)}function fRe(n){return new cc(n.readTime,n.key,-1)}class cc{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new cc(lt.min(),st.empty(),-1)}static max(){return new cc(lt.max(),st.empty(),-1)}}function pRe(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=st.comparator(n.documentKey,e.documentKey),t!==0?t:Ht(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mRe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gRe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UC(n){if(n.code!==Fe.FAILED_PRECONDITION||n.message!==mRe)throw n;qe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ut(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new De((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof De?t:De.resolve(t)}catch(t){return De.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):De.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):De.reject(t)}static resolve(e){return new De((t,s)=>{t(e)})}static reject(e){return new De((t,s)=>{s(e)})}static waitFor(e){return new De((t,s)=>{let r=0,i=0,a=!1;e.forEach(o=>{++r,o.next(()=>{++i,a&&i===r&&t()},l=>s(l))}),a=!0,i===r&&t()})}static or(e){let t=De.resolve(!1);for(const s of e)t=t.next(r=>r?De.resolve(r):s());return t}static forEach(e,t){const s=[];return e.forEach((r,i)=>{s.push(t.call(this,r,i))}),this.waitFor(s)}static mapArray(e,t){return new De((s,r)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const u=l;t(e[u]).next(d=>{a[u]=d,++o,o===i&&s(a)},d=>r(d))}})}static doWhile(e,t){return new De((s,r)=>{const i=()=>{e()===!0?t().next(()=>{i()},r):s()};i()})}}function yRe(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function cy(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ie(s),this.se=s=>t.writeSequenceNumber(s))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}jC.oe=-1;function x1(n){return n==null}function xx(n){return n===0&&1/n==-1/0}function bRe(n){return typeof n=="number"&&Number.isInteger(n)&&!xx(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OO(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function uy(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function GU(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e,t){this.comparator=e,this.root=t||Ls.EMPTY}insert(e,t){return new Wn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ls.BLACK,null,null))}remove(e){return new Wn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ls.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Yb(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Yb(this.root,e,this.comparator,!1)}getReverseIterator(){return new Yb(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Yb(this.root,e,this.comparator,!0)}}class Yb{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ls{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??Ls.RED,this.left=r??Ls.EMPTY,this.right=i??Ls.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new Ls(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ls.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Ls.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ls.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ls.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ut();const e=this.left.check();if(e!==this.right.check())throw ut();return e+(this.isRed()?0:1)}}Ls.EMPTY=null,Ls.RED=!0,Ls.BLACK=!1;Ls.EMPTY=new class{constructor(){this.size=0}get key(){throw ut()}get value(){throw ut()}get color(){throw ut()}get left(){throw ut()}get right(){throw ut()}copy(e,t,s,r,i){return this}insert(e,t,s){return new Ls(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this.comparator=e,this.data=new Wn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new FO(this.data.getIterator())}getIteratorFrom(e){return new FO(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof Ms)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ms(this.comparator);return t.data=e,t}}class FO{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(e){this.fields=e,e.sort(rr.comparator)}static empty(){return new Wl([])}unionWith(e){let t=new Ms(rr.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Wl(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return zd(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new HU("Invalid base64 string: "+i):i}}(e);return new Us(t)}static fromUint8Array(e){const t=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new Us(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ht(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Us.EMPTY_BYTE_STRING=new Us("");const xRe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function uc(n){if(On(!!n),typeof n=="string"){let e=0;const t=xRe.exec(n);if(On(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:zn(n.seconds),nanos:zn(n.nanos)}}function zn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Xu(n){return typeof n=="string"?Us.fromBase64String(n):Us.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WC(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function GC(n){const e=n.mapValue.fields.__previous_value__;return WC(e)?GC(e):e}function Am(n){const e=uc(n.mapValue.fields.__local_write_time__.timestampValue);return new $s(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vRe{constructor(e,t,s,r,i,a,o,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class Rm{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Rm("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Rm&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb={mapValue:{}};function Yu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?WC(n)?4:SRe(n)?9007199254740991:wRe(n)?10:11:ut()}function ja(n,e){if(n===e)return!0;const t=Yu(n);if(t!==Yu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Am(n).isEqual(Am(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=uc(r.timestampValue),o=uc(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,i){return Xu(r.bytesValue).isEqual(Xu(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return zn(r.geoPointValue.latitude)===zn(i.geoPointValue.latitude)&&zn(r.geoPointValue.longitude)===zn(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return zn(r.integerValue)===zn(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=zn(r.doubleValue),o=zn(i.doubleValue);return a===o?xx(a)===xx(o):isNaN(a)&&isNaN(o)}return!1}(n,e);case 9:return zd(n.arrayValue.values||[],e.arrayValue.values||[],ja);case 10:case 11:return function(r,i){const a=r.mapValue.fields||{},o=i.mapValue.fields||{};if(OO(a)!==OO(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!ja(a[l],o[l])))return!1;return!0}(n,e);default:return ut()}}function Dm(n,e){return(n.values||[]).find(t=>ja(t,e))!==void 0}function Ud(n,e){if(n===e)return 0;const t=Yu(n),s=Yu(e);if(t!==s)return Ht(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ht(n.booleanValue,e.booleanValue);case 2:return function(i,a){const o=zn(i.integerValue||i.doubleValue),l=zn(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(n,e);case 3:return LO(n.timestampValue,e.timestampValue);case 4:return LO(Am(n),Am(e));case 5:return Ht(n.stringValue,e.stringValue);case 6:return function(i,a){const o=Xu(i),l=Xu(a);return o.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const d=Ht(o[u],l[u]);if(d!==0)return d}return Ht(o.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const o=Ht(zn(i.latitude),zn(a.latitude));return o!==0?o:Ht(zn(i.longitude),zn(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return PO(n.arrayValue,e.arrayValue);case 10:return function(i,a){var o,l,u,d;const f=i.fields||{},m=a.fields||{},y=(o=f.value)===null||o===void 0?void 0:o.arrayValue,b=(l=m.value)===null||l===void 0?void 0:l.arrayValue,w=Ht(((u=y==null?void 0:y.values)===null||u===void 0?void 0:u.length)||0,((d=b==null?void 0:b.values)===null||d===void 0?void 0:d.length)||0);return w!==0?w:PO(y,b)}(n.mapValue,e.mapValue);case 11:return function(i,a){if(i===Qb.mapValue&&a===Qb.mapValue)return 0;if(i===Qb.mapValue)return 1;if(a===Qb.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),u=a.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const m=Ht(l[f],d[f]);if(m!==0)return m;const y=Ud(o[l[f]],u[d[f]]);if(y!==0)return y}return Ht(l.length,d.length)}(n.mapValue,e.mapValue);default:throw ut()}}function LO(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ht(n,e);const t=uc(n),s=uc(e),r=Ht(t.seconds,s.seconds);return r!==0?r:Ht(t.nanos,s.nanos)}function PO(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const i=Ud(t[r],s[r]);if(i)return i}return Ht(t.length,s.length)}function jd(n){return jE(n)}function jE(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const s=uc(t);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Xu(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return st.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let s="[",r=!0;for(const i of t.values||[])r?r=!1:s+=",",s+=jE(i);return s+"]"}(n.arrayValue):"mapValue"in n?function(t){const s=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const a of s)i?i=!1:r+=",",r+=`${a}:${jE(t.fields[a])}`;return r+"}"}(n.mapValue):ut()}function MO(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function WE(n){return!!n&&"integerValue"in n}function HC(n){return!!n&&"arrayValue"in n}function VO(n){return!!n&&"nullValue"in n}function BO(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function pT(n){return!!n&&"mapValue"in n}function wRe(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function rm(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return uy(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=rm(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=rm(n.arrayValue.values[t]);return e}return Object.assign({},n)}function SRe(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e){this.value=e}static empty(){return new _a({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!pT(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=rm(t)}setAll(e){let t=rr.emptyPath(),s={},r=[];e.forEach((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,s,r),s={},r=[],t=o.popLast()}a?s[o.lastSegment()]=rm(a):r.push(o.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());pT(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ja(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];pT(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){uy(t,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new _a(rm(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,t,s,r,i,a,o){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new tr(e,0,lt.min(),lt.min(),lt.min(),_a.empty(),0)}static newFoundDocument(e,t,s,r){return new tr(e,1,t,lt.min(),s,r,0)}static newNoDocument(e,t){return new tr(e,2,t,lt.min(),lt.min(),_a.empty(),0)}static newUnknownDocument(e,t){return new tr(e,3,t,lt.min(),lt.min(),_a.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_a.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_a.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof tr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new tr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e,t){this.position=e,this.inclusive=t}}function zO(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],a=n.position[r];if(i.field.isKeyField()?s=st.comparator(st.fromName(a.referenceValue),t.key):s=Ud(a,t.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function UO(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ja(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,t="asc"){this.field=e,this.dir=t}}function TRe(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{}class Yn extends qU{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new _Re(e,t,s):t==="array-contains"?new CRe(e,s):t==="in"?new NRe(e,s):t==="not-in"?new kRe(e,s):t==="array-contains-any"?new ARe(e,s):new Yn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new IRe(e,s):new $Re(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ud(t,this.value)):t!==null&&Yu(this.value)===Yu(t)&&this.matchesComparison(Ud(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ut()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ji extends qU{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Ji(e,t)}matches(e){return KU(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function KU(n){return n.op==="and"}function XU(n){return ERe(n)&&KU(n)}function ERe(n){for(const e of n.filters)if(e instanceof Ji)return!1;return!0}function GE(n){if(n instanceof Yn)return n.field.canonicalString()+n.op.toString()+jd(n.value);if(XU(n))return n.filters.map(e=>GE(e)).join(",");{const e=n.filters.map(t=>GE(t)).join(",");return`${n.op}(${e})`}}function YU(n,e){return n instanceof Yn?function(s,r){return r instanceof Yn&&s.op===r.op&&s.field.isEqual(r.field)&&ja(s.value,r.value)}(n,e):n instanceof Ji?function(s,r){return r instanceof Ji&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,a,o)=>i&&YU(a,r.filters[o]),!0):!1}(n,e):void ut()}function QU(n){return n instanceof Yn?function(t){return`${t.field.canonicalString()} ${t.op} ${jd(t.value)}`}(n):n instanceof Ji?function(t){return t.op.toString()+" {"+t.getFilters().map(QU).join(" ,")+"}"}(n):"Filter"}class _Re extends Yn{constructor(e,t,s){super(e,t,s),this.key=st.fromName(s.referenceValue)}matches(e){const t=st.comparator(e.key,this.key);return this.matchesComparison(t)}}class IRe extends Yn{constructor(e,t){super(e,"in",t),this.keys=ZU("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class $Re extends Yn{constructor(e,t){super(e,"not-in",t),this.keys=ZU("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function ZU(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(s=>st.fromName(s.referenceValue))}class CRe extends Yn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return HC(t)&&Dm(t.arrayValue,this.value)}}class NRe extends Yn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Dm(this.value.arrayValue,t)}}class kRe extends Yn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Dm(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Dm(this.value.arrayValue,t)}}class ARe extends Yn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!HC(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>Dm(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RRe{constructor(e,t=null,s=[],r=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=a,this.endAt=o,this.ue=null}}function jO(n,e=null,t=[],s=[],r=null,i=null,a=null){return new RRe(n,e,t,s,r,i,a)}function qC(n){const e=Ft(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>GE(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),x1(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>jd(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>jd(s)).join(",")),e.ue=t}return e.ue}function KC(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!TRe(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!YU(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!UO(n.startAt,e.startAt)&&UO(n.endAt,e.endAt)}function HE(n){return st.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e,t=null,s=[],r=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function DRe(n,e,t,s,r,i,a,o){return new wf(n,e,t,s,r,i,a,o)}function JU(n){return new wf(n)}function WO(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ej(n){return n.collectionGroup!==null}function im(n){const e=Ft(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Ms(rr.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Om(i,s))}),t.has(rr.keyField().canonicalString())||e.ce.push(new Om(rr.keyField(),s))}return e.ce}function La(n){const e=Ft(n);return e.le||(e.le=ORe(e,im(n))),e.le}function ORe(n,e){if(n.limitType==="F")return jO(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new Om(r.field,i)});const t=n.endAt?new vx(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new vx(n.startAt.position,n.startAt.inclusive):null;return jO(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function qE(n,e){const t=n.filters.concat([e]);return new wf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function wx(n,e,t){return new wf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function v1(n,e){return KC(La(n),La(e))&&n.limitType===e.limitType}function tj(n){return`${qC(La(n))}|lt:${n.limitType}`}function rd(n){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(r=>QU(r)).join(", ")}]`),x1(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(r=>jd(r)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(r=>jd(r)).join(",")),`Target(${s})`}(La(n))}; limitType=${n.limitType})`}function w1(n,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):st.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(n,e)&&function(s,r){for(const i of im(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(n,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(n,e)&&function(s,r){return!(s.startAt&&!function(a,o,l){const u=zO(a,o,l);return a.inclusive?u<=0:u<0}(s.startAt,im(s),r)||s.endAt&&!function(a,o,l){const u=zO(a,o,l);return a.inclusive?u>=0:u>0}(s.endAt,im(s),r))}(n,e)}function FRe(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function nj(n){return(e,t)=>{let s=!1;for(const r of im(n)){const i=LRe(r,e,t);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function LRe(n,e,t){const s=n.field.isKeyField()?st.comparator(e.key,t.key):function(i,a,o){const l=a.data.field(i),u=o.data.field(i);return l!==null&&u!==null?Ud(l,u):ut()}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return ut()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){uy(this.inner,(t,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return GU(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PRe=new Wn(st.comparator);function hc(){return PRe}const sj=new Wn(st.comparator);function Yp(...n){let e=sj;for(const t of n)e=e.insert(t.key,t);return e}function MRe(n){let e=sj;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function bu(){return am()}function rj(){return am()}function am(){return new Sf(n=>n.toString(),(n,e)=>n.isEqual(e))}const VRe=new Ms(st.comparator);function Lt(...n){let e=VRe;for(const t of n)e=e.add(t);return e}const BRe=new Ms(Ht);function zRe(){return BRe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XC(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xx(e)?"-0":e}}function ij(n){return{integerValue:""+n}}function URe(n,e){return bRe(e)?ij(e):XC(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(){this._=void 0}}function jRe(n,e,t){return n instanceof KE?function(r,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&WC(i)&&(i=GC(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof Sx?aj(n,e):n instanceof Tx?oj(n,e):function(r,i){const a=GRe(r,i),o=GO(a)+GO(r.Pe);return WE(a)&&WE(r.Pe)?ij(o):XC(r.serializer,o)}(n,e)}function WRe(n,e,t){return n instanceof Sx?aj(n,e):n instanceof Tx?oj(n,e):t}function GRe(n,e){return n instanceof XE?function(s){return WE(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class KE extends S1{}class Sx extends S1{constructor(e){super(),this.elements=e}}function aj(n,e){const t=lj(e);for(const s of n.elements)t.some(r=>ja(r,s))||t.push(s);return{arrayValue:{values:t}}}class Tx extends S1{constructor(e){super(),this.elements=e}}function oj(n,e){let t=lj(e);for(const s of n.elements)t=t.filter(r=>!ja(r,s));return{arrayValue:{values:t}}}class XE extends S1{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function GO(n){return zn(n.integerValue||n.doubleValue)}function lj(n){return HC(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function HRe(n,e){return n.field.isEqual(e.field)&&function(s,r){return s instanceof Sx&&r instanceof Sx||s instanceof Tx&&r instanceof Tx?zd(s.elements,r.elements,ja):s instanceof XE&&r instanceof XE?ja(s.Pe,r.Pe):s instanceof KE&&r instanceof KE}(n.transform,e.transform)}class Eu{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Eu}static exists(e){return new Eu(void 0,e)}static updateTime(e){return new Eu(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function S0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class YC{}function cj(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new KRe(n.key,Eu.none()):new QC(n.key,n.data,Eu.none());{const t=n.data,s=_a.empty();let r=new Ms(rr.comparator);for(let i of e.fields)if(!r.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?s.delete(i):s.set(i,a),r=r.add(i)}return new T1(n.key,s,new Wl(r.toArray()),Eu.none())}}function qRe(n,e,t){n instanceof QC?function(r,i,a){const o=r.value.clone(),l=qO(r.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(n,e,t):n instanceof T1?function(r,i,a){if(!S0(r.precondition,i))return void i.convertToUnknownDocument(a.version);const o=qO(r.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(uj(r)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(r,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function om(n,e,t,s){return n instanceof QC?function(i,a,o,l){if(!S0(i.precondition,a))return o;const u=i.value.clone(),d=KO(i.fieldTransforms,l,a);return u.setAll(d),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(n,e,t,s):n instanceof T1?function(i,a,o,l){if(!S0(i.precondition,a))return o;const u=KO(i.fieldTransforms,l,a),d=a.data;return d.setAll(uj(i)),d.setAll(u),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,s):function(i,a,o){return S0(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(n,e,t)}function HO(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&zd(s,r,(i,a)=>HRe(i,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class QC extends YC{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class T1 extends YC{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function uj(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function qO(n,e,t){const s=new Map;On(n.length===t.length);for(let r=0;r<t.length;r++){const i=n[r],a=i.transform,o=e.data.field(i.field);s.set(i.field,WRe(a,o,t[r]))}return s}function KO(n,e,t){const s=new Map;for(const r of n){const i=r.transform,a=t.data.field(r.field);s.set(r.field,jRe(i,a,e))}return s}class KRe extends YC{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XRe{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&qRe(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=om(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=om(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=rj();return this.mutations.forEach(r=>{const i=e.get(r.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=t.has(r.key)?null:o;const l=cj(a,o);l!==null&&s.set(r.key,l),a.isValidDocument()||a.convertToNoDocument(lt.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Lt())}isEqual(e){return this.batchId===e.batchId&&zd(this.mutations,e.mutations,(t,s)=>HO(t,s))&&zd(this.baseMutations,e.baseMutations,(t,s)=>HO(t,s))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YRe{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QRe{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kn,Rt;function hj(n){if(n===void 0)return jo("GRPC error has no .code"),Fe.UNKNOWN;switch(n){case Kn.OK:return Fe.OK;case Kn.CANCELLED:return Fe.CANCELLED;case Kn.UNKNOWN:return Fe.UNKNOWN;case Kn.DEADLINE_EXCEEDED:return Fe.DEADLINE_EXCEEDED;case Kn.RESOURCE_EXHAUSTED:return Fe.RESOURCE_EXHAUSTED;case Kn.INTERNAL:return Fe.INTERNAL;case Kn.UNAVAILABLE:return Fe.UNAVAILABLE;case Kn.UNAUTHENTICATED:return Fe.UNAUTHENTICATED;case Kn.INVALID_ARGUMENT:return Fe.INVALID_ARGUMENT;case Kn.NOT_FOUND:return Fe.NOT_FOUND;case Kn.ALREADY_EXISTS:return Fe.ALREADY_EXISTS;case Kn.PERMISSION_DENIED:return Fe.PERMISSION_DENIED;case Kn.FAILED_PRECONDITION:return Fe.FAILED_PRECONDITION;case Kn.ABORTED:return Fe.ABORTED;case Kn.OUT_OF_RANGE:return Fe.OUT_OF_RANGE;case Kn.UNIMPLEMENTED:return Fe.UNIMPLEMENTED;case Kn.DATA_LOSS:return Fe.DATA_LOSS;default:return ut()}}(Rt=Kn||(Kn={}))[Rt.OK=0]="OK",Rt[Rt.CANCELLED=1]="CANCELLED",Rt[Rt.UNKNOWN=2]="UNKNOWN",Rt[Rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rt[Rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rt[Rt.NOT_FOUND=5]="NOT_FOUND",Rt[Rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rt[Rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rt[Rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rt[Rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rt[Rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rt[Rt.ABORTED=10]="ABORTED",Rt[Rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rt[Rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rt[Rt.INTERNAL=13]="INTERNAL",Rt[Rt.UNAVAILABLE=14]="UNAVAILABLE",Rt[Rt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZRe(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JRe=new Su([4294967295,4294967295],0);function XO(n){const e=ZRe().encode(n),t=new MU;return t.update(e),new Uint8Array(t.digest())}function YO(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Su([t,s],0),new Su([r,i],0)]}class ZC{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Qp(`Invalid padding: ${t}`);if(s<0)throw new Qp(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Qp(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Qp(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Su.fromNumber(this.Ie)}Ee(e,t,s){let r=e.add(t.multiply(Su.fromNumber(s)));return r.compare(JRe)===1&&(r=new Su([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=XO(e),[s,r]=YO(t);for(let i=0;i<this.hashCount;i++){const a=this.Ee(s,r,i);if(!this.de(a))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new ZC(i,r,t);return s.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const t=XO(e),[s,r]=YO(t);for(let i=0;i<this.hashCount;i++){const a=this.Ee(s,r,i);this.Ae(a)}}Ae(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Qp extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,hy.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new E1(lt.min(),r,new Wn(Ht),hc(),Lt())}}class hy{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new hy(s,t,Lt(),Lt(),Lt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,t,s,r){this.Re=e,this.removedTargetIds=t,this.key=s,this.Ve=r}}class dj{constructor(e,t){this.targetId=e,this.me=t}}class fj{constructor(e,t,s=Us.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class QO{constructor(){this.fe=0,this.ge=JO(),this.pe=Us.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Lt(),t=Lt(),s=Lt();return this.ge.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:ut()}}),new hy(this.pe,this.ye,e,t,s)}Ce(){this.we=!1,this.ge=JO()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,On(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class eDe{constructor(e){this.Le=e,this.Be=new Map,this.ke=hc(),this.qe=ZO(),this.Qe=new Wn(Ht)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const s=this.Ge(t);switch(e.state){case 0:this.ze(t)&&s.De(e.resumeToken);break;case 1:s.Oe(),s.Se||s.Ce(),s.De(e.resumeToken);break;case 2:s.Oe(),s.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(s.Ne(),s.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),s.De(e.resumeToken));break;default:ut()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((s,r)=>{this.ze(r)&&t(r)})}He(e){const t=e.targetId,s=e.me.count,r=this.Je(t);if(r){const i=r.target;if(HE(i))if(s===0){const a=new st(i.path);this.Ue(t,a,tr.newNoDocument(a,lt.min()))}else On(s===1);else{const a=this.Ye(t);if(a!==s){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=t;let a,o;try{a=Xu(s).toUint8Array()}catch(l){if(l instanceof HU)return Bd("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new ZC(a,r,i)}catch(l){return Bd(l instanceof Qp?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,t,s){return t.me.count===s-this.nt(e,t.targetId)?0:2}nt(e,t){const s=this.Le.getRemoteKeysForTarget(t);let r=0;return s.forEach(i=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.Ue(t,i,null),r++)}),r}rt(e){const t=new Map;this.Be.forEach((i,a)=>{const o=this.Je(a);if(o){if(i.current&&HE(o.target)){const l=new st(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,tr.newNoDocument(l,e))}i.be&&(t.set(a,i.ve()),i.Ce())}});let s=Lt();this.qe.forEach((i,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(s=s.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const r=new E1(e,t,this.Qe,this.ke,s);return this.ke=hc(),this.qe=ZO(),this.Qe=new Wn(Ht),r}$e(e,t){if(!this.ze(e))return;const s=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,s),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,s){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),s&&(this.ke=this.ke.insert(t,s))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new QO,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ms(Ht),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||qe("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new QO),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function ZO(){return new Wn(st.comparator)}function JO(){return new Wn(st.comparator)}const tDe={asc:"ASCENDING",desc:"DESCENDING"},nDe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sDe={and:"AND",or:"OR"};class rDe{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function YE(n,e){return n.useProto3Json||x1(e)?e:{value:e}}function QE(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pj(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function wd(n){return On(!!n),lt.fromTimestamp(function(t){const s=uc(t);return new $s(s.seconds,s.nanos)}(n))}function mj(n,e){return ZE(n,e).canonicalString()}function ZE(n,e){const t=function(r){return new In(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function gj(n){const e=In.fromString(n);return On(wj(e)),e}function mT(n,e){const t=gj(e);if(t.get(1)!==n.databaseId.projectId)throw new Ke(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ke(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new st(bj(t))}function yj(n,e){return mj(n.databaseId,e)}function iDe(n){const e=gj(n);return e.length===4?In.emptyPath():bj(e)}function eF(n){return new In(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function bj(n){return On(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function aDe(n,e){let t;if("targetChange"in e){e.targetChange;const s=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ut()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(On(d===void 0||typeof d=="string"),Us.fromBase64String(d||"")):(On(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Us.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const d=u.code===void 0?Fe.UNKNOWN:hj(u.code);return new Ke(d,u.message||"")}(a);t=new fj(s,r,i,o||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=mT(n,s.document.name),i=wd(s.document.updateTime),a=s.document.createTime?wd(s.document.createTime):lt.min(),o=new _a({mapValue:{fields:s.document.fields}}),l=tr.newFoundDocument(r,i,a,o),u=s.targetIds||[],d=s.removedTargetIds||[];t=new T0(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=mT(n,s.document),i=s.readTime?wd(s.readTime):lt.min(),a=tr.newNoDocument(r,i),o=s.removedTargetIds||[];t=new T0([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=mT(n,s.document),i=s.removedTargetIds||[];t=new T0([],i,r,null)}else{if(!("filter"in e))return ut();{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,a=new QRe(r,i),o=s.targetId;t=new dj(o,a)}}return t}function oDe(n,e){return{documents:[yj(n,e.path)]}}function lDe(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=yj(n,r);const i=function(u){if(u.length!==0)return vj(Ji.create(u,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const a=function(u){if(u.length!==0)return u.map(d=>function(m){return{field:id(m.field),direction:hDe(m.dir)}}(d))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=YE(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:r}}function cDe(n){let e=iDe(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){On(s===1);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=function(f){const m=xj(f);return m instanceof Ji&&XU(m)?m.getFilters():[m]}(t.where));let a=[];t.orderBy&&(a=function(f){return f.map(m=>function(b){return new Om(ad(b.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(m))}(t.orderBy));let o=null;t.limit&&(o=function(f){let m;return m=typeof f=="object"?f.value:f,x1(m)?null:m}(t.limit));let l=null;t.startAt&&(l=function(f){const m=!!f.before,y=f.values||[];return new vx(y,m)}(t.startAt));let u=null;return t.endAt&&(u=function(f){const m=!f.before,y=f.values||[];return new vx(y,m)}(t.endAt)),DRe(e,r,a,i,o,"F",l,u)}function uDe(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ut()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function xj(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=ad(t.unaryFilter.field);return Yn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=ad(t.unaryFilter.field);return Yn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ad(t.unaryFilter.field);return Yn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ad(t.unaryFilter.field);return Yn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ut()}}(n):n.fieldFilter!==void 0?function(t){return Yn.create(ad(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ut()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ji.create(t.compositeFilter.filters.map(s=>xj(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ut()}}(t.compositeFilter.op))}(n):ut()}function hDe(n){return tDe[n]}function dDe(n){return nDe[n]}function fDe(n){return sDe[n]}function id(n){return{fieldPath:n.canonicalString()}}function ad(n){return rr.fromServerFormat(n.fieldPath)}function vj(n){return n instanceof Yn?function(t){if(t.op==="=="){if(BO(t.value))return{unaryFilter:{field:id(t.field),op:"IS_NAN"}};if(VO(t.value))return{unaryFilter:{field:id(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(BO(t.value))return{unaryFilter:{field:id(t.field),op:"IS_NOT_NAN"}};if(VO(t.value))return{unaryFilter:{field:id(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:id(t.field),op:dDe(t.op),value:t.value}}}(n):n instanceof Ji?function(t){const s=t.getFilters().map(r=>vj(r));return s.length===1?s[0]:{compositeFilter:{op:fDe(t.op),filters:s}}}(n):ut()}function wj(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e,t,s,r,i=lt.min(),a=lt.min(),o=Us.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Gl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Gl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Gl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Gl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pDe{constructor(e){this.ct=e}}function mDe(n){const e=cDe({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?wx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gDe{constructor(){this.un=new yDe}addToCollectionParentIndex(e,t){return this.un.add(t),De.resolve()}getCollectionParents(e,t){return De.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return De.resolve()}deleteFieldIndex(e,t){return De.resolve()}deleteAllFieldIndexes(e){return De.resolve()}createTargetIndexes(e,t){return De.resolve()}getDocumentsMatchingTarget(e,t){return De.resolve(null)}getIndexType(e,t){return De.resolve(0)}getFieldIndexes(e,t){return De.resolve([])}getNextCollectionGroupToUpdate(e){return De.resolve(null)}getMinOffset(e,t){return De.resolve(cc.min())}getMinOffsetFromCollectionGroup(e,t){return De.resolve(cc.min())}updateCollectionGroup(e,t,s){return De.resolve()}updateIndexEntries(e,t){return De.resolve()}}class yDe{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new Ms(In.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Ms(In.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Wd(0)}static kn(){return new Wd(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bDe{constructor(){this.changes=new Sf(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,tr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?De.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xDe{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vDe{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(s!==null&&om(s.mutation,r,Wl.empty(),$s.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,Lt()).next(()=>s))}getLocalViewOfDocuments(e,t,s=Lt()){const r=bu();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,s).next(i=>{let a=Yp();return i.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const s=bu();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,Lt()))}populateOverlays(e,t,s){const r=[];return s.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((a,o)=>{t.set(a,o)})})}computeViews(e,t,s,r){let i=hc();const a=am(),o=function(){return am()}();return t.forEach((l,u)=>{const d=s.get(u.key);r.has(u.key)&&(d===void 0||d.mutation instanceof T1)?i=i.insert(u.key,u):d!==void 0?(a.set(u.key,d.mutation.getFieldMask()),om(d.mutation,u,d.mutation.getFieldMask(),$s.now())):a.set(u.key,Wl.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((u,d)=>a.set(u,d)),t.forEach((u,d)=>{var f;return o.set(u,new xDe(d,(f=a.get(u))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(e,t){const s=am();let r=new Wn((a,o)=>a-o),i=Lt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let d=s.get(l)||Wl.empty();d=o.applyToLocalView(u,d),s.set(l,d);const f=(r.get(o.batchId)||Lt()).add(l);r=r.insert(o.batchId,f)})}).next(()=>{const a=[],o=r.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,d=l.value,f=rj();d.forEach(m=>{if(!i.has(m)){const y=cj(t.get(m),s.get(m));y!==null&&f.set(m,y),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,f))}return De.waitFor(a)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,r){return function(a){return st.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ej(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next(i=>{const a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):De.resolve(bu());let o=-1,l=i;return a.next(u=>De.forEach(u,(d,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),i.get(d)?De.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{l=l.insert(d,m)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,l,u,Lt())).next(d=>({batchId:o,changes:MRe(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new st(t)).next(s=>{let r=Yp();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const i=t.collectionGroup;let a=Yp();return this.indexManager.getCollectionParents(e,i).next(o=>De.forEach(o,l=>{const u=function(f,m){return new wf(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,s,r).next(d=>{d.forEach((f,m)=>{a=a.insert(f,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,i,r))).next(a=>{i.forEach((l,u)=>{const d=u.getKey();a.get(d)===null&&(a=a.insert(d,tr.newInvalidDocument(d)))});let o=Yp();return a.forEach((l,u)=>{const d=i.get(l);d!==void 0&&om(d.mutation,u,Wl.empty(),$s.now()),w1(t,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wDe{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return De.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:wd(r.createTime)}}(t)),De.resolve()}getNamedQuery(e,t){return De.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(r){return{name:r.name,query:mDe(r.bundledQuery),readTime:wd(r.readTime)}}(t)),De.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SDe{constructor(){this.overlays=new Wn(st.comparator),this.Ir=new Map}getOverlay(e,t){return De.resolve(this.overlays.get(t))}getOverlays(e,t){const s=bu();return De.forEach(t,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((r,i)=>{this.ht(e,t,i)}),De.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.Ir.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(s)),De.resolve()}getOverlaysForCollection(e,t,s){const r=bu(),i=t.length+1,a=new st(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&l.largestBatchId>s&&r.set(l.getKey(),l)}return De.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new Wn((u,d)=>u-d);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>s){let d=i.get(u.largestBatchId);d===null&&(d=bu(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const o=bu(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>o.set(u,d)),!(o.size()>=r)););return De.resolve(o)}ht(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const a=this.Ir.get(r.largestBatchId).delete(s.key);this.Ir.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(s.key,new YRe(t,s));let i=this.Ir.get(t);i===void 0&&(i=Lt(),this.Ir.set(t,i)),this.Ir.set(t,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TDe{constructor(){this.sessionToken=Us.EMPTY_BYTE_STRING}getSessionToken(e){return De.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,De.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(){this.Tr=new Ms(Ts.Er),this.dr=new Ms(Ts.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const s=new Ts(e,t);this.Tr=this.Tr.add(s),this.dr=this.dr.add(s)}Rr(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.Vr(new Ts(e,t))}mr(e,t){e.forEach(s=>this.removeReference(s,t))}gr(e){const t=new st(new In([])),s=new Ts(t,e),r=new Ts(t,e+1),i=[];return this.dr.forEachInRange([s,r],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new st(new In([])),s=new Ts(t,e),r=new Ts(t,e+1);let i=Lt();return this.dr.forEachInRange([s,r],a=>{i=i.add(a.key)}),i}containsKey(e){const t=new Ts(e,0),s=this.Tr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Ts{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return st.comparator(e.key,t.key)||Ht(e.wr,t.wr)}static Ar(e,t){return Ht(e.wr,t.wr)||st.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EDe{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ms(Ts.Er)}checkEmpty(e){return De.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new XRe(i,t,s,r);this.mutationQueue.push(a);for(const o of r)this.br=this.br.add(new Ts(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return De.resolve(a)}lookupMutationBatch(e,t){return De.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.vr(s),i=r<0?0:r;return De.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return De.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return De.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Ts(t,0),r=new Ts(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([s,r],a=>{const o=this.Dr(a.wr);i.push(o)}),De.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Ms(Ht);return t.forEach(r=>{const i=new Ts(r,0),a=new Ts(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],o=>{s=s.add(o.wr)})}),De.resolve(this.Cr(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;st.isDocumentKey(i)||(i=i.child(""));const a=new Ts(new st(i),0);let o=new Ms(Ht);return this.br.forEachWhile(l=>{const u=l.key.path;return!!s.isPrefixOf(u)&&(u.length===r&&(o=o.add(l.wr)),!0)},a),De.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach(s=>{const r=this.Dr(s);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){On(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let s=this.br;return De.forEach(t.mutations,r=>{const i=new Ts(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=s})}On(e){}containsKey(e,t){const s=new Ts(t,0),r=this.br.firstAfterOrEqual(s);return De.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,De.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _De{constructor(e){this.Mr=e,this.docs=function(){return new Wn(st.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,a=this.Mr(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return De.resolve(s?s.document.mutableCopy():tr.newInvalidDocument(t))}getEntries(e,t){let s=hc();return t.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():tr.newInvalidDocument(r))}),De.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=hc();const a=t.path,o=new st(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||pRe(fRe(d),s)<=0||(r.has(d.key)||w1(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return De.resolve(i)}getAllFromCollectionGroup(e,t,s,r){ut()}Or(e,t){return De.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new IDe(this)}getSize(e){return De.resolve(this.size)}}class IDe extends bDe{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(s)}),De.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $De{constructor(e){this.persistence=e,this.Nr=new Sf(t=>qC(t),KC),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new JC,this.targetCount=0,this.kr=Wd.Bn()}forEachTarget(e,t){return this.Nr.forEach((s,r)=>t(r)),De.resolve()}getLastRemoteSnapshotVersion(e){return De.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return De.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),De.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.Lr&&(this.Lr=t),De.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Wd(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,De.resolve()}updateTargetData(e,t){return this.Kn(t),De.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,De.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=t&&s.get(o.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),De.waitFor(i).next(()=>r)}getTargetCount(e){return De.resolve(this.targetCount)}getTargetData(e,t){const s=this.Nr.get(t)||null;return De.resolve(s)}addMatchingKeys(e,t,s){return this.Br.Rr(t,s),De.resolve()}removeMatchingKeys(e,t,s){this.Br.mr(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(a=>{i.push(r.markPotentiallyOrphaned(e,a))}),De.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),De.resolve()}getMatchingKeysForTargetId(e,t){const s=this.Br.yr(t);return De.resolve(s)}containsKey(e,t){return De.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CDe{constructor(e,t){this.qr={},this.overlays={},this.Qr=new jC(0),this.Kr=!1,this.Kr=!0,this.$r=new TDe,this.referenceDelegate=e(this),this.Ur=new $De(this),this.indexManager=new gDe,this.remoteDocumentCache=function(r){return new _De(r)}(s=>this.referenceDelegate.Wr(s)),this.serializer=new pDe(t),this.Gr=new wDe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new SDe,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.qr[e.toKey()];return s||(s=new EDe(t,this.referenceDelegate),this.qr[e.toKey()]=s),s}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,s){qe("MemoryPersistence","Starting transaction:",e);const r=new NDe(this.Qr.next());return this.referenceDelegate.zr(),s(r).next(i=>this.referenceDelegate.jr(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Hr(e,t){return De.or(Object.values(this.qr).map(s=>()=>s.containsKey(e,t)))}}class NDe extends gRe{constructor(e){super(),this.currentSequenceNumber=e}}class eN{constructor(e){this.persistence=e,this.Jr=new JC,this.Yr=null}static Zr(e){return new eN(e)}get Xr(){if(this.Yr)return this.Yr;throw ut()}addReference(e,t,s){return this.Jr.addReference(s,t),this.Xr.delete(s.toString()),De.resolve()}removeReference(e,t,s){return this.Jr.removeReference(s,t),this.Xr.add(s.toString()),De.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),De.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(r=>this.Xr.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.Xr.add(i.toString()))}).next(()=>s.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return De.forEach(this.Xr,s=>{const r=st.fromPath(s);return this.ei(e,r).next(i=>{i||t.removeEntry(r,lt.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(s=>{s?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return De.or([()=>De.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.$i=s,this.Ui=r}static Wi(e,t){let s=Lt(),r=Lt();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new tN(e,t.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kDe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ADe{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return p6()?8:yRe(lr())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,s,r){const i={result:null};return this.Yi(e,t).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,t,r,s).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new kDe;return this.Xi(e,t,a).next(o=>{if(i.result=o,this.zi)return this.es(e,t,a,o.size)})}).next(()=>i.result)}es(e,t,s,r){return s.documentReadCount<this.ji?(Lp()<=_t.DEBUG&&qe("QueryEngine","SDK will not create cache indexes for query:",rd(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),De.resolve()):(Lp()<=_t.DEBUG&&qe("QueryEngine","Query:",rd(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.Hi*r?(Lp()<=_t.DEBUG&&qe("QueryEngine","The SDK decides to create cache indexes for query:",rd(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,La(t))):De.resolve())}Yi(e,t){if(WO(t))return De.resolve(null);let s=La(t);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=wx(t,null,"F"),s=La(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const a=Lt(...i);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,s).next(l=>{const u=this.ts(t,o);return this.ns(t,u,a,l.readTime)?this.Yi(e,wx(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,s,r){return WO(t)||r.isEqual(lt.min())?De.resolve(null):this.Ji.getDocuments(e,s).next(i=>{const a=this.ts(t,i);return this.ns(t,a,s,r)?De.resolve(null):(Lp()<=_t.DEBUG&&qe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),rd(t)),this.rs(e,a,t,dRe(r,-1)).next(o=>o))})}ts(e,t){let s=new Ms(nj(e));return t.forEach((r,i)=>{w1(e,i)&&(s=s.add(i))}),s}ns(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,s){return Lp()<=_t.DEBUG&&qe("QueryEngine","Using full collection scan to execute query:",rd(t)),this.Ji.getDocumentsMatchingQuery(e,t,cc.min(),s)}rs(e,t,s,r){return this.Ji.getDocumentsMatchingQuery(e,s,r).next(i=>(t.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RDe{constructor(e,t,s,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new Wn(Ht),this._s=new Sf(i=>qC(i),KC),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(s)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new vDe(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function DDe(n,e,t,s){return new RDe(n,e,t,s)}async function Sj(n,e){const t=Ft(n);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,t.ls(e),t.mutationQueue.getAllMutationBatches(s))).next(i=>{const a=[],o=[];let l=Lt();for(const u of r){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of i){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(s,l).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:o}))})})}function Tj(n){const e=Ft(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function ODe(n,e){const t=Ft(n),s=e.snapshotVersion;let r=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=t.cs.newChangeBuffer({trackRemovals:!0});r=t.os;const o=[];e.targetChanges.forEach((d,f)=>{const m=r.get(f);if(!m)return;o.push(t.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(i,d.addedDocuments,f)));let y=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Us.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,s)),r=r.insert(f,y),function(w,x,T){return w.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(m,y,d)&&o.push(t.Ur.updateTargetData(i,y))});let l=hc(),u=Lt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))}),o.push(FDe(i,a,e.documentUpdates).next(d=>{l=d.Ps,u=d.Is})),!s.isEqual(lt.min())){const d=t.Ur.getLastRemoteSnapshotVersion(i).next(f=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,s));o.push(d)}return De.waitFor(o).next(()=>a.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,u)).next(()=>l)}).then(i=>(t.os=r,i))}function FDe(n,e,t){let s=Lt(),r=Lt();return t.forEach(i=>s=s.add(i)),e.getEntries(n,s).next(i=>{let a=hc();return t.forEach((o,l)=>{const u=i.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(o)),l.isNoDocument()&&l.version.isEqual(lt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):qe("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{Ps:a,Is:r}})}function LDe(n,e){const t=Ft(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return t.Ur.getTargetData(s,e).next(i=>i?(r=i,De.resolve(r)):t.Ur.allocateTargetId(s).next(a=>(r=new Gl(e,a,"TargetPurposeListen",s.currentSequenceNumber),t.Ur.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=t.os.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.os=t.os.insert(s.targetId,s),t._s.set(e,s.targetId)),s})}async function JE(n,e,t){const s=Ft(n),r=s.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",i,a=>s.persistence.referenceDelegate.removeTarget(a,r))}catch(a){if(!cy(a))throw a;qe("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}s.os=s.os.remove(e),s._s.delete(r.target)}function tF(n,e,t){const s=Ft(n);let r=lt.min(),i=Lt();return s.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,d){const f=Ft(l),m=f._s.get(d);return m!==void 0?De.resolve(f.os.get(m)):f.Ur.getTargetData(u,d)}(s,a,La(e)).next(o=>{if(o)return r=o.lastLimboFreeSnapshotVersion,s.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{i=l})}).next(()=>s.ss.getDocumentsMatchingQuery(a,e,t?r:lt.min(),t?i:Lt())).next(o=>(PDe(s,FRe(e),o),{documents:o,Ts:i})))}function PDe(n,e,t){let s=n.us.get(e)||lt.min();t.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),n.us.set(e,s)}class nF{constructor(){this.activeTargetIds=zRe()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class MDe{constructor(){this.so=new nF,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,s){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new nF,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VDe{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sF{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){qe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){qe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zb=null;function gT(){return Zb===null?Zb=function(){return 268435456+Math.round(2147483648*Math.random())}():Zb++,"0x"+Zb.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BDe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zDe{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys="WebChannelConnection";class UDe extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const s=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=s+"://"+t.host,this.vo=`projects/${r}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${i}`}get Fo(){return!1}Mo(t,s,r,i,a){const o=gT(),l=this.xo(t,s.toUriEncodedString());qe("RestConnection",`Sending RPC '${t}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,a),this.No(t,l,u,r).then(d=>(qe("RestConnection",`Received RPC '${t}' ${o}: `,d),d),d=>{throw Bd("RestConnection",`RPC '${t}' ${o} failed with error: `,d,"url: ",l,"request:",r),d})}Lo(t,s,r,i,a,o){return this.Mo(t,s,r,i,a)}Oo(t,s,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+vf}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach((i,a)=>t[a]=i),r&&r.headers.forEach((i,a)=>t[a]=i)}xo(t,s){const r=BDe[t];return`${this.Do}/v1/${s}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,s,r){const i=gT();return new Promise((a,o)=>{const l=new VU;l.setWithCredentials(!0),l.listenOnce(BU.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case w0.NO_ERROR:const d=l.getResponseJson();qe(Ys,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),a(d);break;case w0.TIMEOUT:qe(Ys,`RPC '${e}' ${i} timed out`),o(new Ke(Fe.DEADLINE_EXCEEDED,"Request time out"));break;case w0.HTTP_ERROR:const f=l.getStatus();if(qe(Ys,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m==null?void 0:m.error;if(y&&y.status&&y.message){const b=function(x){const T=x.toLowerCase().replace(/_/g,"-");return Object.values(Fe).indexOf(T)>=0?T:Fe.UNKNOWN}(y.status);o(new Ke(b,y.message))}else o(new Ke(Fe.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Ke(Fe.UNAVAILABLE,"Connection failed."));break;default:ut()}}finally{qe(Ys,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(r);qe(Ys,`RPC '${e}' ${i} sending request:`,r),l.send(t,"POST",u,s,15)})}Bo(e,t,s){const r=gT(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=jU(),o=UU(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,s),l.encodeInitMessageHeaders=!0;const d=i.join("");qe(Ys,`Creating RPC '${e}' stream ${r}: ${d}`,l);const f=a.createWebChannel(d,l);let m=!1,y=!1;const b=new zDe({Io:x=>{y?qe(Ys,`Not sending because RPC '${e}' stream ${r} is closed:`,x):(m||(qe(Ys,`Opening RPC '${e}' stream ${r} transport.`),f.open(),m=!0),qe(Ys,`RPC '${e}' stream ${r} sending:`,x),f.send(x))},To:()=>f.close()}),w=(x,T,E)=>{x.listen(T,$=>{try{E($)}catch(C){setTimeout(()=>{throw C},0)}})};return w(f,Xp.EventType.OPEN,()=>{y||(qe(Ys,`RPC '${e}' stream ${r} transport opened.`),b.yo())}),w(f,Xp.EventType.CLOSE,()=>{y||(y=!0,qe(Ys,`RPC '${e}' stream ${r} transport closed`),b.So())}),w(f,Xp.EventType.ERROR,x=>{y||(y=!0,Bd(Ys,`RPC '${e}' stream ${r} transport errored:`,x),b.So(new Ke(Fe.UNAVAILABLE,"The operation could not be completed")))}),w(f,Xp.EventType.MESSAGE,x=>{var T;if(!y){const E=x.data[0];On(!!E);const $=E,C=$.error||((T=$[0])===null||T===void 0?void 0:T.error);if(C){qe(Ys,`RPC '${e}' stream ${r} received error:`,C);const O=C.status;let V=function(N){const D=Kn[N];if(D!==void 0)return hj(D)}(O),F=C.message;V===void 0&&(V=Fe.INTERNAL,F="Unknown error status: "+O+" with message "+C.message),y=!0,b.So(new Ke(V,F)),f.close()}else qe(Ys,`RPC '${e}' stream ${r} received:`,E),b.bo(E)}}),w(o,zU.STAT_EVENT,x=>{x.stat===UE.PROXY?qe(Ys,`RPC '${e}' stream ${r} detected buffering proxy`):x.stat===UE.NOPROXY&&qe(Ys,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{b.wo()},0),b}}function yT(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _1(n){return new rDe(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e,t,s=1e3,r=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=s,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),s=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-s);r>0&&qe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jDe{constructor(e,t,s,r,i,a,o,l){this.ui=e,this.Ho=s,this.Jo=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ej(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===Fe.RESOURCE_EXHAUSTED?(jo(t.toString()),jo("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.Yo===t&&this.P_(s,r)},s=>{e(()=>{const r=new Ke(Fe.UNKNOWN,"Fetching auth token failed: "+s.message);return this.I_(r)})})}P_(e,t){const s=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{s(()=>this.listener.Eo())}),this.stream.Ro(()=>{s(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(r=>{s(()=>this.I_(r))}),this.stream.onMessage(r=>{s(()=>++this.e_==1?this.E_(r):this.onNext(r))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return qe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(qe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class WDe extends jDe{constructor(e,t,s,r,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,a),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=aDe(this.serializer,e),s=function(i){if(!("targetChange"in i))return lt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?lt.min():a.readTime?wd(a.readTime):lt.min()}(e);return this.listener.d_(t,s)}A_(e){const t={};t.database=eF(this.serializer),t.addTarget=function(i,a){let o;const l=a.target;if(o=HE(l)?{documents:oDe(i,l)}:{query:lDe(i,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=pj(i,a.resumeToken);const u=YE(i,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(lt.min())>0){o.readTime=QE(i,a.snapshotVersion.toTimestamp());const u=YE(i,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const s=uDe(this.serializer,e);s&&(t.labels=s),this.a_(t)}R_(e){const t={};t.database=eF(this.serializer),t.removeTarget=e,this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GDe extends class{}{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new Ke(Fe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,s,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,ZE(t,s),r,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ke(Fe.UNKNOWN,i.toString())})}Lo(e,t,s,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,ZE(t,s),r,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ke(Fe.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class HDe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(jo(t),this.D_=!1):qe("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qDe{constructor(e,t,s,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{s.enqueueAndForget(async()=>{fy(this)&&(qe("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=Ft(l);u.L_.add(4),await dy(u),u.q_.set("Unknown"),u.L_.delete(4),await I1(u)}(this))})}),this.q_=new HDe(s,r)}}async function I1(n){if(fy(n))for(const e of n.B_)await e(!0)}async function dy(n){for(const e of n.B_)await e(!1)}function _j(n,e){const t=Ft(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),iN(t)?rN(t):Tf(t).r_()&&sN(t,e))}function nN(n,e){const t=Ft(n),s=Tf(t);t.N_.delete(e),s.r_()&&Ij(t,e),t.N_.size===0&&(s.r_()?s.o_():fy(t)&&t.q_.set("Unknown"))}function sN(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Tf(n).A_(e)}function Ij(n,e){n.Q_.xe(e),Tf(n).R_(e)}function rN(n){n.Q_=new eDe({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Tf(n).start(),n.q_.v_()}function iN(n){return fy(n)&&!Tf(n).n_()&&n.N_.size>0}function fy(n){return Ft(n).L_.size===0}function $j(n){n.Q_=void 0}async function KDe(n){n.q_.set("Online")}async function XDe(n){n.N_.forEach((e,t)=>{sN(n,e)})}async function YDe(n,e){$j(n),iN(n)?(n.q_.M_(e),rN(n)):n.q_.set("Unknown")}async function QDe(n,e,t){if(n.q_.set("Online"),e instanceof fj&&e.state===2&&e.cause)try{await async function(r,i){const a=i.cause;for(const o of i.targetIds)r.N_.has(o)&&(await r.remoteSyncer.rejectListen(o,a),r.N_.delete(o),r.Q_.removeTarget(o))}(n,e)}catch(s){qe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await rF(n,s)}else if(e instanceof T0?n.Q_.Ke(e):e instanceof dj?n.Q_.He(e):n.Q_.We(e),!t.isEqual(lt.min()))try{const s=await Tj(n.localStore);t.compareTo(s)>=0&&await function(i,a){const o=i.Q_.rt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const d=i.N_.get(l);if(!d)return;i.N_.set(l,d.withResumeToken(Us.EMPTY_BYTE_STRING,d.snapshotVersion)),Ij(i,l);const f=new Gl(d.target,l,u,d.sequenceNumber);sN(i,f)}),i.remoteSyncer.applyRemoteEvent(o)}(n,t)}catch(s){qe("RemoteStore","Failed to raise snapshot:",s),await rF(n,s)}}async function rF(n,e,t){if(!cy(e))throw e;n.L_.add(1),await dy(n),n.q_.set("Offline"),t||(t=()=>Tj(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{qe("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await I1(n)})}async function iF(n,e){const t=Ft(n);t.asyncQueue.verifyOperationInProgress(),qe("RemoteStore","RemoteStore received new credentials");const s=fy(t);t.L_.add(3),await dy(t),s&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await I1(t)}async function ZDe(n,e){const t=Ft(n);e?(t.L_.delete(2),await I1(t)):e||(t.L_.add(2),await dy(t),t.q_.set("Unknown"))}function Tf(n){return n.K_||(n.K_=function(t,s,r){const i=Ft(t);return i.w_(),new WDe(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{Eo:KDe.bind(null,n),Ro:XDe.bind(null,n),mo:YDe.bind(null,n),d_:QDe.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),iN(n)?rN(n):n.q_.set("Unknown")):(await n.K_.stop(),$j(n))})),n.K_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Tu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,i){const a=Date.now()+s,o=new aN(e,t,a,r,i);return o.start(s),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ke(Fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cj(n,e){if(jo("AsyncQueue",`${e}: ${n}`),cy(n))return new Ke(Fe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e){this.comparator=e?(t,s)=>e(t,s)||st.comparator(t.key,s.key):(t,s)=>st.comparator(t.key,s.key),this.keyedMap=Yp(),this.sortedSet=new Wn(this.comparator)}static emptySet(e){return new Sd(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Sd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Sd;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aF{constructor(){this.W_=new Wn(st.comparator)}track(e){const t=e.doc.key,s=this.W_.get(t);s?e.type!==0&&s.type===3?this.W_=this.W_.insert(t,e):e.type===3&&s.type!==1?this.W_=this.W_.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.W_=this.W_.remove(t):e.type===1&&s.type===2?this.W_=this.W_.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):ut():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,s)=>{e.push(s)}),e}}class Gd{constructor(e,t,s,r,i,a,o,l,u){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,s,r,i){const a=[];return t.forEach(o=>{a.push({type:0,doc:o})}),new Gd(e,t,Sd.emptySet(t),a,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&v1(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JDe{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class eOe{constructor(){this.queries=oF(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,s){const r=Ft(t),i=r.queries;r.queries=oF(),i.forEach((a,o)=>{for(const l of o.j_)l.onError(s)})})(this,new Ke(Fe.ABORTED,"Firestore shutting down"))}}function oF(){return new Sf(n=>tj(n),v1)}async function tOe(n,e){const t=Ft(n);let s=3;const r=e.query;let i=t.queries.get(r);i?!i.H_()&&e.J_()&&(s=2):(i=new JDe,s=e.J_()?0:1);try{switch(s){case 0:i.z_=await t.onListen(r,!0);break;case 1:i.z_=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(a){const o=Cj(a,`Initialization of query '${rd(e.query)}' failed`);return void e.onError(o)}t.queries.set(r,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&oN(t)}async function nOe(n,e){const t=Ft(n),s=e.query;let r=3;const i=t.queries.get(s);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?r=e.J_()?0:1:!i.H_()&&e.J_()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function sOe(n,e){const t=Ft(n);let s=!1;for(const r of e){const i=r.query,a=t.queries.get(i);if(a){for(const o of a.j_)o.X_(r)&&(s=!0);a.z_=r}}s&&oN(t)}function rOe(n,e,t){const s=Ft(n),r=s.queries.get(e);if(r)for(const i of r.j_)i.onError(t);s.queries.delete(e)}function oN(n){n.Y_.forEach(e=>{e.next()})}var e_,lF;(lF=e_||(e_={})).ea="default",lF.Cache="cache";class iOe{constructor(e,t,s){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=s||{}}X_(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Gd(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const s=t!=="Offline";return(!this.options._a||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Gd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==e_.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(e){this.key=e}}class kj{constructor(e){this.key=e}}class aOe{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Lt(),this.mutatedKeys=Lt(),this.Aa=nj(e),this.Ra=new Sd(this.Aa)}get Va(){return this.Ta}ma(e,t){const s=t?t.fa:new aF,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,a=r,o=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,f)=>{const m=r.get(d),y=w1(this.query,f)?f:null,b=!!m&&this.mutatedKeys.has(m.key),w=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let x=!1;m&&y?m.data.isEqual(y.data)?b!==w&&(s.track({type:3,doc:y}),x=!0):this.ga(m,y)||(s.track({type:2,doc:y}),x=!0,(l&&this.Aa(y,l)>0||u&&this.Aa(y,u)<0)&&(o=!0)):!m&&y?(s.track({type:0,doc:y}),x=!0):m&&!y&&(s.track({type:1,doc:m}),x=!0,(l||u)&&(o=!0)),x&&(y?(a=a.add(y),i=w?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),s.track({type:1,doc:d})}return{Ra:a,fa:s,ns:o,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((d,f)=>function(y,b){const w=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ut()}};return w(y)-w(b)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(s),r=r!=null&&r;const o=t&&!r?this.ya():[],l=this.da.size===0&&this.current&&!r?1:0,u=l!==this.Ea;return this.Ea=l,a.length!==0||u?{snapshot:new Gd(this.query,e.Ra,i,a,e.mutatedKeys,l===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new aF,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Lt(),this.Ra.forEach(s=>{this.Sa(s.key)&&(this.da=this.da.add(s.key))});const t=[];return e.forEach(s=>{this.da.has(s)||t.push(new kj(s))}),this.da.forEach(s=>{e.has(s)||t.push(new Nj(s))}),t}ba(e){this.Ta=e.Ts,this.da=Lt();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Gd.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class oOe{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class lOe{constructor(e){this.key=e,this.va=!1}}class cOe{constructor(e,t,s,r,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Sf(o=>tj(o),v1),this.Ma=new Map,this.xa=new Set,this.Oa=new Wn(st.comparator),this.Na=new Map,this.La=new JC,this.Ba={},this.ka=new Map,this.qa=Wd.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function uOe(n,e,t=!0){const s=Fj(n);let r;const i=s.Fa.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Da()):r=await Aj(s,e,t,!0),r}async function hOe(n,e){const t=Fj(n);await Aj(t,e,!0,!1)}async function Aj(n,e,t,s){const r=await LDe(n.localStore,La(e)),i=r.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let o;return s&&(o=await dOe(n,e,i,a==="current",r.resumeToken)),n.isPrimaryClient&&t&&_j(n.remoteStore,r),o}async function dOe(n,e,t,s,r){n.Ka=(f,m,y)=>async function(w,x,T,E){let $=x.view.ma(T);$.ns&&($=await tF(w.localStore,x.query,!1).then(({documents:F})=>x.view.ma(F,$)));const C=E&&E.targetChanges.get(x.targetId),O=E&&E.targetMismatches.get(x.targetId)!=null,V=x.view.applyChanges($,w.isPrimaryClient,C,O);return uF(w,x.targetId,V.wa),V.snapshot}(n,f,m,y);const i=await tF(n.localStore,e,!0),a=new aOe(e,i.Ts),o=a.ma(i.documents),l=hy.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),u=a.applyChanges(o,n.isPrimaryClient,l);uF(n,t,u.wa);const d=new oOe(e,t,a);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot}async function fOe(n,e,t){const s=Ft(n),r=s.Fa.get(e),i=s.Ma.get(r.targetId);if(i.length>1)return s.Ma.set(r.targetId,i.filter(a=>!v1(a,e))),void s.Fa.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await JE(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),t&&nN(s.remoteStore,r.targetId),t_(s,r.targetId)}).catch(UC)):(t_(s,r.targetId),await JE(s.localStore,r.targetId,!0))}async function pOe(n,e){const t=Ft(n),s=t.Fa.get(e),r=t.Ma.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),nN(t.remoteStore,s.targetId))}async function Rj(n,e){const t=Ft(n);try{const s=await ODe(t.localStore,e);e.targetChanges.forEach((r,i)=>{const a=t.Na.get(i);a&&(On(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?a.va=!0:r.modifiedDocuments.size>0?On(a.va):r.removedDocuments.size>0&&(On(a.va),a.va=!1))}),await Oj(t,s,e)}catch(s){await UC(s)}}function cF(n,e,t){const s=Ft(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.Fa.forEach((i,a)=>{const o=a.view.Z_(e);o.snapshot&&r.push(o.snapshot)}),function(a,o){const l=Ft(a);l.onlineState=o;let u=!1;l.queries.forEach((d,f)=>{for(const m of f.j_)m.Z_(o)&&(u=!0)}),u&&oN(l)}(s.eventManager,e),r.length&&s.Ca.d_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function mOe(n,e,t){const s=Ft(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.Na.get(e),i=r&&r.key;if(i){let a=new Wn(st.comparator);a=a.insert(i,tr.newNoDocument(i,lt.min()));const o=Lt().add(i),l=new E1(lt.min(),new Map,new Wn(Ht),a,o);await Rj(s,l),s.Oa=s.Oa.remove(i),s.Na.delete(e),lN(s)}else await JE(s.localStore,e,!1).then(()=>t_(s,e,t)).catch(UC)}function t_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Ma.get(e))n.Fa.delete(s),t&&n.Ca.$a(s,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(s=>{n.La.containsKey(s)||Dj(n,s)})}function Dj(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(nN(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),lN(n))}function uF(n,e,t){for(const s of t)s instanceof Nj?(n.La.addReference(s.key,e),gOe(n,s)):s instanceof kj?(qe("SyncEngine","Document no longer in limbo: "+s.key),n.La.removeReference(s.key,e),n.La.containsKey(s.key)||Dj(n,s.key)):ut()}function gOe(n,e){const t=e.key,s=t.path.canonicalString();n.Oa.get(t)||n.xa.has(s)||(qe("SyncEngine","New document in limbo: "+t),n.xa.add(s),lN(n))}function lN(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new st(In.fromString(e)),s=n.qa.next();n.Na.set(s,new lOe(t)),n.Oa=n.Oa.insert(t,s),_j(n.remoteStore,new Gl(La(JU(t.path)),s,"TargetPurposeLimboResolution",jC.oe))}}async function Oj(n,e,t){const s=Ft(n),r=[],i=[],a=[];s.Fa.isEmpty()||(s.Fa.forEach((o,l)=>{a.push(s.Ka(l,e,t).then(u=>{var d;if((u||t)&&s.isPrimaryClient){const f=u?!u.fromCache:(d=t==null?void 0:t.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;s.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(u){r.push(u);const f=tN.Wi(l.targetId,u);i.push(f)}}))}),await Promise.all(a),s.Ca.d_(r),await async function(l,u){const d=Ft(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>De.forEach(u,m=>De.forEach(m.$i,y=>d.persistence.referenceDelegate.addReference(f,m.targetId,y)).next(()=>De.forEach(m.Ui,y=>d.persistence.referenceDelegate.removeReference(f,m.targetId,y)))))}catch(f){if(!cy(f))throw f;qe("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const m=f.targetId;if(!f.fromCache){const y=d.os.get(m),b=y.snapshotVersion,w=y.withLastLimboFreeSnapshotVersion(b);d.os=d.os.insert(m,w)}}}(s.localStore,i))}async function yOe(n,e){const t=Ft(n);if(!t.currentUser.isEqual(e)){qe("SyncEngine","User change. New user:",e.toKey());const s=await Sj(t.localStore,e);t.currentUser=e,function(i,a){i.ka.forEach(o=>{o.forEach(l=>{l.reject(new Ke(Fe.CANCELLED,a))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Oj(t,s.hs)}}function bOe(n,e){const t=Ft(n),s=t.Na.get(e);if(s&&s.va)return Lt().add(s.key);{let r=Lt();const i=t.Ma.get(e);if(!i)return r;for(const a of i){const o=t.Fa.get(a);r=r.unionWith(o.view.Va)}return r}}function Fj(n){const e=Ft(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bOe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=mOe.bind(null,e),e.Ca.d_=sOe.bind(null,e.eventManager),e.Ca.$a=rOe.bind(null,e.eventManager),e}class Ex{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_1(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return DDe(this.persistence,new ADe,e.initialUser,this.serializer)}Ga(e){return new CDe(eN.Zr,this.serializer)}Wa(e){return new MDe}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ex.provider={build:()=>new Ex};class n_{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>cF(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=yOe.bind(null,this.syncEngine),await ZDe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new eOe}()}createDatastore(e){const t=_1(e.databaseInfo.databaseId),s=function(i){return new UDe(i)}(e.databaseInfo);return function(i,a,o,l){return new GDe(i,a,o,l)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,r,i,a,o){return new qDe(s,r,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,t=>cF(this.syncEngine,t,0),function(){return sF.D()?new sF:new VDe}())}createSyncEngine(e,t){return function(r,i,a,o,l,u,d){const f=new cOe(r,i,a,o,l,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const i=Ft(r);qe("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await dy(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}n_.provider={build:()=>new n_};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xOe{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):jo("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vOe{constructor(e,t,s,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=Zs.UNAUTHENTICATED,this.clientId=uRe.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async a=>{qe("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(s,a=>(qe("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Tu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Cj(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function bT(n,e){n.asyncQueue.verifyOperationInProgress(),qe("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(async r=>{s.isEqual(r)||(await Sj(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function hF(n,e){n.asyncQueue.verifyOperationInProgress();const t=await wOe(n);qe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(s=>iF(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,r)=>iF(e.remoteStore,r)),n._onlineComponents=e}async function wOe(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){qe("FirestoreClient","Using user provided OfflineComponentProvider");try{await bT(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===Fe.FAILED_PRECONDITION||r.code===Fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Bd("Error using user provided cache. Falling back to memory cache: "+t),await bT(n,new Ex)}}else qe("FirestoreClient","Using default OfflineComponentProvider"),await bT(n,new Ex);return n._offlineComponents}async function SOe(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(qe("FirestoreClient","Using user provided OnlineComponentProvider"),await hF(n,n._uninitializedComponentsProvider._online)):(qe("FirestoreClient","Using default OnlineComponentProvider"),await hF(n,new n_))),n._onlineComponents}async function TOe(n){const e=await SOe(n),t=e.eventManager;return t.onListen=uOe.bind(null,e.syncEngine),t.onUnlisten=fOe.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=hOe.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=pOe.bind(null,e.syncEngine),t}function EOe(n,e,t={}){const s=new Tu;return n.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,u){const d=new xOe({next:m=>{d.Za(),a.enqueueAndForget(()=>nOe(i,f)),m.fromCache&&l.source==="server"?u.reject(new Ke(Fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new iOe(o,d,{includeMetadataChanges:!0,_a:!0});return tOe(i,f)}(await TOe(n),n.asyncQueue,e,t,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dF=new Map;function _Oe(n,e,t,s){if(e===!0&&s===!0)throw new Ke(Fe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function fF(n){if(st.isDocumentKey(n))throw new Ke(Fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function $1(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ut()}function s_(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ke(Fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=$1(n);throw new Ke(Fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Ke(Fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ke(Fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_Oe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Lj((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ke(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ke(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ke(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class cN{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pF({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ke(Fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ke(Fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pF(e),e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new nRe;switch(s.type){case"firstParty":return new aRe(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ke(Fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=dF.get(t);s&&(qe("ComponentProvider","Removing Datastore"),dF.delete(t),s.terminate())}(this),Promise.resolve()}}function IOe(n,e,t,s={}){var r;const i=(n=s_(n,cN))._getSettings(),a=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&Bd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),s.mockUserToken){let o,l;if(typeof s.mockUserToken=="string")o=s.mockUserToken,l=Zs.MOCK_USER;else{o=o6(s.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const u=s.mockUserToken.sub||s.mockUserToken.user_id;if(!u)throw new Ke(Fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Zs(u)}n._authCredentials=new sRe(new WU(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new $c(this.firestore,e,this._query)}}class Yo{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Td(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yo(this.firestore,e,this._key)}}class Td extends $c{constructor(e,t,s){super(e,t,JU(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yo(this.firestore,null,new st(e))}withConverter(e){return new Td(this.firestore,e,this._path)}}function $Oe(n,e,...t){if(n=Xr(n),n instanceof cN){const s=In.fromString(e,...t);return fF(s),new Td(n,null,s)}{if(!(n instanceof Yo||n instanceof Td))throw new Ke(Fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(In.fromString(e,...t));return fF(s),new Td(n.firestore,null,s)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ej(this,"async_queue_retry"),this.Vu=()=>{const s=yT();s&&qe("AsyncQueue","Visibility state changed to "+s.visibilityState),this.t_.jo()},this.mu=e;const t=yT();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=yT();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Tu;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!cy(e))throw e;qe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(s=>{this.Eu=s,this.du=!1;const r=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(s);throw jo("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.du=!1,s))));return this.mu=t,t}enqueueAfterDelay(e,t,s){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=aN.createAndSchedule(this,e,t,s,i=>this.yu(i));return this.Tu.push(r),r}fu(){this.Eu&&ut()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class Pj extends cN{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new mF,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new mF(e),this._firestoreClient=void 0,await e}}}function COe(n,e){const t=typeof n=="object"?n:GF(),s=typeof n=="string"?n:"(default)",r=y_(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=i6("firestore");i&&IOe(r,...i)}return r}function NOe(n){if(n._terminated)throw new Ke(Fe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||kOe(n),n._firestoreClient}function kOe(n){var e,t,s;const r=n._freezeSettings(),i=function(o,l,u,d){return new vRe(o,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Lj(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=r.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new vOe(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Hd(Us.fromBase64String(e))}catch(t){throw new Ke(Fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Hd(Us.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mj{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ke(Fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vj{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ke(Fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ke(Fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ht(this._lat,e._lat)||Ht(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AOe=/^__.*__$/;function Bj(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ut()}}class dN{constructor(e,t,s,r,i,a){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new dN(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:s,xu:!1});return r.Ou(e),r}Nu(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:s,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return r_(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Bj(this.Cu)&&AOe.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class ROe{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||_1(e)}Qu(e,t,s,r=!1){return new dN({Cu:e,methodName:t,qu:s,path:rr.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function DOe(n){const e=n._freezeSettings(),t=_1(n._databaseId);return new ROe(n._databaseId,!!e.ignoreUndefinedProperties,t)}function OOe(n,e,t,s=!1){return fN(t,n.Qu(s?4:3,e))}function fN(n,e){if(zj(n=Xr(n)))return LOe("Unsupported field value:",e,n),FOe(n,e);if(n instanceof Vj)return function(s,r){if(!Bj(r.Cu))throw r.Bu(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(s,r){const i=[];let a=0;for(const o of s){let l=fN(o,r.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}}(n,e)}return function(s,r){if((s=Xr(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return URe(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=$s.fromDate(s);return{timestampValue:QE(r.serializer,i)}}if(s instanceof $s){const i=new $s(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:QE(r.serializer,i)}}if(s instanceof uN)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Hd)return{bytesValue:pj(r.serializer,s._byteString)};if(s instanceof Yo){const i=r.databaseId,a=s.firestore._databaseId;if(!a.isEqual(i))throw r.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:mj(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof hN)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return XC(o.serializer,l)})}}}}}}(s,r);throw r.Bu(`Unsupported field value: ${$1(s)}`)}(n,e)}function FOe(n,e){const t={};return GU(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):uy(n,(s,r)=>{const i=fN(r,e.Mu(s));i!=null&&(t[s]=i)}),{mapValue:{fields:t}}}function zj(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof $s||n instanceof uN||n instanceof Hd||n instanceof Yo||n instanceof Vj||n instanceof hN)}function LOe(n,e,t){if(!zj(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){const s=$1(t);throw s==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+s)}}const POe=new RegExp("[~\\*/\\[\\]]");function MOe(n,e,t){if(e.search(POe)>=0)throw r_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Mj(...e.split("."))._internalPath}catch{throw r_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function r_(n,e,t,s,r){const i=s&&!s.isEmpty(),a=r!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${s}`),a&&(l+=` in document ${r}`),l+=")"),new Ke(Fe.INVALID_ARGUMENT,o+n+l)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Yo(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new VOe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(C1("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class VOe extends Uj{data(){return super.data()}}function C1(n,e){return typeof e=="string"?MOe(n,e):e instanceof Mj?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BOe(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ke(Fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class pN{}class mN extends pN{}function zOe(n,e,...t){let s=[];e instanceof pN&&s.push(e),s=s.concat(t),function(i){const a=i.filter(l=>l instanceof gN).length,o=i.filter(l=>l instanceof N1).length;if(a>1||a>0&&o>0)throw new Ke(Fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)n=r._apply(n);return n}class N1 extends mN{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new N1(e,t,s)}_apply(e){const t=this._parse(e);return jj(e._query,t),new $c(e.firestore,e.converter,qE(e._query,t))}_parse(e){const t=DOe(e.firestore);return function(i,a,o,l,u,d,f){let m;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Ke(Fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){yF(f,d);const y=[];for(const b of f)y.push(gF(l,i,b));m={arrayValue:{values:y}}}else m=gF(l,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||yF(f,d),m=OOe(o,a,f,d==="in"||d==="not-in");return Yn.create(u,d,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function UOe(n,e,t){const s=e,r=C1("where",n);return N1._create(r,s,t)}class gN extends pN{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new gN(e,t)}_parse(e){const t=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return t.length===1?t[0]:Ji.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let a=r;const o=i.getFlattenedFilters();for(const l of o)jj(a,l),a=qE(a,l)}(e._query,t),new $c(e.firestore,e.converter,qE(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class yN extends mN{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new yN(e,t)}_apply(e){const t=function(r,i,a){if(r.startAt!==null)throw new Ke(Fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Ke(Fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Om(i,a)}(e._query,this._field,this._direction);return new $c(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new wf(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function jOe(n,e="asc"){const t=e,s=C1("orderBy",n);return yN._create(s,t)}class bN extends mN{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new bN(e,t,s)}_apply(e){return new $c(e.firestore,e.converter,wx(e._query,this._limit,this._limitType))}}function WOe(n){return bN._create("limit",n,"F")}function gF(n,e,t){if(typeof(t=Xr(t))=="string"){if(t==="")throw new Ke(Fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ej(e)&&t.indexOf("/")!==-1)throw new Ke(Fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(In.fromString(t));if(!st.isDocumentKey(s))throw new Ke(Fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return MO(n,new st(s))}if(t instanceof Yo)return MO(n,t._key);throw new Ke(Fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${$1(t)}.`)}function yF(n,e){if(!Array.isArray(n)||n.length===0)throw new Ke(Fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jj(n,e){const t=function(r,i){for(const a of r)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ke(Fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ke(Fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class GOe{convertValue(e,t="none"){switch(Yu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return zn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Xu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ut()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return uy(e,(r,i)=>{s[r]=this.convertValue(i,t)}),s}convertVectorValue(e){var t,s,r;const i=(r=(s=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||s===void 0?void 0:s.values)===null||r===void 0?void 0:r.map(a=>zn(a.doubleValue));return new hN(i)}convertGeoPoint(e){return new uN(zn(e.latitude),zn(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=GC(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Am(e));default:return null}}convertTimestamp(e){const t=uc(e);return new $s(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=In.fromString(e);On(wj(s));const r=new Rm(s.get(1),s.get(3)),i=new st(s.popFirst(5));return r.isEqual(t)||jo(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class HOe extends Uj{constructor(e,t,s,r,i,a){super(e,t,s,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new E0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(C1("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}}class E0 extends HOe{data(e={}){return super.data(e)}}class qOe{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Jb(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new E0(this._firestore,this._userDataWriter,s.key,s,new Jb(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ke(Fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(o=>{const l=new E0(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Jb(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const l=new E0(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Jb(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,d=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),d=a.indexOf(o.doc.key)),{type:KOe(o.type),doc:l,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function KOe(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ut()}}class XOe extends GOe{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hd(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yo(this.firestore,null,t)}}function YOe(n){n=s_(n,$c);const e=s_(n.firestore,Pj),t=NOe(e),s=new XOe(e);return BOe(n._query),EOe(t,n._query).then(r=>new qOe(e,s,n,r))}(function(e,t=!0){(function(r){vf=r})(Qd),Ed(new _u("firestore",(s,{instanceIdentifier:r,options:i})=>{const a=s.getProvider("app").getImmediate(),o=new Pj(new rRe(s.getProvider("auth-internal")),new lRe(s.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Ke(Fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rm(u.options.projectId,d)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Xl(DO,"4.7.3",e),Xl(DO,"4.7.3","esm2017")})();const bF=(n,e,t,s)=>{const r=y=>y*Math.PI/180;if(console.log(`Calculating distance between: (${n},${e}) and (${t},${s})`),!n||!e||!t||!s||isNaN(parseFloat(n))||isNaN(parseFloat(e))||isNaN(parseFloat(t))||isNaN(parseFloat(s))){console.error("Invalid coordinates provided for distance calculation");return}const i=3958.8,a=r(n),o=r(t),l=r(t-n),u=r(s-e),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(o)*Math.sin(u/2)*Math.sin(u/2),f=2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),m=i*f;return console.log(`Calculated distance: ${m.toFixed(2)} miles`),m},xF={apiKey:"AIzaSyBTjR9cgbaO90SR-Dy2k2UTDCh0i-Kpx_Y",authDomain:"hes-bach.firebaseapp.com",projectId:"hes-bach",storageBucket:"hes-bach.appspot.com",messagingSenderId:"648794465181",appId:"1:648794465181:web:6f2336924af1f019f5c574"};let e0,i_,QOe;if(!e0)try{e0=b_(xF),i_=COe(e0),QOe=CL(e0),console.log("Firebase initialized with project:",xF.projectId)}catch(n){console.error("Error initializing Firebase:",n)}const ZOe=async n=>{try{console.log("Geocoding facility address:",n);const e=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(n)}&limit=1`);if(!e.ok)throw new Error("Geocoding failed");const t=await e.json();if(t&&t.length>0)return{lat:parseFloat(t[0].lat),lng:parseFloat(t[0].lon)};throw new Error("Location not found")}catch(e){return console.error("Geocoding error for facility:",e),null}},JOe=async(n,e)=>{try{if(console.log("Searching facilities with keywords:",n),console.log("User location:",e),!i_)return console.error("Firebase database not initialized"),[];const t=$Oe(i_,"facilities"),s=zOe(t,UOe("specialties","array-contains-any",n),jOe("rating","desc"),WOe(10)),i=(await YOe(s)).docs.map(a=>({id:a.id,...a.data()}));if(e&&e.lat&&e.lng){const a=e.lat,o=e.lng,l=[];for(const u of i)if(u.coords&&u.coords.lat&&u.coords.lng){const d=bF(a,o,u.coords.lat,u.coords.lng);l.push({...u,distance:d})}else if(u.address)try{await new Promise(f=>setTimeout(f,300));const d=await ZOe(u.address);if(d){const f=bF(a,o,d.lat,d.lng);l.push({...u,distance:f,coords:d})}else l.push(u)}catch(d){console.error("Error geocoding facility address:",d),l.push(u)}else l.push(u);return l}return i}catch(t){return console.error("Error fetching medical facilities:",t),[]}};function eFe({setSearchResults:n,location:e,setSearchStatus:t,setError:s}){const[r,i]=we.useState(""),a=async o=>{if(o.preventDefault(),!r.trim()){s("Please describe your symptoms");return}if(!e){s("Please enable location or enter your location manually");return}t("analyzing"),s(null);try{const l=await tRe(r);t("searching");const u=await JOe(l,e);u.length===0&&s("No medical facilities found matching your criteria. Try different symptoms or location."),n(u),t("complete")}catch(l){console.error("Search error:",l),s("Sorry, we couldn't complete your search. Please try again."),t("idle")}};return I.jsx("form",{className:"search-container",onSubmit:a,children:I.jsxs("div",{className:"glass-effect",children:[I.jsx("input",{type:"text",placeholder:"Describe your symptoms concisely and clearly (e.g. broken leg)",value:r,onChange:o=>i(o.target.value),className:"search-input"}),I.jsx("button",{type:"submit",className:"search-button",children:"Search"})]})})}const tFe=n=>{if(n==="Open 24/7")return!0;const e=new Date,t=e.toLocaleDateString("en-US",{weekday:"long"}),s=e.getHours(),r=e.getMinutes();if(typeof n!="object")return!1;const i=n[t];if(!i||i==="Closed")return!1;const a=i.match(/(\d+)(?::(\d+))?\s*([ap]m)\s*-\s*(\d+)(?::(\d+))?\s*([ap]m)/i);if(!a)return!1;let o=parseInt(a[1]);const l=a[2]?parseInt(a[2]):0,u=a[3].toLowerCase();let d=parseInt(a[4]);const f=a[5]?parseInt(a[5]):0,m=a[6].toLowerCase();u==="pm"&&o<12&&(o+=12),u==="am"&&o===12&&(o=0),m==="pm"&&d<12&&(d+=12),m==="am"&&d===12&&(d=0);const y=s*60+r,b=o*60+l,w=d*60+f;return y>=b&&y<=w};function nFe({facility:n}){const{name:e,address:t,phoneNumber:s,specialties:r,rating:i,distance:a,hours:o}=n,l=tFe(o);return I.jsxs("div",{className:"result-card",children:[I.jsx("div",{className:`severity-indicator severity-${n.severity||5}`,children:n.severity===1?"Emergency":n.severity===2?"Urgent":n.severity===3?"Standard":n.severity===4?"Routine":"General"}),I.jsx("div",{className:"facility-header",children:I.jsx("h3",{children:e})}),I.jsxs("div",{className:"rating-block",children:[I.jsx("span",{className:"stars",children:"★".repeat(Math.round(i))}),I.jsx("span",{className:"rating-value",children:i.toFixed(1)})]}),I.jsxs("div",{className:"facility-details",children:[I.jsx(sFe,{address:t}),I.jsx("p",{className:"phone",children:s}),a!==void 0?I.jsxs("p",{className:"distance",children:[a.toFixed(1)," miles away"]}):I.jsx("p",{className:"distance no-distance",children:"Distance unavailable"}),I.jsx("div",{className:"status",children:l?I.jsx("span",{className:"open",children:"Open Now"}):I.jsx("span",{className:"closed",children:"Closed"})}),I.jsx("div",{className:"hours-info",children:typeof o=="string"?I.jsx("p",{children:o}):I.jsxs("details",{children:[I.jsx("summary",{children:"Hours"}),I.jsx("ul",{className:"hours-list",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(u=>I.jsxs("li",{children:[I.jsxs("span",{className:"day",children:[u,":"]})," ",o[u]||"Closed"]},u))})]})})]}),I.jsx("div",{className:"specialties",children:r.map((u,d)=>I.jsx("span",{className:"specialty-tag",children:u},d))}),I.jsxs("div",{className:"action-buttons",children:[I.jsx("a",{href:`https://maps.google.com/?q=${encodeURIComponent(t)}`,target:"_blank",rel:"noopener noreferrer",className:"directions-btn",children:"Get Directions"}),I.jsx("a",{href:`tel:${s.replace(/[^0-9]/g,"")}`,className:"call-btn",children:"Call"})]})]})}function sFe({address:n}){const[e,t]=Hl.useState(!1);return I.jsxs("details",{className:"address-details",open:e,onToggle:s=>t(s.target.open),children:[I.jsx("summary",{className:"address-summary",children:"Address"}),I.jsx("div",{className:"address-content",children:n})]})}function rFe({sortOption:n,setSortOption:e}){return I.jsxs("div",{className:"sort-options",children:[I.jsx("span",{children:"Sort by:"}),I.jsxs("div",{className:"sort-buttons",children:[I.jsx("button",{className:n==="severity-desc"?"active":"",onClick:()=>e("severity-desc"),children:"Most Severe First"}),I.jsx("button",{className:n==="severity-asc"?"active":"",onClick:()=>e("severity-asc"),children:"Mildest First"}),I.jsx("button",{className:n==="rating-desc"?"active":"",onClick:()=>e("rating-desc"),children:"Highest Rated"}),I.jsx("button",{className:n==="distance-asc"?"active":"",onClick:()=>e("distance-asc"),children:"Closest First"})]})]})}var Wj={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},vF=Hl.createContext&&Hl.createContext(Wj),iFe=["attr","size","title"];function aFe(n,e){if(n==null)return{};var t=oFe(n,e),s,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(r=0;r<i.length;r++)s=i[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(n,s)&&(t[s]=n[s])}return t}function oFe(n,e){if(n==null)return{};var t={};for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){if(e.indexOf(s)>=0)continue;t[s]=n[s]}return t}function _x(){return _x=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},_x.apply(this,arguments)}function wF(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,s)}return t}function Ix(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wF(Object(t),!0).forEach(function(s){lFe(n,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):wF(Object(t)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(t,s))})}return n}function lFe(n,e,t){return e=cFe(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cFe(n){var e=uFe(n,"string");return typeof e=="symbol"?e:e+""}function uFe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Gj(n){return n&&n.map((e,t)=>Hl.createElement(e.tag,Ix({key:t},e.attr),Gj(e.child)))}function hFe(n){return e=>Hl.createElement(dFe,_x({attr:Ix({},n.attr)},e),Gj(n.child))}function dFe(n){var e=t=>{var{attr:s,size:r,title:i}=n,a=aFe(n,iFe),o=r||t.size||"1em",l;return t.className&&(l=t.className),n.className&&(l=(l?l+" ":"")+n.className),Hl.createElement("svg",_x({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,a,{className:l,style:Ix(Ix({color:n.color||t.color},t.style),n.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),i&&Hl.createElement("title",null,i),n.children)};return vF!==void 0?Hl.createElement(vF.Consumer,null,t=>e(t)):e(Wj)}function Hj(n){return hFe({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(n)}function fFe({results:n}){const[e,t]=we.useState("distance-asc"),[s,r]=we.useState([]),[i,a]=we.useState(3.2);we.useEffect(()=>{if(!n||n.length===0){r([]);return}let u=[...n];switch(u=u.filter(d=>d.distance===void 0?!1:d.distance<=i),e){case"severity-asc":u.sort((d,f)=>(f.severity||5)-(d.severity||5));break;case"severity-desc":u.sort((d,f)=>(d.severity||5)-(f.severity||5));break;case"rating-desc":u.sort((d,f)=>(f.rating||0)-(d.rating||0));break;case"distance-asc":u.sort((d,f)=>d.distance===void 0&&f.distance===void 0?(f.rating||0)-(d.rating||0):d.distance===void 0?1:f.distance===void 0?-1:d.distance-f.distance);break;default:u.sort((d,f)=>(d.severity||5)-(f.severity||5))}r(u)},[n,e,i]);const o=u=>{a(parseFloat(u.target.value))},l=n&&n.length>0?n.length-s.length:0;return!n||n.length===0?null:I.jsxs("div",{className:"results-container",children:[I.jsx("h2",{children:"Medical Facilities Near You"}),I.jsxs("div",{className:"distance-filter",children:[I.jsxs("div",{className:"filter-header",children:[I.jsx(Hj,{className:"filter-icon"}),I.jsx("h3",{children:"Distance Filter"})]}),I.jsxs("label",{htmlFor:"radius-slider",className:"radius-label",children:["Showing facilities within ",I.jsx("span",{className:"radius-value",children:i.toFixed(1)})," miles"]}),I.jsxs("div",{className:"slider-container",children:[I.jsx("span",{className:"range-value",children:"0.5"}),I.jsx("input",{id:"radius-slider",type:"range",min:"0.5",max:"5",step:"0.1",value:i,onChange:o,className:"radius-slider"}),I.jsx("span",{className:"range-value",children:"5.0"})]}),I.jsxs("div",{className:"radius-info",children:[I.jsx("strong",{children:s.length})," facilities found",l>0&&I.jsxs("span",{className:"filtered-out-info",children:["(",l," more available beyond this range)"]})]})]}),I.jsx(rFe,{sortOption:e,setSortOption:t}),I.jsx("div",{className:"results-grid",children:s.length>0?s.map(u=>I.jsx(nFe,{facility:u},u.id)):I.jsxs("div",{className:"no-results-message",children:["No facilities found within ",i.toFixed(1)," miles. Try increasing your search radius."]})})]})}function pFe({setLocation:n}){const[e,t]=we.useState(""),[s,r]=we.useState(""),[i,a]=we.useState(!0),[o,l]=we.useState(!1),[u,d]=we.useState(null),f=()=>{d(null),navigator.geolocation?navigator.geolocation.getCurrentPosition(T=>{n({lat:T.coords.latitude,lng:T.coords.longitude,description:"Current Location"}),l(!0),a(!1)},T=>{m(T)},{enableHighAccuracy:!1,timeout:1e4,maximumAge:3e5}):d("Geolocation is not supported by your browser")},m=T=>{console.error("Error getting current location:",T);let E;switch(T.code){case T.PERMISSION_DENIED:E="Location access was denied. Please enable location services or enter your location manually.";break;case T.POSITION_UNAVAILABLE:E="Location information is unavailable. Please try again or enter your location manually.";break;case T.TIMEOUT:E="Location request timed out. Please try again or enter your location manually.";break;default:E="An unknown error occurred. Please enter your location manually."}d(E),l(!1),a(!0)},y=async T=>{try{const E=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(T)}&limit=1`);if(!E.ok)throw new Error("Geocoding failed");const $=await E.json();if($&&$.length>0)return{lat:parseFloat($[0].lat),lng:parseFloat($[0].lon),description:T};throw new Error("Location not found")}catch(E){throw console.error("Geocoding error:",E),E}},b=async T=>{if(T.preventDefault(),e.trim()){d(null);try{const E=await y(e);n(E),r(e),l(!1),a(!1)}catch{d("Couldn't find that location. Please try a different address.")}}},w=()=>{a(!0)},x=()=>{f()};return I.jsxs("div",{className:"location-container",children:[u&&I.jsx("div",{className:"location-error",children:u}),i?I.jsx("div",{className:"search-container location-search-container",children:I.jsxs("form",{onSubmit:b,children:[I.jsxs("div",{className:"glass-effect",children:[I.jsx(Hj,{className:"location-icon"}),I.jsx("input",{type:"text",placeholder:"Enter your location",value:e,onChange:T=>t(T.target.value),className:"search-input"}),I.jsx("button",{type:"submit",className:"search-button",children:"Set"})]}),I.jsx("div",{className:"location-options",children:I.jsx("button",{type:"button",className:"current-location-btn",onClick:x,children:"Use Current Location"})})]})}):I.jsxs("div",{className:"current-location",children:[I.jsx("span",{children:o?"Using your current location":`Using location: ${s}`}),I.jsx("button",{className:"change-location-btn",onClick:w,children:"Change"})]})]})}function mFe(){return I.jsxs("div",{className:"header",children:[I.jsx("h1",{children:"Health Finder"}),I.jsx("p",{children:"Find the right medical care near you"})]})}const gFe=()=>{const[n,e]=we.useState([]),[t,s]=we.useState(null),[r,i]=we.useState("idle"),[a,o]=we.useState(null),l=()=>{switch(r){case"analyzing":return"Analyzing your symptoms...";case"searching":return"Finding suitable medical facilities near you...";default:return"Searching for medical facilities..."}};return I.jsxs("div",{className:"search-engine-page",children:[I.jsx(kL,{}),I.jsxs("div",{className:"app-container",children:[I.jsx(mFe,{}),I.jsxs("div",{className:"search-section",children:[I.jsx(eFe,{setSearchResults:e,location:t,setSearchStatus:i,setError:o}),I.jsx(pFe,{setLocation:s})]}),a&&I.jsx("div",{className:"error-message",children:a}),r!=="idle"&&r!=="complete"?I.jsxs("div",{className:"loading",children:[I.jsx("div",{className:"spinner"}),I.jsx("p",{children:l()})]}):I.jsx(fFe,{results:n})]})]})},yFe="/assets/earlhamCollege-logo-KzcxQq-d.png",bFe="/assets/feedback-C4zhWRvF.png",xFe=()=>I.jsxs("section",{id:"how-it-works",className:"subcategory-section",children:[I.jsxs("div",{className:"side-menu-bar",children:[I.jsx("h1",{children:"MENU"}),I.jsxs("ul",{className:"side-menu-list",children:[I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/when-and-where",className:"btn",children:" WHEN to go "})}),I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/coming-soon",className:"btn",children:"Insurance General"})}),I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/coming-soon",className:"btn",children:" Earlham Insurance"})}),I.jsx("li",{className:"side-menu-item side-menu-item-last",children:I.jsx("a",{href:"/coming-soon",className:"btn",children:"Tell Us What You Want To Learn!!"})})]})]}),I.jsx("h2",{children:"Learn about how HES works."}),I.jsxs("p",{className:"page-abstract",children:["Understanding the ",I.jsx("a",{href:"/coming-soon",className:"btn",children:"WHAT"}),"(what’s going on with my health?), ",I.jsx("a",{href:"/coming-soon",className:"btn",children:"WHEN"})," (when is it necessary to seek medical help?), ",I.jsx("a",{href:"/coming-soon",className:"btn",children:"WHERE"})," (where is the best place to go for care?), and ",I.jsx("a",{href:"/coming-soon",className:"btn",children:"HOW"})," (how can I access the care I need?) when dealing with an acute illness or injury can help you get timely treatment, avoid confusion in the healthcare system, and prevent unnecessary costs during your college years."]}),I.jsxs("div",{className:"category-container",children:[I.jsxs("div",{className:"service-card",children:[I.jsx("img",{src:AL,alt:"Step One"}),I.jsx("h3",{children:"Understand when to go to where"}),I.jsx("p",{children:"Not sure what to do when you’re feeling off? We’ll help you figure out when to wait, when to visit health services, and when to head to urgent care or the ER—so you can feel confident in your next step."}),I.jsx("a",{href:"/when-and-where",className:"btn",children:"Read more"})]}),I.jsxs("div",{className:"service-card",children:[I.jsx("img",{src:RL,alt:"Step Two"}),I.jsx("h3",{children:"Insurance General"}),I.jsx("p",{children:"Confused by health insurance? You’re not alone. We’ll break it down simply so you can understand how it works, why it matters, and how it protects you."}),I.jsx("a",{href:"/insurance-general",className:"btn",children:"Read more"})]}),I.jsxs("div",{className:"service-card",children:[I.jsx("img",{src:yFe,alt:"Step Three"}),I.jsx("h3",{children:"Earlham Insurance"}),I.jsx("p",{children:"Wondering what’s actually covered by your Earlham insurance? We’ve got the answers—so you can make the most of your plan without the guesswork."}),I.jsx("a",{href:"/earlham-insurance",className:"btn",children:"Read more"})]}),I.jsxs("div",{className:"service-card",children:[I.jsx("img",{src:bFe,alt:"Step Three"}),I.jsx("h3",{children:"Tell Us What You Want to Learn"}),I.jsx("p",{children:"If there’s something else you’re curious about, just let us know—we value your feedback and want to make this guide as helpful as possible for you."}),I.jsx("a",{href:"/coming-soon",className:"btn",children:"Read more"})]})]})]}),vFe=()=>I.jsxs("section",{id:"when-and-where",children:[I.jsxs("div",{className:"side-menu-bar",children:[I.jsx("h1",{children:"MENU"}),I.jsxs("ul",{className:"side-menu-list",children:[I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/when-and-where",className:"btn",children:" WHEN to go WHERE "})}),I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/insurance-general",className:"btn",children:"Insurance General"})}),I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/earlham-insurance",className:"btn",children:" Earlham Insurance"})}),I.jsx("li",{className:"side-menu-item side-menu-item-last",children:I.jsx("a",{href:"/coming-soon",className:"btn",children:"Tell Us What You Want To Learn!!"})})]})]}),I.jsxs("div",{className:"main-part",children:[I.jsx("hr",{className:"divide-line"}),I.jsx("h1",{children:"Pick Your Situation"}),I.jsx("div",{className:"three-caregory-menu",children:I.jsxs("ul",{className:"three-menu",children:[I.jsx("li",{children:I.jsx("a",{href:"#non-urgent",className:"btn",children:"Non-Urgent Symptoms "})}),I.jsx("li",{children:I.jsx("a",{href:"#urgent",className:"btn",children:"Urgent (but not life-threatening) Symptoms "})}),I.jsx("li",{children:I.jsx("a",{href:"#life-threatening",className:"btn",children:"Life-Threatening Symptoms "})})]})}),I.jsx("hr",{class:"divide-line"}),I.jsxs("div",{className:"body-part",children:[I.jsxs("div",{id:"non-urgent",className:"non-urgent",children:[I.jsx("h1",{children:"1. Non-Urgent Symptoms"}),I.jsxs("div",{className:"non-urgent-symptoms",children:[I.jsx("h2",{children:"Example of non-urgent Symptoms:"}),I.jsxs("ul",{children:[I.jsx("li",{children:"Runny nose"}),I.jsx("li",{children:"Mild cough"}),I.jsx("li",{children:"Sore throat"}),I.jsx("li",{children:"Mild fever "}),I.jsx("li",{children:"Mild allergies"}),I.jsx("li",{children:"Mild headaches"}),I.jsx("li",{children:"Minor cuts, scrapes, or bruises"}),I.jsx("li",{children:"Minor sprains"})]})]}),I.jsxs("div",{className:"non-urgent-what-to-do",children:[I.jsx("h2",{children:"What to do:"}),I.jsxs("ul",{children:[I.jsx("li",{children:"If symptoms are mild and not disrupting daily life, consider waiting 1–2 days to see if they improve."}),I.jsx("li",{children:"Many non-urgent issues can be managed at home or by visiting Earlham Health Services."}),I.jsx("li",{children:"Self-care: Hydration (~3 L or 100 oz of water), nutritious meals, ~8 hours of sleep, and over-the-counter medications."})]})]}),I.jsxs("div",{className:"non-urgent-reminder",children:[I.jsx("h2",{children:"Reminder:"}),I.jsxs("p",{children:["Reevaluate symptoms frequently to catch worsening conditions.",I.jsx("span",{children:" When in doubt, see a doctor."})]})]})]}),I.jsxs("div",{id:"urgent",className:"urgent",children:[I.jsx("h1",{children:"2. Urgent (but not life-threatening) Symptoms"}),I.jsxs("div",{className:"urgent-symptoms",children:[I.jsx("h2",{children:"Examples of urgent symptoms:"}),I.jsxs("ul",{children:[I.jsx("li",{children:"High fever (Over 102°F / 39°C)"}),I.jsx("li",{children:"Persistent cough or wheezing"}),I.jsx("li",{children:"Persistent vomiting"}),I.jsx("li",{children:"Persistent diarrhea "}),I.jsx("li",{children:"Urinary Tract Infection (UTI)"}),I.jsx("li",{children:"Deep cut (bleeding for over 10 minutes)"}),I.jsx("li",{children:"Possible broken bones"}),I.jsx("li",{children:"Sprain with large swelling"}),I.jsx("li",{children:"Prolonged dizziness"}),I.jsx("li",{children:"Confusion"})]})]}),I.jsxs("div",{className:"urgent-what-to-do",children:[I.jsx("h2",{children:"What to do:"}),I.jsxs("ul",{children:[I.jsx("li",{children:"Assess the severity and seek care as needed."}),I.jsx("li",{children:"Urgent care clinics: Handle moderate injuries/infections (usually cheaper than ER)."}),I.jsx("li",{children:"Primary care doctors: Manage worsening but stable conditions."}),I.jsx("li",{children:"Manage symptoms with over-the-counter medication, hydration, rest, and basic first aid until medical help is available."})]})]}),I.jsxs("div",{className:"urgent-important",children:[I.jsx("h2",{children:"Important:"}),I.jsxs("p",{children:["If you experience symptoms like ",I.jsx("span",{children:"difficulty breathing, uncontrolled bleeding, "}),"or ",I.jsx("span",{children:"sudden weakness, go to the ER"}),"."]})]})]}),I.jsxs("div",{id:"life-threatening",className:"life-threatening",children:[I.jsx("h1",{children:"3. Life-Threatening Symptoms"}),I.jsxs("div",{className:"life-threatening-what-to-do",children:[I.jsx("h2",{children:"What to do:"}),I.jsx("p",{children:"Call 911 or go to the nearest emergency room immediately."})]}),I.jsxs("div",{className:"life-threatening-symptoms",children:[I.jsx("h2",{children:"Examples of life-threatening symptoms:"}),I.jsxs("ul",{children:[I.jsx("li",{children:"Not breathing or gasping for air"}),I.jsx("li",{children:"Losing consciousness"}),I.jsx("li",{children:"Head or spine injuries"}),I.jsx("li",{children:"Severe burns "}),I.jsx("li",{children:"Seizures"}),I.jsx("li",{children:"Irregular heartbeat"}),I.jsx("li",{children:"Ingesting poisonous substances"}),I.jsx("li",{children:"Severe allergic reactions"}),I.jsx("li",{children:"Uncontrollable bleeding"})]})]}),I.jsxs("div",{className:"life-threatening-important",children:[I.jsx("h2",{children:"Important:"}),I.jsx("p",{children:"DO NOT HESITATE TO CALL 911"})]})]})]})]})]}),wFe=()=>I.jsxs("section",{id:"insurance-general",children:[I.jsxs("div",{className:"side-menu-bar",children:[I.jsx("h1",{children:"MENU"}),I.jsxs("ul",{className:"side-menu-list",children:[I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/when-and-where",className:"btn",children:" WHEN to go "})}),I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/insurance-general",className:"btn",children:"Insurance General"})}),I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/earlham-insurance",className:"btn",children:" Earlham Insurance"})}),I.jsx("li",{className:"side-menu-item side-menu-item-last",children:I.jsx("a",{href:"/coming-soon",className:"btn",children:"Tell Us What You Want To Learn!!"})})]})]}),I.jsxs("div",{className:"main-part",children:[I.jsx("h1",{children:"HES Educational Services: Mastering U.S. Health Insurance"}),I.jsxs("ol",{children:[I.jsxs("li",{className:"section-number",children:[I.jsx("h3",{children:"What Is Health Insurance and Why Does It Matter?"}),I.jsx("p",{children:"Health insurance is a safety net that helps pay for your medical care. Without it, even a simple doctor's visit or emergency room visit can cost hundreds or thousands of dollars. Think of it like this: You pay a little every month (premium) to avoid paying a LOT if something happens."}),I.jsxs("ul",{className:"common-college-scenarios",children:[I.jsxs("li",{children:["You catch the flu and need meds - ",I.jsx("span",{children:"Covered"})]}),I.jsxs("li",{children:["You sprain your ankle during practice - ",I.jsx("span",{children:"Covered"})]}),I.jsxs("li",{children:["You need mental health counseling - ",I.jsx("span",{children:" Often covered"})]}),I.jsxs("li",{children:["You go to the ER for food poisoning - ",I.jsx("span",{children:"Covered, but $$$ if not in-network"})]})]})]}),I.jsxs("li",{className:"section-number",children:[I.jsx("h3",{children:"Key Health Insurance Terms"}),I.jsxs("table",{children:[I.jsx("thead",{children:I.jsxs("tr",{children:[I.jsx("td",{}),I.jsx("th",{scope:"col",children:" "})]})}),I.jsxs("tbody",{children:[I.jsxs("tr",{children:[I.jsx("th",{children:"Premium"}),I.jsx("td",{"data-label":"content",class:"txt",children:I.jsx("span",{children:"Monthly payment to have insurance"})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Deductible"}),I.jsx("td",{"data-label":"content",class:"txt",children:"What you must pay before insurance kicks in"})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Co-pay"}),I.jsx("td",{"data-label":"content",class:"txt",children:"Flat fee for a service"})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Co-insurance"}),I.jsx("td",{"data-label":"content",class:"txt",children:"Percentage you pay after the deductible"})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Out-of-pocket maximum"}),I.jsx("td",{"data-label":"content",class:"txt",children:"The most you'll ever pay in a year"})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"In-network provider"}),I.jsx("td",{"data-label":"content",class:"txt",children:"Doctor/hospital that works with your insurance"})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Out-of-network provider"}),I.jsx("td",{"data-label":"content",class:"txt",children:"Doctor/hospital that is not covered by your insurance"})]})]})]}),I.jsx("p",{children:'Pro Tip: Always make sure to know which doctors are "in-network" to avoid expensive bills'})]}),I.jsxs("li",{className:"section-number",children:[I.jsx("h3",{children:"How to Actually Use Your Insurance"}),I.jsx("h4",{children:"Step-by-step:"}),I.jsxs("ol",{children:[I.jsxs("li",{children:["Know what insurance plan you have.",I.jsxs("ul",{children:[I.jsx("li",{children:"Check your insurance provider's welcome materials or log into your insurance portal"}),I.jsx("li",{children:"Save a digital or physical copy of your insurance card."})]})]}),I.jsxs("li",{children:["Find care.",I.jsxs("ul",{children:[I.jsx("li",{children:"Start at your campus health center if you're unsure."}),I.jsx("li",{children:"Use your insurer's website to find in-network providers."})]})]}),I.jsxs("li",{children:["Bring your card to the appointment",I.jsx("ul",{children:I.jsx("li",{children:"This allows the provider to bill your insurance."})})]}),I.jsxs("li",{children:["Pay co-pays if required.",I.jsx("ul",{children:I.jsx("li",{children:"Some insurance plans waive co-pays at student clinics-check your plan."})})]}),I.jsxs("li",{children:["Keep all receipts and paperwork.",I.jsx("ul",{children:I.jsx("li",{children:"Especially important if you pay out of pocket (e.g., for international plans or out-of-network care)."})})]})]}),I.jsx("p",{children:"Avoid surprise costs by understanding key benefits and limitations."})]}),I.jsxs("li",{className:"section-number",children:[I.jsx("h3",{children:"Do I Need a Referral?"}),I.jsx("p",{children:"It depends on your insurance plan."}),I.jsxs("ul",{children:[I.jsx("li",{children:"Some plans, like HMOs, require a referral from your primary care provider before you can see a specialist."}),I.jsx("li",{children:"Others, like PPOs, often do not require a referral."})]}),I.jsxs("p",{children:["Check your plan details or call the customer service number on your insurance card to be sure.",I.jsx("br",{}),"If you're on a school-provided plan (like Earlham's), see the dedicated guide for that plan."]})]}),I.jsxs("li",{className:"section-number",children:[I.jsx("h3",{children:"Know Where to Go - Based on Urgency."}),I.jsxs("table",{children:[I.jsx("thead",{children:I.jsxs("tr",{children:[I.jsx("td",{}),I.jsx("th",{scope:"col",children:" "})]})}),I.jsxs("tbody",{children:[I.jsxs("tr",{children:[I.jsxs("th",{children:["Minor  ",I.jsx("br",{}),"(cold, allergies)"]}),I.jsx("td",{"data-label":"content",class:"txt",children:I.jsx("span",{children:"Campus Health / Athletic Trainer"})}),I.jsx("td",{"data-label":"cost",class:"txt",children:I.jsx("span",{children:"Free / $"})})]}),I.jsxs("tr",{children:[I.jsxs("th",{children:["Moderate ",I.jsx("br",{}),"(fever, infection)"]}),I.jsx("td",{"data-label":"content",class:"txt",children:I.jsx("span",{children:"Urgent Care"})}),I.jsx("td",{"data-label":"cost",class:"txt",children:I.jsx("span",{children:"$$"})})]}),I.jsxs("tr",{children:[I.jsxs("th",{children:["Serious ",I.jsx("br",{}),"(severe illness, major injury)"]}),I.jsx("td",{"data-label":"content",class:"txt",children:I.jsx("span",{children:"Emergency Room"})}),I.jsx("td",{"data-label":"cost",class:"txt",children:I.jsx("span",{children:"$$$"})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Mental Health"}),I.jsx("td",{"data-label":"content",class:"txt",children:I.jsx("span",{children:"Campus Counseling or In-network therapist"})}),I.jsx("td",{"data-label":"cost",class:"txt",children:I.jsx("span",{children:"Often 20% of visit cost"})})]})]})]})]})]})]})]}),SFe=()=>I.jsxs("section",{id:"earlham-insurance",children:[I.jsxs("div",{className:"side-menu-bar",children:[I.jsx("h1",{children:"MENU"}),I.jsxs("ul",{className:"side-menu-list",children:[I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/when-and-where",className:"btn",children:" WHEN to go "})}),I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/insurance-general",className:"btn",children:"Insurance General"})}),I.jsx("li",{className:"side-menu-item",children:I.jsx("a",{href:"/earlham-insurance",className:"btn",children:" Earlham Insurance"})}),I.jsx("li",{className:"side-menu-item side-menu-item-last",children:I.jsx("a",{href:"/coming-soon",className:"btn",children:"Tell Us What You Want To Learn!!"})})]})]}),I.jsxs("div",{className:"main-part",children:[I.jsx("h1",{children:"Earlham-Aetna Student Health Insurance Guide"}),I.jsxs("div",{className:"get-insurance-id",children:[I.jsx("h2",{children:"Use your plan with confidence during the 2024-2025 school year."}),I.jsxs("h3",{children:["Coverage period: ",I.jsx("span",{children:"August 1, 2024 - July 31, 2025"}),I.jsx("br",{}),"Plan type: PPO (Preferred Provider Organization) ",I.jsx("br",{}),I.jsxs("span",{children:["View or download your insurance ID card:",I.jsx("a",{href:"https://www.aetnastudenthealth.com/en/school/686203/members/get-id-card.html",target:"_blank",rel:"noopener noreferrer",children:" Click Here"})]})]})]}),I.jsxs("div",{className:"how-to-use-student-insurance",children:[I.jsx("h2",{children:"How to Use Your Student Health Insurance Plan"}),I.jsxs("ol",{children:[I.jsxs("div",{children:[I.jsxs("li",{children:[I.jsx("h3",{children:"Know what your plan covers."}),I.jsx("p",{children:"Avoid surprise costs by understanding key benefits and limitations."})]}),I.jsxs("li",{children:[I.jsx("h3",{children:"Always bring your insurance card"}),I.jsx("p",{children:"Save a photo and carry a physical copy."})]}),I.jsxs("li",{children:[I.jsx("h3",{children:"Choose in-network care."}),I.jsxs("p",{children:["Click ",I.jsx("a",{href:"http://www.aetna.com/docfind",target:"_blank",rel:"noopener noreferrer",children:" here"})," to search for providers."]})]})]}),I.jsxs("li",{children:[I.jsx("h3",{children:"Understand how claims work."}),I.jsxs("ul",{children:[I.jsx("li",{children:"In-network: the provider bills Aetna directly"}),I.jsx("li",{children:"Out-of-network: you may need to pay upfront and file a claim. Include itemized bills with your name, ID#, and Earlham College."})]})]}),I.jsxs("li",{children:[I.jsx("h3",{children:"Watch for your Explanation of Benefits (EOB)."}),I.jsx("p",{children:"It will show what was paid and whether you owe anything."})]}),I.jsx("li",{children:I.jsx("h3",{children:"Questions? Contact Aetna Student Health or call 1-877-626-2308."})})]})]}),I.jsxs("div",{className:"referral",children:[I.jsx("h2",{children:"Do I Need a Referral?"}),I.jsxs("p",{children:["No referral is needed to see a specialist with the Earlham Aetna plan.",I.jsx("br",{}),"You can schedule appointments directly with dermatologists, therapists, or any specialist without going through your primary care provider."]})]}),I.jsx("h2",{children:"Key Plan Benefits at a Glance (With Examples)"}),I.jsxs("table",{children:[I.jsx("thead",{children:I.jsxs("tr",{children:[I.jsx("th",{scope:"col"}),I.jsx("th",{scope:"col",children:"In-Network"}),I.jsx("th",{scope:"col",children:"Out-of-Network"}),I.jsx("th",{scope:"col",children:"Example"})]})}),I.jsxs("tbody",{children:[I.jsxs("tr",{children:[I.jsx("th",{children:"Annual Deductible"}),I.jsx("td",{"data-label":"content",class:"in-network",children:I.jsx("span",{children:"$300"})}),I.jsx("td",{"data-label":"content",class:"out-network",children:I.jsx("span",{children:"$300"})}),I.jsx("td",{"data-label":"content",class:"example",children:I.jsx("span",{children:"You pay the first $300 for services before coverage begins."})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Out-of-Pocket Max"}),I.jsx("td",{"data-label":"content",class:"in-network",children:I.jsx("span",{children:"$7,900"})}),I.jsx("td",{"data-label":"content",class:"out-network",children:I.jsx("span",{children:"$7,900"})}),I.jsx("td",{"data-label":"content",class:"example",children:I.jsx("span",{children:"After this, Aetna covers all approved services."})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Primary Care Visit"}),I.jsx("td",{"data-label":"content",class:"in-network",children:I.jsx("span",{children:"20% coinsurance"})}),I.jsx("td",{"data-label":"content",class:"out-network",children:I.jsx("span",{children:"40% coinsurance"})}),I.jsx("td",{"data-label":"content",class:"example",children:I.jsx("span",{children:"A $100 visit = $20 in-network, $40 out-of-network."})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Specialist Visit"}),I.jsx("td",{"data-label":"content",class:"in-network",children:I.jsx("span",{children:"20% coinsurance"})}),I.jsx("td",{"data-label":"content",class:"out-network",children:I.jsx("span",{children:"40% coinsurance"})}),I.jsx("td",{"data-label":"content",class:"example",children:I.jsx("span",{children:"Dermatology visit costing $200 = $40 in-network."})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Urgent Care"}),I.jsx("td",{"data-label":"content",class:"in-network",children:I.jsx("span",{children:"20% coinsurance"})}),I.jsx("td",{"data-label":"content",class:"out-network",children:I.jsx("span",{children:"40% coinsurance"})}),I.jsx("td",{"data-label":"content",class:"example",children:I.jsx("span",{children:"Weekend earache visit = $30 in-network for $150 bill."})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Mental Health (Outpatient)"}),I.jsx("td",{"data-label":"content",class:"in-network",children:I.jsx("span",{children:"20% coinsurance"})}),I.jsx("td",{"data-label":"content",class:"out-network",children:I.jsx("span",{children:"40% coinsurance"})}),I.jsx("td",{"data-label":"content",class:"example",children:I.jsx("span",{children:"$150 session = $30 in-network."})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Emergency Room"}),I.jsx("td",{"data-label":"content",class:"in-network",children:I.jsx("span",{children:"20% after $100 copay"})}),I.jsx("td",{"data-label":"content",class:"out-network",children:I.jsx("span",{children:"Same"})}),I.jsx("td",{"data-label":"content",class:"example",children:I.jsx("span",{children:"ER visit with food poisoning = copay + 20%."})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Generic Drugs"}),I.jsx("td",{"data-label":"content",class:"in-network",children:I.jsx("span",{children:"$30 (retail), $90 (mail)"})}),I.jsx("td",{"data-label":"content",class:"out-network",children:I.jsx("span",{children:"Same"})}),I.jsx("td",{"data-label":"content",class:"example",children:I.jsx("span",{children:"Antibiotics cost $30 retail, no deductible."})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Preferred Brand Drugs"}),I.jsx("td",{"data-label":"content",class:"in-network",children:I.jsx("span",{children:"$60 (retail), $180 (mail)"})}),I.jsx("td",{"data-label":"content",class:"out-network",children:I.jsx("span",{children:"Same"})}),I.jsx("td",{"data-label":"content",class:"example",children:I.jsx("span",{children:"Inhaler = $60 at pharmacy."})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Non-Preferred Brand Drugs"}),I.jsx("td",{"data-label":"content",class:"in-network",children:I.jsx("span",{children:"$85 (retail), $255 (mail)"})}),I.jsx("td",{"data-label":"content",class:"out-network",children:I.jsx("span",{children:"Same"})}),I.jsx("td",{"data-label":"content",class:"example",children:I.jsx("span",{children:"Less common medication = $85 retail."})})]})]})]}),I.jsxs("div",{className:"where-to-go",children:[I.jsx("h2",{children:"Where Should You Go?"}),I.jsxs("p",{children:["Knowing where to go saves time and money. ",I.jsx("br",{}),"Here's a quick guide:"]}),I.jsxs("table",{children:[I.jsx("thead",{children:I.jsxs("tr",{children:[I.jsx("th",{scope:"col"}),I.jsx("th",{scope:"col",children:"Out-of-Network"}),I.jsx("th",{scope:"col",children:"Example"})]})}),I.jsxs("tbody",{children:[I.jsxs("tr",{children:[I.jsx("th",{children:"Minor symptoms (cold, allergies)"}),I.jsx("td",{"data-label":"content",class:"where-to-go-column",children:I.jsx("span",{children:"Go to Earlham Health Services or an on-campus athletic trainer"})}),I.jsx("td",{"data-label":"content",class:"cost",children:I.jsx("span",{children:"Free or low cost"})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Moderate symptoms (fever, infection, sprains):"}),I.jsx("td",{"data-label":"content",class:"where-to-go-column",children:I.jsx("span",{children:"Visit an Urgent Care center"})}),I.jsx("td",{"data-label":"content",class:"cost",children:I.jsx("span",{children:"Cost: 20% in-network coinsurance (approx. $20-40)"})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Serious symptoms (major illness or injury):"}),I.jsx("td",{"data-label":"content",class:"where-to-go-column",children:I.jsx("span",{children:"Go to the Emergency Room (ER)."})}),I.jsx("td",{"data-label":"content",class:"cost",children:I.jsx("span",{children:"20% coinsurance after $100 copay"})})]}),I.jsxs("tr",{children:[I.jsx("th",{children:"Mental Health concerns"}),I.jsx("td",{"data-label":"content",class:"where-to-go-column",children:I.jsx("span",{children:"Use Earlham Counseling Services or see an in-network therapist"})}),I.jsx("td",{"data-label":"content",class:"cost",children:I.jsx("span",{children:"20% coinsurance (e.g., $30 per session)"})})]})]})]})]}),I.jsxs("div",{className:"not-covered-service",children:[I.jsx("h2",{children:"Services That Are Not Covered"}),I.jsx("p",{children:"The following services are generally not covered by your student health insurance plan. If you need them, expect to pay full price or consider separate coverage:"}),I.jsxs("ul",{children:[I.jsx("li",{children:"Acupuncture"}),I.jsx("li",{children:"Cosmetic surgery"}),I.jsx("li",{children:"Adult dental care (cleanings, fillings, etc.)"}),I.jsx("li",{children:"Routine eye exams and glasses for adults"}),I.jsx("li",{children:"Routine foot care (non-medical)"}),I.jsx("li",{children:"Long-term care (e.g., nursing homes)"}),I.jsx("li",{children:"Weight-loss programs (unless part of preventive care)"})]})]})]})]});function TFe(){var m;const[n,e]=we.useState(""),[t,s]=we.useState(""),[r,i]=we.useState(""),[a,o]=we.useState(!1),l=Yd(),d=((m=Ga().state)==null?void 0:m.from)||"/",f=async y=>{y.preventDefault(),o(!0),i("");const b=await qK(n,t);b.success?l(d):i(b.error),o(!1)};return I.jsx("div",{className:"auth-container",children:I.jsxs("div",{className:"auth-card",children:[I.jsx("h2",{children:"Login"}),r&&I.jsx("div",{className:"error-message",children:r}),I.jsxs("form",{onSubmit:f,children:[I.jsxs("div",{className:"form-group",children:[I.jsx("label",{children:"Email"}),I.jsx("input",{type:"email",value:n,onChange:y=>e(y.target.value),required:!0})]}),I.jsxs("div",{className:"form-group",children:[I.jsx("label",{children:"Password"}),I.jsx("input",{type:"password",value:t,onChange:y=>s(y.target.value),required:!0})]}),I.jsx("button",{type:"submit",className:"auth-button",disabled:a,children:a?"Logging in...":"Login"})]}),I.jsxs("p",{className:"auth-link",children:["Don't have an account? ",I.jsx("a",{href:"/signup",children:"Sign up"})]})]})})}function EFe(){const[n,e]=we.useState(""),[t,s]=we.useState(""),[r,i]=we.useState(""),[a,o]=we.useState(""),[l,u]=we.useState(!1),d=Yd(),f=async m=>{if(m.preventDefault(),t!==r){o("Passwords do not match");return}u(!0),o("");try{await KK(n,t),d("/login",{state:{message:"Account created successfully! Please log in."}})}catch(y){o(y.message)}finally{u(!1)}};return I.jsx("div",{className:"auth-container",children:I.jsxs("div",{className:"auth-card",children:[I.jsx("h2",{children:"Sign Up"}),a&&I.jsx("div",{className:"error-message",children:a}),I.jsxs("form",{onSubmit:f,children:[I.jsxs("div",{className:"form-group",children:[I.jsx("label",{children:"Email"}),I.jsx("input",{type:"email",value:n,onChange:m=>e(m.target.value),required:!0})]}),I.jsxs("div",{className:"form-group",children:[I.jsx("label",{children:"Password"}),I.jsx("input",{type:"password",value:t,onChange:m=>s(m.target.value),required:!0})]}),I.jsxs("div",{className:"form-group",children:[I.jsx("label",{children:"Confirm Password"}),I.jsx("input",{type:"password",value:r,onChange:m=>i(m.target.value),required:!0})]}),I.jsx("button",{type:"submit",className:"auth-button",disabled:l,children:l?"Creating Account...":"Sign Up"})]}),I.jsxs("p",{className:"auth-link",children:["Already have an account? ",I.jsx("a",{href:"/login",children:"Login"})]})]})})}function Pp({children:n}){const{isAuthenticated:e}=C_(),t=Ga();return e?n:I.jsx(yH,{to:"/login",state:{from:t.pathname},replace:!0})}const _Fe=()=>I.jsxs("div",{children:[I.jsx(e9,{}),I.jsx(s9,{}),I.jsx(i9,{}),I.jsx(d9,{}),I.jsx(p9,{})]}),IFe=()=>I.jsx(YK,{children:I.jsxs(UH,{children:[I.jsx(kL,{}),I.jsxs(xH,{children:[I.jsx(vo,{path:"/",element:I.jsx(_Fe,{})}),I.jsx(vo,{path:"/healthcare-search",element:I.jsx(Pp,{children:I.jsx(gFe,{})})}),I.jsx(vo,{path:"/how-it-works",element:I.jsx(Pp,{children:I.jsx(xFe,{})})}),I.jsx(vo,{path:"/when-and-where",element:I.jsx(Pp,{children:I.jsx(vFe,{})})}),I.jsx(vo,{path:"/insurance-general",element:I.jsx(Pp,{children:I.jsx(wFe,{})})}),I.jsx(vo,{path:"/earlham-insurance",element:I.jsx(Pp,{children:I.jsx(SFe,{})})}),I.jsx(vo,{path:"/login",element:I.jsx(TFe,{})}),I.jsx(vo,{path:"/signup",element:I.jsx(EFe,{})})]})]})});CG.createRoot(document.getElementById("root")).render(I.jsx(we.StrictMode,{children:I.jsx(IFe,{})}));
